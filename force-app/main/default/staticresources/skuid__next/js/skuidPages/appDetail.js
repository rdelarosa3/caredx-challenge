skuid.runtime.registerApi("v2","skuidPages/appDetail",function(e){var t=function(e){var t={};function a(r){if(t[r]){return t[r].exports}var i=t[r]={i:r,l:false,exports:{}};e[r].call(i.exports,i,i.exports,a);i.l=true;return i.exports}a.m=e;a.c=t;a.d=function(e,t,r){if(!a.o(e,t)){Object.defineProperty(e,t,{enumerable:true,get:r})}};a.r=function(e){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(e,"__esModule",{value:true})};a.t=function(e,t){if(t&1)e=a(e);if(t&8)return e;if(t&4&&typeof e==="object"&&e&&e.__esModule)return e;var r=Object.create(null);a.r(r);Object.defineProperty(r,"default",{enumerable:true,value:e});if(t&2&&typeof e!="string")for(var i in e)a.d(r,i,function(t){return e[t]}.bind(null,i));return r};a.n=function(e){var t=e&&e.__esModule?function t(){return e["default"]}:function t(){return e};a.d(t,"a",t);return t};a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};a.p="";return a(a.s=692)}({692:function(t,a){(function(e){const t=e.$,a=e.snippet.register,r=e.utils,i=r.combineUrls;a("dynamics.exportPage",function(){let t=e.$M("PageDeploy"),a=t.getRows()[0],n=a.dynamicsDataSource,o=e.dataSource.map()[n],s=a.webResourceName,l=a.entityName,u={dataSource:n,webResourceName:s,accessToken:o.authentication.responseBody.access_token};if(a.pageAuthentication==="SAML"&&a.samlProvider){u.samlRedirectUrl=i(window.location.origin,"/auth/saml/sp/"+a.samlProvider+"/redirect");u.skuidPagePath=a.skuidPageUrl}else{u.skuidPagePath=i(window.location.origin,a.skuidPageUrl)}if(a.createPage){if(l){u.pageEntity=l}u.pageType=a.createPage+"";u.pageName=a.pageName}return e.ajax.direct({url:"/api/v1/exportpage/dynamics",type:"POST",body:u,contentType:"application/json",headers:{"x-skuid-data-source-name":o.name}}).then(null,function(e){let t,a,i=e.body;if(i){i=r.parseAsJSONIfString(i);if(i){t=i.message}}if(!t)t="Unknown error";if(t&&t.indexOf("missing prvWriteWebResource")!==-1){a="Your Dynamics CRM Profile does not have permission to update Web Resources."}else if(t&&t.indexOf("missing prvCreateWebResource")!==-1){a="Your Dynamics CRM Profile does not have permission to create Web Resources."}else if(t){a=t}return r.reject({$PreviousAction:{Error:a}})})});a("dynamics.navigateToCustomSettings",function(){let t=e.dataSource.map()[e.$M("PageDeploy").getFirstRow().dynamicsDataSource];let a=t.serviceUrl;let r=a.substring(0,a.indexOf("/api/"));let i="FD140AAF-4DF4-11DD-BD17-0019B9312238";let n=r+"/tools/solution/edit.aspx?id=%7b"+i+"%7d";window.open(n)});a("dynamics.createDataSource",()=>{let t=e.$M("PageDeploy").getFirstRow().dynamicsDataSource;return e.loader.service.loadDataSourceAndDependencies(t)});a("dynamics.createEntityModel",function(){let a=e.$M("PageDeploy"),r=a.getRows()[0].dynamicsDataSource,i="Microsoft.Dynamics.CRM",n=e.$M("DynamicsEntitySetPicklistSource");let o=""+'<model id="EntitysCreatable" query="true" createrowifnonefound="false" datasource="'+r+'" deferfieldrendering="true" sobject="Microsoft.Dynamics.CRM.EntityDefinitions" label="EntityDefinitions" labelplural="EntityDefinitions">'+'<fields><field id="EntitySetName" accessible="true" createable="true" editable="true" sortable="true" label="EntitySetName" displaytype="STRING" edmtype="Edm.String" filterable="true" required="false"/>'+'<field id="CanCreateFrom__ui" uionly="true" displaytype="FORMULA" ogdisplaytype="TEXT" readonly="true" returntype="TEXT"><formula>{{CanCreateForms.Value}}+""</formula></field>'+'<field id="SchemaName" accessible="true" createable="true" editable="true" sortable="true" label="SchemaName" displaytype="STRING" edmtype="Edm.String" filterable="true" required="false"/>'+'<field id="CanCreateForms.Value" accessible="true" createable="true" editable="true" sortable="true" label="Value" displaytype="BOOLEAN" edmtype="Edm.Boolean" filterable="false" required="false"/>'+'<field id="ObjectTypeCode" accessible="true" createable="true" editable="true" sortable="true" label="ObjectTypeCode" displaytype="NUMBER" edmtype="Edm.Int32" filterable="false" required="false"/>'+'<field id="EntitySetName" accessible="true" createable="true" editable="true" sortable="true" label="ObjectTypeCode" displaytype="NUMBER" edmtype="Edm.Int32" filterable="false" required="false"/></fields>'+'<conditions><condition type="fieldvalue" value="true" enclosevalueinquotes="true" field="CanCreateFrom__ui"/></conditions>'+"<actions/>"+"</model>";let s=new e.model.Model(o);s.register();return s.load().then(function(){let e=s.dataSource,a=e.metadata,r=a.dataServices.schemaMap[i];t.each(s.getRows(),function(e,t){let a=t.EntitySetName;let o=r.entitySetMap[a];if(!o)return;let s=o.entityType;let l="";if(s.indexOf(i)!==-1){l=s.substring(i.length+1)}else{l=s}let u=n.createRow();n.updateRow(u,"value",l);n.updateRow(u,"label",l)})})});a("native.createApp",function(){let t=arguments[0],a=t.changes;return{id:a.id,name:a.name,android:true,ios:true,assets_url:e.coreAssetBase}});a("native.createPages",function(){let t=e.$M("App").getFirstRow(),a=e.$M("Routes"),r=a.dataMap[t.default_route_id],i=e.$M("NativePages"),n=i.createRow();i.updateRow(n,{id:r.page.id,name:r.page.name,is_default:true,namespace:"",route:r.fq_route});return i.save().then(function(){i.emptyData();for(let e=0;e<a.data.length;e++){let t=a.data[e];if(r.id!==t.id){let e=i.createRow();i.updateRow(e,{id:t.page.id,name:t.page.name,is_default:false,namespace:"",route:t.fq_route})}}return i.save()}).then(function(){return i.emptyData()})});a("native.buildApp",function(){let t=arguments[0],a=t.changes,i=r.userInfo,n=e.settings.offline&&e.settings.offline("enabled");return{android_key_alias:a.android_key_alias,android_key_passphrase:a.android_key_passphrase,android_keystore_passphrase:a.android_keystore_passphrase,apple_key_passphrase:a.apple_key_passphrase,username:i.userName,first_name:i.firstName,last_name:i.lastName,email:i.email,offlineEnabled:n}});a("native.deleteKey",function(t){let a=t.$Input.name,i=t.$Input.appId;return e.ajax.direct({method:"DELETE",url:"/api/v1/native-service/proxy/apps/".concat(i,"/images/").concat(a),contentType:"application/json",headers:{"skuid-organization":r.userInfo.organizationId}})});a("native.disablePush",function(){const t=e.model.getModel("NativeApp"),a=t.getFirstRow(),i=t.getFieldValue(a,"id");return e.ajax.direct({method:"DELETE",url:"/api/v1/native-service/proxy/apps/".concat(i,"/push"),contentType:"application/json",headers:{"skuid-organization":r.userInfo.organizationId}})});function n(e){if(!e||e.getType()!=="skuid__image")return;const t=/([?&]uniqueKey=)([^?&]*)/,a=e.get("imageSrc");let i;if(a){const n=r.generateGUID();if(a.match(t)){i=a.replace(t,"$1".concat(n))}else{i=a.indexOf("?")>-1?a+"&uniqueKey=".concat(n):a+"?uniqueKey=".concat(n)}e.set("imageSrc",i)}}a("native.updateIconSrc",function(){const t=e.component.getById("IconImage");n(t)});a("native.updateSplashscreenSrcs",function(){const t=[e.component.getById("SplashscreenImage_Portrait"),e.component.getById("SplashscreenImage_Landscape")];t.forEach(e=>{n(e)})});a("AppDetail.ParseRouteParameters",t=>{const a=t.row,r=a.fq_route,i=e.$M("apps__RouteParameters");i.emptyData();i.adoptRows(e.lib.Mustache.parse(r,["{","}"]).filter(e=>e[0]==="name").map(e=>{let t=e[1],a=t.indexOf("*")>-1,r=t.indexOf("?")>-1,i=r||a;if(r)t=t.replace("?","");if(a)t=t.substring(0,t.indexOf("*"));return{IsOptional:i,Name:t,FullName:"{"+e[1]+"}"}}))});a("AppDetail.PreviewParameterizedRoute",t=>{let a=t.row.fq_route;e.$M("apps__RouteParameters").getRows().forEach(e=>{a=a.replace(e.FullName,e.Value||"")});r.redirect({url:a,window:"blank"})})})(e)}});return t});