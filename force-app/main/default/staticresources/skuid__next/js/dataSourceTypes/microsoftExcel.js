skuid.runtime.registerApi("v2","dataSourceTypes/microsoftExcel",function(e){var a=function(e){var a={};function t(l){if(a[l]){return a[l].exports}var r=a[l]={i:l,l:false,exports:{}};e[l].call(r.exports,r,r.exports,t);r.l=true;return r.exports}t.m=e;t.c=a;t.d=function(e,a,l){if(!t.o(e,a)){Object.defineProperty(e,a,{enumerable:true,get:l})}};t.r=function(e){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(e,"__esModule",{value:true})};t.t=function(e,a){if(a&1)e=t(e);if(a&8)return e;if(a&4&&typeof e==="object"&&e&&e.__esModule)return e;var l=Object.create(null);t.r(l);Object.defineProperty(l,"default",{enumerable:true,value:e});if(a&2&&typeof e!="string")for(var r in e)t.d(l,r,function(a){return e[a]}.bind(null,r));return l};t.n=function(e){var a=e&&e.__esModule?function a(){return e["default"]}:function a(){return e};t.d(a,"a",a);return a};t.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)};t.p="";return t(t.s=721)}({721:function(a,t){const{utils:l,dataSource:r,constants:s,component:i}=e,o=r.utils,n="https://graph.microsoft.com/v1.0",{ALPHABET:u,DISPLAY_TYPES:d,MIME_TYPES:c,HTTP_VERBS:b}=s,p="MicrosoftExcel",f="x-metadata",y=c.JSON,m="Workbook",h="Worksheet",v="Range",g="Table",k="TableRange",w="Chart",S=[v,k],{DATE:T,DATETIME:C,NUMBER:x,OBJECT:E,STRING:M,BOOLEAN:O,FORMULA:A,TEXT:I}=d,{GET:N,POST:D,PATCH:R,DELETE:H}=b,q=o.getModelMergeConditions,P={urlEncode:false},B=i.displayMethodRegistry,L=i.DisplayMethod,F=B.get(T),_=B.get(C),j=B.get(I),U=(e,a,t)=>{e.picklistEntries.forEach(e=>{if(t===e.value&&e.arg)a.push(e.arg)})},Y=(a,t)=>{const r=a.attr("workbook"),s=e.$M(l.mergeAsDataInContext(a.attr("model"),t));if(r)return r;return s.getFirstRow().id};B.register("DATE",new L({getDisplayInformation(e,a={}){if(a.row){e=a.row._text[a.fieldId]}return F.getDisplayInformation(e,a)},readModeStrategy:F.readModeStrategy,read(e,a){const t=e.cpi.getContext();a.value=t.row._text[t.field.id];e.set("value",a.value);return F.read(e,a)}}),p);B.register("DATETIME",new L({getDisplayInformation(e,a={}){if(a.row){e=a.row._text[a.fieldId]}return _.getDisplayInformation(e,a)},readModeStrategy:_.readModeStrategy,read(e,a){const t=e.cpi.getContext();a.value=t.row._text[t.field.id];e.set("value",a.value);return _.read(e,a)}}),p);B.register("FORMULA",new L({readModeStrategy:j.readModeStrategy,read(){return j.read.apply(j,arguments)},editModeStrategy:j.editModeStrategy,edit(e,a){const t=e.cpi.getContext();a.value=t.row._formulas[t.field.id];e.set("value",a.value);return j.edit(e,a)}}),p);new r.core.RESTDataSourceTypeBase({name:p,coerceRequest(e){const{type:a,model:t,row:r}=e,s=q(t,e,P),i=this.getEntityMetadataCacheKey(t),{file:o,worksheet:n,parent:u}=s,d=r&&r._rowRange,c=r&&r._formulas;if(a==="query"){if(i===m){if(u){if(u.indexOf(".")!==-1){e.request=Object.assign({},e.request,{url:"/me/drive/root:".concat(u),pathToContent:""})}else{e.request=Object.assign({},e.request,{url:u==="/"?"/me/drive/root/children":"/me/drive/root:".concat(u,":/children"),pathToContent:"value"})}}else{e.request=Object.assign({},e.request,{url:"/me/drive/root/children",pathToContent:"value"})}}}else if(a==="update"){if(S.includes(i)){const a=[];l.eachObject(e.request.data,(e,a)=>c[a]=e);l.eachObject(c,e=>a.push(e));e.request=Object.assign({},e.request,{data:{formulas:[a]},url:"/me/drive/items/".concat(o,"/workbook/worksheets('").concat(n,"')/range(address='").concat(d,"')")})}}e.request=Object.assign({},e.request,{headers:{Accept:y,"Content-Type":y,"Content-Length":0}})},parseSuccessfulLoadResponse(e,a,t,r,s){const i=this.parseResponseBodyAsJSON(e.body),o=q(r,{model:r},P),n=o.hasHeader==="true",u=a.pathToContent,d=this.getEntityMetadataCacheKey(r),c=(e,a,t)=>Object.assign({},e,{createdByUserName:l.getObjectProperty(a,"createdBy.user.displayName"),lastModifiedByUserName:l.getObjectProperty(a,"lastModifiedBy.user.displayName"),oneUp:t.substring(0,t.lastIndexOf("/")),parentDirectory:t}),b=[];let p=u?l.getObjectProperty(i,u):i;if(d===m){if(Array.isArray(p.value)){p.value.forEach((e,a)=>{const t=e.name.split(".").slice(-1)[0],l=e.parentReference.path,r=l?l.split(":")[1]:e.parentReference.id;if(t.indexOf("xlsx")===-1){delete p[a]}else{b.push(c(e,p,r))}});p=b}else if(l.isObject(p)){const e=p.parentReference.path,a=e?e.split(":")[1]:p.parentReference.id;p=[c(p,p,a)]}}else if(S.includes(d)){const e=i.formulas,a=i.values,t=i.text,l=i.address.split("!"),r=l[1],o=r.split(":"),u=[],d=[];let c=[],f=0,y=0,m;if(n){c=p[0];p.shift()}else{s.sort((e,a)=>e.column-a.column);s.forEach(e=>c.push(e.id))}o.forEach((e,a)=>{d[a]=e.replace(/[^0-9]/,"");u[a]=e.replace(/[0-9]/g,"")});a.forEach((a,l)=>{const s=n?e[l+1]:e[l],i=n?t[l+1]:t[l],o={},p={};if(y===0)m=parseInt(d[0],10);if(n&&y===0)m+=1;if(f!==l)m+=1;a.forEach((e,a)=>{o[c[a].replace(/ /g,"").trim()]=s[a];p[c[a].replace(/ /g,"").trim()]=i[a]});const h=r.indexOf(":")===-1?u[0]+m:"".concat(u[0]).concat(m,":").concat(u[1]).concat(m);b[l]={_rowRange:h,_formulas:o,_text:p};a.forEach((e,a)=>b[l][c[a].replace(/ /g,"")]=e);if(f!==l)f=l;y=1});p=b}return p},parseSuccessfulSaveResponse(e,a){const t=l.parseAsJSONIfString(e.body),r=a.model,s=r.fields;if(S.includes(r.objectName)){const e=t.address.split("!"),a={_formulas:{},_text:{},_rowRange:e[1]};s.sort((e,a)=>e.column-a.column);s.forEach(e=>{const l=e.column;a[e.id]=t.values[0][l];a["_formulas"][e.id]=t.formulas[0][l];a["_text"][e.id]=t.text[0][l]});return a}},queryEntityMetadata(a){const t=this.getEntityMetadataCacheKey(a),r=this.prop(f)[t],s=r.methods.query,i={type:"query",method:s,model:a,request:{url:s.url,method:s.verb,contentType:s.contentType,headers:{Accept:y}}},o=a.conditions,n=o?q(a,i,P):{},d=n.hasHeader==="true",c=[],b=[],p=e=>{const a=e.split(":");a.forEach((e,a)=>{c[a]=e.replace(/[0-9]/g,"");b[a]=e.replace(/[^0-9]/,"")});let t=u.indexOf(c[0].toUpperCase()),l=u.indexOf(c[1].toUpperCase())-t;for(let e=0;e<=l;e++){r.fields[e]={id:"Column".concat(u[t]),label:"Column ".concat(u[t]),column:e,displaytype:A,accessible:true,createable:false,editable:true,"x-alwaysinclude":true};t++}};if(S.includes(t)&&l.size(n)){if(e.builder){p(n.range||"")}else if(!l.isString(a)){return this.makeRequest(a,i).then(e=>{const a=this.parseResponseBodyAsJSON(e.body);p(a.address.split("!")[1]);if(d){r.fields=a.values[0].map((e,a)=>Object.assign({},r.fields[a],{label:e}))}return r})}}return l.resolve(r)},createActions(a,t,l={}){const r=l.component,s=(t={})=>{return e.ajax.direct({url:t.url,headers:{Authorization:"Bearer ".concat(a.authentication.responseBody.access_token),"Content-Type":y,Accept:y},method:D,dataType:"json",data:JSON.stringify(t.body)}).then(e=>({$Excel:e})).catch(e=>{throw e})},i={label:"Number",id:"arg1",name:"number",type:"string",valueType:"number"},o={label:v,id:"arg1",name:"range",type:"string",valueType:"range"},u={label:"Workbook ID",id:"workbook",type:"text"},d=[{value:"abs",label:"ABS()",arg:i},{value:"acos",label:"ACOS()",arg:i},{value:"acosh",label:"ACOSH()",arg:i},{value:"acot",label:"ACOT()",arg:i},{value:"acoth",label:"ACOTH()",arg:i},{value:"asin",label:"ASIN()",arg:i},{value:"asinh",label:"ASINH()",arg:i},{value:"atan",label:"ATAN()",arg:i},{value:"atanh",label:"ATANH()",arg:i},{value:"average",label:"AVERAGE()",arg:o},{value:"cos",label:"COS()",arg:i},{value:"cosh",label:"COSH()",arg:i},{value:"cot",label:"COT()",arg:i},{value:"coth",label:"COTH()",arg:i},{value:"csc",label:"CSC()",arg:i},{value:"csch",label:"CSCH()",arg:i},{value:"max",label:"MAX()",arg:o},{value:"median",label:"MEDIAN()",arg:o},{value:"min",label:"MIN()",arg:o},{value:"mode",label:"MODE()",arg:o},{value:"pi",label:"PI()"},{value:"sin",label:"SIN()",arg:i},{value:"sinh",label:"SINH()",arg:i},{value:"sqrt",label:"SQRT()",arg:i},{value:"sqrtpi",label:"SQRTPI()"},{value:"sum",label:"SUM()",arg:o},{value:"round",label:"ROUND()",arg:i},{value:"rounddown",label:"ROUNDDOWN()",arg:i},{value:"roundup",label:"ROUNDUP()",arg:i}];let c,b,p;if(e.builder){c=[u,{label:"Function Name",id:"function",type:"picklist",picklistEntries:d,onChange(e){c.splice(2);U(this,c,e);r.rebuildProps()}}];b=[u,{label:v,id:"range",name:"range",type:"string"},{label:"Has Headers",id:"headers",type:"boolean"}];p=[u,{label:"".concat(h," Name or ID"),id:"worksheet",type:"text"},{label:"".concat(w," Type"),id:"charttype",type:"picklist",picklistEntries:[{value:"ColumnClustered",label:"Clustered Column"},{value:"ColumnStacked",label:"Stacked Column"},{value:"ColumnStacked100",label:"100% Stacked Column"},{value:"Line",label:"Line"},{value:"LineStacked",label:"Stacked Line"},{value:"LineStacked100",label:"100% Stacked Line"},{value:"LineMarkers",label:"Line with Markers"},{value:"LineMarkersStacked",label:"Stacked Line with Markers"},{value:"LineMarkersStacked100",label:"100% Stacked Line with Markers"},{value:"PieOfPie",label:"Pie"},{value:"Doughnut",label:"Doughnut"},{value:"BarClustered",label:"Clustered Bar"},{value:"BarStacked",label:"Stacked Bar"},{value:"BarStacked100",label:"100% Stacked Bar"},{value:"Area",label:"Area"},{value:"AreaStacked",label:"Stacked Area"},{value:"AreaStacked100",label:"100% Stacked Area"},{value:"XYScatter",label:"Scatter with only Markers"},{value:"XYScatterSmooth",label:"Scatter with Smooth Lines and Markers"},{value:"XYScatterSmoothNoMarkers",label:"Scatter with Smooth Lines"},{value:"XYScatterLines",label:"Scatter with Straight Lines and Markers"},{value:"XYScatterLinesNoMarkers",label:"Scatter with Straight Lines"},{value:"Radar",label:"Radar"},{value:"RadarFilled",label:"Filled Radar"},{value:"RadarMarkers",label:"Radar with Markers"}]},{label:"Source Data",id:"sourcedata",type:"text"},{label:"".concat(w," Series By"),id:"seriesby",type:"picklist",defaultValue:"Auto",picklistEntries:[{value:"Auto",label:"Auto"},{value:"Columns",label:"Columns"},{value:"Rows",label:"Rows"}]}];U(c[1],c,t.attr("function"))}return{function:{label:"Excel Function",builderProps:c||"",runtimeExecution(e,a,t,l){const r={};d.forEach(a=>{if(a.value===e.attr("function")&&a.arg){const t=a.arg,l=e.attr(t.id);if(t.valueType==="number"){r[t.name]=l}else if(t.valueType==="range"){r.values=[];if(l.indexOf(",")>-1){l.split(",").forEach(e=>{if(e.match(/[a-z]/i)){r.values.push({address:e})}else{r.values.push(e)}})}else{r.values.push({address:l})}}}});return s({url:"".concat(n,"/me/drive/items/").concat(Y(e,t),"/workbook/functions/").concat(e.attr("function")),body:r,ds:l})}},"create-table":{label:"Create Excel ".concat(g),builderProps:b||"",runtimeExecution(e,a,t,l){return s({url:"".concat(n,"/me/drive/items/").concat(Y(e,t),"/workbook/tables/add"),body:{address:e.attr("range"),hasHeaders:e.attr("headers")==="true"},ds:l})}},"create-chart":{label:"Create ".concat(w),builderProps:p||"",runtimeExecution(e,a,t,l){return s({url:"".concat(n,"/me/drive/items/").concat(Y(e,t),"/workbook/worksheets('").concat(e.attr("worksheet"),"')/charts/add"),body:{type:e.attr("charttype"),sourceData:e.attr("sourcedata"),seriesBy:e.attr("seriesby")},ds:l})}}}},getActions:o.getActionsStatic,getEntityList:o.getEntityListStatic,extendedProperties:{composer:{unomittableFields:true,hasEntityOptions:true},validConditionTypes:["fieldvalue","multiple","param","boolean","modelmerge"],canFieldsBeIndividuallySearched:true,canServerSearch:true,[f]:{[m]:{idFields:["id"],nameField:"name",label:m,labelPlural:"Workbooks",fields:[{id:"id",label:"Id",displaytype:M,inlineHelpText:"Identifier of the drive.",accessible:true,createable:false,editable:false,"x-alwaysinclude":true},{id:"name",label:"Name",displaytype:M,inlineHelpText:"Name of the drive.",accessible:true,createable:false,editable:true},{id:"createdByUserName",label:"Created By",displaytype:M,accessible:true,createable:false,editable:false},{id:"createdDateTime",label:"Created Date Time",displaytype:C,accessible:true,createable:false,editable:false},{id:"lastModifiedByUserName",label:"Last Modified By",displaytype:M,accessible:true,createable:false,editable:false},{id:"lastModifiedDateTime",label:"Last Modified",displaytype:C,accessible:true,createable:false,editable:false},{id:"webUrl",label:"Web Url",displaytype:M,accessible:true,createable:false,editable:false},{id:"parentReference",label:"Parent Reference",displaytype:E,accessible:false,createable:false,editable:false},{id:"size",label:"Size",displaytype:x,accessible:true,createable:false,editable:false},{id:"parentDirectory",label:"Parent Directory",displaytype:M,accessible:true,createable:false,editable:true},{id:"oneUp",label:"Directory Up",displaytype:M,accessible:true,createable:false,editable:false}],methods:{query:{url:"",verb:N,contentType:y,pathToContent:""}},defaultConditions:[{sourcetype:"param",sourceparam:"parent",name:"parent",label:"Path to Folder or File",state:"filterableon",value:""}]},[h]:{idFields:["id"],nameField:"name",label:h,labelPlural:"".concat(h,"s"),fields:[{id:"id",label:"Id",displaytype:M,inlineHelpText:"Identifier of the worksheet.",accessible:true,createable:false,editable:false,"x-alwaysinclude":true},{id:"name",label:"Name",displaytype:M,inlineHelpText:"Name of the worksheet.",accessible:true,createable:true,editable:true,"x-alwaysinclude":true},{id:"position",label:"Position",displaytype:x,inlineHelpText:"Position of the worksheet in the workbook.",accessible:true,createable:false,editable:true,"x-alwaysinclude":true},{id:"visibility",label:"Visibility",displaytype:M,inlineHelpText:"Whether the worksheet is visible.",accessible:true,createable:false,editable:true,"x-alwaysinclude":true}],methods:{query:{url:"/me/drive/items/{{file}}/workbook/worksheets",verb:N,contentType:y,pathToContent:"value"},insert:{url:"/me/drive/items/{{file}}/workbook/worksheets/add",verb:D,contentType:y,receiveDataAs:"recordinbody",successIf:"responsefieldequals",successField:"status",successValue:"Created"},update:{url:"/me/drive/items/{{file}}/workbook/worksheets('{{id}}')",verb:R,contentType:y,receiveDataAs:"recordinbody",successIf:"responsefieldispresent"},delete:{url:"/me/drive/items/{{file}}/workbook/worksheets('{{id}}')",verb:H,contentType:y,successIf:"responsefieldisempty"}},defaultConditions:[{sourcetype:"param",sourceparam:"file",name:"file",label:"File ID",state:"filterableon",type:"fieldvalue",required:true,value:""}]},[v]:{label:v,labelPlural:"".concat(v,"s"),fields:[],methods:{query:{url:"/me/drive/items/{{file}}/workbook/worksheets('{{worksheet}}')/range(address='{{range}}')",verb:N,contentType:y,pathToContent:"values"},update:{url:"",verb:R,contentType:y,pathToContent:""}},defaultConditions:[{sourcetype:"param",sourceparam:"file",name:"file",label:"File ID",state:"filterableon",type:"fieldvalue",required:true,value:""},{sourcetype:"param",sourceparam:"worksheet",name:"worksheet",label:"".concat(h," Name or ID"),state:"filterableon",type:"fieldvalue",required:true,value:""},{sourcetype:"param",sourceparam:"range",name:"range",label:"Cell ".concat(v),state:"filterableon",type:"fieldvalue",value:""},{sourcetype:"param",sourceparam:"hasHeader",name:"hasHeader",label:"Has Headers",state:"fixed",type:"boolean",required:true,value:false}]},[g]:{idFields:["id"],nameField:"name",label:g,labelPlural:"".concat(g,"s"),fields:[{id:"id",label:"Id",displaytype:M,inlineHelpText:"Identifier of the table.",accessible:true,createable:false,editable:false,"x-alwaysinclude":true},{id:"name",label:"Name",displaytype:M,inlineHelpText:"Name of the table.",accessible:true,createable:true,editable:true},{id:"highlightFirstColumn",label:"Highlight First Column",displaytype:O,accessible:true,createable:true,editable:true},{id:"highlightLastColumn",label:"Highlight Last Column",displaytype:O,accessible:true,createable:true,editable:true},{id:"showBandedColumns",label:"Show Banded Columns",displaytype:O,accessible:true,createable:true,editable:true},{id:"showBandedRows",label:"Show Banded Rows",accessible:true,createable:true,editable:true},{id:"showFilterButton",label:"Show Filter Button",accessible:true,createable:true,editable:true},{id:"showHeaders",label:"Show Headers",accessible:true,createable:true,editable:true},{id:"showTotals",label:"Show Totals",accessible:true,createable:true,editable:true},{id:"style",label:"".concat(g," Style"),accessible:true,createable:true,editable:true}],methods:{query:{url:"/me/drive/items/{{file}}/workbook/worksheets('{{worksheet}}')/tables",verb:N,contentType:y,pathToContent:"value"},update:{url:"/me/drive/items/{{file}}/workbook/worksheets('{{worksheet}}')/tables('{{id}}')",verb:R,contentType:y}},defaultConditions:[{sourcetype:"param",sourceparam:"file",name:"file",label:"File ID",state:"filterableon",type:"fieldvalue",required:true,value:""},{sourcetype:"param",sourceparam:"worksheet",name:"worksheet",label:"".concat(h," Name or ID"),state:"filterableon",type:"fieldvalue",required:true,value:""}]},[k]:{label:k,labelPlural:"".concat(k,"s"),fields:[],methods:{query:{url:"/me/drive/items/{{file}}/workbook/tables('{{table}}')/Range",verb:N,contentType:y,pathToContent:"values"},update:{url:"",verb:R,contentType:y,pathToContent:""}},defaultConditions:[{sourcetype:"param",sourceparam:"file",name:"file",label:"File ID",state:"filterableon",type:"fieldvalue",required:true,value:""},{sourcetype:"param",sourceparam:"worksheet",name:"worksheet",label:"".concat(h," Name or ID"),state:"filterableon",type:"fieldvalue",value:""},{sourcetype:"param",sourceparam:"table",name:"table",label:"".concat(g," Name or ID"),state:"filterableon",type:"fieldvalue",required:true,value:""},{sourcetype:"param",sourceparam:"hasHeader",name:"hasHeader",label:"Has Headers",state:"fixed",type:"boolean",required:true,value:true}]},[w]:{idFields:["id"],nameField:"name",label:w,labelPlural:"".concat(w,"s"),fields:[{id:"id",label:"Id",displaytype:M,inlineHelpText:"Identifier of the chart.",accessible:true,createable:false,editable:false,"x-alwaysinclude":true},{id:"name",label:"Name",displaytype:M,inlineHelpText:"Name of the chart.",accessible:true,createable:true,editable:true},{id:"height",label:"Height",displaytype:x,accessible:true,createable:false,editable:false},{id:"width",label:"Width",displaytype:x,accessible:true,createable:false,editable:false},{id:"top",label:"Top",displaytype:x,accessible:true,createable:false,editable:false},{id:"left",label:"Left",displaytype:x,accessible:true,createable:false,editable:false}],methods:{query:{url:"/me/drive/items/{{file}}/workbook/worksheets('{{worksheet}}')/charts",verb:N,contentType:y,pathToContent:"value"},update:{url:"/me/drive/items/{{file}}/workbook/worksheets('{{worksheet}}')/charts('{{name}}')",verb:R,contentTYpe:y},delete:{url:"/me/drive/items/{{file}}/workbook/charts('{{name}}')/delete",verb:D,contentType:y,successIf:"responsebodyisempty"}},defaultConditions:[{sourcetype:"param",sourceparam:"file",name:"file",label:"File ID",state:"filterableon",type:"fieldvalue",required:true,value:""},{sourcetype:"param",sourceparam:"worksheet",name:"worksheet",label:"".concat(h," Name or ID"),state:"filterableon",type:"fieldvalue",value:""}]}}}})}});return a});