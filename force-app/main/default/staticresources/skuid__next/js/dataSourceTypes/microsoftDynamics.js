skuid.runtime.registerApi("v2","dataSourceTypes/microsoftDynamics",function(e){var t=function(e){var t={};function i(a){if(t[a]){return t[a].exports}var n=t[a]={i:a,l:false,exports:{}};e[a].call(n.exports,n,n.exports,i);n.l=true;return n.exports}i.m=e;i.c=t;i.d=function(e,t,a){if(!i.o(e,t)){Object.defineProperty(e,t,{enumerable:true,get:a})}};i.r=function(e){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(e,"__esModule",{value:true})};i.t=function(e,t){if(t&1)e=i(e);if(t&8)return e;if(t&4&&typeof e==="object"&&e&&e.__esModule)return e;var a=Object.create(null);i.r(a);Object.defineProperty(a,"default",{enumerable:true,value:e});if(t&2&&typeof e!="string")for(var n in e)i.d(a,n,function(t){return e[t]}.bind(null,n));return a};i.n=function(e){var t=e&&e.__esModule?function t(){return e["default"]}:function t(){return e};i.d(t,"a",t);return t};i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};i.p="";return i(i.s=720)}({15:function(e){e.exports={date:"1612394257000",id:"v2",major:12,minor:4,patch:20,build:0,number:"12.4.20.0",name:"Spark Update 3 (12.4.20.0)",path:"next"}},720:function(t,i,a){"use strict";a.r(i);var n=a(15);var r=a.t(15,1);(function(e){let t=e.$,i=t.each,a=e.utils,r=e.dataSource.utils,o=e.data.v2.sessionStorage,u="Microsoft.Dynamics.CRM",s="Uniqueidentifier",l={None:false,SystemRequired:true,ApplicationRequired:true,Recommended:false},c="@odata.nextLink",d="Microsoft.Dynamics.CRM.PicklistAttributeMetadata",f="Microsoft.Dynamics.CRM.StatusAttributeMetadata",p="Microsoft.Dynamics.CRM.StateAttributeMetadata",m="statecode",y="statuscode",b={1:{endpoint:"WinOpportunity",objectParameterName:"OpportunityClose"},2:{endpoint:"LoseOpportunity",objectParameterName:"OpportunityClose"}};if(e.dataSource.getType("MicrosoftDynamics"))return;function g(e){if(!e)return false;return e===d||e===f||e===p}function h(e,t,i){return!!a.grab(e,"picklistMetadata","validStateMapping",t,i)}function S(e,t){let i=e.length;while(i--){if(t(e[i],i)){e.splice(i,1)}}}function R(e,t){return e.makeRequest(e.createHTTPRequest(t))}function M(e,t){let i=e.serviceUrl;return R(e,{url:a.combineUrls(i,t),method:"GET",headers:T()}).then(function(e){return e&&e.body})}function v(e){return M(e,"WhoAmI")}function I(e,t,i,a){let n={};n[m]=0;n[y]=i;n["@odata.type"]="#Microsoft.Dynamics.CRM.opportunity";return R(t,{url:a,method:"PATCH",headers:T({"Content-ID":e}),body:JSON.stringify(n)})}function T(e){let i={"Content-Type":"application/json; charset=utf-8",Accept:"application/json","OData-MaxVersion":"4.0","OData-Version":"4.0"};return t.extend(i,e||{})}function D(e){return a.grab(e,"metadata","securityRoles")||[]}let U=e.dataSource.core,E=U.ODataDataSourceTypeBase;new E({name:"MicrosoftDynamics",supportsToLowerForFilters:function e(){return false},getGenericErrorMessage:function e(){return"Unknown error occured during Dynamics request"},preSaveHook:function i(n,r,o,u){let s=u&&(u.type==="opportunities"||u.type==="Microsoft.Dynamics.CRM.opportunities")&&!!a.size(u.updates);if(!s)return a.resolve();let l=e.model.getModel(u.id),c=r&&r.serviceUrl,d=l&&l.getField(m),f=d&&d.picklistMetadata,p=f&&f.stateDefaultMapping;if(!d||!p||!c)return a.resolve();return Promise.all(t.map(o,function(e){let i=e.data,o=e.method==="PATCH",s=i&&i[m],d=i&&i[y];if(!o||s!==1&&s!==2){return}let f=e.__oldid,g=f&&l.getRecordById(f).row(),h=g&&l.getRowOriginals(g),S=b[s],M=S.endpoint,v=S.objectParameterName,D={},U=0,E=true,O=a.resolve();D[v]={"opportunityid@odata.bind":a.combineUrls(c,e.requestUri)};delete i[m];delete i[y];t.each(i,function(e){if(e.indexOf("@odata")===-1||e==="@odata.bind"){E=false;return false}});if(E){i.__shouldRemove=true}if(a.isUndefined(d)||isNaN(d)){d=p[s]}D.Status=d;if(h&&h[m]+""!=="0"){O=I(f,r,p[U],a.combineUrls(c,e.requestUri))}return O.then(function(){return R(r,{url:a.combineUrls(c,M),method:"POST",headers:T(),body:JSON.stringify(D)})}).then(function(){n.updateResults.push({errors:[],id:f,messages:[],record:JSON.stringify({statecode:s,statuscode:d}),source:u.id,success:true})}).catch(function(){n.updateResults.push({errors:[{message:"There was an error attempting to update the Opportunity Status"}],id:f,messages:[],record:{},source:u.id,success:false})})}))},coerceResponseItemData:function e(i,a,n,r){if(a&&a.statusCode==="204"&&n){t.each(n,function(e){if(r&&r[e]){return}if(e==="@odata.type"){let t=n[e];delete n[e];n["@odata\\.type"]=t;return}delete n[e]})}},coerceRequest:function e(t,i){let a=i.model;if(!a)return;let n=a.recordsLimit|0;if(n>0){t.headers["Prefer"]="odata.maxpagesize="+(n+1)}if(i.addOnly&&a.paginationURL){let e=a.paginationURL.split("$skiptoken=");let i=e[e.length-1];t.parameters={$skiptoken:i}}},isPolyMorphicField:function e(t){if(t==="owninguser@odata.bind")return"owninguser@odata.bind";if(t==="owningteam@odata.bind")return"team@odata.bind"},coerceResponse:function e(t,i){if(!i||!t)return;let a=t.body&&t.body[c];if(!a){i.canRetrieveMoreRows=false;return}i.canRetrieveMoreRows=true;i.paginationURL=a.substring(a.indexOf("$skiptoken"))},coerceSaveItemRequest:function i(a,n){let r=this,o=["Edm.DateTimeOffset","Edm.DateTime"];a.headers["Content-ID"]=""+n.key;let u=n&&n.model&&n.model.fieldsMap;t.each(a.data,function(t,i){if(r.isPolyMorphicField(t,i)){delete a.data[t];a.data["ownerid@odata.bind"]=i}if(!u)return;if(u[t]&&o.indexOf(u[t].edmtype)!==-1){a.data[t]=e.time.parseDateTimeString(i).toISOString()}})},supportsBatch:function e(){return a.resolve(true)},coerceAdditionalQueries:function e(t){t.requestUri=t.requestUri.replace("guid'","").replace("')",")")},evaluateUserInfoConditionSourceType:function e(i,n){if(n!=="RoleName"&&n!=="RoleId"){return i.getUserInfoProperty(n)}let r=i.getUserInfoProperty("Roles")||[];if(n==="RoleId"){return r.join(";")}let o=a.keyBy(D(i),"roleid")||{};let u=t.map(r,function(e){let t=o[e]&&o[e].name;return t&&[t,t.toLowerCase()]});return u.join(";")},getTopClause:function e(){},getSkipClause:function e(){},getEntitySetFromEntityTypeName:function e(t,i){let a=this,n=a.getEntityType(t,i);if(n.entitySetName){return a.getEntitySet(n.entitySetName,i)}return E.prototype.getEntitySetFromEntityTypeName(t,i)},getDefaultFieldsForReferenceField:function e(t,i,n){let r=a.getFieldReference(t,i,n);return[r,t+"."+i.keyField]},produceErrorTextFromErrors:function e(i){return"Dynamics Web API Query error: "+t.map(i,function(e){let t=a.grab(e,"response","body"),i,n,r;if(!t){if(a.isString(e))return e;return a.grab(e,"response","error")||"Bad Request"}i=t.message;n=t.statusCode;r=t.error;if(r==="Not Implemented"){return"Attempted a query not supported by the Dynamics Web API ("+n+" - "+r+")"}return i+" ("+r+" - "+n+")"}).join("; ")},withinADynamicsPage:function e(){return a.deparam(window.location.search).inDynamics==="true"},getNameFieldURLForReferenceField:function t(i,n,r){let o=this,u=i.model,s=i.row,l=i.metadata,c=i.options.fieldXML,d=c&&c.attr("redirecttype")||"datasourcedefault",f=e.dataSource.DataSourceType.prototype.getNameFieldURLForReferenceField;if(d!=="datasourcedefault"){return f(i,n,r)}let p=u.dataSource,m=p.metadata,y=p.dataSourceType,b=y.getEntitySet(u.objectName,m),g=b&&y.getEntityType(b.entityType,m),h=g&&g.nameField===i.id,S=u.getRowId(s),R=s&&s[i.id]&&s[i.id][l.keyField],M=l.ref&&o.getEntityType(l.ref,m),v=M&&M.name,I,T,D,U;if(v){D=R;U=v}else if(h){D=S;U=g.name}if(!D||!U)return;I=p.serviceUrl.substring(0,p.serviceUrl.indexOf("/api/")+1);T=I+"main.aspx?etn="+a.encodeHTML(U)+"&id="+a.encodeHTML(D)+"&pagetype=entityrecord";return'<a href="'+T+'" target="'+(o.withinADynamicsPage()?"top":"_blank")+'">'+r+"</a>"},getLinkInfoForReferenceField:function t(i={},n){let r=this,o=i.model,u=i.row,s=o.getField(i.fieldId),l=i.redirectType||"datasourcedefault",c=e.dataSource.DataSourceType.prototype.getLinkInfoForReferenceField;if(l!=="datasourcedefault"){return c(i={},n)}let d=o.dataSource,f=d.metadata,p=d.dataSourceType,m=p.getEntitySet(o.objectName,f),y=m&&p.getEntityType(m.entityType,f),b=y&&y.nameField===s.id,g=o.getRowId(u),h=u&&u[s.id]&&u[s.id][s.keyField],S=s.ref&&r.getEntityType(s.ref,f),R=S&&S.name,M,v,I;if(R){v=h;I=R}else if(b){v=g;I=y.name}if(!v||!I)return;M=d.serviceUrl.substring(0,d.serviceUrl.indexOf("/api/")+1);return{refLink:M+"main.aspx?etn="+a.encodeHTML(I)+"&id="+a.encodeHTML(v)+"&pagetype=entityrecord"}},coerceEntitySetList:function e(i){let n=this;S(i,function(e){return a.isString(e)});t.each(i,function(e,t){t.value=n.trimDefaultNamespace(i[e].value)})},getKeyFields:function e(i){let a={},n=i.key;if(i.name==="systemuser"){a["systemuserid"]={id:"systemuserid",entityType:i};return a}if(i.name==="team"){a["teamid"]={id:"teamid",entityType:i};return a}if(t.isArray(n))n=n[0];if(n&&n.propertyRef){t.each(n.propertyRef,function(e,t){a[t.name]={id:t.name,entityType:i}})}return a},populateExtraServersideCachedMetadata:function i(a){return Promise.all([this.fetchEntityDetailsNotIncludedInMetadataBlob(a),this.fetchSecurityRoles(a)]).then(function(){return a.metadata}).catch(function(i){t.each(i,function(t,i){if(i&&i.message&&i.message.indexOf("Roles")!==-1){(e.component.getByType("skuid__page")[0]||e.component.getByType("skuidpage")[0]).addProblem(i.message)}});return a.metadata})},fetchSecurityRoles:function e(i){let n=i.serviceUrl;return R(i,{url:a.combineUrls(n,"roles?$select=name,roleid,_businessunitid_value"),method:"GET",headers:T()}).then(function(e){let n=a.grab(e,"body","value");if(!n)return;t.each(n,function(e,t){if(t){let e=t["_businessunitid_value"];delete t["@odata.etag"];delete t["_businessunitid_value"];t.businessUnitId=e}});i.metadata.securityRoles=n}).catch(function(){throw new Error("Error Fetching Security Roles")})},fetchEntityDetailsNotIncludedInMetadataBlob:function e(i){let n=this,r=i.metadata,o=["MetadataId","DisplayCollectionName","EntitySetName","PrimaryIdAttribute","DisplayName","SchemaName","LogicalName","PrimaryNameAttribute"],s={dataSource:i,requestUri:a.combineUrls(i.serviceUrl,"EntityDefinitions"+"?$select="+o.join(","))};return n.makeODataRequest(i,s).then(function(e){let i=n.getSchema(r,u),a=e.value,o=i.entityTypeMap,s=i.entitySetMap;t.each(a,function(e,t){let i=t["LogicalName"],a=o[i],n=t["PrimaryNameAttribute"],r=t["DisplayName"],u=t["PrimaryIdAttribute"],l=t["DisplayCollectionName"];if(a){if(u&&a.key&&a.key[0]&&a.key[0].propertyRef[0]){a.key[0].propertyRef[0].name=u}a.nameField=n;a.MetadataId=t["MetadataId"];a.entitySetName=t["EntitySetName"];let e=s[a.entitySetName];if(e&&l&&l.UserLocalizedLabel){e.label=l.UserLocalizedLabel.Label}if(r&&r.UserLocalizedLabel){a.label=r.UserLocalizedLabel.Label}if(e&&e.name==="activitypointers"){e.label=e.label+" (Read-Only)"}}});return r})},trimDefaultNamespace:function e(t){if(t.indexOf(u)===0){return t.substring(u.length+1)}return t},getEntityDefinitionEndpointForAttributes:function e(t,i){return a.combineUrls(i.serviceUrl,"EntityDefinitions("+t.MetadataId+")/Attributes")},getSpecificPicklistEndpoint:function e(t,i,n,r){let o=this,u=o.getEntityDefinitionEndpointForAttributes(t,i);return a.combineUrls(u+"("+n+")",r+"?"+"$select=LogicalName&"+"$expand=OptionSet($select=Options),GlobalOptionSet($select=Options)")},getPicklistMetadataForEntityProps:function e(t,a,n){let r=this,o=r.getSchema(a.metadata),u=o.entitySetMap,s=o.entityTypeMap,l={},c=[],d;i(t,function(e,t){let a=u[r.trimDefaultNamespace(t.objectName)];d=a&&s[r.trimDefaultNamespace(a.entityType)];if(!d)return;if(!d.MetadataId)return;if(!d.builtMaps)r._buildEntitySpecificMaps(d,o,n);i(t.fields,function(e,t){let i=d.propertyMap&&d.propertyMap[t.id];if(!i)return;if(g(i.metadataType)&&!i.picklistEntries){l[JSON.stringify({entityTypeName:d.name,propId:i.metadataId,type:i.metadataType})]=true}})});i(l,function(e){e=JSON.parse(e);let t=s[e.entityTypeName];let i=r.getSpecificPicklistEndpoint(t,a,e.propId,e.type);c.push(r.makeCacheableODataRequest(a,{requestUri:i}).then(function(e){return r.handleNewFieldMetadata([e],t)}))});return Promise.all(c)},parseOptions:function e(i){return t.map(i,function(e){return{value:e.Value,label:a.getObjectProperty(e,"Label.UserLocalizedLabel.Label")||e.Value}})},extractPicklistMetadata:function e(i,n){let r={};if(i===p){r.isState=true;let e=r.stateDefaultMapping={};t.each(n,function(t,i){if(!a.isUndefined(i.Value)&&!a.isUndefined(i.DefaultStatus)){e[i.Value]=i.DefaultStatus}});return r}if(i===f){r.isStatus=true;let e=r.validStateMapping={};t.each(n,function(t,i){if(!a.isUndefined(i.Value)&&!a.isUndefined(i.State)){e[i.State]=e[i.State]||{};e[i.State][i.Value]=true}});return r}},coerceUpdateRows:function e(i,n){t.each(n,function(e,t){if(a.isUndefined(t[m])){return}let n=i.getField(m),r=n&&n.picklistMetadata;if(!r||!r.isState){return}let o=i.getRecordById(e),u=i.getField(y),s=t[m]+"",l=t[y]&&t[y]+""||o&&o.get(y),c=r.stateDefaultMapping,d=h(u,s,l),f=c&&c[s];if(!o||a.isUndefined(f)||!u){return}if(!a.grab(u,"picklistMetadata","isStatus")){return}f=f+"";if(!d){if(!a.isUndefined(t[y])){if(f===t[y]){return}}t[y]=f}})},getValidPicklistEntriesSync:function e(i){let{model:n,row:r,id:o}=i.getState(),u=n.getField(o),s=u.picklistEntries,l=u.picklistMetadata,c,d=r&&r.statecode,f=l&&l.isStatus&&!a.isUndefined(d),p;if(!f){return s}p=l.validStateMapping;c=p[d]||{};return t.map(s,function(e){if(c[e.value]){return e}})},getValidPicklistEntries:function e(t){return a.resolve(this.getValidPicklistEntriesSync(t))},appendAttributesToProperty:function e(t,i,n){let r=this,o=i.OptionSet||i.GlobalOptionSet,u=o&&o.Options,s=i.MetadataId,l=n&&n.AttributePrivileges,c=l&&l.filter(e=>{return e.AttributeId===s})[0];if(u){t.picklistEntries=r.parseOptions(u);t.picklistMetadata=r.extractPicklistMetadata(t.metadataType,u);return}t.metadataId=s;t.defaultValue=i.DefaultFormValue;t.attributeType=i.AttributeType;t.metadataType=i["@odata.type"]&&i["@odata.type"].split("#").pop();t.helptext=a.getObjectProperty(i,"Description.UserLocalizedLabel.Label")||"";t.label=a.getObjectProperty(i,"DisplayName.UserLocalizedLabel.Label")||t.name;t.format=i.Format;if(c){t.accessible=c.CanRead>0;t.createable=c.CanCreate>0;t.editable=c.CanUpdate>0}else{t.accessible=i.IsValidForRead;t.createable=i.IsValidForCreate;t.editable=i.IsValidForUpdate}t.isRequired=i.RequiredLevel&&i.RequiredLevel.Value},isDefAccessible:function e(t){if(t.accessible)return t.accessible;else return true},isDefEditable:function e(t,i){if(t.editable===false||i.editable===false||t.attributeType===s){return false}if(!t.metadataId){return false}return true},isDefFilterable:function e(t,i){let a=i&&i.id;if(a&&a.indexOf(".")!==-1){return false}return t.attributeType==="String"||t.attributeType==="Memo"},fieldIsFilterableWhenSearchingReferenceFieldOptions:function e(t){return t.edmtype==="Edm.String"},isDefCreateable:function e(t,i){if(!t.metadataId){return false}if(t.attributeType==="Uniqueidentifier"&&t.type==="Edm.Guid"){return false}if(t.createable===false||i.createable===false){return false}return true},isDefRequired:function e(t,i){let n=l[t.isRequired]&&i.createable!==false&&t.createable!==false&&t.type!=="Edm.Guid";if(!t.metadataId){return false}if(t.picklistEntries&&!a.isUndefined(t.defaultValue)&&t.isRequired==="SystemRequired"){for(let e=0;e<t.picklistEntries.length;e++){if(t.picklistEntries[e].value===t.defaultValue){return true}}}return n},getReferenceFieldRelatedData:function i(n,r,o,u){let s=n.id,l=n.keyField,c=a.isString(r)?r:r[l],d,f,p,m,y,b,g;if(l&&t.isPlainObject(r)&&r[l]&&a.size(r)>1){return r}let h=u.getRows();for(b=0;b<h.length;b++){if(h[b]===o)continue;m=h[b][s];if(m&&m[l]===c){return m}}f=u.dataSource&&u.dataSource.name;d=e.model.getModelsByDataSource(f);for(b=0;b<d.length;b++){p=d[b];h=p.getRows();for(g=0;g<h.length;g++){y=h[g];if(p.getRowId(y)===c)return y;m=y[s];if(m&&m[l]===c)return m}}let S={};S[l]=c;return S},coerceRequestedFields:function e(t){const i={productassociationid_productassociation:1,parentbundleid_opportunityproduct:1,ownerid:1};S(t,function(e){if(i[e.id]){return true}if(e.isArray){return true}return false});return t},coerceFieldMetadata:function e(t,i){if(i.helptext){t.inlineHelpText=i.helptext}if(i.label){t.label=i.label}if(i.metadataId){t.metadataId=i.metadataId}else{t.label=r.makeLabelFromId(t.id)}if(i.picklistEntries){t.displaytype="PICKLIST";t.picklistEntries=i.picklistEntries;t.picklistMetadata=i.picklistMetadata;if((i.defaultValue||i.defaultValue===0)&&i.defaultValue!==-1){t.defaultValue=i.defaultValue}}else if(i.defaultValue!==null&&i.defaultValue!==undefined){t.defaultValue=i.defaultValue}if(g(i.metadataType))t.displaytype="PICKLIST"},handleNewFieldMetadata:function e(t,a,n){if(!t){return}a.hasExtraMetadata=true;let r=this;i(t,function(e,t){let i=a.propertyMap[t.LogicalName]||a.navigationPropertyMap[t.LogicalName];if(i)r.appendAttributesToProperty(i,t,n)})},getDefaultNamespace:function e(){return u},coerceConditionValue:function e(t,i){let a=i.picklistEntries,n=a&&a.length;if(!n||(t|0+"")===t){return t}for(let e=0;e<n;e++){if(a[e].label===t){return a[e].value+""}}return t},getExtraEntityMetadata:function t(r,o){let s=this,l=[],c=r.metadata,d=s.getSchema(c,u),f=d.entitySetMap,p=d.entityTypeMap,m={};let y=r._offlineStoreQueued;if(!y){r._offlineStoreQueued=true;e.events.subscribeOnce("models.loaded").then(function(){r._offlineStoreQueued=false;e.storage.getDb(n.id).getTable("dataSourceMetadata").add(r.name,{alreadyTransferable:true,data:r.metadata})})}if(typeof o[0]==="string"){o=o.map(e=>({objectName:e}))}i(o,function(e,t){t.entitySetName=u+"."+t.objectName;m[t.objectName]=true});i(m,function(e){let t=f[s.trimDefaultNamespace(e)],n;if(!t)return;n=p[s.trimDefaultNamespace(t.entityType)];if(!n)return;if(!n.builtMaps){s._buildEntitySpecificMaps(n,d,c)}if(n.MetadataId){l.push((n.hasExtraMetadata?a.resolve():s.makeCacheableODataRequest(r,{requestUri:s.getEntityDefinitionEndpointForAttributes(n,r)})).then(function(t){s.handleNewFieldMetadata(t&&t.value,n,r.getStoredAuthData().userInfo);let a=[];i(o,function(t,i){if(i.objectName===e)a.push(i)});return s.getPicklistMetadataForEntityProps(a,r,c)}))}});return Promise.all(l)},getCachedODataRequest:function e(t,i){let a=r.convertRequestObjToKey(i);return o.getItemJSON("".concat(t.name,".").concat(t._metadataCacheVersion,".").concat(a))},setCachedODataRequest:function e(t,i,a){let n=r.convertRequestObjToKey(i);return o.batchSetItem("".concat(t.name,".").concat(t._metadataCacheVersion,".").concat(n),JSON.stringify(a))},makeCacheableODataRequest:function e(t,i,n){let r=this.getCachedODataRequest(t,i);if(r){return a.resolve(r)}return this.makeODataRequest(t,i).then(e=>{if(n){e=n(e)}this.setCachedODataRequest(t,i,e);return e})},getUserInfoProperties:function e(t={}){let i=[{value:"UserId",label:"User Id",defaultValue:true},{value:"OrganizationId",label:"Organization Id"},{value:"BusinessUnitId",label:"Business Unit Id"}];if(t.renderCondition){i.push({value:"RoleName",label:"Role Names"});i.push({value:"RoleId",label:"Role Ids"})}else{i.push({value:"Roles",label:"Roles"})}return i},getUserInfo:function e(t){let i,a,n,r;return v(t).then(e=>{i=e.UserId;a=e.BusinessUnitId;n=e.OrganizationId;return this.getSystemUserRoles(t,i)}).then(e=>{r=e;return this.getAttributePrivileges(t,i)}).then(e=>{return{AttributePrivileges:e,UserId:i,Roles:r,BusinessUnitId:a,OrganizationId:n}}).catch(()=>{return{}})},getSystemUserRoles:function e(i,n){let r=i.serviceUrl;return R(i,{url:a.combineUrls(r,"systemuserrolescollection?$select=roleid&$filter=systemuserid eq "+n),method:"GET",headers:T()}).then(function(e){let i=a.grab(e,"body","value"),n=[];if(!i||!i.length){return n}t.each(i,function(e,t){if(t){n.push(t.roleid)}});return n}).catch(function(){return[]})},getAttributePrivileges:function e(t,i){let n=t.serviceUrl;return R(t,{url:a.combineUrls(n,"systemusers(".concat(i,")/Microsoft.Dynamics.CRM.RetrievePrincipalAttributePrivileges")),method:"GET",headers:T()}).then(function(e){return e&&e.body&&e.body.AttributePrivileges})},getActions:r.getActionsStatic,getFunctionMap:function e(t){let i={},a=t.dataServices,n=a.enumTypeMap,r=n["mscrm.ConditionOperator"],o=a.schema;o.forEach(function(e){let t=e.namespace;e.function&&e.function.forEach(function(e){if(r.picklistEntries.findIndex(t=>t.name===e.name)===-1){i["".concat(t,".").concat(e.name)]=e}})});return i},getFunctionsList:function e(t){let i=[],a=t.dataServices,n=a.enumTypeMap,r=n["mscrm.ConditionOperator"],o=a.schema;o.forEach(function(e){let t=e.namespace;e.function&&e.function.forEach(function(e){if(r.picklistEntries.findIndex(t=>t.name===e.name)===-1){e.namespace=t;i.push(e)}})});return i},properties:{composer:{supports:{childRelationships:false},canFieldsBeSelected:function e(t){if(t.breadcrumb.endsobject){return true}else{return"Select an external object for this Model."}}},canAutoGenerateConditionsFromFields:true,canConditionsBeGrouped:true,hasGlobalSearchEntities:true,validConditionTypes:["blank","datasourceuserinfo","fieldvalue","modelmerge","multiple","param","userinfo"]}})})(e)}});return t});