!function(n){var i={};function o(e){if(i[e])return i[e].exports;var t=i[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.m=n,o.c=i,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(n,i,function(e){return t[e]}.bind(null,i));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=194)}({16:function(e,t,n){"use strict";var d,c,u,l,p,m,h,a,f,i,o;d=skuid,c=d.builder.mobile={},u=d.$,l=d.utils,p=l.makeXMLDoc,m=d.builder.core,h=d.mobile,a=d.events.subscribe,f=d.events.publish,i=d.componentType.register,o=d.componentType.get,m.addValidActionOptions([{value:"-",label:"Visual navigation",disabled:!0},{value:"setLeftPanel",label:"Set Left Panel"},{value:"toggleLeftPanel",label:"Toggle Left Panel"},{value:"hideLeftPanel",label:"Hide Left Panel"},{value:"setMainPanel",label:"Set Main Panel"},{value:"setPopupPanel",label:"Set Popup Panel"},{value:"hidePopupPanel",label:"Hide Popup Panel"},{value:"blockUI",label:"Show message and block UI"},{value:"unblockUI",label:"Unblock the UI"},{value:"redirect",label:"Go to URL"},{value:"toggleSetupMenu",label:"Toggle Setup Menu"}]),m.addValidActionOptions(m.getCoreActionOptions()),c.model,c.row,c.pageXML,c.mobileXML,c.resourcesXML,c.componentViewer,c.propertyViewer,c.makeAddComponentsCategory=function(e){return{label:(e=e||{}).label||"Add Components",props:[{type:"validcomponents",childrenNodeName:e.childrenNodeName}]}},c.makeDraggableComponent=function(t,n){t.draggable({handle:".smb-component-gripper",appendTo:h.panelarea,delay:100,helper:function(){var e=u("<div>").addClass("smb-component-draghelper");return e.append(u("<div>").text(n.name)),e},scroll:!0,revert:"invalid",start:function(){t.addClass("smb-component-dragging");var e=u(this).data("ui-draggable");e.scrollParent=c.componentViewer.element,e.overflowOffset=e.scrollParent.offset()},stop:function(){t.removeClass("smb-component-dragging")},scrollSensitivity:60,scrollSpeed:10,drag:function(e,t){var n=u(this).data("ui-draggable"),i=n,o=i.options,r=!1;t.position.top-=i.scrollParent[0].scrollTop,i.overflowOffset.top+i.scrollParent[0].offsetHeight-e.pageY<o.scrollSensitivity?i.scrollParent[0].scrollTop=r=i.scrollParent[0].scrollTop+o.scrollSpeed:e.pageY-i.overflowOffset.top<o.scrollSensitivity&&(i.scrollParent[0].scrollTop=r=i.scrollParent[0].scrollTop-o.scrollSpeed),r&&u.ui.ddmanager.prepareOffsets(n,e)},cursorAt:{right:10,top:10}})},c.FieldSelectDeck=function(e,t){var n=this;if(e||(e=u("<div>")),n.breadcrumb=t.breadcrumb,!n.breadcrumb)return!1;if(n.options=t,(n.element=e).addClass("smb-fielddeck nx-list-contents sm-grid"),e.off(),e.on("tap",".smb-fieldcard",function(e){e.stopPropagation()}),e.on("tap",".smb-fieldcard-inmodel",function(){var e=u(this).closest(".smb-fieldcard").data("card");e.component&&e.component.select&&e.component.select()}),e.on("hold",".smb-fieldcard",function(e){u(this).closest(".smb-fieldcard").data("card").toggleSelect(),e.stopPropagation()}),e.on("tap",".smb-fieldcard-toggle",function(e){u(this).closest(".smb-fieldcard").data("card").toggleSelect(),e.stopPropagation()}),e.on("tap",".smb-fieldcard-referencelink",function(e){var t=u(this).closest(".smb-fieldcard").data("card");n.followReference(t.fielddata),e.stopPropagation()}),t.controls){n.subcontrolwrapper=u("<div>").addClass("smb-fielddeck-subcontrol"),n.breadcrumbwrapper=u("<div>").addClass("smb-breadcrumb-wrapper"),n.quickletterwrapper=u("<div>").addClass("smb-quickletter-wrapper");var i=u("<div>").addClass("smb-fielddeck-search-wrapper"),o=u("<div>").addClass("smb-fielddeck-selected-wrapper");if(t.showSelectedFilter){var r=u("<div>").addClass("smb-fielddeck-selected-toggle").text("S").on("tap",function(){n.selectedOnly=!n.selectedOnly,u(this).toggleClass("active"),n.render()});o.append(r)}else o.hide(),n.subcontrolwrapper.addClass("nofilter");n.searchBox=d.ui.renderers.TEXT.edit({onChange:function(e){n.searchtext=e,n.render()}}).css("padding","3px 6px"),i.append(n.searchBox),n.subcontrolwrapper.append(n.breadcrumbwrapper,n.quickletterwrapper),t.controls.append(i,o,n.subcontrolwrapper),n.breadcrumbwrapper.on("tap",".nx-pagebuilder-breadcrumb-link",function(){n.breadcrumb=n.breadcrumb.slice(0,u(this).index()+1),n.render()})}},c.FieldSelectDeck.prototype.render=function(){var a=this,s=u.Deferred();return a.element.empty(),u.when(m.processBreadCrumbInfo(a.breadcrumb)).fail(function(e){s.reject(e)}).done(function(i){if(!i.endsobject)return a.element.append(u("<div>").addClass("smb-fielddeck-error").text("Select an SObject for this Model.")),void s.reject("Select an SObject for this Model");var o=a.options.controls,e=i.endsobject;o&&(a.breadcrumbwrapper.empty(),a.breadcrumbwrapper.append(i.elements)),a.options.prefix=i.prefix;var t,n=d.dataSource.getDataSource("salesforce"),r={objectName:e};i.prefix&&(r.objectName=i.endsobject,r.path=i.prefix),t="Loading metadata for object "+e+"...",u.blockUI({message:t}),u.when(n.getEntityMetadata({entities:r,ignoreMetadataOverrides:!0})).fail(function(e){u.blockUI({message:"There was an error retrieving metadata: "+e,timeout:2e3})}).done(function(e){var n=u.merge([],e.getSortedFieldsList()),t=a.options.getUiOnlyFields;t&&!i.prefix&&(t=t())&&t.each(function(){var e=u(this),t=e.attr("id");n.push({id:t,label:m.getModelFieldComponentLabel(e)||t+" (Ui-Only)",displaytype:e.attr("displaytype"),destroyCardOnUnselect:!0})}),u.each(n,function(){if(a.searchtext){var e=-1!==this.id.toLowerCase().indexOf(a.searchtext.toLowerCase()),t=-1!==this.label.toLowerCase().indexOf(a.searchtext.toLowerCase());if(!e&&!t)return!0}return!(!a.options.filter||a.options.filter(this,i.prefix))||!(!a.selectedOnly||!a.options.isSelected||a.options.isSelected(this,i.prefix))||void a.element.append(new c.FieldSelectCard(this,a.options).element)}),d.responsive.prepareGrid(a.element,{precision:"10",layoutMode:"rigid",minWidth:"160"}),h.processResponsiveArea(a.element),o.find(":input").focus(),u.unblockUI()})}),s.promise()},c.FieldSelectDeck.prototype.followReference=function(e){var t={rel:e.rel,ref:e.ref,isPolymorphic:!1};this.searchBox.val(""),this.searchtext="",this.breadcrumb.push(t),this.render()},c.FieldSelectCard=function(e,t){this.fielddata=e,this.deckoptions=t,this.element=u("<div>").addClass("smb-fieldcard sm-card sm-grid-division"),this.element.data("card",this),this.body=u("<div>").addClass("smb-fieldcard-inner"),this.fieldCardTitle=u("<div>").addClass("smb-fieldcard-title"),this.fieldCardBody=u("<div>").addClass("smb-fieldcard-body"),this.fieldCardToggle=u("<div>").addClass("smb-fieldcard-toggle fa fa-fw");var n=u("<div>").addClass("smb-fieldcard-referencelink fa fa-fw fa-external-link");this.fieldReferenceCount=u("<div>").addClass("smb-fieldcard-referencecount"),this.body.append(this.fieldCardTitle,this.fieldCardBody,this.fieldCardToggle);var i=e.displaytype;this.fieldCardTitle.text(e.label),"REFERENCE"===e.displaytype&&"null"!==e.rel&&e.referenceTo&&e.referenceTo.length&&(this.body.append(n),this.deckoptions.referenceCount&&(this.updateReferenceCount(),this.body.append(this.fieldReferenceCount)),i="REF"),this.fieldCardBody.text(i),d.responsive.prepareDivision(this.element,{relativeSize:"1",minWidth:"160"}),this.setSelect(),this.element.append(this.body)},c.FieldSelectCard.prototype.updateReferenceCount=function(){this.fieldReferenceCount.text(this.deckoptions.referenceCount(this.fielddata,this.deckoptions.prefix))},c.FieldSelectCard.prototype.isSelected=function(){return this.deckoptions.isSelected&&this.deckoptions.isSelected(this.fielddata,this.deckoptions.prefix)},c.FieldSelectCard.prototype.toggleSelect=function(){this.isSelected()?this.deckoptions.onUnselect&&this.deckoptions.onUnselect(this.fielddata,this.deckoptions.prefix,this):this.deckoptions.onSelect&&this.deckoptions.onSelect(this.fielddata,this.deckoptions.prefix,this),this.setSelect()},c.FieldSelectCard.prototype.setSelect=function(){this.isSelected()?(this.body.addClass("smb-fieldcard-inmodel"),this.fieldCardToggle.addClass("fa-times").removeClass("fa-check"),this.component=new c.Component(this.deckoptions.getFieldXML(this.fielddata,this.deckoptions.prefix)).render(),this.component.card=this):!0===this.fielddata.destroyCardOnUnselect?this.element.detach():(this.body.removeClass("smb-fieldcard-inmodel"),this.fieldCardToggle.addClass("fa-check").removeClass("fa-times"))},c.propertyRenderers={helptext:function(e){e.element.append(u("<div>").addClass("smb-proptertyitem-helparea").html(e.html))},field:function(n,i){var o,r,a,e=u("<div>").addClass("sm-field-label").text(n.label),t=m.getStoredValue(i,n),s=function(e){m.updateState(i,{value:e,key:n.id}),l.text(e),n.onChange&&n.onChange(e),h.hidePopupPanel()};n.sobject?(o=n.sobject,a=i.closest("model")):((r=n.modelname?n.modelname:n.modelprop?i.attr(n.modelprop):i.closest("model").attr("id"))&&(a=m.getModelFromModelName(r)),o=m.getSObjectNameFromModelName(r));var d=u("<div>"),l=u("<div>").addClass("smb-propertyitem-valuetextbox").text(t);i.attr(n.id)!==t&&s(t);var p=u("<div>").addClass("smb-propertyitem-actionbutton fa fa-fw fa-wrench").on("tap",function(){var t=u("<div>").addClass("smb-fielddeckcontrols").css({left:"122px","padding-top":"1px"}),e=new c.FieldSelectDeck(u("<div>"),{breadcrumb:[{rel:o,ref:o,id:r}],controls:t,isSelected:function(e,t){return t+e.id===i.attr(n.id)},onSelect:function(e,t){s(t+e.id)},onUnselect:function(){s("")},getUiOnlyFields:function(){return!(!a||a.attr("sobject")!==o)&&a.children("fields").children('[uionly="true"]')},getFieldXML:function(e,t){var n=t+e.id;return!(!a||a.attr("sobject")!==o)&&a.children("fields").children('[id="'+n+'"]')},filter:n.filter});h.setPopupPanel(e.element,{title:function(e){e.append(u("<span>").text("Select a Field"),t)},noPadding:!0}),e.render()});d.append(p,l),n.element.append(e,d)},panel:function(t,n){var e,i=u("<div>").addClass("sm-field-label").text(t.label),o=t.id,r=[];c.panelsXML.children().each(function(){var e=u(this).attr("uniqueid");r.push({value:e,label:e})}),e=d.ui.renderers.PICKLIST.edit({value:n.attr(o),entries:r,onChange:function(e){m.updateState(n,{key:o,value:e}),t.onChange&&t.onChange(e)}}),t.element.append(i,e)},multiitem:function(o,r){var a=o.id,e=o.storeAs,t=u("<div>").addClass("sm-field-label").text(o.label),n=r.children(a),i=u("<div>");function s(t){var n=u("<div>").addClass("smb-propertyitem-multiitem").css("clear","both"),e=u("<div>").addClass("smb-propertyitem-valuebox"),i=u("<div>").addClass("smb-propertyitem-actionbutton smb-propertyitem-actionbutton-black fa fa-fw fa-times").on("tap",function(e){t.remove(),n.remove(),o.onChange&&o.onChange(),e.gesture.preventDefault()});return e.append(m.getValueEditorFromMetadata(o,r,a,t)),n.append(i,e)}n.length||(n=p("<values/>").append(p("<value/>"))).appendTo(r),n.children(e.name).each(function(){i.append(s(u(this)))}),o.element.append(t,i),o.element.append(u("<div>").text("Add Another Value").addClass("smb-property-action").css("margin-left","0px").on("tap",function(e){var t=p("<value/>").appendTo(n);i.append(s(t)),o.onChange&&o.onChange(),e.gesture.preventDefault()}))},validcomponents:function(a,s){var e=s[0].nodeName.toLowerCase(),d=m.getBuilder(e),t=m.getAvailableComponentsWithFolders(),n=t.noFolderComponents,i=t.activeFolders;if(a.element.css("margin-top","0px"),!n)return!1;var o=function(e,t){if(t&&t.options&&!1===t.options.makeDraggable)return!0;if(!m.doesParentAcceptComponent(t,d))return!0;var n=u("<div>").addClass("smb-component-tag-wrapper"),i=u("<div>").addClass("smb-component-tag").text(t.name),o=u("<div>").addClass("smb-component-titlebuttons"),r=u("<div>").addClass("smb-component-titlebutton smb-component-gripper fa fa-bars fa-fw");o.append(r),i.append(o),i.data("builder",t),c.makeDraggableComponent(i,t),n.append(i),e.append(n)};u.each(n,function(){return o(a.element,this.builder)}),u.each(i,function(){var e=u("<div>").addClass("smb-folder"),t=u("<div>").addClass("smb-folder-header").text(this.name),n=u("<div>").addClass("smb-folder-body");u.each(this.components,function(){return o(n,this.builder)}),n.children().length&&(e.append(t,n),a.element.append(e))}),a.element.on("doubletap",".smb-component-tag",function(e){var t=u(this).data("builder"),n=new c.Component(t.defaultStateGenerator()).render(),i=m.getComponentFromState(s);i.body.append(n.element),n.builder&&n.builder.afterAttach&&n.builder.afterAttach(n);var o=a.childrenNodeName||"components",r=s.children(o).first();r.length||(r=p("<"+o+"/>").appendTo(s)),r.append(n.state),f("skuidBuilderSave"),e.gesture.preventDefault(),e.stopPropagation(),h.processResponsiveArea(i.element)})},remove:function(e,t){var n=t[0].nodeName.toLowerCase(),i=m.getBuilder(n),o=u("<div>").addClass("smb-property-action").text("Remove this "+(i?i.name:"Component")).click(function(){m.getComponentFromState(t).remove(),e.onChange&&e.onChange()});e.element.append(o)},customaction:function(e){var t=u("<div>").addClass("smb-property-action").text(e.label||"Custom Action");e.customAction&&t.on("tap",function(){e.customAction()}),e.element.append(t)},template:function(n,i){var o="node",r="attribute";n.location||(n.location=o);var e=m.getStoredValue(i,n);if(!e&&n.defaultValue){var t={value:e=n.defaultValue};n.location==o&&n.id?t.childNodeName=n.id:n.location==r&&(t.key=n.id),m.updateState(i,t)}var a=n.displayAs,s=u("<"+("input"===a?"input":"textarea")+">").val(e);l.delayInputCallback(s,function(e){var t={value:e};n.location==o&&n.id?t.childNodeName=n.id:n.location==r&&(t.key=n.id),m.updateState(i,t),n.onChange&&n.onChange(e)});var d=u("<div>").addClass("sm-field-label").text(n.label);n.element.append(d,s)},code:function(n,i){u("<div>").addClass("sm-field-label").text(n.label).appendTo(n.element);var e=u("<div>").css("position","relative").css("height","400px").appendTo(n.element),t=u("<div>").addClass("nx-code-editor").appendTo(e).hide(),o=window.ace.edit(t[0]);n.syntax&&o.getSession().setMode("ace/mode/"+n.syntax),o.setValue(m.getStoredValue(i,n));var r=o.getSession().getUndoManager();r.reset(),o.getSession().setUndoManager(r),o.getSession().getSelection().clearSelection(),t.show(),o.getSession().on("change",function(){var e=o.getValue(),t={value:e};n.id&&(t.childNodeName=n.id),m.updateState(i,t),n.onChange&&n.onChange(e)})}},u.each(["autocomplete","boolean","condition","filepath","icon","model","models","multipicklist","numberbox","quicknumber","picklist","sobject","standard"],function(e,n){c.propertyRenderers[n]=function(e,t){!function(e,t,n){var i=u("<div>").addClass("sm-field-label").text(t.label),o=m.propertyRenderers[e](t,n);l.isPromise(o)?(t.element.append(i),o.then(function(e){t.element.append(e)})):t.element.append(i,o)}(n,e,t)}}),c.Component=function(e,t){if(!e||!e[0])return!1;var n=this;if(t?(n.builder=t,n.builderId=n.builder.id):(n.builderId=e[0].nodeName.toLowerCase(),n.builder=m.getBuilder(n.builderId)),!n.builder)return!1;m.registerComponent(n),n.builderoptions=u.extend({allowSelection:!0,makeDraggable:!0,makeSiblingDropZone:!0},n.builder.options),n.element=u("<div>").addClass("smb-component"),n.header=u("<div>").addClass("smb-component-header"),n.headerTitle=u("<div>").addClass("smb-component-header-title").text(n.builder?n.builder.name:n.builderId),n.titleButtons=u("<div>").addClass("smb-component-titlebuttons"),n.gripper=u("<div>").addClass("smb-component-titlebutton smb-component-gripper fa fa-ellipsis-v fa-fw"),n.header.append(n.headerTitle,n.titleButtons),n.builderoptions.makeDraggable&&n.titleButtons.append(n.gripper),n.body=u("<div>").addClass("smb-component-body"),n.element.append(n.header,n.body),n.builderoptions.makeSiblingDropZone&&(n.dropzone=new c.DropZone,n.element.append(n.dropzone.element)),n.state=e,n.element.data("component",n)},c.Component.prototype.setTitle=function(e){return this.headerTitle.text(e),this},c.Component.prototype.setHeaderText=function(e){return this.setTitle(e)},c.Component.prototype.render=function(){return this.builder&&(this.body.empty(),this.builder.mobileRenderer?this.builder.mobileRenderer(this):this.builder.componentRenderer&&this.builder.componentRenderer(this)),this},c.Component.prototype.refresh=function(){return this.body.children().detach(),this.render(),h.processResponsiveElements(),this.builder&&this.builder.afterAttach&&this.builder.afterAttach(this),this},c.Component.prototype.rebuildProps=function(e){return this.renderProperties(e)},c.Component.prototype.renderProperties=function(e){return f("skuid.pageComposer.propertyPanel.beforeRender"),e||(e=c.propertyViewer),e&&e.clear(),this.builder&&this.builder.propertiesRenderer(e,this),f("skuid.pageComposer.propertyPanel.afterRender"),this},c.Component.prototype.renderChildren=function(e,t){this.addComponents(e,t||this.body)},c.Component.prototype.addComponents=function(e,n){e||(e="components");var t,i=this.state.children(e).first();i.length||(i=p("<"+e+"/>").appendTo(this.state)),t=i.children(),new c.ComponentAcceptor(n,i),t.each(function(){var e=u(this),t=m.getComponentFromState(e)||new c.Component(u(this));t&&(t.render(),t.element&&(t.element.data("component",t),n.append(t.element),t.builder&&t.builder.afterAttach&&t.builder.afterAttach(t)))})},c.Component.prototype.isSelected=function(){return this===c.componentViewer.selectedComponent},c.Component.prototype.select=function(e){this.builderoptions.allowSelection&&(e=u.extend({showPropertiesPanel:!0},e),c.componentViewer.addSelection(this),this.builderoptions.makeDraggable&&c.makeDraggableComponent(this.element,this.builder),f("skuidBuilderViewProperties",[this]),e.showPropertiesPanel&&h.addLeftPanel("propertyviewer",{transition:"slide",replace:!0,position:1}),f("skuidBuilderComponentSelect",[this]))},c.Component.prototype.unselect=function(){this.element.removeClass("smb-selected"),this.builderoptions.makeDraggable&&this.element.data("ui-draggable")&&this.element.draggable("destroy")},c.Component.prototype.remove=function(){c.componentViewer.clearSelection(),c.propertyViewer.clear(),this.element.remove(),this.state.remove(),this.save(),m.unregisterComponent(this),h.processResponsiveElements()},c.Component.prototype.getPersonalizationService=function(){var e="_personalizationService",t=this[e];return t||(t=this[e]=d.personalization.createComponentService({uniqueId:null})),t},c.Component.prototype.save=function(){return f("skuidBuilderSave"),this},c.ComponentAcceptor=function(e,t){this.element=e.addClass("smb-acceptor"),this.element.data("acceptor",this),this.state=t,this.dropzone=new c.DropZone("acceptor"),this.element.append(this.dropzone.element)},c.DropZone=function(e){var a=this;this.type=e||"component",this.element=u("<div>").addClass("smb-dropzone"),this.element.droppable({accept:function(e){var t=e.data("component"),n=t?t.builder:e.data("builder");if(!n)return!1;var i=a.element.closest(".smb-acceptor").data("acceptor");if(!i)return!1;var o=i.element.closest(".smb-component").data("component").builder;return m.doesParentAcceptComponent(n,o)},tolerance:"touch",drop:function(e,t){if(m.dropStack=u(),a.element.is(".smb-dropzone-hover")){var n,i=t.draggable.data("component");if(i)i.state.detach(),i.element.detach();else{var o=t.draggable.data("builder");i=new c.Component(o.defaultStateGenerator()).render()}var r=a.element.closest(".smb-acceptor").data("acceptor").state;("acceptor"===a.type?(n=0,a.element):(n=a.element.parent().index(),a.element.parent())).after(i.element),d.utils.insertAtIndex(r,i.state,n),i.builder&&i.builder.afterAttach&&i.builder.afterAttach(i),f("skuidBuilderSave"),a.element.removeClass("smb-dropzone-hover"),h.processResponsiveElements()}},over:function(){m.dropStack=m.dropStack.add(u(this)),m.dropStack.removeClass("smb-dropzone-hover"),m.dropStack.first().addClass("smb-dropzone-hover")},out:function(){m.dropStack.removeClass("smb-dropzone-hover"),m.dropStack=m.dropStack.not(u(this)),m.dropStack.first().addClass("smb-dropzone-hover")},activeClass:"smb-dropzone-active"})},c.ComponentViewer=function(e){this.element=e.addClass("smb-component-viewer"),this.selectedComponent,e.on("tap",".smb-component",function(e){u(this).data("component").select(),e.gesture.preventDefault(),e.stopPropagation()}),e.on("hold",".smb-component",function(e){u(this).data("component").select({showPropertiesPanel:!1}),e.stopPropagation(),e.preventDefault()})},c.ComponentViewer.prototype.loadComponent=function(e){this.element.children().detach();var t=m.getComponentFromState(e);return t||(t=new c.Component(e).render()),this.element.append(t.element),this.clearSelection(),t},c.ComponentViewer.prototype.addSelection=function(e){this.clearSelection(),(this.selectedComponent=e).element.addClass("smb-selected")},c.ComponentViewer.prototype.clearSelection=function(){this.selectedComponent&&this.selectedComponent.unselect(),this.selectedComponent=null},c.ComponentViewer.prototype.clear=function(){this.element.empty(),this.clearSelection()},c.PropertyViewer=function(e){var t=this;t.lists=[],t.element=e.addClass("smb-propview"),t.header=u("<div>").addClass("smb-propview-header sm-title"),t.headerText=u("<div>").addClass("smb-propviewer-headertext"),t.titleButtons=u("<div>").addClass("sm-titlebutton-wrapper"),t.closeButton=u("<div>").addClass("sm-titlebutton fa fa-angle-double-left fa-fw"),t.closeButton.click(function(){h.toggleLeftPanel("propertyviewer",{transition:"slide"})}),t.titleButtons.append(t.closeButton),t.header.append(t.titleButtons,t.headerText),t.body=u("<div>").addClass("smb-propview-body"),t.body.on("click",".smb-propertylist-header",function(){var e=u(this).parent().data("list");e&&e.revealContents&&e.revealContents()}),t.openLists={},t.element.append(t.header,t.body)},c.PropertyViewer.prototype.setTitle=function(e){this.headerText.text(e)},c.PropertyViewer.prototype.setHeaderText=function(e){this.setTitle(e)},c.PropertyViewer.prototype.loadComponent=function(e){this.openLists={},this.clear(),e.renderProperties(this)},c.PropertyViewer.prototype.addList=function(e){(e.viewer=this).lists.push(e)},c.PropertyViewer.prototype.addLists=function(e){var t=this;u.each(e,function(){(this.viewer=t).lists.push(this)})},c.PropertyViewer.prototype.render=function(){var e=this;this.body.empty(),u.each(this.lists,function(){this.render(this.state),e.body.append(this.element)})},c.PropertyViewer.prototype.clear=function(){this.body.empty(),this.lists=[],this.setTitle("")},c.PropertyViewer.prototype.applyPropTreeItem=function(e,t){if(e.isChild){var n=e.id;n||(n=e.childrenNodeName);var i=t.children(n);i.length||(i=e.defaultStateFunction&&e.defaultStateFunction()||p("<"+n+"/>"),t.append(i)),this.addList(new c.MiniComponentList(i,e))}else this.addList(new c.MiniComponentList(t,e))},c.PropertyViewer.prototype.applyPropTree=function(e,t){var n=this;e instanceof Array?u.each(e,function(e){n.applyPropTreeItem(this,t,{autoselect:0===e,wrapper:n.body})}):n.applyPropTreeItem(e,t,{autoselect:!0,wrapper:n.body})},c.PropertyViewer.prototype.applyPropsWithCategories=function(e,n){var i=this;u.each(e,function(){var e=this,t=e.state?e.state:n;(e.props&&0<e.props.length||e.customPropFunction||e.tree)&&(e.customPropFunction||(e.tree?i.applyPropTree(e.tree,t):i.addList(new c.PropertyList(t,e))))}),this.render()},c.MiniComponentList=function(e,t){t=t||{};var n=this;this.element=u("<div>").addClass("smb-propertylist"),this.element.data("list",this),this.header=u("<div>").addClass("smb-propertylist-header"),this.body=u("<div>").addClass("smb-propertylist-body").hide(),this.bodycontents=u("<div>"),this.propcontents=u("<div>"),this.expandIndicator=u("<div>").addClass("smb-propertylist-titleicon fa fa-chevron-down fa-fw"),this.items=[],this.inactive=t.inactive,this.state=t.state?t.state:e,this.childNodeCount=0,this.options=t,this.inactive&&this.element.hide(),this.fakeComponent={state:n.state,save:c.Component.prototype.save,rebuildProps:function(){n.getItems(),n.renderItems()},refresh:function(){}},this.childrenNodeName=t.childrenNodeName,this.childNodeName=t.childNodeName,this.childrenNodeName&&this.childNodeName&&(this.childbuilder=m.getBuilder(this.childNodeName),this.body.append(this.createAddButton(this.childbuilder,this.childrenNodeName))),this.body.append(this.propcontents,this.bodycontents),this.headertitle=u("<div>").addClass("smb-propertylist-headertitle").text(t.title||t.label),this.header.append(this.expandIndicator,this.headertitle),(this.childrenNodeName||this.childNodeName||this.options.childrenFunction||this.options.children)&&(this.headercount=u("<div>").addClass("smb-propertylist-headercount"),this.header.append(this.headercount)),this.element.append(this.header,this.body),this.getItems()},c.MiniComponentList.prototype.createAddButton=function(e,t,n){var i=this;return u("<div>").addClass("smb-property-action").text(n||"Add new "+e.name).click(function(){i.addChild(e,t)})},c.MiniComponentList.prototype.addItem=function(e){this.items.push(e)},c.MiniComponentList.prototype.addItems=function(e){var t=this;u.each(e,function(){t.push(this)})},c.MiniComponentList.prototype.getItems=function(){var n=this;n.items=[];var e=this.options,t=e.propsFunction&&e.propsFunction(n.fakeComponent)||e.props||[];t&&u.each(t,function(e,t){n.addItem(new c.PropertyItem(t))})},c.MiniComponentList.prototype.renderItems=function(){var e=this;e.propcontents.empty(),u.each(this.items,function(){this.render(e.state),e.propcontents.append(this.element)})},c.MiniComponentList.prototype.createBuilderFromTreeObj=function(r){var e=r.linkedComponent;return new m.Builder({id:r.id,name:r.id,options:{makeSiblingDropZone:!1,makeDraggable:!1},mobileRenderer:function(e){e.bodycontent.text(r.labelFunction&&r.labelFunction(e.state)||r.label)},propertiesRenderer:function(t,n){var e=r.propsFunction&&r.propsFunction(n)||r.props||[],i=new c.PropertyList(n.state);u.each(e,function(){i.addItem(new c.PropertyItem(this))}),t.addLists([i]);var o=r.childrenFunction&&r.childrenFunction({state:n.state})||r.children;o&&u.each(o,function(){var e=this;t.addList(new c.MiniComponentList(n.state,{title:e.invisibleParentLabel||"Child Components",childrenFunction:function(){return[e]}}))}),t.render()},hideWrapper:!0,defaultStateGenerator:function(){return r.defaultStateFunction&&r.defaultStateFunction()||p("<"+r.id+"/>")},onSelect:function(){e&&e.element.addClass("nx-pagebuilder-selected")},resetPropCategory:!1})},c.MiniComponentList.prototype.render=function(){var e,i,o=this;if(o.bodycontents.empty(),o.childbuilder&&o.childrenNodeName){if(this.inactive)return!1;var t=this.state.children(this.childrenNodeName).first().children();t.each(function(){var e=new c.MiniComponent(u(this),o.childbuilder);e.render(),o.bodycontents.append(e.element)}),this.setCount(t.length)}else o.renderItems(),e=o.options.childrenFunction&&o.options.childrenFunction({state:o.state})||o.options.children,i=0,e&&e.length&&u.each(e,function(){var t,e=this,n=o.createBuilderFromTreeObj(e);o.bodycontents.append(o.createAddButton(n,e.invisibleParent,e.addtooltip)),t=u("<div>"),o.bodycontents.append(t),t.sortableComponent({axis:"y",component:o.fakeComponent,parentStateSelector:e.invisibleParent,placeholder:"sk-placeholder",onSort:function(){o.render()},handle:".smb-minicomponent-handle"}),e.invisibleParent?o.state.children(e.invisibleParent).each(function(){u(this).children(e.id).each(function(){var e=new c.MiniComponent(u(this),n);e.render(),t.append(e.element),i++})}):o.state.children(e.id).each(function(){var e=new c.MiniComponent(u(this),n);e.render(),t.append(e.element),i++})}),this.setCount(i)},c.MiniComponentList.prototype.addChild=function(e,t){var n=new c.MiniComponent(e.defaultStateGenerator(),e);if(t){var i=this.state.children(t).first();i.length||(i=p("<"+t+"/>").appendTo(this.state)),this.state.children(t).first().append(n.state)}else this.state.append(n.state);this.bodycontents.append(n.element),n.render(),this.increaseCount(),f("skuidBuilderSave")},c.MiniComponentList.prototype.revealContents=function(){this.body.slideToggle()},c.MiniComponentList.prototype.decreaseCount=function(){this.setCount(this.childNodeCount-1)},c.MiniComponentList.prototype.increaseCount=function(){this.setCount(this.childNodeCount+1)},c.MiniComponentList.prototype.setCount=function(e){this.childNodeCount=e,this.headercount&&this.headercount.text(this.childNodeCount)},c.MiniComponent=function(e,t){var n=this;this.builderId=t.id,this.builder=t,this.state=e,this.element=u("<div>").addClass("smb-minicomponent"),this.handle=u("<div>").addClass("smb-minicomponent-handle fa fa-ellipsis-v"),this.body=u("<div>").addClass("smb-minicomponent-body"),this.bodycontent=u("<div>").addClass("smb-minicomponent-content"),this.properties=new c.MiniPropViewer;var i=u("<div>").addClass("smb-minicomponent-removeicon fa fa-times fa-fw").click(function(e){n.remove(),e.stopPropagation()});m.registerComponent(n),this.body.append(i,this.bodycontent),this.element.append(this.handle,this.body,this.properties.element),this.body.on("click",function(){n.properties.element.slideToggle()})},c.MiniComponent.prototype.refresh=function(){return this.bodycontent.empty(),this.builder.mobileRenderer(this),this},c.MiniComponent.prototype.render=function(){this.builder&&(this.builder.mobileRenderer(this),this.builder.propertiesRenderer(this.properties,this))},c.MiniComponent.prototype.renderProperties=function(){return this.properties.clear(),this.builder.propertiesRenderer(this.properties,this),this},c.MiniComponent.prototype.rebuildProps=function(){return this.renderProperties()},c.MiniComponent.prototype.remove=function(){this.element.closest(".smb-propertylist").data("list").decreaseCount(),this.element.remove(),this.state.remove(),m.unregisterComponent(this),f("skuidBuilderSave")},c.MiniComponent.prototype.save=function(){return f("skuidBuilderSave"),this},c.MiniPropViewer=function(){this.lists=[],this.element=u("<div>").addClass("smb-minicomponent-propviewer").hide()},c.MiniPropViewer.prototype.clear=function(){this.lists=[],this.element.empty()},c.MiniPropViewer.prototype.addList=function(e){this.lists.push(e)},c.MiniPropViewer.prototype.addLists=function(e){var t=this;u.each(e,function(){t.lists.push(this)})},c.MiniPropViewer.prototype.render=function(){var e=this;this.element.empty(),u.each(this.lists,function(){this.render(this.state),e.element.append(this.element)})},c.MiniPropViewer.prototype.applyPropTreeItem=c.PropertyViewer.prototype.applyPropTreeItem,c.MiniPropViewer.prototype.applyPropTree=c.PropertyViewer.prototype.applyPropTree,c.MiniPropViewer.prototype.applyPropsWithCategories=c.PropertyViewer.prototype.applyPropsWithCategories,c.PropertyList=function(e,t){var n=this;t=u.extend({expanded:!1,title:""},t),n.items=[],n.element=u("<div>").addClass("smb-propertylist"),n.element.data("list",n),n.header=u("<div>").addClass("smb-propertylist-header"),n.body=u("<div>").addClass("smb-propertylist-body"),n.expanded=t.expanded,n.viewer=null,n.name=t.title||t.name||t.label,n.element.append(n.header,n.body),n.state=e;var i=t.propsFunction&&t.propsFunction({state:n.state,save:c.Component.prototype.save})||t.props||[];i&&u.each(i,function(e,t){n.addItem(new c.PropertyItem(t))})},c.PropertyList.prototype.addItem=function(e){this.items.push(e)},c.PropertyList.prototype.addItems=function(e){var t=this;u.each(e,function(){t.push(this)})},c.PropertyList.prototype.render=function(){var e=this,t=!1;this.body.empty(),this.name?(t=this.viewer&&this.viewer.openLists&&this.name in this.viewer.openLists?!!this.viewer.openLists[this.name]:this.expanded,this.headertitle=u("<div>").addClass("smb-propertylist-headertitle").text(this.name),this.expandIndicator=u("<div>").addClass("smb-propertylist-titleicon fa fa-chevron-"+(t?"up":"down")+" fa-fw"),this.header.append(this.expandIndicator,this.headertitle)):t=!0,this.expanded=t,this.expanded?this.body.css("display",""):this.body.css("display","none"),u.each(this.items,function(){this.render(e.state),e.body.append(this.element)})},c.PropertyList.prototype.revealContents=function(){this.expanded=!this.expanded,this.expandIndicator.removeClass("fa-chevron-"+(this.expanded?"down":"up")),this.expandIndicator.addClass("fa-chevron-"+(this.expanded?"up":"down")),this.body.slideToggle(),this.viewer&&(this.viewer.openLists[this.name]=this.expanded)},c.PropertyItem=function(e){this.element=u("<div>").addClass("smb-propertyitem"),u.extend(this,e)},c.PropertyItem.prototype.render=function(e){this.element.empty();var t=this.type||"standard";c.propertyRenderers[t]?c.propertyRenderers[t](this,e):c.propertyRenderers.standard(this,e)},c.setupPageXML=function(e){if(e||(e=c.model.getFieldValues(c.row,m.getLayoutFields(),!0).join("")),e.length){c.pageXML=p(e);var t=c.pageXML.children("components").first();c.mobileXML=t.children("skuidmobile").first(),c.mobileXML.length||(c.mobileXML=p("<skuidmobile><mobilepanels/><mobilenavs/></skuidmobile>").appendTo(t)),c.modelsXML=c.pageXML.children("models").first(),c.resourcesXML=c.pageXML.children("resources").first(),c.panelsXML=c.mobileXML.children("mobilepanels").first(),c.navsXML=c.mobileXML.children("mobilenavs").first()}m.pageXML=c.pageXML,f("skuidBuilderXMLLoaded")},i("mobileComponentViewer",function(e){c.model=m.pageModel=d.$M("page"),c.row=m.pageRow=c.model.getFirstRow(),c.setupPageXML();var t=new c.ComponentViewer(e),n=function(){h.setLeftPanel("quicknav",{displaymode:"fit",preventProcessing:!0,transition:"none"}).then(function(){h.addLeftPanel("panels",{displaymode:"push",position:1}),u(".sm-buttonset-nav").removeClass("sm-active"),u("#quicknav").children().eq(2).addClass("sm-active")})};a("skuidBuilderSave",function(){m.save(c.pageXML[0],c.model,c.row)}),c.componentViewer=t,a("skuidMobileReady",function(){n()}),a("skuidMobileSavePage",function(e){e&&e.button&&e.button.startProcessing(),d.$M("page").save({callback:function(){e&&e.button&&e.button.stopProcessing()}})}),a("skuidMobileCancelPage",function(){d.$M("page").cancel(),d.builder.mobile.setupPageXML(),c.propertyViewer.clear(),c.componentViewer.clear(),f("skuidBuilderRefreshModelList"),f("skuidBuilderRefreshNavList"),f("skuidBuilderRefreshPanelList"),f("skuidBuilderRefreshLabelList"),f("skuidBuilderRefreshJSItemList"),f("skuidBuilderRefreshCSSItemList"),n()}),a("skuidMobilePreviewPage",function(){var e=d.$M("page"),t=d.snippet.get("skuid.builder.page.preview");t&&t({model:e})})}),i("mobilePropertyViewer",function(e){var t=new c.PropertyViewer(e);a("skuidBuilderViewProperties",function(e){t.loadComponent(e)}),c.propertyViewer=t}),i("mobileBuilderPageProperty_Theme",function(e){var t=u.map(d.builder.core.availableThemes,function(e){return{label:e.Name,value:e.Name}});t.unshift({label:"Default",value:""});var n={id:"theme",type:"picklist",label:"Theme",picklistEntries:t,helptext:"The name of the theme to use."},i=new c.PropertyItem(n);i.render(c.pageXML),e.append(i.element)}),i("mobileBuilderPageProperty_UnsavedChangesWarning",function(e){var t=new c.PropertyItem({id:"unsavedchangeswarning",type:"picklist",label:"Warn users if page has unsaved changes",picklistEntries:[{label:"No",value:""},{label:"Yes",value:"yes"}],defaultValue:"",helptext:"If a user tries to leave or close this page, and one or more of its Models has unsaved changes, a warning message will be shown before they can leave."});t.render(c.pageXML),e.append(t.element)}),i("mobileBuilderModelList",function(e){e.append(o("mobileBuilderPropertyPanelHeader")({title:"Models",showCloseButton:!0,closePanel:"models",showAddButton:!0,eventToPublishOnAdd:"skuidBuilderAddModel"}),o("mobileBuilderPropertyPanelList")({xmlParentFunction:function(){return c.modelsXML},addEventName:"skuidBuilderAddModel",builderName:"model",refreshEventName:"skuidBuilderRefreshModelList",labelFunction:function(e){return e.attr("id")},showRemoveButton:!1}))}),i("mobileBuilderNavList",function(e){e.append(o("mobileBuilderPropertyPanelHeader")({title:"Headers and Footers",showCloseButton:!0,closePanel:"navs",showAddButton:!0,eventToPublishOnAdd:"skuidBuilderAddNav"}),o("mobileBuilderPropertyPanelList")({xmlParentFunction:function(){return c.navsXML},addEventName:"skuidBuilderAddNav",builderName:"mobilenav",refreshEventName:"skuidBuilderRefreshNavList",labelFunction:function(e){var t="footer"===e.attr("type")?"Footer":"Header",n=e.attr("name")||t;return e.attr("uniqueid")?n+=" - "+e.attr("uniqueid"):n+=" - [New "+t+"]",n},showRemoveButton:!1}))}),i("mobileBuilderPanelList",function(e){e.append(o("mobileBuilderPropertyPanelHeader")({title:"Page Panels",showCloseButton:!0,closePanel:"panels",showAddButton:!0,eventToPublishOnAdd:"skuidBuilderAddPanel"}),o("mobileBuilderPropertyPanelList")({xmlParentFunction:function(){return c.panelsXML},addEventName:"skuidBuilderAddPanel",builderName:"mobilepanel",refreshEventName:"skuidBuilderRefreshPanelList",labelFunction:function(e){return e.attr("uniqueid")||"[New Panel]"},showRemoveButton:!1}))}),i("mobileBuilderPropertyPanelList",function(o){var r=o.element||u("<div>");r.on("tap",".sm-button-custom",function(){var e=o.xmlParentFunction&&o.xmlParentFunction(),t=u(this).index();c.componentViewer.loadComponent(e.children().eq(t)),h.processResponsiveElements()});var i=function e(){var t=o.xmlParentFunction&&o.xmlParentFunction(),n={state:t,save:c.Component.prototype.save,rebuildProps:function(){e()}};r.empty(),r.sortableComponent({axis:"y",component:n,placeholder:"sk-placeholder",onSort:function(){e()},handle:".smb-minicomponent-handle"}),t.children().each(function(){var e,t,n=u(this),i=new h.ui.Button({icon:o.icon,iconColor:"#bbb",label:o.labelFunction(n)});i.element.css("position","relative").addClass("smb-menupropertylist sm-button-custom sm-liststyle sm-level"+(o.indentLevel||0)),o.showRemoveButton&&(e=u("<div>").addClass("sm-titlebutton sm-accordion-item-button fa fa-times fa-fw").on("tap",function(e){new c.Component(n).remove(),c.componentViewer.clear(),i.element.remove(),e.stopPropagation()}),t=u("<div>").addClass("sm-titlebutton-wrapper").append(e),i.element.append(t)),i.element.append(u("<div>").addClass("smb-minicomponent-handle fa fa-ellipsis-v")),r.append(i.element)})};return i(),a(o.addEventName,function(e){var t,n=o.xmlParentFunction&&o.xmlParentFunction();e=e&&e.jquery?e.clone():m.getBuilder(o.builderName).defaultStateGenerator(),n.length||(t=o.xmlGrandParentFunction&&o.xmlGrandParentFunction(),n=m.defaultStateGenerators[o.parentBuilderName](),t.append(n)),n.append(e),c.componentViewer.loadComponent(e).select(),h.processResponsiveElements(),f("skuidBuilderSave"),i()}),a(o.refreshEventName,function(){i()}),r}),i("mobileBuilderPropertyPanelHeader",function(e){var t,n,i=e.element||u("<div>"),o=u("<div>").addClass("sm-titlebutton-wrapper").appendTo(i);return i.addClass("smb-propview-header sm-title").css("padding","10px 10px 9px 10px"),u("<div>").addClass("smb-propviewer-headertext").text(e.title).appendTo(i),e.showCloseButton&&(t=u("<div>").addClass("sm-titlebutton fa fa-angle-double-left fa-fw").appendTo(o),e.closePanel&&t.click(function(){h.toggleLeftPanel(e.closePanel,{transition:"slide"})})),e.showAddButton&&(n=u("<div>").addClass("sm-titlebutton fa fa-plus-circle fa-fw").appendTo(o),e.eventToPublishOnAdd&&n.click(function(){f(e.eventToPublishOnAdd)})),i}),i("mobileBuilderPagePropertiesHeader",function(e){o("mobileBuilderPropertyPanelHeader")({element:e,title:"Edit Page Properties",showCloseButton:!0,closePanel:"pageproperties"})}),i("mobileBuilderResourcePanelHeader",function(e){o("mobileBuilderPropertyPanelHeader")({element:e,title:"Resources",showCloseButton:!0,closePanel:"resources"})}),i("mobileBuilderLabelList",function(e){o("mobileBuilderPropertyPanelList")({element:e,icon:"fa-angle-double-right",xmlParentFunction:function(){return c.resourcesXML.children("labels")},xmlGrandParentFunction:function(){return c.resourcesXML},addEventName:"skuidMobileAddLabelItem",builderName:"label",parentBuilderName:"labels",refreshEventName:"skuidBuilderRefreshLabelList",labelFunction:function(e){return e.attr("id")||"[No Label ID]"},showRemoveButton:!0,indentLevel:2})}),i("mobileBuilderJSList",function(e){o("mobileBuilderPropertyPanelList")({element:e,icon:"fa-angle-double-right",xmlParentFunction:function(){return c.resourcesXML.children("javascript")},xmlGrandParentFunction:function(){return c.resourcesXML},addEventName:"skuidMobileAddJSItem",builderName:"jsitem",parentBuilderName:"javascript",refreshEventName:"skuidBuilderRefreshJSItemList",labelFunction:function(e){return m.getJSItemLabel(e).name||"[No Javascript Item Name]"},showRemoveButton:!0,indentLevel:2})}),i("mobileBuilderCSSList",function(e){o("mobileBuilderPropertyPanelList")({element:e,icon:"fa-angle-double-right",xmlParentFunction:function(){return c.resourcesXML.children("css")},xmlGrandParentFunction:function(){return c.resourcesXML},addEventName:"skuidMobileAddCSSItem",builderName:"cssitem",parentBuilderName:"css",refreshEventName:"skuidBuilderRefreshCSSItemList",labelFunction:function(e){var t=m.getCSSItemLabel(e);return t.prefix+" "+t.name},showRemoveButton:!0,indentLevel:2})}),i("mobileBuilderXMLEditLink",function(t){var e=new d.ui.Editor(t),n=new h.ui.Button({icon:"fa-code",label:"Edit Page XML"});n.element.addClass("sm-button").click(function(){window.location="/apex/skuid__ui?page=PageXMLEdit&id="+d.$M("page").data[0].Id}),e.registerModel(d.$M("page")),e.handleSave=function(e){e&&t.show()},e.handleCancel=function(){t.show()},e.handleChange=function(){t.hide()},t.append(n.element)}),a("skuidBuilderComponentSelect",function(e){"model"===e.builderId&&m.setLastSelectedModelComponent(e)}),d.snippet.register("saveAndPreview",function(){var e=arguments[0],t=e.model||d.$M("page"),n=e.component.editor,i=d.snippet.get("skuid.builder.page.preview");i&&i({editor:n,model:t,saveFirst:!0})})},194:function(e,t,n){"use strict";n.r(t);n(16)}});