!function(a){var r={};function i(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return a[e].call(t.exports,t,t.exports,i),t.l=!0,t.exports}i.m=a,i.c=r,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(a,r,function(e){return t[e]}.bind(null,r));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=324)}({324:function(e,t,a){"use strict";a.r(t);a(325),a(326)},325:function(e,t,a){"use strict";var c,R,r,b,i,d,o,p,u,h,l,n,V,j,W,f,U,g,m,s;c=skuid,R=c.$,r=c.builder,b=r.core,i=r.desktop,d=r.mobile,o=c.utils,p=o.makeXMLDoc,u=c.$L,h=c.events.publish,l=!1,n=c.visualizations,V=n.core,j=n.chart,W={line:{options:[j.types.line,j.types.spline,j.types.area,j.types.areaspline,j.types.column,j.types.bar],previewExtras:{xAxis:{categories:["Category A","Category B","Category C"]},yAxis:{},series:[{name:"Series 1",data:[7,6.9,9.5]},{name:"Series 2",data:[-.2,.8,5.7]}]}},pie:{options:[j.types.pie,j.types.donut,j.types.funnel,j.types.pyramid],previewExtras:{series:[{name:"Series 1",data:[["Segment A",7],["Segment B",6.9],["Segment C",9.5]]}]}},scatter:{options:[j.types.scatter,j.types.bubble]}},f={line:W.line.previewExtras,spline:W.line.previewExtras,area:W.line.previewExtras,areaspline:W.line.previewExtras,column:W.line.previewExtras,bar:W.line.previewExtras,pie:W.pie.previewExtras,donut:{series:[{name:"Series 1",innerSize:"70%",data:[["Segment A",7],["Segment B",6.9],["Segment C",9.5]]}]},funnel:{plotOptions:{series:{neckWidth:"30%",neckHeight:"25%"}},series:[{name:"Series 1",data:[["Segment A",7],["Segment B",6.9],["Segment C",9.5]]}]},pyramid:W.pie.previewExtras,bubble:{series:[{name:"Series 1",data:[[97,36,79],[94,74,60],[68,76,58],[64,87,56],[68,27,73],[74,99,42],[7,93,87],[51,69,40],[38,23,33],[57,86,31]]},{name:"Series 2",data:[[25,10,87],[2,75,59],[11,54,8],[86,55,93],[5,3,58],[90,63,44],[91,33,17],[97,3,56],[15,67,48],[54,25,81]]}]},scatter:{series:[{name:"Series 1",data:[[97,36],[94,74],[68,76],[64,87],[68,27],[74,99],[7,93],[51,69],[38,23],[57,86]]},{name:"Series 2",data:[[25,10],[2,75],[11,54],[86,55],[5,3],[90,63],[91,33],[97,3],[15,67],[54,25]]}]}},U=function(e){var t={id:e.id,label:e.title||"Title",type:"template",location:"attribute",displayAs:"input"};return e.onChange&&(t.onChange=e.onChange),e.helptext&&(t.helptext=e.helptext),e.modelName&&(t.modelName=e.modelName),t},g=function(e,t,a){var r=b.validators.uniqueAttribute(e,t,{description:"Axis",attributeDescription:"ID",nodeList:a.state.find("axis")});return!0===r?b.validators.alphaNumericUnder(e,{description:"Axis IDs"}):r},m=function(e){e||(e={});var t=e.component;return{id:"serieslist",label:"Series List",deleteable:!1,icon:"sk-bi-renderconditions",isChild:!0,linkedComponent:t,props:[{type:"helptext",html:"Define one or more data series for this chart"}],children:[{id:"series",indent:0,linkedComponent:t,labelFunction:function(e){var t="",a=e.attr("modelId"),r=e.attr("aggfunction"),i=e.attr("valuefield"),l=e.attr("xvaluefield"),n=e.attr("yvaluefield"),o=e.attr("sizefield"),s=e.attr("splittype"),d=e.attr("splitfield"),c=e.attr("splittemplate");return"template"===s&&c?c:(r&&(t+=V.AGG_FUNCTIONS[r].label+" "),i&&(t+=i),l&&(t+=l),n&&(t+=", "+n),o&&(t+=", "+o),a&&(t+=" ("+a+")"),"field"===s&&d&&(t+=" by "+d),t||"Series")},defaultStateFunction:function(){return p("<series/>")},childrenFunction:function(e){return V.getSeriesOnClickActionsTree({seriesComponent:e,component:t,seriesObj:this})},propsFunction:function(e){return function(e){var a=e.seriesComponent,t=e.component,r=a.state,i=t.state,l=i.attr("type"),n=r.attr("modelId")||i.attr("model"),o=V.getModelFieldsOptions(n),s=j.types[l].metadata,d=[{label:"-- Chart default --",value:""}],c=R.merge([{label:"-- Chart default --",value:""}],o),p=R.map(V.AGG_FUNCTIONS,function(e){return e}),u=R.merge([{label:"-- None --",value:""}],p),h=i.children("dataaxes"),f=i.children("categoryaxes"),b=function(e){var t={id:e.id,type:"picklist",label:e.label,picklistEntries:e.entries,onChange:function(){a.refresh()}};return e.helptext&&(t.helptext=e.helptext),t},g=function(e){var t={id:e.id,type:"picklist",label:e.label,picklistEntries:e.entries,onChange:function(){a.refresh()}};return e.helptext&&(t.helptext=e.helptext),t},m={id:"modelId",type:"model",label:"Model",noneOption:{label:"-- Chart default --",value:""},onChange:function(){a.refresh().rebuildProps()}},y={id:"splittype",label:"Split Type",type:"picklist",defaultValue:"none",picklistEntries:[{label:"None",value:"none"},{label:"Field",value:"field"},{label:"Template",value:"template"}],onChange:function(){a.refresh().rebuildProps()}},v={id:"splitfield",type:"picklist",label:"Split Field",helptext:"Optionally split this series into multiple series by a model field",picklistEntries:o,onChange:function(){a.refresh()}},C=U({id:"splittemplate",title:"Split Template",helptext:"Optional template, allows for custom names for chart Series and for splitting data into multiple series",onChange:function(){a.refresh()},modelName:n}),x=b({id:"aggfunction",label:"Aggregate Function",entries:u}),k=g({id:"valuefield",label:"Data Field",entries:o}),w={id:"categoryField",type:"picklist",label:"Category Field",picklistEntries:c,onChange:function(){a.refresh().rebuildProps()}},S=b({id:"xaggfunction",label:"X Aggregate Function",entries:u}),A=g({id:"xvaluefield",label:"X Data Field",entries:o}),D=b({id:"yaggfunction",label:"Y Aggregate Function",entries:u}),O=g({id:"yvaluefield",label:"Y Data Field",entries:o}),F=b({id:"sizeaggfunction",label:"Size Aggregate Function",entries:u}),I=g({id:"sizefield",label:"Size Field",entries:o});R.each(W[j.types[l].category].options,function(){d.push(this)});var T,E,M=[],B={id:"type",type:"picklist",label:"Type",picklistEntries:d,onChange:function(){a.refresh()}},G={line:[x,k,y],pie:[x,k,y],scatter:[y]},L=function(e,r){var t=e.children("axis"),i=[];return R.each(t,function(){var e=R(this),t=e.attr("id"),a=e.attr("title")||t;r.type&&r.type!==e.attr("type")||i.push({value:t,label:a})}),1<i.length&&{id:r.id,type:"picklist",label:r.label,picklistEntries:i}};if(!0===s.hasMultiAxis)if(!0===s.hasXY)T=L(h,{id:"xAxisId",label:"X Data Axis",type:"xaxis"}),E=L(h,{id:"yAxisId",label:"Y Data Axis",type:"yaxis"});else{var P=L(h,{id:"dataAxisId",label:"Data Axis"});P&&M.push(P)}if(M.push(m),!0===s.hasCategories){var _=L(f,{id:"categoryAxisId",label:"Category Axis"});_&&M.push(_),r.attr("modelId")&&M.push(w)}M=M.concat(G[l]||G[j.types[l].category]);var N=r.attr("splittype");return"field"===N?M.push(v):"template"===N&&M.push(C),!0===s.hasXY&&(T&&M.push(T),M.push(S),M.push(A),E&&M.push(E),M.push(D),M.push(O)),!0===s.hasSize&&(M.push(F),M.push(I)),M.push(B),M}({component:t,seriesComponent:e})}}]}},s=function(e,t){var a=j.types[t.chart.type];e.highcharts()&&e.highcharts().destroy(),t.chart.type=a.hcType||t.chart.type,(t.legend&&!0===t.legend.showLabels||!1===t.legend.showLabels)&&(t.plotOptions||(t.plotOptions={}),t.plotOptions[t.chart.type]||(t.plotOptions[t.chart.type]={}),t.plotOptions[t.chart.type].dataLabels={enabled:t.legend.showLabels}),a.additionalProps&&a.additionalProps(t),R.extend(t.chart,{reflow:!1}),e.highcharts(t)},b.registerBuilder(new b.Builder({id:"skuidvis__chartset",name:"Chart Set",icon:"sk-bi-fields-agg",isJSCreateable:!0,hideFromComponentsList:!0,description:"A collection of related Charts",propertiesRenderer:function(e,r){var i=this,t=r.state,l=t.children("charts").first(),a=[];if(e.setHeaderText(i.name+" Properties"),c.mobile){var n=[],o=function(e,a){return new d.PropertyItem({type:"customaction",label:e,customAction:function(){var e,t=b.getBuilder(a).getDefaultState(void 0,{setUniqueId:!0});l.append(t),r.save(),e=r.addChart(t),i.selectChart(e)}})};n.push(o("Add Drilldown Chart","skuidvis__chart"),o("Add Drilldown Geochart","skuidvis__geochart")),0<n.length&&a.push({name:"Actions",props:n,expanded:!0}),a.push({name:"Remove",props:[{type:"remove"}]})}e.applyPropsWithCategories(a,t)},componentRenderer:function(r){var i=this,e=r.state,l=r.chartsNode=e.children("charts").first();if(r.setTitle(i.name),R.extend(r,{charts:[],chartsMap:{},chartsNav:R("<ul>").addClass("sk-charts-nav"),chartPreview:R("<div>").addClass("sk-chart-preview")}),i.buildChartSetNav(r),r.body.append(r.chartsNav,r.chartPreview),r.addChart=function(e){return i.addChart(r,e)},r.getChartByID=function(e){return i.getChartByID(r,e)},r.selectChartByIndex=function(e){return i.selectChartByIndex(r,e)},r.removeChart=function(e){return i.removeChart(r,e)},!c.mobile){var t=function(e,t,a){return{text:e,icon:t,action:function(){var e,t=b.getBuilder(a).getDefaultState(void 0,{setUniqueId:!0});l.append(t),r.save(),e=r.addChart(t),i.selectChart(e),e.reflow()}}};r.addActionGroup([t("Chart","sk-bi-fields-agg","skuidvis__chart"),t("Geochart","sk-icon-world","skuidvis__geochart")],"Add Drilldown","sk-icon-add")}},handleStateEvent:function(e,t,a){var r=!1,i=t.type,l=t.chartSet;if("chartset.chart.remove"===i&&a===l){var n=t.chartID,o=e.find('action[type="drilldown"][chartid="'+n+'"]');o.length&&(r=!0,o.remove())}!0===r&&a.save()},buildChartSetNav:function(e){var t=this,a=e.state.children("charts").first();a.length&&(a.children().each(function(){t.addChart(e,R(this))}),void 0===e.selectedChart&&t.selectChart(e.charts[0]))},addChart:function(e,t){var a=this,r=e.charts,i=e.chartsMap,l=e.chartsNav,n=R("<li>").text("Chart "+(r.length+1)),o=t.attr("uniqueid"),s=c.mobile?new d.Component(t).render():b.componentFactoryWithCache(t,b.getBuilder(t[0].nodeName),{makeDraggable:!1,isGlobalComponent:!1});return R.extend(s,{chartSet:e,button:n}),r.push(s),o&&(i[o]=s),n.on("click.skuid",function(e){e.stopPropagation(),a.selectChart(s)}),l.append(n),s},selectChart:function(e){var t=e.chartSet,a=t.selectedChart;if(void 0!==a){var r=a.button;r&&r.removeClass("selected")}var i=e.button;return i&&i.addClass("selected"),e.refresh(),(t.isSelected()||!t.isSelected()&&void 0!==t.selectedChart)&&e.select(),t.selectedChart=e,t.chartPreview.empty().append(e.element),c.events.publish("skuid.chart.reflow",[{component:e}]),e},selectChartByIndex:function(e,t){return this.selectChart(e.charts[t])},getChartByID:function(e,t){if(void 0!==t)return e.chartsMap[t]},removeChart:function(e,t){if(void 0!==t){var a=t.state.attr("uniqueid");t.remove(),t===e.selectedChart&&delete e.selectedChart,b.publishStateEvent({type:"chartset.chart.remove",chartSet:e,chartID:a}),e.save().refresh(),e.charts&&e.charts.map(function(e){e.reflow()})}},defaultStateGenerator:function(){return p("<skuidvis__chartset/>").append(p("<charts/>"))},afterAttach:function(t){c.events.subscribe(["component.drag.complete"],function(e){e._GUID===t._GUID&&t.charts.map(function(e){e.reflow()})})}})),b.registerBuilder(new b.Builder({id:"skuidvis__chart",name:"Chart",icon:"sk-bi-fields-agg",isJSCreateable:!0,givesMultipleContextRows:!0,supportsMultipleContextRows:!0,description:function(){return'The Chart component displays data series from one or more models in various formats, helping users visualize relationships or trends in the data.\n\t\t\t\t\t<br><br>\n\t\t\t\t\tFor more information, see the <a href="'+c.platform.getDocsBaseUrl()+'skuid/components/original/visualizations/chart/">Chart component tutorial</a>.\n\t\t\t\t\t<br><br>\n\t\t\t\t\t'+i.getDescriptionTag()},onDropEvent:"chart.addedToBuilder",actionTypes:{series:function(e){return V.getSeriesActions(e)}},handleStateEvent:function(e,a,t){var r=!1,i=a.type,l="model.idChange"===i,n=e.attr("model"),o=e.children("serieslist").children(),s=a.component,d=a.oldId,c=a.newId,p=!1;if(l&&(p=b.handleModelIdChange(e,a)||p,a.oldId===n&&(o&&R.each(o,function(e,t){t=R(t),a.oldId===t.attr("modelId")&&t.attr("modelId",a.newId)}),p=!0)),t===s){var u=e.children("serieslist").first();"chart.dataAxes.idChange"===i&&R.each(u.children("series"),function(){var e=R(this);e.attr("dataAxisId")===d&&(e.attr("dataAxisId",c),r=!0)}),"chart.categoryAxes.idChange"===i&&R.each(u.children("series"),function(){var e=R(this);e.attr("categoryAxisId")===d&&(e.attr("categoryAxisId",c),r=!0)})}p&&t&&h("skuidBuilderComponentNeedsRefresh",[t]),!0===r&&t.save()},propertiesRenderer:function(s,d){s.setHeaderText(u("chart")+" Properties");var a=[];R.each(W,function(e,t){a.push({label:"-- "+j.types[e].label+u("chart")+" Types --",value:"",disabled:!0}),R.each(t.options,function(){a.push(this)}),a.push({label:"",value:"",disabled:!0})});var e=d.state,t=j.types[e.attr("type")].metadata,r={id:"type",type:"picklist",label:"Default "+u("chart")+" Type",picklistEntries:a,onChange:function(e,t){var a=d.state,r=j.types[e].metadata;if(j.types[e].category!==j.types[t].category){var i=!1;if(a.children("allowedtypes").length&&(a.children("allowedtypes").remove(),i=!0),!0===r.hasCategories||!0===r.hasXY){0===a.children("dataaxes").length&&a.append(p("<dataaxes/>"));var l={x:[],y:[],categories:[]},n=a.children("dataaxes"),o=a.children("categoryaxes");R.each(n.children("axis"),function(){var e=R(this);"xaxis"===e.attr("type")?l.x.push(e):l.y.push(e)}),R.each(o.children("axis"),function(){var e=R(this);l.categories.push(e)}),!0===r.hasXY&&(r.hasCategories||0===l.categories.length||(0===l.x.length&&R.each(l.categories,function(){this.attr("type","xaxis"),n.append(this),l.x.push(this)}),l.categories=[],o.children().remove(),i=!0),R.each(l.y,function(){this.attr("type")||(this.attr("type","yaxis"),i=!0)}),0===l.x.length&&(n.append(p('<axis id="xAxis" type="xaxis"/>')),i=!0),0===l.y.length&&(n.append(p('<axis id="yAxis" type="yaxis"/>')),i=!0)),!0===r.hasCategories&&(0!==l.x.length&&(R.each(n.children("axis"),function(){var e=R(this);"xaxis"===e.attr("type")&&(e.remove(),i=!0)}),l.x=[]),0===l.categories.length&&(o.append(p('<axis id="categories"/>')),i=!0),0===l.y.length&&(n.append(p('<axis id="axis1"/>')),i=!0))}!0===i&&d.save()}d.refresh().rebuildProps(s)}},i={id:"allowedtypes",location:"node",type:"multipicklist",storeAs:{type:"node",name:"type"},label:"Additional Chart Types",helptext:"If additional types are specified here, the user will be able to dynamically change the default chart type at runtime.",picklistEntries:W[j.types[e.attr("type")].category].options,noneSelectedText:"Select Types..."},l=[{name:"Basic",props:R.merge([r,i],function(e){var t,a=[{id:"model",type:"model",label:"Model",required:!0},U({id:"maintitle",onChange:function(){e.refresh()}}),U({id:"subtitle",title:"Subtitle",onChange:function(){e.refresh()}})];return o.isMultiCurrencyOrganization&&(t={id:"useorgcurrency",label:"Use default currency of Org rather than User.",type:"boolean",defaultValue:"false"},a.push(t)),a}(d)),expanded:!0}];if(!0!==t.hasMultiAxis&&!0!==t.hasXY||l.push({name:"Axes",tree:function(e){e||(e={});var f=e.component,t=[],a=j.types[f.state.attr("type")].metadata,r=function(e){var t=e.attr("type"),a=e.attr("id"),r=e.attr("title"),i="true"===e.attr("flip"),l="";return r?(l+=r,a&&(l+=" ("+a+")")):a&&(l+=a),(t||i)&&(l+=" | ",t&&(l+=t+(i?", ":"")),i&&(l+="flipped")),l},i={id:"dataaxes",label:"Data Axes",deleteable:!1,icon:"sk-icon-popup",isChild:!0,linkedComponent:f,propsFunction:function(){return[{type:"helptext",html:'Declare one or more "Data Axes" for the chart. Think of a data axis like a "Y Axis" on a chart.'}]},children:[{id:"axis",indent:0,labelFunction:function(e){return r(e)},defaultStateFunction:function(){var e=f.state.children("dataaxes").children("axis").length+1||1;return p('<axis id="axis'+e+'"/>')},propsFunction:function(a){var e,t=[],r=(e=[],!0===j.types[f.state.attr("type")].metadata.hasXY&&e.push({label:"X Axis",value:"xaxis"},{label:"Y Axis",value:"yaxis"}),e),i=function(){a.refresh()},l={id:"type",type:"picklist",location:"attribute",label:"Type",required:!0,helptext:'"Data" Axes correspond to the "Y" Axis of the chart. "Category" Axes correspond to the "X" Axis of the chart.',defaultValue:r.length&&r[0].value,picklistEntries:r,onChange:function(){a.refresh()}};return t=[{id:"id",type:"string",location:"attribute",label:"ID",required:!0,validator:function(e){return g(e,a,f)},onChange:function(e,t){a.refresh(),b.publishStateEvent({type:"chart.dataAxes.idChange",component:f,oldId:t,newId:e})}},{id:"title",type:"string",location:"attribute",label:"Title",onChange:function(e){i()}}],r.length&&t.push(l),t.push({id:"flip",label:"Flipped",type:"boolean",helptext:'"Flip" this axis to the opposite side of the chart (e.g. if the chart default is on the left side, this axis will be displayed on the right side)',onChange:function(e){i()}},{id:"integersonly",label:"Integers Only",type:"boolean",helptext:"If checked, this axis will only display Integer values",onChange:function(e){i()}},{id:"minvalue",label:"Min Value",type:"string",validator:c.builder.core.validators.numericOnly,onChange:function(e){i()}},{id:"maxvalue",label:"Max Value",type:"string",validator:c.builder.core.validators.numericOnly,onChange:function(e){i()}}),t}}]},l={id:"categoryaxes",label:"Category Axes",deleteable:!1,icon:"sk-icon-hierarchy",isChild:!0,linkedComponent:f,propsFunction:function(){return[{type:"helptext",html:'Declare one or more "Category Axes" for the chart. Think of a category axis like an "X Axis" on a chart.'}]},children:[{id:"axis",indent:0,labelFunction:function(e){return r(e)},defaultStateFunction:function(){var e=f.state.children("categoryaxes").children("axis").length+1||1;return p('<axis id="axis'+e+'"/>')},propsFunction:function(a){var e=[],t=f.state.attr("model"),r=V.getModelFieldsOptions(t),i=R.map(V.DATE_GRANULARITIES,function(e){return e}),l={id:"id",type:"string",location:"attribute",label:"ID",required:!0,validator:function(e){return g(e,a,f)},onChange:function(e,t){a.refresh(),b.publishStateEvent({type:"chart.categoryAxes.idChange",component:f,oldId:t,newId:e})}},n={id:"title",type:"string",location:"attribute",label:"Title",onChange:function(){a.refresh()}},o={id:"categorytype",label:"Category Type",type:"picklist",defaultValue:"field",picklistEntries:[{label:"Field",value:"field"},{label:"Template",value:"template"}],onChange:function(){a.refresh().rebuildProps()}},s={id:"field",type:"picklist",label:"Category Field",defaultValue:r.length&&r[0].value,picklistEntries:r,onChange:function(){a.refresh().rebuildProps()}},d=U({id:"template",title:"Category Template",helptext:"Optional template, allows for custom category names and handling of blank values in category data",onChange:function(){a.refresh()}}),c={id:"dategranularity",type:"picklist",label:"Default Date Granularity",defaultValue:i.length&&i[0].value,picklistEntries:i},p={id:"allowedgranularities",location:"node",type:"multipicklist",storeAs:{type:"node",name:"type"},label:"Additional Granularities",helptext:"If additional date granularities are specified here, the user will be able to dynamically change the date granularity at runtime.",picklistEntries:i,noneSelectedText:"Select Granularities..."};switch(e=[l,n,o],a.state.attr("categorytype")){case"field":e.push(s);var u=a.state.attr("field")||r&&r[0]&&r[0].fieldId,h=u&&b.getFieldInfoFromCache(t,u);!h||"DATE"!==h.displaytype&&"DATETIME"!==h.displaytype||(void 0===a.state.attr("fillvals")&&(a.state.attr("fillvals","true"),a.save()),e.push({id:"fillvals",type:"picklist",label:"Fill in values",picklistEntries:[{value:"",label:"Skip Missing Dates"},{value:"true",label:"Fill in Gaps"},{value:"week",label:"Fill in Entire Week"},{value:"month",label:"Fill in Entire Month"},{value:"year",label:"Fill in Entire Year"}],helptext:"Automatically fill in gaps in Category values (e.g. if a month is skipped in the model data, create a category entry anyway)"},c,p));break;case"template":e.push(d)}return e.push({id:"flip",type:"boolean",label:"Flipped",helptext:'"Flip" this axis to the opposite side of the chart (e.g. if the chart default is on the left side, this axis will be displayed on the right side)'}),e}}]};return t.push(i),!0===a.hasCategories&&t.push(l),t}({component:d,propViewer:s})}),l.push({name:"Series",tree:m({component:d,propViewer:s})}),l.push({name:"Styling",tree:function(l){var e=j.types[l.state.attr("type")].metadata,a=function(e,t,a){a.refresh(),l.refresh()},r=[{label:"-- Chart Default --",value:""},{label:"On",value:"true"},{label:"Off",value:"false"}],t={label:"Colors",deleteable:!1,linkedComponent:l,summaryFunction:function(e){var t=R("<div>").css({position:"relative"}),a=R("<div>").text("Chart Default"),r=V.buildColorGenerator(l),i=e.children("colors");return i&&(a.empty(),R.each(i.children("value"),function(){var e=R(this).html();a.append(R("<div>").css({"background-color":e,height:"15px",width:"8px","margin-right":"2px",display:"inline-block"}))})),t.append(a,r),t},propsFunction:function(e){var t=[];return t.push({id:"backgroundcolor",type:"color",label:"Background Color",defaultValue:"",placeholder:"default",onChange:function(){l.refresh()}},{id:"backbuttonbgcolor",type:"color",label:"Back Button Background",helptext:'Optional, specify the background color of the "Back" button when drilled down',defaultValue:"",placeholder:"default"},{id:"backbuttontextcolor",type:"color",label:"Back Button Color",helptext:'Optional, specify the color of the text of the "Back" button when drilled down',defaultValue:"",placeholder:"default"},{id:"colors",location:"node",type:"multiitem",storeAs:{type:"node",name:"value"},label:"Chart Colors",helptext:"Choose one or more colors to be used for this chart. When all colors are used, new colors are pulled from the start again.",onChange:function(){e.refresh(),l.refresh()}}),t}},i={label:"Stacking",deleteable:!1,linkedComponent:l,summaryFunction:function(e){var t=e.attr("stacking")||"";return R.map(r,function(e){if(e.value===t)return e.label})},propsFunction:function(t){return[{id:"stacking",type:"picklist",label:"Stack Series",helptext:"If checked, stackable chart types will be stacked.",picklistEntries:r,onChange:function(e){a(0,0,t)}}]}},n=[t,V.getHeightTree({component:l,defaultSummary:"-- Chart Default --",label:"Chart Height"})];!0===e.isStackable&&n.push(i),!0===e.hasLegend&&n.push(V.getLegendTree({component:l,defaultSummary:"-- Chart Default --",metadata:e}));var o=[{label:"-- Chart Default --",value:""},{label:"On",value:"true"},{label:"Off",value:"false"}],s={label:"Data Labels",deleteable:!1,linkedComponent:l,state:l.state.children("legend:first"),summaryFunction:function(e){var t=e.attr("showlabels")||"";return R.map(o,function(e){if(e.value===t)return e.label})},propsFunction:function(t){return[{id:"showlabels",type:"picklist",label:"Display Data Labels",location:"attribute",picklistEntries:o,onChange:function(e){a(0,0,t)}}]}};return n.push(s),n}(d)}),l.push(V.getAdvancedProps({component:d}),b.getRenderingCategory({component:d,propViewer:s}),b.getContextCategory({state:e,model:e.attr("model")})),c.mobile){if(void 0===d.chartSet){var n=V.getMobileActionsList(d)||[];0<n.length&&l.push({name:"Actions",props:n})}l.push({name:"Remove",props:[{type:"remove"}]})}s.applyPropsWithCategories(l,e)},buildChartObj:function(e){var t={chart:{type:e.attr("type")||"line"},title:{text:e.attr("maintitle")},subtitle:{text:e.attr("subtitle")},credits:{enabled:!1},plotOptions:{series:{animation:!1}}},a=e.children("colors"),r={backgroundColor:e.attr("backgroundcolor")},i=t.chart.type,l=j.types[i].hcType||i,n=j.types[i].metadata;R.extend(t,f[i]||{}),"off"===e.attr("export")?t.exporting={enabled:!1}:"offline"===e.attr("export")&&(t.exporting={mode:"offline"}),"true"==e.attr("stacking")&&(t.plotOptions||(t.plotOptions={}),t.plotOptions.series||(t.plotOptions.series={}),t.plotOptions.series.stacking="normal");var o=e.children("legend");if(o){var s=o.attr("layout");t.legend="off"===s?{enabled:!1}:{layout:o.attr("layout"),align:o.attr("halign"),verticalAlign:o.attr("valign")};var d=o.attr("showlabels");"true"===d?t.legend.showLabels=!0:"false"===d&&(t.legend.showLabels=!1),!0!==n.hasDataLabels||"horizontal"!==t.legend.layout&&"vertical"!==t.legend.layout||(t.plotOptions||(t.plotOptions={}),t.plotOptions[l]||(t.plotOptions[l]={}),R.extend(!0,t.plotOptions[l],{showInLegend:!0}))}if(a){var c=a.children("value");c.length&&(t.colors=[],R.each(c,function(){t.colors.push(R(this).text())}))}return t.chart||(t.chart={}),t.chart.backgroundColor=r.backgroundColor,t},componentRenderer:function(a){a.setTitle(a.builder.name),a.givesMultipleContextRows=!0;var e=a.state,t=a.chartSet,r=a.chartWrapper=R("<div>").addClass("sk-chart-wrapper"),i=e.attr("height");a.container=R("<div>").addClass("sk-chart-container").appendTo(r),a.chartObj=this.buildChartObj(e),i&&r.css({height:i}),c.mobile||(void 0===t?V.addDrilldownActionGroup(a):a.addActionItem({text:u("Remove"),icon:"sk-icon-delete",action:function(){t.removeChart(a)},id:"removeButton"})),a.reflow=function(){var e=a.container,t=e.highcharts();t&&t.chartWidth!==e.width()&&e.is(":visible")&&t.reflow()}},afterAttach:function(t){t.body.append(t.chartWrapper),l&&s(t.container,t.chartObj),c.utils.addResizeHandler(t.reflow,100),o.delayEventCallback({eventType:"tabshow pageload dialogopen stepchange",delay:20,callback:t.reflow}),c.events.subscribeOnce(["skuid.pageBuilder.complete",this.onDropEvent],function(){s(t.container,t.chartObj),l=!0}),!l&&c.events.subscribe("component.drag.complete",function(e){e._GUID===t._GUID&&t.reflow()}),c.events.subscribe(["ui.reflow","skuid.chart.reflow"],function(e){e&&e.length&&e[0].component!==t||t.reflow()})},defaultStateGenerator:function(e){var t=b.getLastSelectedModelComponent(),a=t?t.state:b.getFirstModel(),r=a?a.attr("id"):null,i=p("<"+this.id+' model="'+r+'" maintitle="{{Model.labelPlural}}" type="line" />');return i.append(p('<dataaxes><axis id="axis1"/></dataaxes>'),p('<categoryaxes><axis id="categories" categorytype="field"/></categoryaxes>'),p("<serieslist/>"),p("<colors/>"),p('<legend layout="horizontal" halign="center" valign="bottom"/>')),e||(e={}),!0===e.includeContextCondition&&i.append(p("<conditions/>").append(p('<condition type="contextrows" field="Id" mergefield="Id" operator="in" autocreated="true"/>'))),i}}))},326:function(e,t,a){"use strict";var h,m,r,d,i,f,o,b,l,y,v,g;h=skuid,m=h.$,r=h.builder,d=r.core,i=r.desktop,f=h.utils,o=f.makeXMLDoc,b=h.$L,l=h.visualizations,y=l.core,v=l.map,g=v.defaultSettings,d.registerBuilder(new d.Builder({id:"skuidvis__geochart",name:"Geochart",icon:"sk-icon-world",isJSCreateable:!0,givesMultipleContextRows:!0,supportsMultipleContextRows:!0,actionTypes:{series:function(e){var t=y.getSeriesActions(e,{indent:3}),a=e.mapMetadata;return a&&a.drillDownMap&&t.push({value:"mapDrillIn",label:"Map Drill In",props:[{type:"helptext",html:'Also known as "Classic" Drilldown for Geocharts, this will load the next level down map for this Geochart'}]}),t}},description:function(){return'A choropleth map, the Geochart component displays data on map regions (such as country, state,  province, or county maps) that are shaded in proportion to an aggregate value for each region.\n\t\t\t\t<br><br>\n\t\t\t\tFor more information, see the <a href="'+h.platform.getDocsBaseUrl()+'skuid/components/original/visualizations/geochart/">Geochart component tutorial</a>.\n\t\t\t\t<br><br>\n\t\t\t\t'+i.getDescriptionTag()},propertiesRenderer:function(e,t){e.setHeaderText("Geochart Properties");var a=t.state,r=a.attr("maptype");if(void 0===a.attr("mapgroup")){var i=v.types[r]&&v.types[r].group;d.updateState(a,{key:"mapgroup",value:i||"global"})}var l=[{name:"Basic",props:[{id:"maintitle",type:"string",location:"attribute",label:"Title",onChange:function(){t.refresh()}},{id:"subtitle",type:"string",location:"attribute",label:"Subtitle",onChange:function(){t.refresh()}},{id:"model",type:"model",label:"Model",required:!0},{id:"mapgroup",type:"picklist",label:"Map Group",defaultValue:"global",picklistEntries:[{value:"global",label:"Global"},{value:"af",label:"Africa"},{value:"as",label:"Asia"},{value:"eu",label:"Europe"},{value:"na",label:"North America"},{value:"oc",label:"Oceania"},{value:"sa",label:"South America"},{value:"canada",label:"Canadian Provinces"},{value:"usa",label:"USA States"}],onChange:function(){t.rebuildProps(e)}},{id:"maptype",type:"picklist",label:"Map Type",picklistEntries:m.map(v.types,function(e,t){if(-1!==m.inArray(a.attr("mapgroup"),e.groups))return{value:t,label:e.title}}).sort(function(e,t){return e.label>t.label?1:e.label<t.label?-1:0}),onChange:function(){t.refresh()}}],expanded:!0},{name:"Series",tree:function(e){e||(e={});var b=e.propViewer,g=e.component;return[{id:"serieslist",label:"Series List",deleteable:!1,icon:"sk-bi-renderconditions",isChild:!0,linkedComponent:g,props:[{type:"helptext",html:"Define one or more data series for this map"}],children:[{id:"series",indent:1,labelFunction:function(e){var t="",a=e.attr("modelId"),r=e.attr("valueField"),i=e.attr("splitField"),l=e.attr("aggFunction");return l&&(t+=y.AGG_FUNCTIONS[l].label+" "),r&&(t+=r),a&&(t+=" ("+a+")"),i&&(t+=" by "+i),t||"Series"},defaultStateFunction:function(){return o('<series joinBy="hc-key"/>')},childrenFunction:function(e){return y.getSeriesOnClickActionsTree({seriesComponent:e,component:g,seriesObj:this})},propsFunction:function(a){var e,t,r=a.state,i=v.types[g.state.attr("maptype")],l=r.attr("modelId")||g.state.attr("model"),n=y.getModelFieldsOptions(l),o=m.merge([{label:"-- None --",value:""}],n),s=m.merge([{label:"-- None --",value:""}],m.map(y.AGG_FUNCTIONS,function(e){return e})),d=function(e){var t={id:e.id,type:"picklist",label:e.label,picklistEntries:e.entries,onChange:function(){a.refresh()}};return e.helptext&&(t.helptext=e.helptext),t},c={id:"modelId",type:"model",label:"Model",noneOption:{label:"-- Default --",value:""},onChange:function(){a.refresh(),a.rebuildProps&&a.rebuildProps(),a.renderProperties&&a.renderProperties(b)}},p=(t={id:(e={id:"aggFunction",label:"Aggregate Function",entries:s}).id,type:"picklist",label:e.label,picklistEntries:e.entries,onChange:function(){a.refresh()}},e.helptext&&(t.helptext=e.helptext),t),u=d({id:"valueField",label:"Data Field",entries:n}),h=[];if(h.push(c,p,u),i.features&&i.features.length){var f={country:"The default maps in Geocharts require 2-digit ISO-3166 codes to connect your data to the maps. Country Field data that does not match this format will not be displayed.",state:"The default maps in Geocharts require 2-digit ISO-3166 codes to connect your data to the maps. State Field data that does not match this format will not be displayed."};m.each(i.features,function(){var e=d({id:this.id+"field",label:this.label+" Field"+(this.defaultValue?" ("+this.defaultValue+")":""),entries:!0===this.required?n:o});this.helptext?e.helptext=this.helptext:void 0!==f[this.id]&&(e.helptext=f[this.id]),h.push(e)})}else h.push({id:"mergeKey",type:"template",location:"attribute",displayAs:"input",label:"Merge Key"});return h}}]},{id:"buckets",label:"Buckets",deleteable:!1,icon:"sk-bi-conditions",isChild:!0,linkedComponent:g,props:[{type:"helptext",html:'Options for sorting series data into buckets (e.g. "Low" is values  < 10, "Medium" is values 10 to 20...)'}],children:[{id:"bucket",indent:1,summaryFunction:function(e){var t=m("<span>").text("Bucket"),a=e.attr("label"),r=e.attr("from"),i=e.attr("to"),l=e.attr("color");return a?t.html(a):i&&!r?t.html("< "+i):i&&r?t.html(r+" - "+i):!i&&r&&t.html("> "+r),l&&t.prepend(y.getColorPreview(l)),t},defaultStateFunction:function(){return o("<bucket/>")},propsFunction:function(a){var e=function(e){var t={id:e.id,label:e.label,type:"string",location:"attribute",onChange:function(){a.refresh(),g.refresh()}};return e.validator&&(t.validator=e.validator),t},t=[];return t.push(e({id:"label",label:"Label"}),e({id:"from",label:"From",validator:d.validators.numericOnly}),e({id:"to",label:"To",validator:d.validators.numericOnly}),e({id:"color",label:"Color"})),t}}]}]}({component:t,propViewer:e})},{name:"Styling",tree:function(p){var u=[{value:"",label:"-- Map Default --"},{value:"sk-data-value",label:"Data Value"},{value:"sk-off",label:"Off"}];return[{label:"Colors",deleteable:!1,linkedComponent:p,summaryFunction:function(e){var t=m("<div>").css({position:"relative"}),a=m("<div>").text("Map Default"),r=y.buildColorGenerator(p,{colorCount:7,variance:"0"}),i=e.children("colors");return i&&(a.empty(),m.each(i.children("value"),function(){var e=m(this).html();a.append(m("<div>").css({"background-color":e,height:"15px",width:"8px","margin-right":"2px",display:"inline-block"}))})),t.append(a,r),t},propsFunction:function(e){var t=[];return t.push({id:"backgroundcolor",type:"color",placeholder:"default",label:"Background Color",onChange:function(){p.refresh()}},{id:"hovercolor",type:"color",placeholder:"default",label:"Hover Color",helptext:"Optional, color to display when mousing over a map area",onChange:function(){p.refresh()}},{id:"nullcolor",type:"color",placeholder:"default",label:"Null Color",helptext:"Optional, color to display in map areas where this no data",onChange:function(){p.refresh()}},{id:"backbuttonbgcolor",type:"color",placeholder:"default",label:"Back Button Background",helptext:'Optional, specify the background color of the "Back" button when drilled down/in',defaultValue:""},{id:"backbuttontextcolor",type:"color",placeholder:"default",label:"Back Button Color",helptext:'Optional, specify the color of the text of the "Back" button when drilled down/in',defaultValue:""},{label:"Chart Colors",helptext:"Choose one or more colors to be used for this chart. When all colors are used, new colors are pulled from the start again.",id:"colors",location:"node",type:"multiitem",storeAs:{type:"node",name:"value"},onChange:function(){e.refresh(),p.refresh()}}),t}},y.getHeightTree({component:p,defaultSummary:"-- Geochart Default --",label:"Height"}),y.getLegendTree({component:p,defaultSummary:"-- Geochart Default --",defaultState:"<legend/>"}),{id:"regions",label:"Regions",deleteable:!1,linkedComponent:p,summaryFunction:function(e){var t=m("<span>").text("-- Geochart Default --"),a="",r=e.attr("rbcolor"),i=e.attr("rbwidth"),l=e.attr("rbstyle");return i&&(a=i),l&&(""!==a&&(a+=" | "),a+=l),""!==a&&t.html(a),r&&t.prepend(y.getColorPreview(r)),t},propsFunction:function(e){var t=function(){p.refresh(),e.refresh()};return[{type:"helptext",html:"Options for styling borders between regions on the Geochart"},{id:"rbstyle",type:"picklist",label:"Style",picklistEntries:[{value:"",label:"-- Geochart Default --"},{value:"Solid",label:"Solid"},{label:"ShortDash"},{label:"ShortDot"},{label:"ShortDashDot"},{label:"ShortDashDotDot"},{value:"Dot",label:"Dot"},{label:"Dash"},{label:"LongDash"},{label:"DashDot"},{label:"LongDashDot"},{label:"LongDashDotDot"}],onChange:function(e){t()}},{id:"rbwidth",label:"Width",type:"string",placeholder:"default",validator:d.validators.numericOnly,onChange:function(e){t()}},{id:"rbcolor",label:"Color",type:"color",placeholder:"default",onChange:function(e){t()}}]}},{id:"labels",label:"Labels",deleteable:!1,linkedComponent:p,summaryFunction:function(e){var t=v.types[p.state.attr("maptype")],a=m("<div>").text("Map Default"),r="",i=e.attr("dlformat"),l=e.attr("dlcolor"),n=e.attr("dlstrokecolor"),o=e.attr("dlstrokewidth");if(i){var s=u.concat(t.labelFormats||[]),d=m.grep(s,function(e){return e.value===i});r+=d.length&&d[0].label||i}if(""!==r&&a.text(r),l||o||n){var c=y.getColorPreview(l||"white").css({border:"3px solid rgba(0,0,0,0.5)"});n&&c.css({"border-color":n}),a.prepend(c)}return a},propsFunction:function(e){var t=[],a=v.types[p.state.attr("maptype")],r=function(){p.refresh(),e.refresh()},i={id:"dlformat",label:"Format",type:"picklist",defaultValue:"",picklistEntries:u,onChange:function(e){r()}},l={id:"dlcolor",label:"Text Color",type:"color",defaultValue:"",placeholder:"default",onChange:function(e){r()}},n={id:"dlbold",label:"Bold Labels",type:"boolean",onChange:function(e){r()}},o={id:"dlstrokecolor",label:"Stroke Color",placeholder:"default",helptext:'Color and alpha of the outline around data labels (e.g. "rgba(0,0,0,0.5)")',type:"color",onChange:function(e){r()}},s={id:"dlstrokewidth",label:"Stroke Width (in pixels)",placeholder:"default",validator:d.validators.numericOnly,helptext:'Width of the outline around data labels in pixels (e.g. "3")',type:"string",onChange:function(e){r()}};return a.labelFormats&&a.labelFormats.length&&(i.picklistEntries=u.concat([{label:"",value:"",disabled:!0},{label:"Additional Formats",value:"",disabled:!0}],a.labelFormats)),t.push(i),"sk-off"!=p.state.attr("dlformat")&&t.push(l,n,o,s),t}}]}(t)},y.getAdvancedProps({component:t}),d.getRenderingCategory({component:t,propViewer:e})];if(h.mobile){if(void 0===t.chartSet){var n=y.getMobileActionsList(t)||[];0<n.length&&l.push({name:"Actions",props:n})}l.push({name:"Remove",props:[{type:"remove"}]})}e.applyPropsWithCategories(l,a)},componentRenderer:function(r){r.setTitle(r.builder.name),r.givesMultipleContextRows=!0;var e=r.state,t=r.chartSet,a=m("<div>").addClass("sk-chart-wrapper"),i=m("<div>").addClass("sk-chart-container").appendTo(a),l=m.Deferred(),n=r.mapMetadata=v.types[e.attr("maptype")||Object.keys(v.types)[0]],o={backgroundColor:e.attr("backgroundcolor")||g.BACKGROUND_COLOR,nullColor:e.attr("nullcolor")||g.NULL_COLOR,hoverColor:e.attr("hovercolor"),colors:y.getColorsArray(e.children("colors").first()),legend:e.children("legend").first(),regions:{color:e.attr("rbcolor"),width:e.attr("rbwidth")||g.REGION_WIDTH,style:e.attr("rbstyle")},labels:{format:e.attr("dlformat"),color:e.attr("dlcolor")||g.LABEL_COLOR,bold:"true"===e.attr("dlbold"),strokeColor:e.attr("dlstrokecolor"),strokeWidth:e.attr("dlstrokewidth")||g.STROKE_WIDTH}},s=e.find("buckets:first > bucket"),d={title:{text:e.attr("maintitle")||"My Map"},subtitle:{text:e.attr("subtitle")||"Subtitle"},credits:{enabled:!1},colorAxis:{min:0},plotOptions:{map:{dataLabels:{enabled:!0,formatter:function(){return this.point.name}},animation:!1}}};if(a.css({height:e.attr("height")||"400px",position:"relative"}),i.css({height:"100%",width:"100%",position:"absolute"}),r.mapWrapper=a,r.container=i,r.mapObj=d,"off"===e.attr("export")&&(d.exporting={enabled:!1}),o.backgroundColor&&(d.chart||(d.chart={}),d.chart.backgroundColor=o.backgroundColor),o.nullColor&&(d.plotOptions.map.nullColor=o.nullColor),o.hoverColor&&(d.plotOptions.map.states={hover:{color:o.hoverColor}}),1<o.colors.length&&o.colors[0]&&o.colors[o.colors.length-1]){var c=o.colors;m.extend(d.colorAxis,{minColor:c[0],maxColor:c[c.length-1]})}if(v.methods.formatRegions(d,o.regions),(o.labels.format||o.labels.color||o.labels.strokeColor||o.labels.strokeWidth)&&v.methods.formatDataLabels(d,o.labels),0<s.length){var p=[];m.each(s,function(){var e=m(this),t={},a=e.attr("to"),r=e.attr("from"),i=e.attr("label"),l=e.attr("color");a&&(t.to=a),r&&(t.from=r),i&&(t.name=i),l&&(t.color=l),p.push(t)}),m.extend(d.colorAxis,{dataClasses:p})}if(o.legend.length){var u=y.parseNodetoObj(o.legend);v.methods.formatLegend(d,u)}f.getJSONBodyOfZIPResourceFile("GeochartMaps","skuid",n.mapfile).done(function(e){l.resolve(e)}).fail(function(e){l.reject(e)}),l.done(function(e){var t=[],a=-1;m.each(e.features,function(){if(-1===a)return a++,!0;t.push({"hc-key":this.properties["hc-key"],value:a++}),7===a&&(a=-1)}),d.series=[{data:t,mapData:e,joinBy:"hc-key"},{name:"Separators",type:"mapline",data:Highcharts.geojson(e,"mapline"),color:"silver",showInLegend:!1,enableMouseTracking:!1}],function(e){var t=e.container;t.highcharts()&&t.highcharts().destroy(),t.highcharts("Map",e.mapObj)}(r)}),h.mobile||(void 0===t?y.addDrilldownActionGroup(r):r.addActionItem({text:b("Remove"),icon:"sk-icon-delete",action:function(){t.removeChart(r)},id:"removeButton"})),r.reflow=function(){var e=r.container,t=e.highcharts();t&&t.chartWidth!==e.width()&&e.is(":visible")&&t.reflow()}},afterAttach:function(t){t.body.append(t.mapWrapper),h.utils.addResizeHandler(t.reflow,100),f.delayEventCallback({eventType:"tabshow pageload dialogopen stepchange",delay:20,callback:t.reflow}),h.events.subscribe(["ui.reflow","skuid.chart.reflow"],function(e){e&&e.length&&e[0].component!==t||t.reflow()})},defaultStateGenerator:function(){var e,t=d.getLastSelectedModelComponent(),a=t?t.state:d.getFirstModel(),r=a?a.attr("id"):null;for(var i in v.types){e=i;break}return o("<"+this.id+' model="'+r+'" maintitle="{{Model.labelPlural}}" maptype="'+e+'" height="600px" />').append(o("<colors/>"),o("<legend/>"))}}))}});