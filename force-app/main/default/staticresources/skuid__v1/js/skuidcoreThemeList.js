!function(n){var r={};function i(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,i),t.l=!0,t.exports}i.m=n,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=318)}({10:function(H,J,$){var V;!function(l){var u=/^\s+/,c=/\s+$/,r=0,a=l.round,h=l.min,f=l.max,e=l.random;function d(e,t){if(t=t||{},(e=e||"")instanceof d)return e;if(!(this instanceof d))return new d(e,t);var n=function(e){var t={r:0,g:0,b:0},n=1,r=null,i=null,s=null,a=!1,o=!1;"string"==typeof e&&(e=function(e){e=e.replace(u,"").replace(c,"").toLowerCase();var t,n=!1;if(x[e])e=x[e],n=!0;else if("transparent"==e)return{r:0,g:0,b:0,a:0,format:"name"};if(t=U.rgb.exec(e))return{r:t[1],g:t[2],b:t[3]};if(t=U.rgba.exec(e))return{r:t[1],g:t[2],b:t[3],a:t[4]};if(t=U.hsl.exec(e))return{h:t[1],s:t[2],l:t[3]};if(t=U.hsla.exec(e))return{h:t[1],s:t[2],l:t[3],a:t[4]};if(t=U.hsv.exec(e))return{h:t[1],s:t[2],v:t[3]};if(t=U.hsva.exec(e))return{h:t[1],s:t[2],v:t[3],a:t[4]};if(t=U.hex8.exec(e))return{r:I(t[1]),g:I(t[2]),b:I(t[3]),a:E(t[4]),format:n?"name":"hex8"};if(t=U.hex6.exec(e))return{r:I(t[1]),g:I(t[2]),b:I(t[3]),format:n?"name":"hex"};if(t=U.hex4.exec(e))return{r:I(t[1]+""+t[1]),g:I(t[2]+""+t[2]),b:I(t[3]+""+t[3]),a:E(t[4]+""+t[4]),format:n?"name":"hex8"};if(t=U.hex3.exec(e))return{r:I(t[1]+""+t[1]),g:I(t[2]+""+t[2]),b:I(t[3]+""+t[3]),format:n?"name":"hex"};return!1}(e));"object"==typeof e&&(P(e.r)&&P(e.g)&&P(e.b)?(t=function(e,t,n){return{r:255*N(e,255),g:255*N(t,255),b:255*N(n,255)}}(e.r,e.g,e.b),a=!0,o="%"===String(e.r).substr(-1)?"prgb":"rgb"):P(e.h)&&P(e.s)&&P(e.v)?(r=D(e.s),i=D(e.v),t=function(e,t,n){e=6*N(e,360),t=N(t,100),n=N(n,100);var r=l.floor(e),i=e-r,s=n*(1-t),a=n*(1-i*t),o=n*(1-(1-i)*t),u=r%6;return{r:255*[n,a,s,s,o,n][u],g:255*[o,n,n,a,s,s][u],b:255*[s,s,o,n,n,a][u]}}(e.h,r,i),a=!0,o="hsv"):P(e.h)&&P(e.s)&&P(e.l)&&(r=D(e.s),s=D(e.l),t=function(e,t,n){var r,i,s;function a(e,t,n){return n<0&&(n+=1),1<n&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}if(e=N(e,360),t=N(t,100),n=N(n,100),0===t)r=i=s=n;else{var o=n<.5?n*(1+t):n+t-n*t,u=2*n-o;r=a(u,o,e+1/3),i=a(u,o,e),s=a(u,o,e-1/3)}return{r:255*r,g:255*i,b:255*s}}(e.h,r,s),a=!0,o="hsl"),e.hasOwnProperty("a")&&(n=e.a));return n=C(n),{ok:a,format:e.format||o,r:h(255,f(t.r,0)),g:h(255,f(t.g,0)),b:h(255,f(t.b,0)),a:n}}(e);this._originalInput=e,this._r=n.r,this._g=n.g,this._b=n.b,this._a=n.a,this._roundA=a(100*this._a)/100,this._format=t.format||n.format,this._gradientType=t.gradientType,this._r<1&&(this._r=a(this._r)),this._g<1&&(this._g=a(this._g)),this._b<1&&(this._b=a(this._b)),this._ok=n.ok,this._tc_id=r++}function i(e,t,n){e=N(e,255),t=N(t,255),n=N(n,255);var r,i,s=f(e,t,n),a=h(e,t,n),o=(s+a)/2;if(s==a)r=i=0;else{var u=s-a;switch(i=.5<o?u/(2-s-a):u/(s+a),s){case e:r=(t-n)/u+(t<n?6:0);break;case t:r=(n-e)/u+2;break;case n:r=(e-t)/u+4}r/=6}return{h:r,s:i,l:o}}function s(e,t,n){e=N(e,255),t=N(t,255),n=N(n,255);var r,i,s=f(e,t,n),a=h(e,t,n),o=s,u=s-a;if(i=0===s?0:u/s,s==a)r=0;else{switch(s){case e:r=(t-n)/u+(t<n?6:0);break;case t:r=(n-e)/u+2;break;case n:r=(e-t)/u+4}r/=6}return{h:r,s:i,v:o}}function t(e,t,n,r){var i=[F(a(e).toString(16)),F(a(t).toString(16)),F(a(n).toString(16))];return r&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function o(e,t,n,r){return[F(M(r)),F(a(e).toString(16)),F(a(t).toString(16)),F(a(n).toString(16))].join("")}function n(e,t){t=0===t?0:t||10;var n=d(e).toHsl();return n.s-=t/100,n.s=j(n.s),d(n)}function m(e,t){t=0===t?0:t||10;var n=d(e).toHsl();return n.s+=t/100,n.s=j(n.s),d(n)}function g(e){return d(e).desaturate(100)}function p(e,t){t=0===t?0:t||10;var n=d(e).toHsl();return n.l+=t/100,n.l=j(n.l),d(n)}function _(e,t){t=0===t?0:t||10;var n=d(e).toRgb();return n.r=f(0,h(255,n.r-a(-t/100*255))),n.g=f(0,h(255,n.g-a(-t/100*255))),n.b=f(0,h(255,n.b-a(-t/100*255))),d(n)}function b(e,t){t=0===t?0:t||10;var n=d(e).toHsl();return n.l-=t/100,n.l=j(n.l),d(n)}function v(e,t){var n=d(e).toHsl(),r=(n.h+t)%360;return n.h=r<0?360+r:r,d(n)}function S(e){var t=d(e).toHsl();return t.h=(t.h+180)%360,d(t)}function k(e){var t=d(e).toHsl(),n=t.h;return[d(e),d({h:(n+120)%360,s:t.s,l:t.l}),d({h:(n+240)%360,s:t.s,l:t.l})]}function y(e){var t=d(e).toHsl(),n=t.h;return[d(e),d({h:(n+90)%360,s:t.s,l:t.l}),d({h:(n+180)%360,s:t.s,l:t.l}),d({h:(n+270)%360,s:t.s,l:t.l})]}function T(e){var t=d(e).toHsl(),n=t.h;return[d(e),d({h:(n+72)%360,s:t.s,l:t.l}),d({h:(n+216)%360,s:t.s,l:t.l})]}function w(e,t,n){t=t||6,n=n||30;var r=d(e).toHsl(),i=360/n,s=[d(e)];for(r.h=(r.h-(i*t>>1)+720)%360;--t;)r.h=(r.h+i)%360,s.push(d(r));return s}function R(e,t){t=t||6;for(var n=d(e).toHsv(),r=n.h,i=n.s,s=n.v,a=[],o=1/t;t--;)a.push(d({h:r,s:i,v:s})),s=(s+o)%1;return a}d.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},getLuminance:function(){var e,t,n,r=this.toRgb();return e=r.r/255,t=r.g/255,n=r.b/255,.2126*(e<=.03928?e/12.92:l.pow((.055+e)/1.055,2.4))+.7152*(t<=.03928?t/12.92:l.pow((.055+t)/1.055,2.4))+.0722*(n<=.03928?n/12.92:l.pow((.055+n)/1.055,2.4))},setAlpha:function(e){return this._a=C(e),this._roundA=a(100*this._a)/100,this},toHsv:function(){var e=s(this._r,this._g,this._b);return{h:360*e.h,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=s(this._r,this._g,this._b),t=a(360*e.h),n=a(100*e.s),r=a(100*e.v);return 1==this._a?"hsv("+t+", "+n+"%, "+r+"%)":"hsva("+t+", "+n+"%, "+r+"%, "+this._roundA+")"},toHsl:function(){var e=i(this._r,this._g,this._b);return{h:360*e.h,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=i(this._r,this._g,this._b),t=a(360*e.h),n=a(100*e.s),r=a(100*e.l);return 1==this._a?"hsl("+t+", "+n+"%, "+r+"%)":"hsla("+t+", "+n+"%, "+r+"%, "+this._roundA+")"},toHex:function(e){return t(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return function(e,t,n,r,i){var s=[F(a(e).toString(16)),F(a(t).toString(16)),F(a(n).toString(16)),F(M(r))];if(i&&s[0].charAt(0)==s[0].charAt(1)&&s[1].charAt(0)==s[1].charAt(1)&&s[2].charAt(0)==s[2].charAt(1)&&s[3].charAt(0)==s[3].charAt(1))return s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0);return s.join("")}(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:a(this._r),g:a(this._g),b:a(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+a(this._r)+", "+a(this._g)+", "+a(this._b)+")":"rgba("+a(this._r)+", "+a(this._g)+", "+a(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:a(100*N(this._r,255))+"%",g:a(100*N(this._g,255))+"%",b:a(100*N(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+a(100*N(this._r,255))+"%, "+a(100*N(this._g,255))+"%, "+a(100*N(this._b,255))+"%)":"rgba("+a(100*N(this._r,255))+"%, "+a(100*N(this._g,255))+"%, "+a(100*N(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(A[t(this._r,this._g,this._b,!0)]||!1)},toFilter:function(e){var t="#"+o(this._r,this._g,this._b,this._a),n=t,r=this._gradientType?"GradientType = 1, ":"";if(e){var i=d(e);n="#"+o(i._r,i._g,i._b,i._a)}return"progid:DXImageTransform.Microsoft.gradient("+r+"startColorstr="+t+",endColorstr="+n+")"},toString:function(e){var t=!!e;e=e||this._format;var n=!1,r=this._a<1&&0<=this._a;return t||!r||"hex"!==e&&"hex6"!==e&&"hex3"!==e&&"hex4"!==e&&"hex8"!==e&&"name"!==e?("rgb"===e&&(n=this.toRgbString()),"prgb"===e&&(n=this.toPercentageRgbString()),"hex"!==e&&"hex6"!==e||(n=this.toHexString()),"hex3"===e&&(n=this.toHexString(!0)),"hex4"===e&&(n=this.toHex8String(!0)),"hex8"===e&&(n=this.toHex8String()),"name"===e&&(n=this.toName()),"hsl"===e&&(n=this.toHslString()),"hsv"===e&&(n=this.toHsvString()),n||this.toHexString()):"name"===e&&0===this._a?this.toName():this.toRgbString()},clone:function(){return d(this.toString())},_applyModification:function(e,t){var n=e.apply(null,[this].concat([].slice.call(t)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(p,arguments)},brighten:function(){return this._applyModification(_,arguments)},darken:function(){return this._applyModification(b,arguments)},desaturate:function(){return this._applyModification(n,arguments)},saturate:function(){return this._applyModification(m,arguments)},greyscale:function(){return this._applyModification(g,arguments)},spin:function(){return this._applyModification(v,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(w,arguments)},complement:function(){return this._applyCombination(S,arguments)},monochromatic:function(){return this._applyCombination(R,arguments)},splitcomplement:function(){return this._applyCombination(T,arguments)},triad:function(){return this._applyCombination(k,arguments)},tetrad:function(){return this._applyCombination(y,arguments)}},d.fromRatio=function(e,t){if("object"==typeof e){var n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]="a"===r?e[r]:D(e[r]));e=n}return d(e,t)},d.equals=function(e,t){return!(!e||!t)&&d(e).toRgbString()==d(t).toRgbString()},d.random=function(){return d.fromRatio({r:e(),g:e(),b:e()})},d.mix=function(e,t,n){n=0===n?0:n||50;var r=d(e).toRgb(),i=d(t).toRgb(),s=n/100;return d({r:(i.r-r.r)*s+r.r,g:(i.g-r.g)*s+r.g,b:(i.b-r.b)*s+r.b,a:(i.a-r.a)*s+r.a})},d.readability=function(e,t){var n=d(e),r=d(t);return(l.max(n.getLuminance(),r.getLuminance())+.05)/(l.min(n.getLuminance(),r.getLuminance())+.05)},d.isReadable=function(e,t,n){var r,i,s=d.readability(e,t);switch(i=!1,(r=function(e){var t,n;t=((e=e||{level:"AA",size:"small"}).level||"AA").toUpperCase(),n=(e.size||"small").toLowerCase(),"AA"!==t&&"AAA"!==t&&(t="AA");"small"!==n&&"large"!==n&&(n="small");return{level:t,size:n}}(n)).level+r.size){case"AAsmall":case"AAAlarge":i=4.5<=s;break;case"AAlarge":i=3<=s;break;case"AAAsmall":i=7<=s}return i},d.mostReadable=function(e,t,n){var r,i,s,a,o=null,u=0;i=(n=n||{}).includeFallbackColors,s=n.level,a=n.size;for(var l=0;l<t.length;l++)u<(r=d.readability(e,t[l]))&&(u=r,o=d(t[l]));return d.isReadable(e,o,{level:s,size:a})||!i?o:(n.includeFallbackColors=!1,d.mostReadable(e,["#fff","#000"],n))};var x=d.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},A=d.hexNames=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t}(x);function C(e){return e=parseFloat(e),(isNaN(e)||e<0||1<e)&&(e=1),e}function N(e,t){(function(e){return"string"==typeof e&&-1!=e.indexOf(".")&&1===parseFloat(e)})(e)&&(e="100%");var n=function(e){return"string"==typeof e&&-1!=e.indexOf("%")}(e);return e=h(t,f(0,parseFloat(e))),n&&(e=parseInt(e*t,10)/100),l.abs(e-t)<1e-6?1:e%t/parseFloat(t)}function j(e){return h(1,f(0,e))}function I(e){return parseInt(e,16)}function F(e){return 1==e.length?"0"+e:""+e}function D(e){return e<=1&&(e=100*e+"%"),e}function M(e){return l.round(255*parseFloat(e)).toString(16)}function E(e){return I(e)/255}var O,B,L,U=(B="[\\s|\\(]+("+(O="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+O+")[,|\\s]+("+O+")\\s*\\)?",L="[\\s|\\(]+("+O+")[,|\\s]+("+O+")[,|\\s]+("+O+")[,|\\s]+("+O+")\\s*\\)?",{CSS_UNIT:new RegExp(O),rgb:new RegExp("rgb"+B),rgba:new RegExp("rgba"+L),hsl:new RegExp("hsl"+B),hsla:new RegExp("hsla"+L),hsv:new RegExp("hsv"+B),hsva:new RegExp("hsva"+L),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function P(e){return!!U.CSS_UNIT.exec(e)}void 0!==H&&H.exports?H.exports=d:void 0===(V=function(){return d}.call(J,$,J,H))||(H.exports=V)}(Math)},3:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getUrlParameter=t.buildResourcesJson=t.makeTones=t.buildResourcesObjectFromThemeData=t.getResourcesCommentString=void 0;var r,b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(10),a=(r=i)&&r.__esModule?r:{default:r};var v=["DO NOT EDIT, this is a generated file and all changes","will be overwritten. If you wish to change the resources","loaded, please do so in the skuid_theme.json"].join(" ");t.getResourcesCommentString=function(){return v};var s=t.buildResourcesObjectFromThemeData=function(e){var t,n,r,i,s,a,o={},u=[],l={},c=e.cssResources||[],h=e.themeSettings?JSON.parse(JSON.stringify(e.themeSettings.getAll?e.themeSettings.getAll():e.themeSettings)):void 0,f=e.webFonts||{};if(f.google&&f.google.length)for(l.google={families:[]},i=0;i<f.google.length;i++)(r=f.google[i]).url&&(n=k(r.url,"family")),l.google.families.push(n);if(h&&h.tokens&&h.tokens.fontFamily){var d=h.tokens.fontWeight||{},m=":"+Object.keys(d).map(function(e){return d[e].value}).join(","),g=h.tokens.fontFamily,p=[];Object.keys(g).forEach(function(e){"google"===g[e].value.type&&p.push(g[e].value);var t=g[e].value.primaryFamily;g[e].value.secondaryFamily&&(t+=", "+g[e].value.secondaryFamily),g[e].value=t}),l=b(l,{google:{families:p.map(function(e){return e.primaryFamily+=m}).filter(function(e){return e})}})}if(f.custom)for(l.custom={families:[],urls:[]},i=0;i<f.custom.length;i++)t=f.custom[i],l.custom.families.push(t.name),t.url&&l.custom.urls.push(t.url);if(f.typekit&&(l.typekit={id:f.typekit}),h&&h.webFonts&&h.webFonts.typekit&&(l.typekit={id:h.webFonts.typekit}),l.typekit||l.google||l.custom?o.fontConfig=l:o.fontConfig={},c&&c.length){for(i=0;i<c.length;i++){switch(a=null,(s=c[i]).type){case"external":a={type:"external",url:s.url||s.path};break;default:a={type:"static",name:s.name},["namespace","path"].forEach(function(e){s.hasOwnProperty(e)&&(a[e]=s[e])})}a&&u.push(a)}u.length&&(o.cssResources=u)}if(h){if(o.themeSettings=function(e){return JSON.parse(JSON.stringify(e))}(h),h.palette){var _={};Object.keys(h.palette).forEach(function(e){var t=h.palette[e].value;_[e]={value:{color:t.color}},t.shades&&(_[e].value._shades=S(t.color,t.shades.map(function(e){return-e}).reverse())),t.tints&&(_[e].value._tints=S(t.color,t.tints))}),o.themeSettings.palette=_}h.tokens&&Object.keys(h.tokens).forEach(function(e){var t=h.tokens[e],n={};Object.keys(t).forEach(function(e){n[e]={value:t[e].value}}),o.themeSettings.tokens[e]=n})}return function(e){if(e&&e.hasOwnProperty){var t,n=0;for(t in e)e.hasOwnProperty(t)&&n++;return n}return 0}(o)&&(o.__comment=v),o},S=t.makeTones=function(e,t){var n=(0,a.default)(e),r=[],i=(0,a.default)("#000"),s=(0,a.default)("#fff");return t.forEach(function(e){e<0?r.push(a.default.mix(n,i,-e).toHexString()):r.push(a.default.mix(n,s,e).toHexString())}),r.map(function(e){return e.toUpperCase()})},k=(t.buildResourcesJson=function(e){return JSON.stringify(s(e),null,"\t")},t.getUrlParameter=function(e,t){var n,r=e.split("?");1<r.length&&(r=r[1]),n=r.split("&");for(var i=0;i<n.length;i++){var s=n[i].split("=");if(s[0]==t)return s[1]}})},318:function(e,t,n){"use strict";n.r(t);n(46),n(47),n(319)},319:function(e,t,n){"use strict";!function(d){var o=d.$,e=d.snippet.registerSnippet,m=d.utils,g=m.inPlatform(d.constants.NATIVE);function p(e){return"Ink"===e.skuid__Type__c||"Ink"===e.type}e("skuid.loadJSZip",function(){return"undefined"!=typeof JSZip?m.resolve():m.loadJS(d.platform.getResourceUrl({modstamp:m.getCacheTimestamp(),ns:"skuid",path:"js/lib/jSZip.js"}))}),e("skuid.settings.copyPrefsFromOrgDefault",function(e){var t=e.initiatorId,n=e.model,r=e.row,i=d.$M("stng__OrgPreferences"),s=i.getFirstRow(),a={};o.each(i.fields,function(){m.startsWith(this.id,"skuid__")&&"skuid__Use_Component_Packs__c"!==this.id&&(a[this.id]=i.getFieldValue(s,this.id,!0))}),n.updateRow(r,a,{initiatorId:t})}),e("skuid.theme.createThemeResource",function(){var e=arguments[0],i=d.$,s=e.row,a=e.model,t=p(s);g?s.version_date=d.version.date:s.skuid__Skuid_Version_Date__c=d.version.date;var o,u,l,c=s.BaseTheme;l=g?(o=s.name,u="Mobile"===s.type,s.resource_name):(o=s.Name,u="Mobile"==s.skuid__Type__c,s.skuid__Resource_Name__c);var n=!1;if(i.each(a.registeredLists,function(e,t){if(t.validateRequiredFields().length)return!(n=!0)}),n)return m.reject();var r="SkuidTheme"+s.BaseTheme,h=d.platform.themeBuilder.getThemeResourceUrl({apiVersion:t?"v2":"v1",name:r,namespace:"skuid"}),f=i.Deferred();return JSZipUtils.getBinaryContent(h,function(e,t){e&&f.reject(e);var n=void 0;try{n=new JSZip(t),f.resolve(n)}catch(e){console.error(e),f.reject(e)}}),f.then(function(e){var t=e.file("skuid_theme.json").asText(),n={id:o,lessVars:{},tempVars:{},webFonts:t.webFonts,baseTheme:c,isMobile:u,iconsets:t.iconsets,themeSettings:{}};e.file("skuid_theme.json",JSON.stringify(n,void 0,"\t"));var r={ContentType:"application/zip",Body:e.generate({type:"base64",compression:"DEFLATE"}),CacheControl:"Public"};return g?r.FileName=l:(r.Name=l,r.skuid__Resource_Namespace__c=s.skuid__Resource_Namespace__c),i.ajax({type:"POST",url:g?"/api/v1/uploadTheme":"/services/data/v32.0/sobjects/StaticResource",headers:{"Content-Type":"application/json",Authorization:"Bearer "+m.userInfo.sessionId},data:JSON.stringify(r),dataType:"json"}).then(function(e){if(!g)return d.sfdc.api.query("SELECT NamespacePrefix FROM StaticResource WHERE Id='"+e.id+"'").then(function(e){a.updateRow(s,{skuid__Skuid_Version_Date__c:d.version.date,skuid__Resource_Namespace__c:e.records[0].NamespacePrefix})});a.updateRow(s,{version_date:d.version.date,file_id:e.id})})})}),e("skuid.theme.exportTheme",function(){var e=arguments[0],s=d.$.Deferred(),a=e.row,t=e.model.getRecordForRow(a).get(),n=p(a);(g?["id","file_id","updated_at","updated_by","created_by","updated_by_id","created_by_id"]:["Id","LastModifiedById","LastModifiedBy","attributes"]).forEach(function(e){delete t[e]});var r,i,o,u=JSON.stringify(t);return o=g?(r=a.resource_name,d.platform.themeBuilder.getThemeResourceUrl({apiVersion:n?"v2":"v1",name:a.resource_name})):(r=a.skuid__Resource_Name__c,i=a.skuid__Resource_Namespace__c,m.getStaticResourceUrl(r,i,void 0,(new Date).getTime())),JSZipUtils.getBinaryContent(o,function(e,t){if(e)return s.reject();var n=new JSZip;n.load(t),n.file("objdef.json",u);var r=n.generate({type:"blob",compression:"DEFLATE"}),i=(a.Name||a.name)+".sktheme";m.saveAs(r,i),s.resolve()}),s.promise()});e("skuid.theme.importTheme",g?function(e){var t=d.$,r=t.Deferred(),n=d.$M("stng__Themes_Import"),i=d.$M("stng__Themes_Import_File"),s=e.apiExtensions.$Result.body;n.cancel(),i.cancel();var a=!1;return d.$.ajax({url:"/themes/"+s.name+"/objdef.json",type:"GET",contentType:"application/json"}).fail(function(){return r.reject("The uploaded file is not a valid Skuid Theme. objdef.json not found.")}).then(function(e){if(!1===(a=function(e){var t=d.constants.NATIVE,n={};switch(e.skuid__Type__c?"SKUID":t){case"SKUID":n.name=e.Name,n.type=e.skuid__Type__c,n.active=e.skuid__Active__c;break;case t:n=e;break;default:n=!1}return n}(e)))return r.reject("The uploaded file is not a valid Skuid Theme.");var t=d.$M("stng__Themes_Existing");return t.setCondition(t.getConditionByName("ThemeName"),a.name),t.updateData()}).then(function(){var e=d.$M("stng__Themes_Existing"),t=d.$M("stng__Themes_"+a.type),n=e.getFirstRow(),r=t;return n?(r=e).updateRow(n,{file_id:s.id,resource_name:s.name}):r.updateRow(t.createRow(),{name:a.name,resource_name:s.name,version_date:d.version.date,file_id:s.id,type:a.type}),r.save()}).then(function(e){if(e.messages&&e.messages.length){var n=t("#themeImportErrors").length?t("#themeImportErrors"):t('&lt;div id="themeImportErrors" class="nx-error"&gt;');return n.prependTo(t("#importUploadTitle")),n.empty(),t.each(e.messages,function(e,t){n.append("&lt;div&gt;"+t+"&lt;/div&gt;;")}),d.$M("stng__Themes_Desktop").cancel(),r.reject()}r.resolve()}),r}:function(){var r=d.$,e=arguments[0].record,t=e.id||e.Id,n=d.$M("stng__Themes_Import"),i=JSZip(e.Body,{base64:!0});if(n.cancel(),i.files["objdef.json"]){var s,a,o,u,l=JSON.parse(i.files["objdef.json"].asText()),c=d.$M("stng__Themes_"+(l.skuid__Type__c||l.type)),h="SELECT Id FROM skuid__Theme__c WHERE Name='"+(l.Name||l.name)+"'";u=t?(o="SELECT Id,NamespacePrefix,Name FROM StaticResource WHERE Id='"+t+"'",d.sfdc.api.query(o).then(function(e){e&&e.records&&e.records[0]&&(a=e.records[0],u.resolve&&u.resolve())})):r.Deferred().resolve();var f=d.sfdc.api.query(h).then(function(e){return e.records&&e.records[0]?(s=e.records[0],e):r.Deferred().reject()});r.when(f,u).then(function(){n.conditions[0].value=s.Id,a?(l.skuid__Resource_Name__c=a.Name,l.skuid__Resource_Namespace__c=a.NamespacePrefix):(delete l.skuid__Resource_Name__c,delete l.skuid__Resource_Namespace__c);var e=void 0;return n.updateData().then(function(){return e=n.updateRow({Id:s.Id,skuid__Type__c:l.skuid__Type__c||l.type,skuid__Active__c:l.skuid__Active__c||l.active,skuid__Skuid_Version_Date__c:l.skuid__Skuid_Version_Date__c||l.version_date},l),n.save()}).then(c.adoptRow(e))}).catch(function(){var t=n.createRow({additionalConditions:[{field:"Name",value:l.Name||l.name},{field:"skuid__Resource_Name__c",value:a.Name},{field:"skuid__Type__c",value:l.skuid__Type__c||l.type},{field:"skuid__Active__c",value:l.skuid__Active__c||l.active},{field:"skuid__Skuid_Version_Date__c",value:l.skuid__Skuid_Version_Date__c||l.version_date},{field:"skuid__Resource_Namespace__c",value:a.NamespacePrefix}]});n.save({callback:function(e){if(e.messages&&e.messages.length){var n=r("#themeImportErrors").length?r("#themeImportErrors"):r('<div id="themeImportErrors" class="nx-error">');n.prependTo(r("#importUploadTitle")),n.empty(),r.each(e.messages,function(e,t){n.append("<div>"+t+"</div>")})}else c.adoptRow(t)}})})}else alert("The uploaded file is not a valid skuid theme")}),e("resourceNamer",function(){var r=!1,i=o(".popup-resource-name input");o(".popup-theme-name input").on("input",function(e){var t,n;r||(t=g?e.target.value&&(n=e.target.value.match(/[\w _\-]+/g))&&n.length?n.join(""):"":e.target.value.match(/[a-z]|[A-Z]|[0-9]/g).join("").replace(/SKTHEME/g,"")+"SKTHEME",i.val(t),i.trigger("input"))}),i.on("keypress",function(){r=!0})})}(skuid)},46:function(e,t,n){"use strict";!function(s){var a=s.themeBuilder={themeSettings:{}},o=s.$,u=a.utils={},e={render:function(e,n){less.render(e,{optimization:1},function(e,t){n(e,t)})},parseVars:function(e){var t,n,r,i,s=e.match(/@[\w\-_]+\s*:\s*[^;]*;/g),a={};for(t=0;t<s.length;t++)if((r=(n=s[t].split(":"))[0].match(/[^@].+/))&&(r=r[0],null!==(i=n[1].match(/[^ ].+[^;]/)))){var o=(i=i[0]).match(/@[\w\-_]+/g);if(o&&0<o.length)for(var u=0;u<o.length;u++)i=i.replace(o[u],a[o[u].replace("@","")]);a[r]=i}return a}};function l(e){return"static"===e.type?["static",e.name||"",e.namespace||"",e.path||""].join("--"):"external"===e.type?["external",e.url||e.path||""]:""}o.extend(u,{clone:function(e){return void 0===e?e:JSON.parse(JSON.stringify(e))},getCSSResourceIdentifier:l,isBaseThemeCSSResource:function(e){var t=a.themeConfigurations.base,n=t?t.cssResources:null,r=l(e),i=!1;return r&&n&&n.length&&o.each(n,function(e,t){if(l(t)===r)return!(i=!0)}),i},isBaseThemeFontDefinition:function(e,t){var n=a.themeConfigurations.base,r=n?n.webFonts:null,i=t.name,s=!1;return i&&r&&r[e]&&r[e].length&&o.each(r[e],function(e,t){if(t.name===i)return!(s=!0)}),s},lessRenderer:e,parallel:function(e,r){if(0!==e.length){var i=[],s=0,a=0,o=!1;for(var t in e)"remove"!=t&&a++;for(var n in e)"remove"!=n&&e[n](u(n))}else r.apply(this,{});function u(n){return function(){var e=n;s++;for(var t=0;t<arguments.length;t++)void 0===i[t]&&(i[t]=[]),i[t][e]=arguments[t];if(s==a&&!o)return o=!0,void r.apply(this,i)}}},parseCssSize:function(e,t){var n,r,i=void 0!==(t=t||{}).defaultUnit?t.defaultUnit:"px";return s.utils.isString(e)&&(r=(r=e.match(/px|rem|em|pt/))?r[0]:i,n=parseFloat(e),"pt"===r&&(r="px",n*=4/3)),{size:n,unit:r}},parseSkuidBorderLess:function(e){var t,n=e.split(/[, ]\s*/),r={};if(n.length<=3)t=u.parseCssSize(n[0]),r.all={},r.all.width=t.size,r.all.widthUnit=t.unit,r.all.style=n[1],r.all.color=n[2],r.top=u.clone(r.all),r.right=u.clone(r.all),r.bottom=u.clone(r.all),r.left=u.clone(r.all);else{for(var i=["top","right","bottom","left"],s=0,a=0;s<n.length&&a<i.length;)r[i[a]]={},"null"==n[s]||"none"==n[s]?(r[i[a]].width="1",r[i[a]].style="none",r[i[a]].color="black",s++):(t=u.parseCssSize(n[s]),r[i[a]].width=t.size,r[i[a]].widthUnit=t.unit,r[i[a]].style=n[s+1],r[i[a]].color=n[s+2],s+=3),a++;r.individuallySet=!0}return r},randomSeed:function(e){this.seed=e,this.random=function(){var e=1e4*Math.sin(this.seed++);return e-Math.floor(e)}},rgbToHex:function(e){return(e=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4===e.length?"#"+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):""},subscribeMultipleEventsOnce:function(e,r){var i={};e.forEach(function(e){i[e]=!1;var n=s.events.subscribe(e,function(){var t=!0;s.events.unsubscribe(n),i[e]=!0,o.each(i,function(e){t=t&&i[e]}),t&&r()})})},toLessString:function(e){var t="";for(var n in e)t+="@"+n+":"+e[n]+";";return t},baseThemes:["SkuidThemeClassic","SkuidThemeBuilderDark","SkuidThemeBuilderLight","SkuidThemeModern","SkuidThemePaper","SkuidThemeMobileClassic","SkuidThemeCleanGreen","SkuidThemeCoolGrey","SkuidThemeDynamics","SkuidThemeGlacial","SkuidThemeIceAge","SkuidThemeInvestor","SkuidThemeLightningDesign","SkuidThemeMaterialBlue","SkuidThemeSlated","SkuidThemeMobileCoolGrey","SkuidThemeMobileIceAge","SkuidThemeMobileMaterialBlue","SkuidThemeMobileNorthernLights","SkuidThemeInk","SkuidThemeInkComposerLight","SkuidThemeInkComposerDark","SkuidThemeLightning","SkuidThemeSkuidApp"]})}(skuid)},47:function(e,t,n){"use strict";var i=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),b=n(3);function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}!function(h){h.themeBuilder||(h.themeBuilder={});var f=h.$,d=h.utils,u=h.events.publish,l=h.themeBuilder,s=d.resolve,c=h.themeSettings.ThemeSettings;function m(e){return void 0===e?e:JSON.parse(JSON.stringify(e))}function o(e){if(d.startsWith(e,"/resource/")){var t,n,r,i,s=e.substring(10).split("/");if(1<=s.length&&(isNaN(s[0])||s.shift(),1<=s.length))return t=2===(i=s.shift().split("__")).length?(n=i[0],i[1]):i[0],s.length&&(r=s.join("/")),{type:"static",name:t,namespace:n,path:r}}return!1}var a={},g=function(){function r(e,t,n){v(this,r),this._themeModel=e,this._themeRecords=t,this._resourceRecords=n}return i(r,[{key:"migrate",value:function(t){var i=this;return f.when.all(this._themeRecords.map(function(n){var r=i._resourceRecords.find(function(e){return e.Name===n.skuid__Resource_Name__c});if(r)return h.platform.themeBuilder.getResource(r,"skuid_theme.json").then(function(t){t=JSON.parse(t);var n=a[t.baseTheme];return n?{themeData:t,baseThemeData:n.data,baseThemeLess:n.less}:h.platform.themeBuilder.getThemeData(r).then(function(e){return n=a[t.baseTheme]={data:e.baseThemeData,less:e.baseThemeLess},e})}).then(function(e){if(!e.themeData.baseTheme)return f.Deferred().reject("No theme configuration");var t=new l.ThemeConfiguration(f.extend(e.themeData,{resource:r,baseThemeData:e.baseThemeData,lessStr:e.baseThemeLess,model:i._themeModel,row:n}));return(t=h.themeBuilder.migrateTheme(t)).loadAndProcessLess().then(function(){return t})}).then(function(e){return e.save({skipScreenshot:!0,noLess:t.noLess})}).then(function(){return h.events.publish("skuid.themeBuilder.themeUpdated",[n.Name])}).catch(function(e){return h.events.publish("skuid.themeBuilder.themeUpdateFailed",[n.Name,e&&e.message||""])})}))}}]),r}();function e(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};if(e&&t){var r=e.getRows(),i=t.getRows();if(r.length&&i.length){var s=0;n.whiteList&&(r=r.filter(function(e){return-1===n.whiteList.indexOf(e.skuid__Resource_Name__c)}));var a,o=[],u=void 0;for(u=0,a=r.length;u<a;u+=10)o.push(new g(e,r.slice(u,u+10),i));var l=h.events.subscribe("skuid.themeBuilder.themeUpdated",function(e){!d.runningTests()&&f.blockUI({fadeIn:0,message:s+" of "+r.length+' Themes updated <br/> Updated "'+e+'"'}),s++}),c=h.events.subscribe("skuid.themeBuilder.themeUpdateFailed",function(e,t){!d.runningTests()&&f.blockUI({fadeIn:0,message:'Error updating "'+e+'"'+(t?": "+t:"")}),s++});return function e(t){return o[t].migrate(n).then(function(){if(t<o.length-1)return e(t+1)})}(0).then(function(){h.events.unsubscribe([l,c])})}}}function p(i,n){n=n||{};var s={},a=i.cssResources,o=l.utils.clone;return function(e){var n=f.Deferred();return JSZipUtils.getBinaryContent(e,function(e,t){e?n.reject(e):n.resolve(t)}),n.promise()}(i.baseThemeUrl).then(function(e){var t=new JSZip(e),n="",r=f.Deferred();return s.lessVars=o(i.lessVars),s.webFonts=o(i.webFonts),s.cssResources=o(a),s.typekitId=o(i.typekitId),s.iconsets=o(i.iconsets),s.baseTheme=o(i.baseTheme),s.isMobile=o(i.isMobile),s.themeSettings=o(i.themeSettings.getAll()),s.themeSettingsLocal=o(i.themeSettingsLocal.getAll()),s.timeStamp=(new Date).getTime(),i.migrations&&(s.migrations=o(i.migrations)),s.id=i.id||i.getThemeUrl().split("/").splice(-2)[0].split("skuid__SkuidTheme").join("").toLowerCase(),s.initialized=!0,i.inlineCss&&(s.hasInlineCss=!0,n+=i.inlineCss,t.file("inline.css",n)),i.baseThemeData.hasInlineCss?h.platform.themeBuilder.getResource({Name:"SkuidTheme"+i.baseTheme,NamespacePrefix:"skuid"},"inline.css").then(function(e){n+=" "+e,r.resolve(t,n)}).fail(r.reject):r.resolve(t,""),r.promise()}).then(function(t,e){return t.file("skuid_theme.json",function(e){return JSON.stringify(e,void 0,"\t")}(s)),t.file("skuidtheme.css",i.outputCSS+(e?" "+e:"")),t.file("resources.json",(0,b.buildResourcesJson)(i)),n.screenshotFunction&&!n.skipScreenshot?n.screenshotFunction(i).then(function(e){return e&&t.file("screenshot.png",e,{base64:!0}),t}):(i.screenshot&&t.file("screenshot.png",i.screenshot,{base64:!0}),t)}).then(function(e){return e.generate({type:"base64",compression:"DEFLATE"})}).catch(function(e){throw'Error generating zip: "'+e+'"'})}h.snippet.register("skuid.themebuilder.updateThemes",function(){return f.blockUI({fadeIn:0,message:"Updating themes, please wait..."}),e(h.$M("stng__Themes_Desktop"),h.$M("stng__DesktopThemeResources"),{whiteList:l.utils.baseThemes}).then(function(){return e(h.$M("stng__Themes_Mobile"),h.$M("stng__MobileThemeResources"),{whiteList:l.utils.baseThemes})}).then(function(){!function(e,t){var n=h.$M("UiDriver"),r=n.getFirstRow();n.updateRow(r,e,void 0!==t?t:!r[e])}("showUpdateThemesButton",!1),f.blockUI({fadeIn:0,message:"Done updating themes!",timeout:2500})})});var r=function(){function o(e){v(this,o);var t,n,r=this,i=e.baseThemeData&&new o(e.baseThemeData),s=e.baseTheme||"Modern";if(s=s.charAt(0).toUpperCase()+s.slice(1),i&&(t=i.cssResources,n=i.webFonts),r.baseTheme=m(e.baseTheme),r.baseThemeData=i,r.baseThemeUrl=m(e.baseThemeUrl),r.cssResources=m(e.cssResources)||[],r.iconsets=m(e.iconsets),r.id=m(e.id),r.initialized=m(e.initialized),r.isMobile=m(e.isMobile),r.lessVars=m(e.lessVars),r.migrations=m(e.migrations),r.outputCSS=m(e.outputCSS),r.resource=e.resource,r.themeResourceName=m(e.themeResourceName),r.themeResourceName=this.resource&&m(this.resource.resourceName||this.resource.resource_name),r.timeStamp=(new Date).getTime(),r.webFonts=m(e.webFonts)||{},r.lessStr=m(e.lessStr),r.model=e.model,r.row=e.row,r.subscriptions={},r.hasInlineCss=e.hasInlineCss,e.themeSettings instanceof c?r.themeSettings=new c(m(e.themeSettings.getAll())||{}):r.themeSettings=new c(m(e.themeSettings)||{}),e.themeSettingsLocal instanceof c?r.themeSettingsLocal=new c(m(e.themeSettingsLocal.getAll())||{}):r.themeSettingsLocal=new c(m(e.themeSettingsLocal)||{}),i&&i.lessVars&&(r.lessVars=f.extend(i.lessVars,r.lessVars||{})),r.lessVars&&(r.baseThemeUrl=h.platform.themeBuilder.getThemeResourceUrl({name:"SkuidTheme"+s,namespace:"skuid",modstamp:(new Date).getTime()})),!r.initialized&&i&&(n&&(r.webFonts=n),t)){var a={};r.cssResources.forEach(function(e){var t=l.utils.getCSSResourceIdentifier(e);a[t]=e}),t.forEach(function(e){var t=l.utils.getCSSResourceIdentifier(e);a[t]||r.cssResources.push(e)})}i&&i.themeSettings&&(r.themeSettings=_(i.themeSettings,r.themeSettingsLocal)),i&&i.hasInlineCss&&h.platform.themeBuilder.getResource({Name:r.baseTheme,NamespacePrefix:"skuid"},"inline.css").done(function(e){u("skuid.themeBuilder.baseInlineCssLoaded",[e])}),r.hasInlineCss&&r.resource&&h.platform.themeBuilder.getResource(r.resource,"inline.css").done(function(e){r.inlineCss=e,u("skuid.themeBuilder.inlineCssLoaded",[r])})}return i(o,[{key:"getThemeUrl",value:function(){return h.platform.getResourceUrl({name:this.resourceName,namespace:this.resource.resourceNamespace,modstamp:(new Date).getTime()})+"/"}},{key:"save",value:function(n){n=n||{};var r=this,i=r.model||l.model,e=l.utils.clone;if(!r.resource)throw"Cannot save, Theme Config has no resource";return u("skuid.themeBuilder.saveStatus",["Saving Theme..."]),r.themeSettingsLocal&&r.themeSettings.setAll(_(r.baseThemeData.themeSettings,r.themeSettingsLocal).getAll()),h.utils.delay(10).then(function(){return u("skuid.themeBuilder.saveStatus",["Compiling Theme to CSS..."]),n.noLess?s():f.when(function(e,t){var n=f.Deferred();return l.utils.lessRenderer.render(e+l.utils.toLessString(t),function(e,t){e?n.reject(e):n.resolve(t.css)}),n.promise()}(r.lessStr,e(r.lessVars)).then(function(e){return u("skuid.themeBuilder.saveStatus",["Compressing Theme CSS file..."]),f.when(e,h.utils.delay(1))}).then(function(e){return new CleanCSS({compatibility:"ie8"}).minify(e).styles}),function(e){return e.hasInlineCss&&void 0===e.inlineCss?h.platform.themeBuilder.getResource({Name:"SkuidTheme"+e.baseTheme,NamespacePrefix:"skuid"},"inline.css").catch(s):s()}(r)).then(function(e,t){r.outputCSS=[e,t,r.inlineCss].filter(function(e){return!!e}).join(" ")})}).then(function(){if(i){var e=r.row||i.getFirstRow(),t=h.platform.getEntityFieldName("theme","version_date");i.updateRow(e,t,h.version.date)}return u("skuid.themeBuilder.saveStatus",["Generating Theme bundle..."]),p(r,n)}).then(function(e){return u("skuid.themeBuilder.saveStatus",["Saving Theme bundle to server..."]),h.platform.themeBuilder.saveTheme(r,e,r.resource)}).then(function(){if(i)return i.save()}).then(function(){return u("skuid.themeBuilder.saveStatus",["Saved",1500]),u("skuid.themeBuilder.saveSuccess",[]),r}).fail(function(e){u("skuid.themeBuilder.saveStatus",["Save failed",1500]),u("skuid.themeBuilder.saveFailure",[e]);var t="There was a problem saving this Theme"+(r.id?": "+r.id:"");!d.runningTests()&&console.error(t,e),e&&("string"==typeof e?e+=": "+e:e.message&&(e+=": "+e.message)),!d.runningTests()&&f.blockUI({fadeIn:0,message:t,timeout:3e3})})}},{key:"loadAndProcessLess",value:function(){var t=this;function n(e){return'"'===(e=e.split('\\"').join('"').split("\\r\\n").join("\n").split("\\t").join("\t").split("\\n").join("\n").split("\\\\").join("\\"))[0]&&(e=e.substring(1,e.length-1)),t.lessStr=e}return t.lessStr?s(n(t.lessStr)):h.platform.themeBuilder.getResource({Name:"SkuidTheme"+(t.baseThemeData.baseTheme||{mobileclassic:"MobileClassic",modern:"Modern",paper:"Paper",classic:"Classic",ink:"Ink"}[t.baseThemeData.id]),NamespacePrefix:"skuid"},"skuidtheme.min.less").done(function(e){return n(e)}).fail(function(){f.blockUI({fadeIn:0,message:"There was an error"}),setTimeout(f.unblockUI,2e3)})}},{key:"removeSetting",value:function(e){var t=this;t.themeSettingsLocal.unset(e),t.baseThemeData.themeSettings.get(e)?t.themeSettings.set(e,t.baseThemeData.themeSettings.get(e)):t.themeSettings.unset(e)}},{key:"updateSetting",value:function(r,e){var i=this,t=i.subscriptions,s={};f.each(t,function(e){s[e]=JSON.stringify(h.utils.getObjectProperty(i.themeSettings,e))}),i.themeSettingsLocal.set(r,e),i.themeSettings.set(r,e),f.map(t,function(e,t){return t}).filter(function(e){var t=(r||"").match(e),n=JSON.stringify(i.themeSettings.get(e));return s[e]!==n&&(t&&0==t.index)}).forEach(function(e){t[e].forEach(function(e){e()})})}},{key:"subscribeChange",value:function(t,n){var r=this.subscriptions;return r[t]||(r[t]=[]),r[t].push(n),{unsubscribe:function(){var e=r[t].indexOf(n);-1!==e&&r[t].splice(e,1)}}}},{key:"getSetting",value:function(e){return this.themeSettings.get(e)}}]),o}();function _(e,t){var n=f.extend(!0,{},e.getAll(),t.getAll()),r=h.utils.getObjectProperty(t,"palette");f.each(r,function(e,t){t.value.shades&&(n.palette[e].value.shades=t.value.shades),t.value.tints&&(n.palette[e].value.tints=t.value.tints)});var i=h.utils.getObjectProperty(t,"tokens.shadow");return f.each(i,function(e,t){n.tokens.shadow[e]=t}),new c(n)}d.loadJS(h.platform.getResourceUrl({ns:"skuid",path:"js/lib/jSZip.js"})),l.updateThemes=e,l.updateAllThemes=function(){h.snippet.get("skuid.themebuilder.updateThemes")("",!0)},l.migrateTheme=function(e){var t=new r(e),n=t.migrations;return n||(n=t.migrations={}),n.millau||(function(e){var t=f.extend({},e),n=t.webFonts&&t.webFonts.custom,s=t.cssResources,a={};s||(s=t.cssResources=[]),s.forEach(function(e){var t=l.utils.getCSSResourceIdentifier(e);a[t]=e}),n&&n.length&&n.forEach(function(e){var t,n=e.localurl,r=e.url,i=o(n)||o(r);!i&&r&&(-1<r.indexOf("http://")||-1<r.indexOf("https://"))&&(i={type:"external",path:r}),i&&(t=l.utils.getCSSResourceIdentifier(i),a[t]||s.push(i),delete e.localurl,delete e.url)})}(t),n.millau=""+(new Date).getTime()),t},l.ThemeConfiguration=r}(skuid)}});