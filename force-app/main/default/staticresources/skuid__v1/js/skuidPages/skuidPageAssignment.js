!function(i){var n={};function a(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return i[e].call(t.exports,t,t.exports,a),t.l=!0,t.exports}a.m=i,a.c=n,a.d=function(e,t,i){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)a.d(i,n,function(e){return t[e]}.bind(null,n));return i},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=343)}({343:function(e,t,i){"use strict";!function(b){var d,S=b.$,w=b.$M,y=b.$L,l=b.snippet,e=l.registerSnippet,I=b.utils,o=b.ui.getFieldRenderer;e("Multipicklist",function(){o("MULTIPICKLIST").edit(arguments[0],I.decodeHTML(arguments[1]))}),e("skuid.snippets.utils.GetSObjectsAsItems",function(){var i=[],e=I.sObjectList;return e&&S.each(e,function(e,t){i.push({value:t,label:t})}),i}),e("skuid.pageAssignments.assignedTo",function(e,t){var i,n,a=w("Profiles"),s=e._GUID,o=e.id,r=e.model,d=e.row,l="skuid__Assigned_To_User__",c=l+"c",u=l+"r.Name",_=r.getField(c),p=r.getFieldValue(d,c,!0);if(t?I.startsWith(t,a.keyPrefix)?(i="profile",n=a.accessible&&a.dataMap[t]&&a.dataMap[t].Name):p&&(i="user",n=r.getFieldValue(d,u)):(n=y("Organization_Default"),i="org"),"edit"===e.mode&&a.accessible&&_.editable){var g=S("<select>");g.append(S("<option>").prop("selected","org"===i).attr("value","org").text(y("Organization_Default"))),g.append(S("<option>").prop("selected","profile"===i).attr("value","profile").text(y("Profile_Object_Label"))),g.append(S("<option>").prop("selected","user"===i).attr("value","user").text(_.referenceTo[0].label)),g.on("change",function(){var e=g.val(),t={};t[o]="",t[c]="",i=e,r.updateRow(d,t,{initiatorId:s}),"org"!==e&&e?"profile"===e?(f.show().val(""),v.hide()):"user"===e&&(f.hide(),v.show()):(f.hide(),v.hide())});var m=[];S.each(a.data,function(){var e={label:this.Name,value:this.Id};m.push(e)});var f=S("<input>").val(n).autocomplete({source:m,select:function(e,t){return r.updateRow(d,o,t.item.value,{initiatorId:s}),f.val(t.item.label),!1},minLength:0}).blur(function(){""===f.val()&&r.updateRow(d,o,"",{initiatorId:s})}),k=new b.ui.Field(d,r,null,{fieldId:c,useSOSL:!0,SOSLFields:"ALL FIELDS",searchFields:[{id:"Name"}],returnFields:[{id:"Name",showInSearchDialog:!0},{id:"Title",showInSearchDialog:!0},{id:"Profile.Name",label:"<label>"+a.label+"</label>",showInSearchDialog:!0},{id:"Username",showInSearchDialog:!0}],mode:"edit",register:!0});k.render(),r.registerField({id:c,row:d,handleChange:function(){p=t=r.getFieldValue(d,c,!0),r.updateRow(d,o,p,{initiatorId:s}),n=r.getFieldValue(d,u)}});var v=k.element;e.element.addClass("nx-polymorphic").append(g,f,v),"org"===i?(f.hide(),v.hide()):"profile"===i?v.hide():"user"===i&&f.hide()}else{var h=S("<div>").addClass("nx-fieldtext").html(n);e.element.removeClass("nx-polymorphic").html(h)}}),e("skuid.pageAssignments.pageLookup",function(e,t){var i=e.model.getFieldValue(e.row,"skuid__Use_Standard_Layouts__c");if((i||!t&&0!==t)&&(t=""),"edit"!==e.mode)e.element.removeClass("nx-polymorphic"),i?o("TEXT").read(e,"(Use Standard Layouts)"):o("REFERENCE").read(e,t);else{var n,a,s=S("<select>");o("REFERENCE").edit(e,t),n=e.element.children("input").first(),a=e.element.children(".nx-field-reference-search").first(),s.append(S("<option>").prop("selected",!i).attr("value","skuid").text("Skuid Page"),S("<option>").prop("selected",i).attr("value","standard").text("Use Standard Layouts")).on("change",function(){e.model.updateRow(e.row,e.id,"",{initiatorId:e._GUID}),i="skuid"!==s.val(),e.model.updateRow(e.row,"skuid__Use_Standard_Layouts__c",i,{initiatorId:e._GUID}),i?(n.hide(),a.hide()):(n.show(),a.show())}),e.element.addClass("nx-polymorphic").prepend(s),i&&n.hide()}}),e("skuid.pageAssignments.recordTypeLookup",function(i,e){var a,s,t,o=w("RecordTypes"),n=b.label.merge(y("Any_X"),o.label||""),r=function(){var n=i.row.skuid__SObject_Type__c;a=[],s={},S.each(o.data,function(e,t){if(t.SobjectType===n){var i={label:t.Name,value:t.DeveloperName};a.push(i),s[t.DeveloperName]=i}})};if(r(),e&&s[e]?e=s[e].label:(e=n,t="any"),"edit"===i.mode&&o.accessible){var d=S("<select>");d.append(S("<option>").prop("selected","any"===t).attr("value","any").text(n)),d.append(S("<option>").prop("selected","any"!==t).attr("value","specific").text(y("Specific_Record_Type"))),d.on("change",function(){i.model.updateRow(i.row,i.id,"",{initiatorId:i._GUID}),"any"!==d.val()&&d.val()?"specific"===d.val()&&(l.show(),l.val("")):l.hide()});var l=S("<input>").val(e).autocomplete({source:function(e,t){r(),t(S.ui.autocomplete.filter(a,e.term))},select:function(e,t){return i.model.updateRow(i.row,i.id,t.item.value,{initiatorId:i._GUID}),l.val(t.item.label),!1},minLength:0}).blur(function(){""===l.val()&&i.model.updateRow(i.row,i.id,"",{initiatorId:i._GUID})});i.element.addClass("nx-polymorphic").append(d,l),"any"===t&&l.hide()}else{var c=S("<div>").addClass("nx-fieldtext").html(e);i.element.removeClass("nx-polymorphic").append(c)}}),e("skuid.pageAssignments.sObjectTypeLookup",function(i,e){var t="objectType";if(d||(d=l.getSnippet("skuid.snippets.utils.GetSObjectsAsItems")()),e||0===e?-1==S.inArray(e,I.sObjectList)&&(t="arbitrary"):e="","edit"!==i.mode){var n=S("<div>").addClass("nx-fieldtext").html(e);i.element.removeClass("nx-polymorphic").append(n)}else{var a,s,o,r=S("<select>");o=function(e){"arbitrary"===e?(a.hide(),s.show()):(a.show(),s.hide())},r.append(S("<option>").prop("selected","objectType"===t).attr("value","objectType").text("Object Type")),r.append(S("<option>").prop("selected","arbitrary"===t).attr("value","arbitrary").text("Other Situation")),r.on("change",function(){i.model.updateRow(i.row,i.id,"",{initiatorId:i._GUID}),a.val(""),s.val(""),o(r.val())}),a=S("<input>").val(I.decodeHTML(e)).autocomplete({source:d,select:function(e,t){return i.model.updateRow(i.row,i.id,t.item.value,{initiatorId:i._GUID}),a.val(t.item.label),!1},minLength:0}).blur(function(){""===a.val()&&i.model.updateRow(i.row,i.id,"",{initiatorId:i._GUID})}),s=S("<input>").val(I.decodeHTML(e)),I.delayInputCallback(s,function(e){i.model.updateRow(i.row,i.id,e,{initiatorId:i._GUID})}),i.element.addClass("nx-polymorphic").append(r,a,s),o(t)}}),e("skuid.pageAssignments.objectTypesMultipicklist",function(t){var e=w("assign__UniqueObjectTypesUsed_Packaging").data;t.element.append(b.ui.renderers.MULTIPICKLIST.edit({entries:S.map(e,function(e){return{value:e.objectType,label:e.objectType}}),renderas:e.length<=10?"CHECKBOXES":"",selectedList:8,onChange:function(e){t.model.updateRow(t.row,t.id,e,{initiatorId:t._GUID})}}))}),e("skuid.pageAssignments.createDefaultRowsForPackaging",function(){w("assign__StaticResourceInfoForPackaging").createRow(),w("assign__PageAssignmentInfoForPackaging").createRow()}),e("ExportAllPageAssignments",function(){var e=b.model.initializeModel(new b.model.Model({fields:[{id:"skuid__Environment_Type__c"},{id:"skuid__SObject_Type__c"},{id:"skuid__Action_Type__c"},{id:"skuid__Context__c"},{id:"skuid__RecordTypeDeveloperName__c"},{id:"skuid__Page__c"},{id:"skuid__Page__r.Name"},{id:"skuid__Page__r.skuid__Module__c"},{id:"skuid__Page__r.skuid__UniqueId__c"},{id:"skuid__Use_Standard_Layouts__c"},{id:"skuid__IsActive__c"},{id:"OwnerId"}],data:[],id:"AllPageAssignmentsForExport",objectName:"skuid__Page_Assignment__c",orderByClause:"skuid__Environment_Type__c, skuid__SObject_Type__c, skuid__Action_Type__c",doQuery:!0,doClone:!1,recordsLimit:200,canRetrieveMoreRows:!0})),i=S("<div>").text(y("Retrieving_data_for_export"));function t(){e.exportData({useAPINamesForHeaders:!0}),i.text(b.label.merge(y("All_records_exported_to_CSV"),e.data.length)),setTimeout(function(){S.unblockUI()},1500)}S.blockUI({message:i}),e.load(function(){e.canRetrieveMoreRows?e.loadAllRemainingRecords({stepCallback:function(e,t){i.text(b.label.merge(y("Retrieving_records_a_to_b"),e,t))},finishCallback:function(){t()}}):t()})});var a,t=b.sfdc.api,P=t.SObject,T=t.query,R=t.escapeMetadataBody;e("existingPageAssignmentPackRenderer",function(i,e){var n=w("assign__StaticResourceInfoForPackaging"),a=n.getFirstRow(),t=S("<input>").attr({type:"radio",name:"existingPageAssignmentPack"}).addClass("nx-radio").val(e).on("change.skuid",function(){var e=i.model,t=i.row;n.updateRow(a,{Name:e.getFieldValue(t,"Name"),Description:e.getFieldValue(t,"Description")})});i.element.append(t)}),e("skuid.pageAssignments.pack",function(){var e,t,i,n=arguments[0],a=n.model,s=n.packAll,o=w("assign__PageAssignmentInfoForPackaging"),r=o.getFirstRow(),d=w("assign__StaticResourceInfoForPackaging"),l=d.getFirstRow(),c=w("assign__PageAssignmentsInStaticResources"),u=d&&d.getFieldValue(l,"Name"),_=d&&d.getFieldValue(l,"Description"),p="SELECT Id, Name, Description FROM StaticResource WHERE Name = '"+u+"'",g="SELECT Id,Name,skuid__Environment_Type__c,skuid__SObject_Type__c,skuid__Action_Type__c,skuid__Context__c,skuid__Assigned_To_User__c, skuid__Assigned_To_User__r.Name, skuid__RecordTypeDeveloperName__c,skuid__Page__c,skuid__Page__r.skuid__UniqueId__c, skuid__Page__r.Name,skuid__Page__r.skuid__Module__c,skuid__Use_Standard_Layouts__c, skuid__IsActive__c FROM skuid__Page_Assignment__c ";if(s){if(o&&r){var m=[],f=o.getFieldValue(r,"EnvironmentTypesPackaging",!0);if(f?m.push("skuid__Environment_Type__c IN ('"+f.split(";").join("','")+"')"):m.push("skuid__Environment_Type__c = null"),"specific"===r.ObjectTypesPackaging){var k=o.getFieldValue(r,"skuid__SObject_Type__c",!0);k&&m.push("skuid__SObject_Type__c IN ('"+k.split(";").join("','")+"')")}var v=r.ProfilesPackaging;"org"===v?m.push("skuid__Context__c = null"):"organdprofile"===v&&m.push("(skuid__Context__c = null) OR (skuid__Context__c like '00e%')"),m.length&&(g+="WHERE ("+m.join(") AND (")+")")}}else{if((e="assign__Assignments_Classic"===a.id?"PageAssignmentsTable":"assign__Assignments_Lightning"===a.id?"PageAssignmentsTable_Lightning":null)&&(t=S("#"+e)).data("object")&&t.data("object").list&&(i=S("#"+e).data("object").list.getSelectedItems()),!i||!i.length)return void S.blockUI({message:"Please select at least one Page Assignment to package.",timeout:2500});g+="WHERE Id IN ('"+S.map(i,function(e){return e.row.Id}).join("','")+"')"}g+=" ORDER BY skuid__RecordTypeDeveloperName__c NULLS LAST, skuid__Context__c NULLS LAST, skuid__Use_Standard_Layouts__c DESC, skuid__Page__r.skuid__Module__c NULLS FIRST",S.blockUI({message:"Getting Page Assignment and StaticResource records..."});var h,b,y=T(p),I=T(g);S.when(I).then(function(e){b=e.records}),S.when(y).then(function(e){h=e.records}),S.when(y,I).then(function(){var e,t=S.Deferred();0<h.length?(e=new P("StaticResource",{Id:h[0].Id,CacheControl:"Private"}),t.resolve()):(S.blockUI({message:"Creating StaticResource..."}),(e=new P("StaticResource",{Name:u,Description:_,Body:R(JSON.stringify([])),CacheControl:"Private"})).insert({success:function(){t.resolve()},error:function(e){t.reject({resourceName:u,errorMessage:e.responseJSON[0].message})}})),S.when(t).then(function(){S.blockUI({message:"Packaging Page Assignments into StaticResource..."}),e.Body=R(JSON.stringify(b)),e.ContentType="application/json",S.when(e.update()).then(function(){S.blockUI({message:'The "'+u+'" Page Assignments Pack was created/updated successfully!',timeout:3e3}),S(".ui-dialog-content").last().dialog("close"),o.cancel(),c.updateData()},function(e){S.blockUI({message:'There was an error creating the "'+u+'" Page Assignments Pack'+(e&&e.errorMessage?":\n\n"+e.errorMessage:"."),timeout:5e3})})},function(e){S.blockUI({message:'There was an error creating the "'+e.resourceName+'" Page Assignments Pack:\n\n'+e.errorMessage,timeout:5e3})})})}),e("skuid.pageAssignments.packAll",function(){var e=S.extend(arguments[0],{packAll:!0});b.snippet.getSnippet("skuid.pageAssignments.pack")(e)}),e("skuid.pageAssignments.unpack",function(){var i,n=[],e=S("#pageAssignmentSRSelect").find("input");return S.each(e,function(){var e=S(this),t=e.val();null!==t&&!0===e.prop("checked")&&n.push(t)}),n.length?(i=S.Deferred(),b.PageAssignment.RefreshFromPacks(JSON.stringify(n),function(e){var t=S.parseJSON(e);t&&(t.isSuccess?i.resolve():(t.errors&&t.errors.length&&(S.blockUI({message:t.errors[0],timeout:5e3}),i.reject()),a=t.recordFailures,i.reject()))},{escape:!1}),i.promise()):(S.blockUI({message:"Please select one or more Page Assignment Packs.",timeout:2500}),!1)}),e("skuid.pageAssignments.displayUnpackFailures",function(){if(!(a&&0<a.length))return!1;var e=w("assign__FailedAssignments"),t=[];S.each(a,function(){var e=this.record;S.extend(e,{Error:this.message}),t.push(e)}),e.adoptRows(t)}),e("skuid.pageAssignments.bytesToKBs",function(){var e=arguments[0],t=arguments[1],i=0;S.isNumeric(t)&&(i=S.number(t/1e3,1)+" KB"),o("TEXT").read(e,i)})}(skuid)}});