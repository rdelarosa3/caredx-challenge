!function(n){var o={};function i(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,i),t.l=!0,t.exports}i.m=n,i.c=o,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=346)}({346:function(e,t,n){"use strict";var g,v;g=window.skuid,v=g.$,g.componentType.register("pageXMLEditor",function(t){var n=g.$M("page"),o=void 0,e=new g.ui.Editor(t),i=null,r=g.builder.core,a=!1;function l(e){var r="";e=e.replace(/(>)(<)(\/*)/g,"$1\r\n$2$3");var a=0;return v.each(e.split("\r\n"),function(e,t){var n=0;t.match(/.+<\/\w[^>]*>$/)?n=0:t.match(/^<\/\w/)?0!==a&&(a-=1):n=t.match(/^<\w[^>]*[^\/]>.*$/)?1:0;for(var o="",i=0;i<a;i++)o+="\t";r+=o+t+"\r\n",a+=n}),r}function s(){var e=(o=n.getFirstRow())[g.platform.getEntityFieldName("page","id")];p.prop("href",g.platform.getPageComposeUrlById(e)),(i=window.ace.edit("pagexmleditorbox")).setValue(l(n.getFieldValues(o,r.layoutFields,!0).join("")));var t=i.getSession();t.setMode("ace/mode/xml"),t.setUseSoftTabs(!1),t.setTabSize(4),t.getSelection().clearSelection(),u.show(),t.on("change",function(){if(!a){var e;try{e=g.utils.makeXMLDoc(function(e){return e.replace(/(>)(\s*)(<)(\/*)/g,"$1$3$4")}(i.getValue()))}catch(e){return void c.show()}c.hide(),r.save(e[0],n,o)}}),f()}r.layoutFields=g.platform.getLayoutFields(),g.utils.layoutFields=r.layoutFields,n&&e.registerModel(n),e.handleCancel=function(){p.removeClass("disabled"),i&&(a=!0,i.setValue(l(n.getFieldValues(o,r.layoutFields,!0).join(""))),i.getSession().getSelection().clearSelection(),a=!1)},e.handleSave=function(){p.removeClass("disabled")},e.handleChange=function(){p.addClass("disabled")};var d=v('<div id="wrapper">'),u=v('<div id="pagexmleditorbox">').addClass("nx-code-editor"),c=v("<div>Invalid XML</div>").addClass("nx-error").css({position:"absolute",top:"4px",right:"4px"}).hide(),p=v("<a>").addClass("nx-pagebuilder-viewxmllink").text("View/Edit in Page Composer");function f(){var e=window.innerHeight-v(".sk-headerwrapper").outerHeight()-100+"px";d.css("height",e),u.css("height",e),t.css("position","relative").css("height",e),i.resize()}d.append(u),t.append(d,p,c),v(document.body).one("pageload",function(){if(n.getRows().length)s();else var e=g.events.subscribe("models.loaded",function(){g.events.unsubscribe(e),s()})}),v(window).resize(f)})}});