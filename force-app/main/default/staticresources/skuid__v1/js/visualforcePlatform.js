!function(i){var n={};function o(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return i[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.m=i,o.c=n,o.d=function(e,t,i){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(i,n,function(e){return t[e]}.bind(null,n));return i},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=189)}({1:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.apiVersionsArray=void 0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e};t.isValidApiVersion=function(e){return a.default.hasOwnProperty(e)};var o,r=i(2),a=(o=r)&&o.__esModule?o:{default:o};t.apiVersionsArray=Object.keys(a.default).map(function(e){return n({id:e},a.default[e])});t.default=a.default},14:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SCHEMA={auth_provider:{auth_method:"skuid__Auth_Method__c",authorize_endpoint_url:"skuid__Authorize_Endpoint_URL__c",client_id:"skuid__Client_Id__c",client_secret:"skuid__Client_Secret__c",custom_callback_url:"skuid__Custom_Callback_URL__c",id:"Id",name:"Name",oauth_grant_type:"skuid__OAuth_Grant_Type__c",oauth_provider_type:"skuid__Type__c",request_headers:"skuid__Request_Headers__c",token_endpoint_url:"skuid__Token_Endpoint_URL__c",token_request_body_parameters:"skuid__Token_Request_Body_Parameters__c",default_scopes:"skuid__Default_Scopes__c"},auth_provider_credential:{id:"Id",auth_provider_id:"skuid__Auth_Provider__c",auth_provider_name:"Auth_Provider_Name__ui",user_id:"skuid__User__c",access_token:"skuid__Access_Token__c",access_token_issued:"skuid__Access_Token_Issued__c",access_token_expiration:"skuid__Access_Token_Expiration__c",refresh_token:"skuid__Refresh_Token__c"},component_pack:{active:"skuid__Active__c",api_version:"skuid__API_Version__c",id:"Id",load_order:"skuid__Load_Order__c",name:"Name",resource_name:"skuid__Resource_Name__c",type:"skuid__Type__c"},data_service:{host:"skuid__Host__c",id:"Id",name:"Name",port:"skuid__Port__c",version:"skuid__Version__c",is_active:"skuid__Active__c"},data_source:{authentication:"skuid__Authentication__c",auth_request_body:"skuid__Auth_Request_Body__c",auth_request_body_content_type:"skuid__Auth_Request_Body_Content_Type__c",auth_request_headers:"skuid__Auth_Request_Headers__c",auth_request_verb:"skuid__Auth_Request_Verb__c",auth_url:"skuid__Authentication_URL__c",credential_source:"skuid__Credential_Source__c",data_service_id:"skuid__Data_Service_Id__c",data_service:"skuid__Data_Service__r",external_id:"skuid__External_Id__c",id:"Id",is_active:"skuid__Active__c",name:"Name",password:"skuid__Password__c",request_body_parameters:"skuid__Request_Body_Parameters__c",request_headers:"skuid__Request_Headers__c",request_url_parameters:"skuid__Request_URL_Parameters__c",url:"skuid__URL__c",username:"skuid__Username__c",use_proxy:"skuid__Use_Apex_Proxy__c",type:"skuid__Adapter_Name__c"},data_source_credential:{id:"Id",password:"skuid__Password__c",user_id:"skuid__Applies_To__c",username:"skuid__Username__c"},page:{api_version:"skuid__API_Version__c",composer_settings:"skuid__Composer_Settings__c",id:"Id",is_master_page:"skuid__IsMaster__c",master_page:"skuid__MasterPage__r",master_page_id:"skuid__MasterPage__c",max_auto_saves:"skuid__Max_Auto_Saves__c",module:"skuid__Module__c",name:"Name",updated_at:"LastModifiedDate"},page_version:{api_version:"skuid__API_Version__c",description:"skuid__Description__c",id:"Id"},profile:{id:"Id",name:"Name"},static_resource:{id:"Id",name:"Name",namespace:"NamespacePrefix",content_type:"ContentType"},theme:{id:"Id",name:"Name",resource_name:"skuid__Resource_Name__c",resource_namespace:"skuid__Resource_Namespace__c",type:"skuid__Type__c",version_date:"skuid__Skuid_Version_Date__c",active:"skuid__Active__c"}}},189:function(e,t,i){"use strict";i.r(t);i(9),i(190)},190:function(e,t,i){"use strict";var n=i(1),f=a(n),o=a(i(7)),r=i(14);function a(e){return e&&e.__esModule?e:{default:e}}var l=skuid.$,s="skuid__Module__c",u="salesforce",m="v1",d={},c={},p=skuid.runtime.cache.get("canAccessIconsViaAJAX",null,!0);function h(){return skuid.utils}function _(){var e;return(e=h()).resolve.apply(e,arguments)}function g(){return h().apps?h().apps.apps:h().sfApps}function v(e){var t,i,n,o=l.Deferred(),r=!1,a=window.Visualforce,s=function(){r||(r=!0,window.confirm('You need to log in again, your session has expired.\n\nPress "OK" to go to the login page now.\n\nPress "Cancel" to remain on this page. Refresh your browser to go to the login page.')&&(skuid.offline.isEnabled()?window.location.href="/?startURL="+encodeURI(window.location.href):window.location.reload()))};return e?(s(),o.reject()):(t=l.Deferred(),i=setTimeout(t.reject,5e3),n=l('<iframe src="/apex/" width="0" height="0"/>').css("display","none").appendTo(document.body).load(function(){clearTimeout(i),n.remove(),t.resolve()}),t.promise()).then(function(){return l.when.all(l.map(a.remoting.Manager.providers,function(e){return function(e){var t=l.Deferred(),i=setTimeout(t.reject,5e3);return e.refresh(function(){clearTimeout(i),t.resolve()}),t.promise()}(e)}))}).then(function(){o.resolve()},function(){s(),o.reject()}),o.promise()}function k(){return h().apps?h().apps.tabs:h().sfTabs}function y(n){return l.map(n.tabs,function(e){var t=k()[e],i=n.url&&n.url.slice(-20);return i&&(i=-1===i.indexOf("tsid=")?"":(-1===t.url.indexOf("?")?"?":"&")+i),{label:t.label,link:t.url+i}})}function b(){var e,t=[],i=g(),n=k();return i&&n&&(l.each(i,function(){if(this.isSelected)return e=this,!1}),e&&(t=y(e))),t}function S(e){var t=g();if(!t)return[];e||(e={});var i,n,o=[],r={},a=[],s=e.selectedAppFirst,u=e.withTabs;return l.each(t,function(e,t){if(s&&t.isSelected)n=t;else{var i=t.sortOrder;-1<i&&!r[i]?r[i]=t:a.push(t)}}),(i=Object.keys(r)).sort(function(e,t){return e-t}),n&&o.push(n),l.each(i,function(e,t){o.push(r[t])}),a.length&&o.concat(a),l.map(o,function(e){var t=u?y(e):null;return{label:e.label,link:e.url,items:t}})}function w(){return S({selectedAppFirst:!0})}function P(){return S({withTabs:!0})}function x(){return[{label:"My Profile",link:"/_ui/core/userprofile/UserProfilePage"},{label:"My Settings",link:"/ui/setup/Setup?setupid=PersonalSetup"},{label:"My Data Source Credentials",link:"/apex/skuid__CredentialsManagement"},{label:"My Apps",link:null,items:w},{label:"Salesforce Setup",link:"/setup/forcecomHomepage.apexp?setupid=ForceCom"},{label:"Developer Console",link:"/_ui/common/apex/debug/ApexCSIPage",window:"blank"},{label:"Logout",link:I()}]}function I(){var e=j("prefix"),t="";return e&&(t=h().endsWith(e,"/s")?e.substring(0,e.length-2):e),t+"/secur/logout.jsp"}function N(){return"https://"+skuid.settings.site("instance").toLowerCase()+".salesforce.com/services/apexrest/skuid"}function C(){return N()+"/api/v1/auth/token"}sforce.one&&navigator&&(navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPhone/i))&&(skuid.$.ui.dialog.prototype._focusTabbable=function(){}),window.Visualforce&&window.Visualforce.remoting&&(window.Visualforce.remoting.timeout=9e4);var T={RICHTEXT:{edit:function(e){return skuid.ui.renderers.RICHTEXT.edit(e)},destroy:function(e){var t=e.field||e.editor||e.component,i=t&&t._richtextInstanceAPI;i&&(i.destroy(),delete t._richtextInstanceAPI)}}};function A(e,t){var i=window.__staticResourceMetadata||skuid.runtime.cache.get("loader.files");if(i&&i[e])return i[e][t]}function F(e){var t=skuid.page.sitePrefix||window.__sfdcSiteUrlPrefix||"",i=f.default[e.apiVersion||m].path,n=window.location.host,o=void 0,r=void 0,a=void 0,s=void 0,u=void 0,l=void 0,d=void 0;if(t&&!t.startsWith("/")&&(t="/"+t),h().isObject(e)){if(e.type&&"external"===e.type)return e.url||e.path;o=e.name||e.resource,r=e.namespace||e.ns,a=e.nestedPath||e.path,s=e.modstamp}else o=e;if("skuid"===r&&(o?o.startsWith("js/")&&!a?(a=o,o=i,d=!0):o.match(/(\.js|\.css)$/i)&&(o=(o=h().capitalizeFirst(o)).replace(/\.js$/i,"JS").replace(/\.css$/i,"CSS")):!o&&a&&a.startsWith("js/")&&(o=i,d=!0),o===i&&a&&(d=!0),!s&&d)){var c=A("skuid",i);c&&(s=c.m)}if(o&&!s){var p=A(r||"c",o);p&&(s=p.m)}return skuid.offline.networkDown()&&-1<n.search(/\.visual\.?force\.com/)&&(l=h().getLocalVisualforceDomain(n),r&&(l=l.replace("--c","--"+r).replace("//c.","//"+r+".")),u=window.location.protocol+"//"+l),[u||"",t,"/resource/",s&&s+"/",r&&r+"__",o,a&&"/"+a].filter(function(e){return!!e}).join("")}function O(e){return l.when(skuid.remote.promisify.apply(null,[skuid.remote(),e].concat(Array.prototype.slice.call(arguments,1))))}function U(t){var e=c[t];if(e)return e;for(var i=arguments.length,n=Array(1<i?i-1:0),o=1;o<i;o++)n[o-1]=arguments[o];return c[t]=O.apply(void 0,[t].concat(n)).then(function(e){return delete c[t],e}).catch(function(e){throw delete c[t],e})}var M={checkNetwork:function(){return O("checkNetwork").catch(function(e){if(e&&e.indexOf&&-1!==e.indexOf("Remoting request invalid for your session.  Refresh page and re-submit request"))return v(0);if(h().isString(e)){if(-1<e.indexOf("Logged in?"))return;if(-1<e.indexOf("Could not find an action"))return}throw e})},getDataSourceTypes:function(){return skuid.remote().getDataSourceTypes?U("getDataSourceTypes"):_(skuid.dataSource.listAllTypes().map(function(e){return{label:e.name,value:e.name}}))},getToken:function(){return U("getToken")},componentPack:function(e){return h().isUndefined(e)&&(e=null),O("componentPackService",e)},dataSources:function(){return U("dataSourceService")},events:function(){var e=skuid.events,t=e.Event,i=e.EventParameter;return _([{name:"force:closeQuickAction",label:"Lightning: Close Quick Action"},{name:"force:showToast",label:"Lightning: Show Toast Message",parameters:[{name:"title",label:"Title",displayType:"TEXT"},{name:"message",label:"Message",displayType:"TEXT",metadata:{required:!0}},{name:"duration",label:"Duration (milliseconds)",displayType:"INTEGER",metadata:{defaultValue:"5000"}},{name:"type",label:"Type",displayType:"PICKLIST",metadata:{defaultValue:"other",required:!0,picklistEntries:[{label:"Error",value:"error"},{label:"Warning",value:"warning"},{label:"Success",value:"success"},{label:"Info",value:"info"},{label:"Other",value:"other"}]}},{name:"mode",label:"Remains visible until",displayType:"PICKLIST",metadata:{defaultValue:"dismissible",required:!0,picklistEntries:[{label:"User closes OR duration elapses",value:"dismissible"},{label:"Duration elapses - no close button.",value:"pester"},{label:"Until user closes - duration is ignored.",value:"sticky"}]}},{name:"key",label:"Icon",displayType:"TEXT"}]}].map(function(e){return new t(e.name,e.label,(e.parameters||[]).map(function(e){return new i(e.name,e.label,e.displayType,e.metadata)}),{scope:skuid.constants.EVENT_SCOPES.GLOBAL,subscribable:!1})}))},labels:function(e){return O("labelsService",JSON.stringify(e),null)},meta:function(e){return O("metaService",JSON.stringify(e))},page:function(e,t){return h().isUndefined(t)&&(t=null),O("pageService",e,t).then(function(e){var t=e.masterPageName,i=e.pageAPIVersion,n=e.pageId,o=e.pageLastModifiedDate,r=e.pageLayout;return{metadata:{pageAPIVersion:i,pageName:e.pageName,pageId:n,pageLastModifiedDate:o,masterPageName:t,namespace:e.namespace},xml:r}})},personalization:function(e){return O("personalizationService",JSON.stringify(e))},serviceModstamps:function(){return O("loaderServiceModstamps")},theme:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:m;return O("themeService",JSON.stringify({themeToRequest:e,pageApiVersion:t}))}};null===p&&skuid.$.ajax(F({ns:"skuid",name:"IconsSVG",modstamp:(new Date).getTime()}),{type:"head",error:function(){p=!1,skuid.runtime.cache.set("canAccessIconsViaAJAX",!1)},success:function(){p=!0,skuid.runtime.cache.set("canAccessIconsViaAJAX",!0)}});var D=void 0;function R(t){var i=skuid.utils.getCacheTimestamp(),n=skuid.storage.getDb("iconsCache"),e=void 0;return n?e=_(n):(e=D||skuid.storage.createDb("iconsCache","IndexedDB",[{name:"svgStrings"}]),D||(D=e)),e.then(function(e){return(n=e).svgStrings.get(t)}).then(function(e){return e&&e.modstamp<i?e.string:h().getBodyOfZIPResourceFile("IconsSVG","skuid",t+"/"+t+".min.svg").then(function(e){return n.svgStrings.add(t,{string:e,modstamp:(new Date).getTime()}),e})})}function E(){return"salesforce"}var j=function(e){return skuid.settings.site(e)};skuid.events.subscribeOnce("skuid.settings.added:site",function(){var e=j("runningOnForceSite");if(e){var t=j("baseUrl"),i=j("prefix");l.extend(skuid.page,{baseUrl:t,runningOnForceSite:e,sitePrefix:i}),h()._setAttachmentBaseUrl(h().combineUrls(t||"","/servlet/servlet.FileDownload?file=blah"))}}),skuid.platform={attemptLogin:v,FileComponent:o.default,get:function(e){return d[e]},getActions:function(){return[{name:"user-logout",label:"Logout",getProperties:function(){return[]},run:function(){window.location.href=I()}}]},getAuthUrl:function(){return N()+"/api/v1/auth/check"},getBasePreviewUrl:function(e,t){var i="/apex/skuid__ui?page="+e[r.SCHEMA.page.name];return t&&(i+="&"+t.substring(-1<l.inArray(t.charAt(0),["&","?"])?1:0)),i},getBaseXmlEditorUrl:function(e){return"/apex/skuid__PageXMLEdit?id="+e[r.SCHEMA.page.id]},getBodiesOfZIPResourceFilesWithAjax:function(e,t){var a=[],s=skuid.$,u={};return s.each(h().parseAsJSONIfString(e),function(e,t){var i,n=u[e]={},o=e.split("__"),r=void 0;2===o.length&&(r=o.shift()),i=F({namespace:r,resource:o[0]}),t.forEach(function(t){a.push(s.ajax({cache:!0,method:"GET",url:i+"/"+t}).then(function(e){n[t]=e}))})}),s.when.all(a).then(function(){t(u,{status:"SUCCESS"})}).catch(function(e){t(null,{message:h().isString(e)?e:e.message})})},getDefaultDataService:function(){return _({PLINY_WARDEN_HOST:"gateway-us.skuid.net",PLINY_WARDEN_PORT:"443",PLINY_WARDEN_VERSION:"0.2.4"})},getDefaultDataSourceName:E,getDefaultDataSourceTypeName:function(){return"salesforce"},getDocsBaseUrl:function(){return"https://docs.skuid.com/latest/"+skuid.version.id+"/en/"},getPageNavigateUrl:function(){return window.location.pathname},getEntityFieldName:function(e,t){return r.SCHEMA[e][t]},getEntityFieldNames:function(e){return r.SCHEMA[e]},getLayoutFields:function(){return["skuid__Layout__c","skuid__Layout2__c","skuid__Layout3__c","skuid__Layout4__c","skuid__Layout5__c"]},getLogoutUrl:I,getMaxProxyRequestPayload:function(){return 65e4},getName:function(){return"visualforce"},getNavigationItemSourceTypes:function(){return[{value:"sftabs",label:"Salesforce Tabs for Current App",items:b},{value:"sfapps",label:"Salesforce Apps",items:w},{value:"sfappswithtabs",label:"Salesforce Apps with Tabs",items:P},{value:"sfusermenu",label:"Salesforce User Menu",items:x}]},getOAuthRedirectUri:function(e){var t=window.location.origin,i=e.customCallbackUrl;return!i||h().determineIfInSkuidNamespace()?t+"/apex/skuid__oauthcallback":h().combineUrls(t,i)},getOAuthProxyUri:function(){return window.location.origin+"/apex/skuid__oauthproxy"},getPageAPIVersions:function(){return n.apiVersionsArray},getPageComposeUrlById:function(e){return"/apex/skuid__PageBuilder?id="+e},getPageComposeUrlByName:function(e,t){return"/apex/skuid__PageBuilder?pagename="+e+(t?"&pagemodule="+t:"")},getPublicKeyEndpoint:function(){return C()},getRenderers:function(){return T},getResourceUrl:F,getSiteResourceUrl:function(e){return F(e)},getTokenURL:C,hasFeature:function(e){return skuid.features&&skuid.features.hasOwnProperty(e)},isPlatformSessionError:function(e,t){var i=!1;return"salesforce"===t.name&&(e&&-1!==e.indexOf("Logged in?")?i=!0:e&&-1!==e.indexOf("Page not allowed for the profile")?i=!0:e&&-1!==e.indexOf("Remoting request invalid")&&(i=!0)),i},preloadIconSetDependencies:function(e){return p?function(e){return l.get({cache:!0,dataType:"xml",url:F({ns:"skuid",name:"IconsSVG",path:e+"/"+e+".min.svg"})})}(e).catch(function(){return p=!1,skuid.runtime.cache.set("canAccessIconsViaAJAX",!1),R(e)}):R(e)},recordUsage:function(){},requiresClientSideModelLoading:function(){return!1},requiresSerializedProxyRequests:function(){return!0},services:M,set:function(e,t){d[e]=t},uploadComponentPackFile:function(e){var t=e.body,i=e.resourceName;return l.ajax({type:"POST",url:"/services/data/v34.0/sobjects/StaticResource",headers:{"Content-Type":"application/json",Authorization:"Bearer "+skuid.utils.userInfo.sessionId},data:JSON.stringify({Name:i,ContentType:"application/zip",Body:t,CacheControl:"Public"}),dataType:"json"})}},skuid.platform.builder={getProtectedModules:function(){return skuid.builder.core.protectedModules},getPageModule:function(e,t){return e.getFieldValue(t,s,!0)||""},getPageIncludeTypes:function(){return[{label:"Skuid Page",value:"skuid"},{label:"Page Assignment",value:"assignment"}]},getModuleEntries:function(e){return skuid.$.map(e.getField(s).picklistEntries,function(e){return{value:e.value,label:e.label,disabled:!1===e.active,defaultValue:e.defaultValue}})},getAvailableComponentPacks:function(){return skuid.builder.core.availablePacks},getPageSelectProperty:function(t){return{id:t.id,type:"autocomplete",sobject:"skuid__Page__c",dataSource:t.dataSource,fieldsToReturn:["Name","skuid__Module__c","skuid__API_Version__c"],fieldsToSearch:["Name","skuid__Module__c"],displayTemplate:"{{Name}}{{#skuid__Module__c}} ({{skuid__Module__c}}){{/skuid__Module__c}}",valueTemplates:t.valueTemplates||{pagename:"{{Name}}",module:"{{skuid__Module__c}}"},order:"Name",filter:function(e){return e&&e.length?e.filter(function(e){return"Skuid"!==e.skuid__Module__c&&(!t.sameVersionOnly||e.skuid__API_Version__c===m)}):e},label:t.label,helptext:t.helptext,required:!0,onChange:t.onChange||function(){}}},getStaticResourceProperty:function(e){return{id:e.id,type:"autocomplete",sobject:"StaticResource",fieldsToReturn:["Name","NamespacePrefix","ContentType"],fieldsToSearch:["Name","NamespacePrefix"],displayTemplate:"{{Name}}{{#ContentType}} ({{ContentType}}){{/ContentType}}",valueTemplates:e.valueTemplates,order:"Name",label:"Resource Name",helptext:e.helptext,required:e.required||!1,onChange:e.onChange||function(){}}},getNestedPathProperty:function(t){return{id:t.id||"filepath",type:"filepath",label:"File Path (within ZIP Static Resources)",helptext:"The desired file's relative location within Static Resources that are .zip files. Do not use unless your Static Resource is a ZIP file.",divisionSize:"2",getResourceName:function(){var e=t.state.attr(t.nameProperty).split("__");return e[e.length-1]},getResourceNamespace:function(){return t.state.attr(t.namespaceProperty)||null},onChange:t.onChange||function(){}}}},skuid.platform.themeBuilder={getThemeData:function(e,t){var i=l.Deferred();return skuid.ThemeComposerController.bootstrap(JSON.stringify({resourceName:e.Name,resourceNamespace:e.NamespacePrefix}),function(e){t&&t(e),i.resolve(e)},{escape:!1}),i.promise()},getThemeResourceUrl:function(e){return skuid.platform.getResourceUrl(e)},getResource:function(e,t){return h().getBodyOfZIPResourceFile(e.Name,e.NamespacePrefix,t)},saveTheme:function(e,t,i){var n={Id:e.resourceId||i.Id,Body:t};return new skuid.sfdc.api.SObject("StaticResource",n).update()}},skuid.sfdc.search=function(){var t=skuid.dataSource.get(u),e=arguments;function i(){return t.search.apply(t,e)}return t?i():skuid.loader.service.loadDataSourceAndDependencies(u).then(function(e){return t=e,i()})}},2:function(e){e.exports={v1:{id:"v1",isLegacy:!0,isLatest:!0,path:"v1",released:!0},v2:{id:"v2",path:"next",released:!1}}},4:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}}(),d=r(i(5)),o=r(i(6));function r(e){return e&&e.__esModule?e:{default:e}}var p=skuid.utils,m=skuid.$L,h=skuid.$,_=p.getDefaultImageUrl,f=p.encodeHTML,s=p.isString,a=function(){function c(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c);var e=this,n=e.fileController=this.initializeFileController(t,i),o=n.uploadMethod,r=n.dataSource,a=n.row,s=n.model,u=n.canCreateOrUpdateImage,l=n.canUpload;if(!n.initialized){if(n.isNewRow)var d=skuid.events.subscribe("models.saved",function(e){s&&s.id in e.models&&(s.isRowNew(a)||(t.empty(),new(skuid.platform.FileComponent||c)(t,i),skuid.events.unsubscribe(d)))});return t.text(n.error),!1}t.data("object",e).addClass("nx-fileupload"),e.elem=t,e.options=i,e.buttonText=i.label||m("Upload"),e.dataSource=r,e.canCreateOrUpdateImage=u,e.uploadMethod=o,e.canUpload=l,t.off("imageuploadcomplete imageuploadstarted mouseenter mouseleave click drop dragleave dragenter dragover"),e.instantiateUploader(),e.initialSetup()}return n(c,[{key:"instantiateUploader",value:function(){var e,t,i=this,n=i.fileController,o=n.canCreateOrUpdateImage,r=n.fieldName,a=n.saveTo,s=n.model,u=n.row,l=i.canUpload;(o||"field"===a)&&(i.uploader=new d.default(n),l?(i.uploader.attach(i),u&&s.getRowId(u)&&i.uploader.setSource({row:u,model:s},i.elem,r)):i.elem.text((e=p.isApiEnabled(),t=p.isFileAPISupported(),e||t?e&&!t?"Your browser does not support HTML5 file uploads.":!e&&t?"You do not have permission to upload files using the API.":void 0:"You either do not have permission to upload files using the API, or your browser does not support HTML5 file uploads."))),i.uploader&&l||(i.canCreateOrUpdateImage=n.canCreateOrUpdateImage=!1)}},{key:"initialSetup",value:function(){var s=this,u=this,e=u.elem,l=u.uploadMethod,t=u.canCreateOrUpdateImage,i=this.fileController,n=i.fileId,d=i.displayAs,o=i.deletable,r=i.model,a=i.editable;if(u.status=h("<div>").addClass("nx-fileupload-status").css({float:"none",display:"inline-block"}).appendTo(e).hide(),u.statustext=h("<div>").appendTo(u.status),"filename"===d||l.forceStoreAsFileName){var c=void 0,p=void 0;if(!1!==t&&u.uploader&&(p=h("<div>"),u.progressParentDiv=p,skuid.mobile?(p.addClass("sm-button").css("display","inline-block"),c=new skuid.mobile.ui.Button({icon:"fa-plus",label:u.buttonText,element:p,iconColor:"green"}),p.on("tap",function(){u.uploader.pickFile()})):p.text(u.buttonText).css("vertical-align","top").skooButton({icon:"sk-icon-upload"}).click(function(e){e.stopPropagation(),u.uploader.pickFile()}),p.appendTo(e)),skuid.mobile||(u.status.addClass("nx-actionselect nx-status").css({"margin-left":"4px","word-break":"break-all"}),u.statustext.addClass("nx-actionselect-text")),r&&r.updateable&&o){if(skuid.mobile){u.deletebutton=h('<div class="sm-button">');var f=new skuid.mobile.ui.Button({icon:"fa-minus",element:u.deletebutton,iconColor:"red"});u.deletebutton.on("tap",function(){f.startProcessing(),u.deleteImage()}),e.on("imagedeletecomplete",function(){f.stopProcessing()})}else u.deletebutton=h('<div class="sk-icon inline sk-icon-delete">').css({border:"3px solid #EEE","vertical-align":"top","background-color":"#EEE","margin-top":"3px",cursor:"pointer"}),u.deletebutton.click(function(){u.deleteImage()});u.deletebutton.css("display","inline-block").appendTo(e)}e.on("imageuploadstarted",function(e,t){s.fileController.supportsDragAndDrop||(s.fileName=t.fileName),s.setStatus(skuid.label.merge(m("Uploading"),t.fileName||"")),u.status.off("click.skuid"),c&&c.startProcessing()}),c&&e.on("imageuploadcomplete",function(){c.stopProcessing()})}else"image"===d&&((u.progressParentDiv=e).children(".nx-edithover").remove(),e.addClass("nx-attachmentimage"),u.defaultImageSrc=_(u.options.defaultImage||"person"),u.image=h("<img>").addClass("nx-attachmentimage-image").css("max-width","100%").appendTo(e),!1!==t&&e.on("mouseenter",function(){a&&u.uploader&&u.elem.append(h("<div>").addClass("nx-edithover sk-icon inline sk-icon-edit").css({"background-color":"white",opacity:"0.8",border:"4px solid white"}).click(function(e){u.elem.find(".nx-error").remove(),u.uploader&&u.uploader.pickFile(),e.stopPropagation()})),l.needsFieldContext&&!n||!o||u.imageError||e.append(h("<div>").addClass("nx-edithover sk-icon inline sk-icon-delete").css({cursor:"pointer","background-color":"white",opacity:"0.8",border:"4px solid white",left:"4px"}).click(function(e){u.elem.find(".nx-error").remove(),u.deleteImage(),e.stopPropagation()}))}).on("mouseleave",function(){u.elem.find("div.nx-edithover").remove()}));e.on("imageuploadcomplete",function(e,t){u.fileController.uploadFinished(t);var i,n=t&&(t.newFileId||t.newAttachmentId),o=u.fileController,r=o.fileId,a=o.fileName;n&&u.draw(),t&&t.message?(i={text:t.message,hideIn:4},r&&a&&"image"!==d&&(i.complete=function(){s.setStatus(a)}),s.setStatus(i)):l.needsFieldContext||s.setStatus({text:m("Upload_Successful"),hideIn:2})}),u.draw()}},{key:"draw",value:function(){var n=this,o=n.uploadMethod,e=this.fileController,r=e.fileId,a=e.fileName,t=e.displayAs,i=e.fieldName,s=e.deletable,u=e.cacheBuster,l=n.elem,d=u?"&cachebuster="+u:"";n.imageError=!1;var c=function(){if(r){var t,i=h("<img>").css({"max-height":"600px","max-width":"800px"}),e=n.image&&n.image.attr("src");e?i.attr("src",e):o.getSrc&&o.getSrc({context:{id:r},component:n.fileController.getComponent(),paramString:d,dataSource:o.dataSource}).then(function(e){t=e,i.attr("src",e)},function(){i.attr("src","")}),i.load(function(){var e=h("<div>").attr("title",f(a)).append(i).dialog({close:function(){h(this).remove()},modal:!0,width:"auto",resizable:!1,open:function(){h(".ui-widget-overlay").on("click",function(){e.dialog("close")})},dialogClass:"nx-imageview"})}),i.error(function(){t&&skuid.dataSource.utils.downloadWithLink(a,t)})}};if("filename"===t||(o||{}).forceStoreAsFileName)r&&a&&i?(n.setStatus(a),n.status.off("click.skuid").on("click.skuid",function(){c()}),s&&n.deletebutton&&n.deletebutton.show()):(n.deletebutton&&n.deletebutton.hide(),n.status.hide());else if("image"===t){if(r||!o.needsFieldContext){var p={};r&&(p.id=r),o.getSrc&&o.getSrc({context:p,component:n.fileController.getComponent(),paramString:d,dataSource:o.dataSource}).then(function(e){n.image.attr("src",e)},function(){n.image.attr("src","")})}else n.imageError=!0,n.defaultImageSrc&&n.image.attr("src",n.defaultImageSrc);n.image.error(function(){n.imageError||(n.imageError=!0,n.defaultImageSrc&&n.image.attr("src",n.defaultImageSrc))}),l.off("click.skuid").on("click.skuid",function(){c()}),n.status&&n.status.hide()}}},{key:"setStatus",value:function(e){var t,i,n,o=this,r=o.status,a=o.statustext;e&&(s(e)?t=e:(t=e.text,i=e.hideIn,n=e.complete)),r&&a&&(o.statusTimeout&&clearTimeout(o.statusTimeout),skuid.ui.setStatus(r,a,t),0<=i&&(o.statusTimeout=setTimeout(function(){r.animate({opacity:0},{duration:2e3,complete:n||function(){r.hide()}})},1e3*i)))}},{key:"deleteImage",value:function(){var t=this,i=this.fileController.fileId,n=skuid.$.Deferred();return this.fileController.deleteFile({startHook:function(){t.setStatus(m("Deleting"))},endHook:function(e){e&&e.message?t.setStatus({text:e.message,hideIn:2,complete:function(){return t.draw()}}):(t.elem.trigger("imagedeletecomplete",{oldFileId:i}),t.draw()),n.resolve()}}),n.promise()}},{key:"unregister",value:function(){this.elem&&this.elem.remove&&this.elem.remove(),this.uploader&&this.uploader.unregister(this)}},{key:"initializeFileController",value:function(e,t){return new o.default({component:t.component,element:e,context:t.context,model:t.model,row:t.row,dataSource:t.datasource,idField:t.idField,field:t.field,saveTo:t.saveTo,storeAs:t.storeAs,displayAs:t.displayAs,editable:t.editable,deletable:t.deletable,fileName:t.filename,description:t.description,maxFileSize:t.maxFileSize,enforceMaxFileSize:t.enforceMaxFileSize,cacheBuster:t.cacheBuster,snippetName:t.snippetName,autoRefreshModelsOnUpload:t.autoRefreshModelsOnUpload,uploadSuccessActions:t.onUploadSuccessActions,uploadFailureActions:t.onUploadFailureActions,label:t.label})}}]),c}();t.default=a,p.FileComponent=a},5:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}}();var o=skuid.utils,f=skuid.$,m=o._ie,r=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.fileController=e,this.uploadMethod=e.uploadMethod,this.canUpload=e.canUpload,this.fileName=e.fileName,this.fileNameOverride=e.fileNameOverride,this.description=e.description,this._GUID=e._GUID,this.progressDiv=f("<div>").addClass("nx-file-progress"),this.dragAndDrop=e.supportsDragAndDrop,e.supportsDragAndDrop?this.iframe=f('<input style="display:none;" type="file" id="'+o.generateUniqueId()+'" multiple>'):this.iframe=f('<iframe style="display:none;" src="" frameborder="0">')}return n(t,[{key:"setSource",value:function(e,t,i){var n=this.uploadMethod;if(!this.dragAndDrop){var o=this.description||"",r=this.fileNameOverride;n&&n.getIframeSrc&&this.iframe.attr("src",n.getIframeSrc(e,t,i,{description:o,fileNameOverride:r}))}}},{key:"pickFile",value:function(){this.dragAndDrop?this.iframe.click():this.iframe.contents().find("input[type=file]").click()}},{key:"startProgress",value:function(){this.fileComponent.progressParentDiv&&this.fileComponent.progressParentDiv.append(this.progressDiv)}},{key:"handleProgress",value:function(e){if(this.fileComponent.progressParentDiv){var t=Math.round(e.loaded/e.total*100);t<100&&this.progressDiv.css("width",t+"%")}}},{key:"endProgress",value:function(){var e=this;this.fileComponent.progressParentDiv&&(this.progressDiv.css("width","100%"),setTimeout(function(){return e.progressDiv.detach()},1e3))}},{key:"uploadFile",value:function(e){var t=this,i=this.fileController,n=this.fileController.element;return i.uploadFile(e,{startHook:function(e){t.startProgress(),n.trigger("imageuploadstarted",e)},progressHook:function(e){t.handleProgress(e)},endHook:function(e){t.endProgress(),n.trigger("imageuploadcomplete",e)}})}},{key:"attach",value:function(e){var t,i,n,o,r,a=this,s=this,u=this.fileController,l=e.elem,d="nx-file-dropping",c=!1;if(s.iframe.appendTo(l),s.element=l,s.fileComponent=e,s.dragAndDrop){i=f(document.body),n=f("<div>").addClass("nx-file-droppable").text(e.buttonText),o=function(e){e.preventDefault();var t=e.originalEvent.dataTransfer?e.originalEvent.dataTransfer.files:e.target.files;u.handleUpload(t,{startHook:function(e){a.startProgress(),l.trigger("imageuploadstarted",e)},progressHook:function(e){a.handleProgress(e)},endHook:function(e){a.endProgress(),l.trigger("imageuploadcomplete",e)}})};var p=function(){r&&clearTimeout(r),r=setTimeout(function(){n.detach(),c=!1,n.removeClass(d)},100)};s.iframe.on("click",function(e){this.value=null,e.stopPropagation()}).on("change",o),l.on("dragover",function(e){m||e.stopPropagation(),e.preventDefault(),e.originalEvent.dataTransfer.dropEffect="copy"}).on("dragenter",function(e){m&&(e.stopPropagation(),e.preventDefault(),p()),n.addClass(d),m&&(c||(l.append(n),c=!0))}).on("dragleave",function(e){m&&(e.stopPropagation(),e.preventDefault()),n.removeClass(d)}).on("drop",o),i.on("dragenter."+s._GUID,function(e){e.preventDefault(),m?(c||(l.append(n),c=!0),p()):(t=e.target,l.append(n))}).on("dragover."+s._GUID,function(e){e.preventDefault(),m&&p()}).on("dragleave."+s._GUID,function(e){m||t!==e.target||(n.detach(),n.removeClass(d))}).on("drop."+s._GUID,function(e){return e.preventDefault(),e.stopPropagation(),n.detach(),n.removeClass(d),t=null,!1})}}},{key:"unregister",value:function(e){var t=e.options._GUID;f(document.body).off("dragenter."+t+" dragleave."+t+" drop."+t)}}]),t}();t.default=r},6:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=function(){function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}}();var o=skuid,I=o.$L,N=o.utils,C=o.$,T=N.isFileAPISupported(),r=function(){function P(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,P),this.initialized=!1;var t=e.component,i=e.context,n="object"===x(e.model)?e.model:skuid.$M(e.model),o=t?C(t.xmlDefinition):void 0,r=o?t.createConditionsFromXml(o):null,a=e.row||P.getRow(n,i,r),s=e.dataSource,u=n?n.getDataSource():skuid.dataSource.get(s),l=e.saveTo,d="field"===l,c=e.idField,p=e.storeAs,f=e.deletable||e.deleteable,m=e.editable,h=e.fileName,_=e.fileName,g=void 0,v=void 0,k=void 0,y=void 0,b=T&&(!function(e){if(!e)return!0;var t=e.getDataSourceType();return!!t&&t.isDataSourceNativeSalesforce(e)}(u)||N.isApiEnabled()&&N.userInfo.isAuthenticated);if(!n&&!e.model&&i&&i.model&&(n=i.model),t&&(this.component=t,this._GUID=t._GUID),this.model=n,this.row=a,this.dataSource=u,this.storeAs=p,this.saveTo=l,this._deletable=f,this.editable=m,this.idField=c,this.xmlDef=o,this.dataSourceName=s,this.autoRefreshModelsOnUpload=e.autoRefreshModelsOnUpload,this.field=e.field,this.displayAs=e.displayAs,this.element=e.element,this.cacheBuster=e.cacheBuster,this.description=e.description,this.snippetName=e.snippetName,this.enforceMaxFileSize=!!e.enforceMaxFileSize,this.maxFileSize=parseInt(e.maxFileSize,10),this.defaultMaxFileSizeMessage=I("Error_Exceeds_Max_File_Size"),this.uploadSuccessActions=e.uploadSuccessActions,this.uploadFailureActions=e.uploadFailureActions,u||d)if(y=u.getUploadMethod(p),d&&(y={}),y||d)if(this.uploadMethod=y,n||!y.needsRecordContext)if(!y.needsRecordContext||a){var S=!0;if(y.needsRecordContext){if(!n.accessible)return void this.addError("You do not have permission to upload files to this record.");if(n.isRowNew(a))return this.addError("This record must be saved before you can upload files."),void(this.isNewRow=!0)}if(y.needsFieldContext){if(!(k=c))return void this.addError("No image field was specified");g=n.getFieldValue(a,k),v=this.getFileId(y,k,n,a),h=this.getFileName(y,k,n,a);var w=n.getField(k);S=n.accessible&&(m||f)&&(n.updateable&&w.editable||g)}this.canUpload=!1,this.supportsDragAndDrop=b,y.supportsIframeUpload&&y.supportsIframeUpload()?this.canUpload=!0:b&&(this.canUpload=!0),this.fieldValue=g,this.fileId=v,this.fileName=h,this.fileNameOverride=_,this.fieldName=k,this.canCreateOrUpdateImage=S,this.initialized=!0}else this.addError("No record found for file component.");else this.addError("This upload method requires a record context, but could not find one.");else this.addError(skuid.label.merge(I("Error_Could_Not_Find_Upload_Method"),p));else this.addError(skuid.label.merge(I("Error_Invalid_File_Upload_Data_Source"),s))}return n(P,[{key:"addError",value:function(e){this.error=e}},{key:"shouldSaveToField",value:function(){return"field"===this.saveTo}},{key:"getFileId",value:function(e,t,i,n){var o=e.getFileIdField&&e.getFileIdField(t);return i.getFieldValue(n,o)}},{key:"getFileName",value:function(e,t,i,n){var o=e.getFileNameField&&e.getFileNameField(t);return i.getFieldValue(n,o)}},{key:"handleUpload",value:function(){var t=this,i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if("field"===this.saveTo){n.startHook&&n.startHook({fileName:i[0].name});var o=this.model,r=this.row,a=this.field,e=new FileReader;return e.onload=function(e){var t={};t[a]=e.target.result,o.updateRow(r,t),n.endHook&&n.endHook({newFileName:i[0].name})},void e.readAsText(i[0])}if(i.length){var s=void 0;Array.from(i).forEach(function(e){s=s?s.then(function(){return t.uploadFile(e,n)}):t.uploadFile(e,n)})}return!1}},{key:"uploadFile",value:function(e){var t=this,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=skuid.$.Deferred(),o=this.dataSource,r=this.getOptions(),a=this.getComponent(),s=function(e){i.startHook&&i.startHook(e)},u=function(e){i.endHook&&i.endHook(e),e&&e.message?n.reject(e.message):n.resolve()},l=function(e){i.progressHook&&i.progressHook(e)};if(this.enforceMaxFileSize&&e.size>this.maxFileSize){var d=skuid.label.merge(this.defaultMaxFileSizeMessage,e.name,function(t){var e=[{value:"000000000",label:"GB"},{value:"000000",label:"MB"},{value:"000",label:"KB"},{value:"",label:"B"}].find(function(e){return t.endsWith(e.value)});return""+t.substring(0,t.length-e.value.length)+e.label}(""+this.maxFileSize));i.endHook({message:d})}else o.authenticate().then(function(){t.uploadMethod.upload(e,a,r,s,u,l)},function(e){i.endHook({message:e})});return n.promise()}},{key:"uploadFinished",value:function(e){var n=this,o=void 0,t=e&&(e.newFileId||e.newAttachmentId),i=new Date;this.cacheBuster=i.getTime(),e&&e.newFileName&&this.uploadMethod.needsFieldContext&&(this.fileName=e.newFileName),t&&(this.fileId=t,this.fieldValue=e.newFieldValue||e.newImageId,this.syncModel()),e&&e.message?(this.fileId&&this.fileName&&"image"===this.displayAs&&!this.fileId&&this.fileName&&(this.fileName=""),this.uploadFailureActions&&skuid.actions.runActionsNode(this.uploadFailureActions,this,{model:this.model,row:this.row,$Error:{Message:e.message}})):(this.uploadMethod.needsFieldContext||this.uploadMethod.canRunPostUploadSnippet&&this.snippetName&&skuid.snippet.get(this.snippetName)(e),this.uploadMethod.relatedObjectName&&this.autoRefreshModelsOnUpload&&(o=[],skuid.model.list().forEach(function(e){var t=e.objectName===n.uploadMethod.relatedObjectName,i=e.dataSource===n.uploadMethod.dataSource;t&&i&&(o.push(e),e.cancel())}),skuid.model.updateData(o)),this.uploadSuccessActions&&skuid.actions.runActionsNode(this.uploadSuccessActions,this,{model:this.model,row:this.row,apiExtensions:{$Result:{body:e&&e.body?e.body:{}}}}))}},{key:"deleteFile",value:function(){var t=this,i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=function(e){e&&e.message||(t.fileId=null,t.fileName=null,t.fieldValue=null,t.syncModel()),i.endHook&&i.endHook(e)};this.dataSource.authenticate().then(function(){return i.startHook&&i.startHook(),t.uploadMethod.deleteFile({context:{model:t.model,row:t.row},component:t.getComponent(),dataSource:t.uploadMethod.dataSource})}).then(n).catch(function(e){return n({message:e})})}},{key:"syncModel",value:function(){var e={},t=this.model,i=this.row,n={},o=this.uploadMethod,r=o.getFileIdField&&o.getFileIdField(this.fieldName),a=o.getFileNameField&&o.getFileNameField(this.fieldName),s={};t&&i&&(e[t.getRowId(i)]=n,this.fieldName&&(this.fieldValue===i[this.fieldName]&&this.fileId===t.getFieldValue(i,r,!0)||(n[this.fieldName]=this.fieldValue),N.setObjectProperty(s,r,this.fileId),N.setObjectProperty(s,a,this.fileName),this.fieldValue?(C.each(s,function(e,t){n[e]=t}),C.extend(i,n)):(delete i[this.fieldName],C.each(s,function(e){return delete i[e]})),N.size(n)&&t.notifyFieldsOfChange(e,{initiatorId:this._GUID})))}},{key:"getComponent",value:function(){return{model:this.model,row:this.row,ownerIdField:this.ownerIdField,fieldValue:this.fieldValue,fieldName:this.fieldName,fileId:this.fileId,fileName:this.fileName,options:this.getOptions()}}},{key:"getOptions",value:function(){return{filename:this.fileName,fileNameOverride:this.fileNameOverride,description:this.description,storeAs:this.storeAs,saveTo:this.saveTo,uploadMethod:this.uploadMethod,field:this.field,saveToModel:this.model&&this.model.id,model:this.model,row:this.row,displayAs:this.displayAs,autoRefreshModelsOnUpload:this.autoRefreshModelsOnUpload,idField:this.idField,deletable:this.deletable,editable:this.editable,_GUID:this._GUID,cacheBuster:this.cacheBuster,xmlDef:this.xmlDef}}},{key:"deletable",get:function(){return this._deletable}},{key:"deleteable",get:function(){return this._deletable}}],[{key:"getRow",value:function(e,t,i){var n=void 0;return e&&e.data&&(n=i&&i.length?e.getRows(i,t):t&&e&&t.model&&t.row&&t.model===e?[t.row]:e.getRows(null,t)),n&&n.length?n[0]:null}}]),P}();t.default=r},7:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=function(){function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}}(),s=function e(t,i,n){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,i);if(void 0===o){var r=Object.getPrototypeOf(t);return null===r?void 0:e(r,i,n)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(n):void 0},r=i(4),u=(n=r)&&n.__esModule?n:{default:n};var l=skuid.$,d=skuid.utils,c=skuid.constants.LOG_LEVELS,a=function(e){function a(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e,t))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(a,u.default),o(a,[{key:"instantiateUploader",value:function(){this.shouldUseLightningUploader()||s(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"instantiateUploader",this).call(this)}},{key:"initialSetup",value:function(){if(this.shouldUseLightningUploader()){var o=this,e=o.fileController,t=o.elem,i=e.model,n=e.row,r=e.component.getParentPage({root:!0});o._lightningComponent&&(o._lightningComponent.destroy(),o._lightningComponent=void 0),o.destroyFlag=!1,l.when().then(function(){return t.empty(),r.teleportLightningComponent("lightning:fileUpload",{label:o.buttonText,recordId:a.getRecordIdForLightningFileUpload(i,n),onuploadfinished:function(e,t){var i=t.getParam("files"),n=!0;i.length&&0<i.length?i.forEach(function(e){e.documentId||(n=!1)}):n=!1,n?o.fileController.uploadFinished():o.fileController.uploadFinished({message:"Error uploading file."})}},t)}).then(function(e){o._lightningComponent=e,!0===o.destroyFlag&&(o._lightningComponent.destroy(),o.destroyFlag=!1)}).catch(function(e){d.log(e,c.WARNING),t.text("Error generating Lightning File component")})}else s(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"initialSetup",this).call(this)}},{key:"draw",value:function(){this.shouldUseLightningUploader()||s(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"draw",this).call(this)}},{key:"unregister",value:function(){s(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"unregister",this).call(this),this.shouldUseLightningUploader()&&(this._lightningComponent?(this._lightningComponent.destroy(),this.destroyFlag=!1):this.destroyFlag=!0)}},{key:"shouldUseLightningUploader",value:function(){if(void 0!==this.useLightningUploader)return this.useLightningUploader;var e=this.fileController.xmlDef,t=!(!e||"true"!==e.attr("uselightninguploader")),i=!(!e||!e.parents("popup").length);return this.useLightningUploader=!(!(this.uploadMethod&&this.uploadMethod.supportsLightningUploader&&d.inPlatform(skuid.constants.LIGHTNING)&&t)||i)}}],[{key:"getRecordIdForLightningFileUpload",value:function(e,t){return e&&t?e.getRowId(t):d.userInfo.userId}}]),a}();t.default=a},9:function(e,t,i){"use strict";!function(p){var f,m,h,_=p.$,e=p.sfdc.weblink={};function g(e){e&&(e instanceof Array?e.length&&_.each(e,function(){f.push(this)}):f.push(this))}function v(e){return e in m}function t(){f=[],m={},h={}}t(),e.get=function t(e){var i,n,o=e.weblinkName,r=e.objectName,a=e.namespacePrefix,s=e.callback,u=_.Deferred();if(o&&r&&_.each(f,function(e,t){if(t.Name===o&&t.PageOrSobjectType===r){if(a===t.NamespacePrefix)return n=t,!1;t.NamespacePrefix&&(i=t)}}),!n&&i&&(n=i),n||!0===e.didQuery||v(r))u.resolve(),s&&s(n);else{var l,d=h[r],c=!1;d||(d=h[r]=[],c=!0),d.push(e),l={objectNames:[r]},p.page.language&&(l.languages=[p.page.language]),c&&p.remote.promisify(p.remote(),"getWeblinks",JSON.stringify(l)).then(function(e){m[r]=1,e&&e.length&&g(e),d.forEach(function(e){e.didQuery=!0,t(e)}),delete h[r]}).catch(function(){u.resolve(),d.length&&d.forEach(function(e){e.callback&&e.callback(null)}),delete h[r]})}return u},e.getLabel=function(e){var t=e.Localization;return t&&t.records?t.records[0].Value:e.MasterLabel},e.getAllForObject=function(e){var t=[];return f.length&&_.each(f,function(){this.PageOrSobjectType===e&&t.push(this)}),t},e.add=g,e.haveQueriedForObject=v,e.resetCaches=t}(skuid)}});