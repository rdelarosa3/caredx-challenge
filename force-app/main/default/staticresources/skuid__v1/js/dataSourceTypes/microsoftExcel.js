!function(t){var l={};function r(e){if(l[e])return l[e].exports;var a=l[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=l,r.d=function(e,a,t){r.o(e,a)||Object.defineProperty(e,a,{enumerable:!0,get:t})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(a,e){if(1&e&&(a=r(a)),8&e)return a;if(4&e&&"object"==typeof a&&a&&a.__esModule)return a;var t=Object.create(null);if(r.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:a}),2&e&&"string"!=typeof a)for(var l in a)r.d(t,l,function(e){return a[e]}.bind(null,l));return t},r.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(a,"a",a),a},r.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)},r.p="",r(r.s=364)}({364:function(e,a,t){"use strict";var b,l,x,r,i,s,o,c,p,n,d,u,f,y,m,E,h,v,k,g,w,A,S,T,C,O,N,D,R,I,M,H,P,q,B,L,F,_,U=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l])}return e};function j(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}b=skuid,x=b.utils,r=b.dataSource,i=b.constants,s=r.utils,o=b.ui.getFieldRenderer,c="https://graph.microsoft.com/v1.0",p=i.ALPHABET,n=i.DISPLAY_TYPES,d=i.MIME_TYPES,u=i.HTTP_VERBS,f="MicrosoftExcel",y="x-metadata",m=d.JSON,E="Workbook",h="Worksheet",k="Table",w="Chart",A=[v="Range",g="TableRange"],S=n.DATE,T=n.DATETIME,C=n.NUMBER,O=n.OBJECT,N=n.STRING,D=n.BOOLEAN,R=n.FORMULA,I=n.TEXT,M=u.GET,H=u.POST,P=u.PATCH,q=u.DELETE,B=s.getModelMergeConditions,L={urlEncode:!1},F=function(e,a,t){e.picklistEntries.forEach(function(e){t===e.value&&e.arg&&a.push(e.arg)})},_=function(e,a){var t=e.attr("workbook"),l=b.$M(x.mergeAsDataInContext(e.attr("model"),a));return t||l.getFirstRow().id},r.getDataSourceType(f)||new r.core.RESTDataSourceTypeBase({name:f,coerceRequest:function(e){var a=e.type,t=e.model,l=e.row,r=B(t,e,L),i=this.getEntityMetadataCacheKey(t),s=r.file,o=r.worksheet,n=r.parent,d=l&&l._rowRange,u=l&&l._formulas;if("query"===a)i===E&&(n?-1!==n.indexOf(".")?e.request=U({},e.request,{url:"/me/drive/root:"+n,pathToContent:""}):e.request=U({},e.request,{url:"/"===n?"/me/drive/root/children":"/me/drive/root:"+n+":/children",pathToContent:"value"}):e.request=U({},e.request,{url:"/me/drive/root/children",pathToContent:"value"}));else if("update"===a&&A.includes(i)){var c=[];b.$.each(e.request.data,function(e,a){return u[e]=a}),b.$.each(u,function(e,a){return c.push(a)}),e.request=U({},e.request,{data:{formulas:[c]},url:"/me/drive/items/"+s+"/workbook/worksheets('"+o+"')/range(address='"+d+"')"})}e.request=U({},e.request,{headers:{Accept:m,"Content-Type":m,"Content-Length":0}})},parseSuccessfulLoadResponse:function(e,a,t,l,r){var i=this.parseResponseBodyAsJSON(e.body),o="true"===B(l,{model:l},L).hasHeader,s=a.pathToContent,n=this.getEntityMetadataCacheKey(l),d=function(e,a,t){return U({},e,{createdByUserName:x.getObjectProperty(a,"createdBy.user.displayName"),lastModifiedByUserName:x.getObjectProperty(a,"lastModifiedBy.user.displayName"),oneUp:t.substring(0,t.lastIndexOf("/")),parentDirectory:t})},u=[],c=s?x.getObjectProperty(i,s):i;if(n===E){if(Array.isArray(c.value))c.value.forEach(function(e,a){var t=e.name.split(".").slice(-1)[0],l=e.parentReference.path,r=l?l.split(":")[1]:e.parentReference.id;-1===t.indexOf("xlsx")?delete c[a]:u.push(d(e,c,r))}),c=u;else if(x.isObject(c)){var b=c.parentReference.path,p=b?b.split(":")[1]:c.parentReference.id;c=[d(c,c,p)]}}else if(A.includes(n)){var f=i.formulas,y=i.values,m=i.text,h=i.address.split("!")[1],v=h.split(":"),k=[],g=[],w=[],S=0,T=0,C=void 0;o?(w=c[0],c.shift()):(r.sort(function(e,a){return e.column-a.column}),r.forEach(function(e){return w.push(e.label)})),v.forEach(function(e,a){g[a]=e.replace(/[^0-9]/,""),k[a]=e.replace(/[0-9]/g,"")}),y.forEach(function(e,t){var l=o?f[t+1]:f[t],r=o?m[t+1]:m[t],i={},s={};0===T&&(C=parseInt(g[0],10)),o&&0===T&&(C+=1),S!==t&&(C+=1),e.forEach(function(e,a){i[w[a].replace(/ /g,"").trim()]=l[a],s[w[a].replace(/ /g,"").trim()]=r[a]});var a=-1===h.indexOf(":")?k[0]+C:""+k[0]+C+":"+k[1]+C;u[t]={_rowRange:a,_formulas:i,_text:s},e.forEach(function(e,a){return u[t][w[a].replace(/ /g,"")]=e}),S!==t&&(S=t),T=1}),c=u}return c},parseSuccessfulSaveResponse:function(e,a){var t=x.parseAsJSONIfString(e.body),l=a.model,r=l.fields;if(A.includes(l.objectName)){var i={_formulas:{},_text:{},_rowRange:t.address.split("!")[1]};return r.sort(function(e,a){return e.column-a.column}),r.forEach(function(e){var a=e.column;i[e.id]=t.values[0][a],i._formulas[e.id]=t.formulas[0][a],i._text[e.id]=t.text[0][a]}),i}},queryEntityMetadata:function(e){var t=this,a=this.getEntityMetadataCacheKey(e),r=this.prop(y)[a],l=r.methods.query,i={type:"query",method:l,model:e,request:{url:l.url,method:l.verb,contentType:l.contentType,headers:{Accept:m}}},s=e.conditions?B(e,i,L):{},o="true"===s.hasHeader,n=[],d=[],u=function(e){e.split(":").forEach(function(e,a){n[a]=e.replace(/[0-9]/g,""),d[a]=e.replace(/[^0-9]/,"")});for(var a=p.indexOf(n[0].toUpperCase()),t=p.indexOf(n[1].toUpperCase())-a,l=0;l<=t;l++)r.fields[l]={id:"Column"+p[a],label:"Column "+p[a],column:l,displaytype:R,accessible:!0,createable:!1,editable:!0,"x-alwaysinclude":!0},a++};if(A.includes(a)&&x.size(s))if(b.builder)u(s.range||"");else if(!x.isString(e))return this.makeRequest(e,i).then(function(e){var a=t.parseResponseBodyAsJSON(e.body);return u(a.address.split("!")[1]),o&&(r.fields=a.values[0].map(function(e){return{label:e}})),r});return x.resolve(r)},createActions:function(a,e){var t=(2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}).component,i=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return b.ajax.direct({url:e.url,headers:{Authorization:"Bearer "+a.authentication.responseBody.access_token,"Content-Type":m,Accept:m},method:H,dataType:"json",data:JSON.stringify(e.body)}).then(function(e){return{$Excel:e}}).catch(function(e){throw e})},l={label:"Number",id:"arg1",name:"number",type:"string",valueType:"number"},r={label:v,id:"arg1",name:"range",type:"string",valueType:"range"},s={label:"Workbook ID",id:"workbook",type:"text"},o=[{value:"abs",label:"ABS()",arg:l},{value:"acos",label:"ACOS()",arg:l},{value:"acosh",label:"ACOSH()",arg:l},{value:"acot",label:"ACOT()",arg:l},{value:"acoth",label:"ACOTH()",arg:l},{value:"asin",label:"ASIN()",arg:l},{value:"asinh",label:"ASINH()",arg:l},{value:"atan",label:"ATAN()",arg:l},{value:"atanh",label:"ATANH()",arg:l},{value:"average",label:"AVERAGE()",arg:r},{value:"cos",label:"COS()",arg:l},{value:"cosh",label:"COSH()",arg:l},{value:"cot",label:"COT()",arg:l},{value:"coth",label:"COTH()",arg:l},{value:"csc",label:"CSC()",arg:l},{value:"csch",label:"CSCH()",arg:l},{value:"max",label:"MAX()",arg:r},{value:"median",label:"MEDIAN()",arg:r},{value:"min",label:"MIN()",arg:r},{value:"mode",label:"MODE()",arg:r},{value:"pi",label:"PI()"},{value:"sin",label:"SIN()",arg:l},{value:"sinh",label:"SINH()",arg:l},{value:"sqrt",label:"SQRT()",arg:l},{value:"sqrtpi",label:"SQRTPI()"},{value:"sum",label:"SUM()",arg:r},{value:"round",label:"ROUND()",arg:l},{value:"rounddown",label:"ROUNDDOWN()",arg:l},{value:"roundup",label:"ROUNDUP()",arg:l}],n=void 0,d=void 0,u=void 0;return b.builder&&(d=[s,{label:v,id:"range",name:"range",type:"string"},{label:"Has Headers",id:"headers",type:"boolean"}],u=[s,{label:h+" Name or ID",id:"worksheet",type:"text"},{label:w+" Type",id:"charttype",type:"picklist",picklistEntries:[{value:"ColumnClustered",label:"Clustered Column"},{value:"ColumnStacked",label:"Stacked Column"},{value:"ColumnStacked100",label:"100% Stacked Column"},{value:"Line",label:"Line"},{value:"LineStacked",label:"Stacked Line"},{value:"LineStacked100",label:"100% Stacked Line"},{value:"LineMarkers",label:"Line with Markers"},{value:"LineMarkersStacked",label:"Stacked Line with Markers"},{value:"LineMarkersStacked100",label:"100% Stacked Line with Markers"},{value:"PieOfPie",label:"Pie"},{value:"Doughnut",label:"Doughnut"},{value:"BarClustered",label:"Clustered Bar"},{value:"BarStacked",label:"Stacked Bar"},{value:"BarStacked100",label:"100% Stacked Bar"},{value:"Area",label:"Area"},{value:"AreaStacked",label:"Stacked Area"},{value:"AreaStacked100",label:"100% Stacked Area"},{value:"XYScatter",label:"Scatter with only Markers"},{value:"XYScatterSmooth",label:"Scatter with Smooth Lines and Markers"},{value:"XYScatterSmoothNoMarkers",label:"Scatter with Smooth Lines"},{value:"XYScatterLines",label:"Scatter with Straight Lines and Markers"},{value:"XYScatterLinesNoMarkers",label:"Scatter with Straight Lines"},{value:"Radar",label:"Radar"},{value:"RadarFilled",label:"Filled Radar"},{value:"RadarMarkers",label:"Radar with Markers"}]},{label:"Source Data",id:"sourcedata",type:"text"},{label:w+" Series By",id:"seriesby",type:"picklist",defaultValue:"Auto",picklistEntries:[{value:"Auto",label:"Auto"},{value:"Columns",label:"Columns"},{value:"Rows",label:"Rows"}]}],F((n=[s,{label:"Function Name",id:"function",type:"picklist",picklistEntries:o,onChange:function(e){n.splice(2),F(this,n,e),t.rebuildProps()}}])[1],n,e.attr("function"))),{function:{label:"Excel Function",builderProps:n||"",runtimeExecution:function(l,e,a,t){var r={};return o.forEach(function(e){if(e.value===l.attr("function")&&e.arg){var a=e.arg,t=l.attr(a.id);"number"===a.valueType?r[a.name]=t:"range"===a.valueType&&(r.values=[],-1<t.indexOf(",")?t.split(",").forEach(function(e){e.match(/[a-z]/i)?r.values.push({address:e}):r.values.push(e)}):r.values.push({address:t}))}}),i({url:c+"/me/drive/items/"+_(l,a)+"/workbook/functions/"+l.attr("function"),body:r,ds:t})}},"create-table":{label:"Create Excel "+k,builderProps:d||"",runtimeExecution:function(e,a,t,l){return i({url:c+"/me/drive/items/"+_(e,t)+"/workbook/tables/add",body:{address:e.attr("range"),hasHeaders:"true"===e.attr("headers")},ds:l})}},"create-chart":{label:"Create "+w,builderProps:u||"",runtimeExecution:function(e,a,t,l){return i({url:c+"/me/drive/items/"+_(e,t)+"/workbook/worksheets('"+e.attr("worksheet")+"')/charts/add",body:{type:e.attr("charttype"),sourceData:e.attr("sourcedata"),seriesBy:e.attr("seriesby")},ds:l})}}}},getActions:s.getActionsStatic,getEntityList:s.getEntityListStatic,fieldRenderers:function(){var e;return j(e={},S,{read:function(e){o(S).read(e,new Date(e.row._text[e.id]))},readonly:function(e){o(S).readonly(e,new Date(e.row._text[e.id]))},edit:function(e){o(S).edit(e,new Date(e.row._text[e.id]))}}),j(e,T,{read:function(e){o(T).read(e,new Date(e.row._text[e.id]))},readonly:function(e){o(T).readonly(e,new Date(e.row._text[e.id]))},edit:function(e){o(T).edit(e,e.row._text[e.id])}}),j(e,R,{read:function(e,a){o(I).read(e,a)},readonly:function(e,a){o(I).readonly(e,a)},edit:function(e){o(I).edit(e,e.row._formulas[e.id])}}),e},extendedProperties:j({composer:{unomittableFields:!0,hasEntityOptions:!0},validConditionTypes:["fieldvalue","multiple","param","boolean","modelmerge"],canFieldsBeIndividuallySearched:!0,canServerSearch:!0},y,(l={},j(l,E,{idFields:["id"],nameField:"name",label:E,labelPlural:"Workbooks",fields:[{id:"id",label:"Id",displaytype:N,inlineHelpText:"Identifier of the drive.",accessible:!0,createable:!1,editable:!1,"x-alwaysinclude":!0},{id:"name",label:"Name",displaytype:N,inlineHelpText:"Name of the drive.",accessible:!0,createable:!1,editable:!0},{id:"createdByUserName",label:"Created By",displaytype:N,accessible:!0,createable:!1,editable:!1},{id:"createdDateTime",label:"Created Date Time",displaytype:T,accessible:!0,createable:!1,editable:!1},{id:"lastModifiedByUserName",label:"Last Modified By",displaytype:N,accessible:!0,createable:!1,editable:!1},{id:"lastModifiedDateTime",label:"Last Modified",displaytype:T,accessible:!0,createable:!1,editable:!1},{id:"webUrl",label:"Web Url",displaytype:N,accessible:!0,createable:!1,editable:!1},{id:"parentReference",label:"Parent Reference",displaytype:O,accessible:!1,createable:!1,editable:!1},{id:"size",label:"Size",displaytype:C,accessible:!0,createable:!1,editable:!1},{id:"parentDirectory",label:"Parent Directory",displaytype:N,accessible:!0,createable:!1,editable:!0},{id:"oneUp",label:"Directory Up",displaytype:N,accessible:!0,createable:!1,editable:!1}],methods:{query:{url:"",verb:M,contentType:m,pathToContent:""}},defaultConditions:[{sourcetype:"param",sourceparam:"parent",name:"parent",label:"Path to Folder or File",state:"filterableon",value:""}]}),j(l,h,{idFields:["id"],nameField:"name",label:h,labelPlural:h+"s",fields:[{id:"id",label:"Id",displaytype:N,inlineHelpText:"Identifier of the worksheet.",accessible:!0,createable:!1,editable:!1,"x-alwaysinclude":!0},{id:"name",label:"Name",displaytype:N,inlineHelpText:"Name of the worksheet.",accessible:!0,createable:!0,editable:!0,"x-alwaysinclude":!0},{id:"position",label:"Position",displaytype:C,inlineHelpText:"Position of the worksheet in the workbook.",accessible:!0,createable:!1,editable:!0,"x-alwaysinclude":!0},{id:"visibility",label:"Visibility",displaytype:N,inlineHelpText:"Whether the worksheet is visible.",accessible:!0,createable:!1,editable:!0,"x-alwaysinclude":!0}],methods:{query:{url:"/me/drive/items/{{file}}/workbook/worksheets",verb:M,contentType:m,pathToContent:"value"},insert:{url:"/me/drive/items/{{file}}/workbook/worksheets/add",verb:H,contentType:m,receiveDataAs:"recordinbody",successIf:"responsefieldequals",successField:"status",successValue:"Created"},update:{url:"/me/drive/items/{{file}}/workbook/worksheets('{{id}}')",verb:P,contentType:m,receiveDataAs:"recordinbody",successIf:"responsefieldispresent"},delete:{url:"/me/drive/items/{{file}}/workbook/worksheets('{{id}}')",verb:q,contentType:m,successIf:"responsefieldisempty"}},defaultConditions:[{sourcetype:"param",sourceparam:"file",name:"file",label:"File ID",state:"filterableon",type:"fieldvalue",required:!0,value:""}]}),j(l,v,{label:v,labelPlural:v+"s",fields:[],methods:{query:{url:"/me/drive/items/{{file}}/workbook/worksheets('{{worksheet}}')/range(address='{{range}}')",verb:M,contentType:m,pathToContent:"values"},update:{url:"",verb:P,contentType:m,pathToContent:""}},defaultConditions:[{sourcetype:"param",sourceparam:"file",name:"file",label:"File ID",state:"filterableon",type:"fieldvalue",required:!0,value:""},{sourcetype:"param",sourceparam:"worksheet",name:"worksheet",label:h+" Name or ID",state:"filterableon",type:"fieldvalue",required:!0,value:""},{sourcetype:"param",sourceparam:"range",name:"range",label:"Cell "+v,state:"filterableon",type:"fieldvalue",value:""},{sourcetype:"param",sourceparam:"hasHeader",name:"hasHeader",label:"Has Headers",state:"fixed",type:"boolean",required:!0,value:!1}]}),j(l,k,{idFields:["id"],nameField:"name",label:k,labelPlural:k+"s",fields:[{id:"id",label:"Id",displaytype:N,inlineHelpText:"Identifier of the table.",accessible:!0,createable:!1,editable:!1,"x-alwaysinclude":!0},{id:"name",label:"Name",displaytype:N,inlineHelpText:"Name of the table.",accessible:!0,createable:!0,editable:!0},{id:"highlightFirstColumn",label:"Highlight First Column",displaytype:D,accessible:!0,createable:!0,editable:!0},{id:"highlightLastColumn",label:"Highlight Last Column",displaytype:D,accessible:!0,createable:!0,editable:!0},{id:"showBandedColumns",label:"Show Banded Columns",displaytype:D,accessible:!0,createable:!0,editable:!0},{id:"showBandedRows",label:"Show Banded Rows",accessible:!0,createable:!0,editable:!0},{id:"showFilterButton",label:"Show Filter Button",accessible:!0,createable:!0,editable:!0},{id:"showHeaders",label:"Show Headers",accessible:!0,createable:!0,editable:!0},{id:"showTotals",label:"Show Totals",accessible:!0,createable:!0,editable:!0},{id:"style",label:k+" Style",accessible:!0,createable:!0,editable:!0}],methods:{query:{url:"/me/drive/items/{{file}}/workbook/worksheets('{{worksheet}}')/tables",verb:M,contentType:m,pathToContent:"value"},update:{url:"/me/drive/items/{{file}}/workbook/worksheets('{{worksheet}}')/tables('{{id}}')",verb:P,contentType:m}},defaultConditions:[{sourcetype:"param",sourceparam:"file",name:"file",label:"File ID",state:"filterableon",type:"fieldvalue",required:!0,value:""},{sourcetype:"param",sourceparam:"worksheet",name:"worksheet",label:h+" Name or ID",state:"filterableon",type:"fieldvalue",required:!0,value:""}]}),j(l,g,{label:g,labelPlural:g+"s",fields:[],methods:{query:{url:"/me/drive/items/{{file}}/workbook/tables('{{table}}')/Range",verb:M,contentType:m,pathToContent:"values"},update:{url:"",verb:P,contentType:m,pathToContent:""}},defaultConditions:[{sourcetype:"param",sourceparam:"file",name:"file",label:"File ID",state:"filterableon",type:"fieldvalue",required:!0,value:""},{sourcetype:"param",sourceparam:"worksheet",name:"worksheet",label:h+" Name or ID",state:"filterableon",type:"fieldvalue",value:""},{sourcetype:"param",sourceparam:"table",name:"table",label:k+" Name or ID",state:"filterableon",type:"fieldvalue",required:!0,value:""},{sourcetype:"param",sourceparam:"hasHeader",name:"hasHeader",label:"Has Headers",state:"fixed",type:"boolean",required:!0,value:!0}]}),j(l,w,{idFields:["id"],nameField:"name",label:w,labelPlural:w+"s",fields:[{id:"id",label:"Id",displaytype:N,inlineHelpText:"Identifier of the chart.",accessible:!0,createable:!1,editable:!1,"x-alwaysinclude":!0},{id:"name",label:"Name",displaytype:N,inlineHelpText:"Name of the chart.",accessible:!0,createable:!0,editable:!0},{id:"height",label:"Height",displaytype:C,accessible:!0,createable:!1,editable:!1},{id:"width",label:"Width",displaytype:C,accessible:!0,createable:!1,editable:!1},{id:"top",label:"Top",displaytype:C,accessible:!0,createable:!1,editable:!1},{id:"left",label:"Left",displaytype:C,accessible:!0,createable:!1,editable:!1}],methods:{query:{url:"/me/drive/items/{{file}}/workbook/worksheets('{{worksheet}}')/charts",verb:M,contentType:m,pathToContent:"value"},update:{url:"/me/drive/items/{{file}}/workbook/worksheets('{{worksheet}}')/charts('{{name}}')",verb:P,contentTYpe:m},delete:{url:"/me/drive/items/{{file}}/workbook/charts('{{name}}')/delete",verb:H,contentType:m,successIf:"responsebodyisempty"}},defaultConditions:[{sourcetype:"param",sourceparam:"file",name:"file",label:"File ID",state:"filterableon",type:"fieldvalue",required:!0,value:""},{sourcetype:"param",sourceparam:"worksheet",name:"worksheet",label:h+" Name or ID",state:"filterableon",type:"fieldvalue",value:""}]}),l))})}});