!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=215)}([function(e){e.exports={date:"1534254252473",id:"v1",major:11,minor:4,patch:0,number:"11.4.0",name:"Millau (11.4.0)",path:"v1"}},,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,[{key:"refreshAPIToken",value:function(){var e=this;return skuid.platform.services.getToken().then(function(t){var n=t.token,i=e.extractJWTPayload(n).exp;return e.apiToken={expiration:i,jwt:n}})}},{key:"extractJWTPayload",value:function(e){var t=e.split(".");if(3!=t.length)throw new Error("JWT not formatted correctly");return JSON.parse(atob(t[1]))}},{key:"getAPIToken",value:function(){var e=this.apiToken;return e&&this.isValid(e)?skuid.utils.resolve(e):this.refreshAPIToken()}},{key:"isValid",value:function(e){var t=void 0;return(t=skuid.utils.isString(e)?this.extractJWTPayload(e).exp:e.expiration)&&t>Date.now()/1e3}}]),e}();t.default=new r},,,,,,,,,,,,function(e,t,n){"use strict";var i,r,o,a,s;skuid,i=skuid.$,r=i(document.body),o=skuid.utils,a=function(e){return" sk-pagepanel-"+e},s=function(e){return" nx-page-withpanels-"+e},skuid.componentType.register("panel",function(e,t,n){var l=n.context,c="true"===t.attr("closeonpageclick"),d=i('<div class="nx-page-clickcatcher">'),u=t.attr("uniqueid"),f=t.children("interactions").first(),p=n.origin=t.attr("origin")||"left",h=n.getParentPage(),g=n.behavior=t.attr("behavior")||"overlay",m="left"===n.origin||"right"===n.origin,v=!m;n.size=t.attr("size")||"270px",n._open=!1,e.addClass("sk-pagepanel"+a(g)+a(p));var y={};y["overflow-"+(v?"x":"y")]=o._oniOS()?"scroll":"auto",y[v?"height":"width"]=n.size,e.css(y),n.createChildComponents(t.find("components").first().children(),e,l),f.length&&skuid.interactions.enableInteractions(e,{interactionsDef:f,component:n,context:l}),n.toggle=function(e){if(e!==n._open){var t,l=n.behavior,u=h.getContentElement(),f=h.getElement(),g=n.element,y=g[v?"outerHeight":"outerWidth"](!0)+"px",b="reveal"===l?u:f,w="right"===n.origin||"bottom"===n.origin?"-":"",S=v?"0,"+w+y+",0":w+y+",0,0";e=void 0!==e?e:!n._open,g[e?"addClass":"removeClass"](a("open")),"overlay"!==l&&"reveal"!==l||(g.addClass(a("animatable")),g.one("transitionend.skuid",function(){g.removeClass(a("animatable"))})),"reveal"!==l&&"push"!==l||(e?(i.each(h.panel.getAll(),function(e,t){t.id()!==n.id()&&t.close()}),(m||"push"===l)&&(t=r.scrollTop(),b.one("transitionend.skuid",function(){u.scrollTop(t)}))):t=u.scrollTop(),u.toggleClass(s("pushed"),e),e?(f.addClass("nx-page-withpanels "+s(p)),u.scrollTop(t),o._oniOS()&&u.css("overflow","scroll"),g.css("opacity",""),m?r.css("overflow-x","hidden"):(u["top"===n.origin?"append":"prepend"]('<div class="sk-slidingpanelhelper" style="height: '+y+'">'),"top"!==n.origin&&y&&u.scrollTop(u.scrollTop()+parseFloat(y)))):((m||"push"===l)&&(r.scrollTop(t),m||g.css({top:t+"px","z-index":1})),b.one("transitionend.skuid",function(){n._open||(g.css({opacity:0,top:"","z-index":""}),i.each(h.panel.getAll(),function(e,t){return"overlay"===t.behavior||"reveal"===t.behavior}),f.removeClass("nx-page-withpanels "+s(p)),o._oniOS()&&u.css("overflow",""))}),m?b.one("transitionend.skuid",function(){n._open||r.css("overflow-x","")}):i(".sk-slidingpanelhelper").remove()),e?(b.css("transform","translate3d("+S+")"),g.css("z-index","")):(b.css("transform",""),b.one("transitionend.skuid",function(){n._open||g.css("z-index","-100")}))),e?c&&(u.append(d),b.one("transitionend.skuid",function(){n._open&&d.one("click.skuid",function(){d.remove(),n.close()})})):d.remove(),n._open=e}},n.close=function(){n.toggle(!1)},n.open=function(){n.toggle(!0)},n.isOpen=function(){return n._open},n.unregister=function(){skuid.component.Component.prototype.unregister.call(n),h.panel._detachById(u)},n.updateContext=function(i){var r=t.children("interactions").first();e.empty(),n.unregisterChildComponents(),n.createChildComponents(t.find("components").first().children(),e,i),r.length&&(skuid.interactions.disableInteractions(e),skuid.interactions.enableInteractions(e,{interactionsDef:r,component:n,context:i})),n.context=i},setTimeout(function(){n.toggle(!0)},0)})},,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";!function(e){var t=e.$,n={},i=e.utils;t.extend(n,{init:function(){if(!window.cordova.skuidPush)return i.resolve();var r=new window.cordova.skuidPush.Push,o=i.userInfo;return r.requestPermission().then(function(){return r.init().then(function(e){n.deviceToken=e.deviceToken,n.type=i.lowercase(e.type)}).then(function(){return o.userId?function(n){var i=e.data.sessionStorage,r=i.getItem("activeUserTimeLogged"),o=i.getItem("loggedActiveUser"),a=!1;if(r&&o)if(n.userId!==o)a=!0;else{var s=Math.round((new Date).getTime()/1e3);Math.round(new Date(r).getTime()/1e3)<s-86400&&(a=!0)}else a=!0;return a?e.ajax.direct({method:"POST",url:"/api/v1/native-service/public-proxy/apps/"+n.appId+"/active-users",contentType:"application/json",headers:{"skuid-organization":n.organizationId},body:n}).then(function(e){return i.setItem("activeUserTimeLogged",(new Date).toString()),i.setItem("loggedActiveUser",n.userId),e}):t.when()}({deviceToken:n.deviceToken,appId:e.native.preferences.skuidappid,userId:o.userId,serviceType:n.type,organizationId:o.organizationId}):t.when()})}).catch(function(e){console.error(e)})},sendNotifications:function(t,n){t=t||e.native.preferences.skuidappid;var i=e.utils.userInfo.organizationId;return e.ajax.direct({method:"POST",url:"/api/v1/native-service/"+t+"/send-messages",contentType:"application/json",headers:{"skuid-organization":i},body:n})}}),e.native.push=n}(window.skuid)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFileNameForPage=function(e,t){var n=window.skuid.platform.getEntityFieldName,i=n("page","id"),r=n("page","name"),o=void 0;arguments.length>1?o=e:(o=e[i],t=e[r]);return("skuid_pgsp_"+o+"_"+t).replace(/[^a-zA-Z0-9_]/g,"_").replace(/_+/g,"_").slice(0,50).replace(/_$/,"")}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";!function(e){var t=e.$,n=e.native||(e.native={}),i=n.geo={};function r(e){return e*(Math.PI/180)}function o(e,t,n,i,o){var a=function(e,t,n,i){var o=r(n-e),a=r(i-t),s=Math.sin(o/2)*Math.sin(o/2)+Math.cos(r(e))*Math.cos(r(n))*Math.sin(a/2)*Math.sin(a/2);return 2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s))*6371}(e,t,n,i);return"kilometers"!==o&&o?"miles"===o?.621371*a:"meters"===o?1e3*a:"yards"===o?1093.61*a:void 0:a}function a(){var i=t.Deferred();return e.utils.userInfo.location=e.utils.userInfo.location||{},navigator.geolocation.getCurrentPosition(function(r){var a=r.coords,s=Math.round(1e4*a.latitude)/1e4,l=Math.round(1e4*a.longitude)/1e4,c=e.utils.userInfo.location.latitude,d=e.utils.userInfo.location.longitude;if((c||d||0===c&&0===d)&&o(s,l,c,d,"meters")<4.9)return i.resolve(e.utils.userInfo.location);return e.utils.userInfo.location.latitude=s,e.utils.userInfo.location.longitude=l,function(i,r){if(e.platform.isCordova()){var o=t.Deferred();return n._reverseGeocode(function(e){o.resolve(e.length?e[0]:{})},function(e){o.reject(e)},i,r),o.promise()}return e.native.geoAPI.reverseGeocode(i,r)}(s,l).then(function(n){t.extend(e.utils.userInfo.location,n),e.data.v2.sessionStorage.setItem("user-location",JSON.stringify(e.utils.userInfo.location)),i.resolve(e.utils.userInfo.location)}).catch(function(){i.resolve(e.utils.userInfo.location)})},function(){i.resolve(e.utils.userInfo.location)},{timeout:8e3,enableHighAccuracy:!0}),i.promise()}n.initializeUserLocation=function(){e.utils.userInfo.location={};var n=e.data.v2.sessionStorage.getItem("user-location");return n?(e.utils.userInfo.location=JSON.parse(n),t.when()):a()},i.updateCurrentUserPosition=a,e.utils.runningTests()&&(i._getDistanceBetweenTwoPoints=o)}(window.skuid)},function(e,t,n){"use strict";!function(e){var t=e.$,n=e.native||(e.native={}),i="/api/v1/geolocation/proxy/",r=n.geoAPI={},o={};function a(n){return o[n]?t.when(JSON.parse(JSON.stringify(o[n]))):e.ajax.direct({method:"GET",url:i+n}).then(function(e){if(e.body.error_message)throw console.log(e.body.error_message),e.body.error_message;return e.body.results?(o[n]=e.body.results,e.body.results):(o[n]=e.body,e.body)})}function s(e){return a("geocode/json?"+e)}r.forwardGeocode=function(e){return s("address="+e).then(function(e){var t=e[0].geometry.location;return{latitude:t.lat,longitude:t.lng}})},r.reverseGeocode=function(e,n){return s("latlng="+e+","+n).then(function(e){var n={"route:long_name":"thoroughfare","street_number:long_name":"subThoroughfare","locality:long_name":"locality","administrative_area_level_2:long_name":"subAdministrativeArea","administrative_area_level_1:long_name":"administrativeArea","country:long_name":"countryName","country:short_name":"countryCode","postal_code:long_name":"postalCode"},i={},r=e[0].address_components;return t.each(r,function(e,t){var r=t.types[0];n[r+":long_name"]&&(i[n[r+":long_name"]]=t.long_name),n[r+":short_name"]&&(i[n[r+":short_name"]]=t.short_name)}),i}).catch(function(){return{}})},r.getDrivingDistanceAndTripTimeFromAddresses=function(i,r){var o={};return t.each(i,function(e,t){t.trim()&&(o[t]=1)}),(i=Object.keys(o).sort()).length?(e.utils.userInfo.location?t.when():n.initializeUserLocation()).then(function(){var n=e.utils.userInfo.location;return function(e,t){return a("distancematrix/json?units="+(t=t||"imperial")+(e?"&"+e:""))}("origins="+n.latitude+","+n.longitude+"&destinations="+i.join("|"),r).then(function(e){var n={};return t.each(e.rows[0].elements,function(e,t){var r=i[e];"OK"===t.status&&(n[r]={distance:t.distance,time:t.duration})}),n})}):t.when()}}(window.skuid)},function(e,t,n){"use strict";var i,r=n(45),o=n(0),a=(i=o)&&i.__esModule?i:{default:i};!function(e){var t,n,i,o=!1,s={},l=e.offline,c=e.utils,d=c.parseAsJSONIfString,u="popstate.skuid",f=e.$,p=f.extend,h=c.makeXMLDoc,g=e.$L,m=c.reject,v=c.resolve,y=["apps","features","runningUserInfo"],b="metaService",w="error";function S(e,t,n){this._entry=e,this._process=t,this._dependencies=n,this._isProcessed=!1,this._isBeingProcessed=!1}function C(){return c.inPlatform(e.constants.LIGHTNING)}function I(t,n,i){i||(i=["datasource"]),i.forEach(function(i){var r=t.attr(i)||t.attr("service")||e.platform.getDefaultDataSourceName();n.hasOwnProperty(r)||(n[r]={})})}function k(e,t,n,i){var r=x(e,n,i);if(r&&!t.includes(r))return t.push(r),r}function x(t,n,i){var r;return("skuid"===t.namespace||!t.namespace&&"skuid"===i)&&(r="skuid"),e.utils.isString(t)?t:t.url?t.url:t.resource?e.platform.getSiteResourceUrl({name:t.resource,namespace:r,path:t.path,modstamp:t.modstamp,type:t.type,apiVersion:t.apiVersion}):t.path?e.platform.getSiteResourceUrl({name:n,namespace:r,path:t.path,modstamp:t.modstamp,type:t.type}):void 0}function T(e,t,n){var i=t.jsLoads,r=t.cssLoads,o=C(),a=t.jsDependencyGraph.componentPacks,s=a[n.id],l=n.file,d=l&&l.resource,u=n.namespace||l&&l.namespace,p=l&&l.apiVersion,h=n.customLabelNamespace;!s&&o&&(s=a[n.id]=[]),e.js&&e.js.forEach(function(e){e.type="componentPack",p&&(e.apiVersion=p);var t=k(e,i,d,u);if(t&&o){var n=[];s.push(new S(t,function(){return c.loadJS(t)},n)),s.length>1&&n.push(s[s.length-2])}}),e.css&&e.css.forEach(function(e){e.type="componentPack",p&&(e.apiVersion=p),k(e,r,d,u)}),e.labels&&e.labels.length&&(e.customLabelDependencies||(e.customLabelDependencies=[]),Array.prototype.push.apply(e.customLabelDependencies,e.labels)),e.customLabelDependencies&&f.each(e.customLabelDependencies,function(e,n){t.labelDependencies[function(e,t){return t?t+"__"+e:e}(n,h)]=!0})}function R(t,n,i,r,o){var a=t.prop("tagName"),s=function(t,n,i){var r=F(t,i),o=r[0],a=r[1],s=null,l=(c=o,e.componentPacks[c]);var c;l&&f.each(l.components,function(){if(this.id===a)return E(l,n),s=this,!1});return s}(a,i,r);n.hasOwnProperty(a)||(n[a]={}),s&&(!function(e,t,n){var i,r=t.pathsToDataSourceAttributes;r&&(i=n.dataSourceDependencies,r.forEach(function(t){var n=t.split(":"),r=n[0],o=n[1];(r?e.find(r):e).each(function(e,t){I(f(t),i,[o])})}))}(t,s,i),o||(o=function(t,n){return e.componentPacks[F(t,n)[0]]}(a,r)),T(s,i,o),s.pathsToChildComponents&&f.each(s.pathsToChildComponents,function(){var e=this.split(">"),o=t;f.each(e,function(e,t){o=o.children(t)}),f.each(o.children(),function(){R(f(this),n,i,r)})}),s.pathsToActions&&f.each(s.pathsToActions,function(){var o=this.split(">"),a=t;f.each(o,function(e,t){a=a.children(t)}),f.each(a.children(),function(){!function t(n,i,r,o){var a=n.attr("type");if("popup"===a||"showPopup"===a)f.each(n.children("popup").first().children("components").first().children(),function(){R(f(this),i,r,o)});else if("drawer"===a)f.each(n.children("drawer").first().children("components").first().children(),function(){R(f(this),i,r,o)});else if("toggleSlidingPanel"===a||"openSlidingPanel"===a)f.each(n.children("panel").first().children("components").first().children(),function(){R(f(this),i,r,o)});else if("multi"===a)f.each(n.children("actions").first().children(),function(){t(f(this),i,r,o)});else if("voice-command"===a){var s=e.voiceCommands.getUIComponentType(n);R(h("<"+s+"/>"),i,r,o)}else"datasource-action"===a&&n.attr("datasource")&&I(n,r.dataSourceDependencies)}(f(this),n,i,r)})}))}S.prototype={process:function(){var e=this;if(this._isBeingProcessed)return this._processPromise;this._isBeingProcessed=!0;var t=function(){return e._process().then(function(){e._isBeingProcessed=!1,e._isProcessed=!0})};return this._dependencies?this._processPromise=f.when.all(this._dependencies.map(function(e){return e.process()})).then(t):this._processPromise=t()}};var D=function(t,n){var i="",r="",o=[],a=[],s={},l=t.prop("tagName"),d=C();function u(e){if(e&&(o.push(e),d)){var t=[];n.push(new S(e,function(){return c.loadJS(e)},t)),n.length>1&&t.push(n[n.length-2])}}return"labels"===l?f.each(t.children(),function(){var e=f(this).attr("id");e&&(s[e]=!0)}):"javascript"===l?f.each(t.children("jsitem"),function(){var t=f(this),n=t.attr("location"),r=t.text().trim();switch(n){case"inline":r&&(i+=r+";\n");break;case"external":u(t.attr("url"));break;case"inlinesnippet":r&&(i+="skuid.snippet.register('"+t.attr("name")+"',function(args){"+r+"\n});\n");break;case"inlinecomponent":r&&(i+="skuid.componentType.register('"+t.attr("name")+"',function(args) {"+r+"\n});\n");break;case"staticresource":u(e.platform.getSiteResourceUrl({name:t.attr("name"),path:t.attr("filepath"),namespace:t.attr("namespace")}))}}):"css"===l&&f.each(t.children("cssitem"),function(){var t,n=f(this),i=n.attr("location"),o=n.text().trim();switch(i){case"inline":o&&(r+=o+"\n");break;case"external":(t=n.attr("url"))&&a.push(t);break;case"staticresource":(t=e.platform.getSiteResourceUrl({name:n.attr("name"),path:n.attr("filepath"),namespace:n.attr("namespace")}))&&a.push(t)}}),{inlineJS:i,inlineCSS:r,jsGraphNodes:n,jsLoads:o,cssLoads:a,labels:s}},A=function(t){e.componentPacks||(e.componentPacks={}),t&&f.each(t,function(t,n){e.componentPacks[n.id]=n})},E=function(e,t){T(e,t,e),e.components&&e.components.length&&f.each(e.components,function(n,i){(i.alwaysLoad||e.alwaysLoad)&&T(i,t,e)})};function F(e,t){var n,i,r=e.split("__");return 1===r.length?(n=e,i="Mobile"===t?"skuidmobilecore":"skuidcore"):(n=r[1],i=r[0]),[i,n]}function N(t){e.label&&e.label.add(t)}function M(t){var i,d=C(),b={},T=t.element,F=t.pageRequest,P=(F=void 0===F?{}:F).isInclude,O=void 0!==P&&P,L=F.isPopState,B=void 0!==L&&L,j=F.isReplace,V=void 0!==j&&j,G=F.isSecondTry,H=void 0!==G&&G,z=F.namespace,q=F.pageId,Y=F.pageModule,K=void 0===Y?z:Y,X=F.pageName,J=F.parameters,Q=void 0===J?{}:J,Z=F.routeName,ee=F.pageType,te=void 0===ee?"Desktop":ee,ne=F.parentPageId,ie=F.previousPageComponent,re=F.wrapper,oe=t.pageResponse,ae=void 0===oe?b:oe,se=t.pageComponentExtensions,le=e.runtime.getGlobalCacheValue({key:"loader.serviceModstamps "}),ce=re?re.prop("id"):null;if(ae===b)return e.runtime.load(t);if((O||ie||(ie=T?T.data?T.data("component"):null:e.component.getByType("skuidpage")[0]),i=ie&&e.page.getUnloadMessage(ie))&&!window.confirm(i))return c.reject();f.holdReady(!0),!o&&e.utils.inPlatform([e.constants.NATIVE])&&(o=!0,f(window).off(u).on(u,function(t){var n=t.originalEvent.state;n&&(n.pageName||n.routeName)&&e.runtime.load({isPopState:!0,isReplace:!0,namespace:n.namespace,pageModule:n.pageModule,pageName:n.pageName,parameters:n.parameters,routeName:n.routeName})})),e.NProgress.start();var de,ue,fe,pe,he,ge,me,ve,ye,be,we=c.generateUniqueId(),Se={"Ui-Only":{}},Ce={componentPacks:{},dataSourceTypes:[],pageResources:[]},Ie={},ke={},xe=[],Te=[],Re={cssLoads:Te,dataSourceDependencies:Se,jsDependencyGraph:Ce,jsLoads:xe,labelDependencies:ke,pageParameters:Q},De="",Ae="",Ee=(new Date).getTime(),Fe=[],Ne="default",Me=e.loader.service,_e=e.runtime.getGlobalCacheValue({key:"loader.siteSettings"}),Pe=[];function Oe(e){e&&f.inArray(e,["server","default","client"])>-1&&(Ne=e)}function Le(){if(!ue.hasOwnProperty(we))return m("Load terminated")}function Ue(e){return le&&le[e]||Ee}return re||(re=f(document.body),ce="body"),(ue=s[ce])&&c.size(ue)&&V&&f.each(ue,function(e,t){t&&t.publish&&t.publish("stop.loading"),delete ue[e]}),ue||(ue=s[ce]={}),ue[we]=0,e.settings.init(_e),f.when(ae,e.offline.initiateServiceWorker(),e.storage.initialize(a.default.id,e.storage.getVersionedSchemas(a.default.id))).then(function(t){Pe.push(Me.componentPack(te,Ue("componentPackService")).then(A)),V||O||Pe.push(Me.events().then(e.events.register));var n,i,r=Le(),o=t.xml,a=t.metadata;return r||(ve=c.makeXMLDoc(o),X=a.pageName,q=a.pageId,ge=new Date(a.pageLastModifiedDate).getTime(),n=a.masterPageName,i=a.masterPageNamespace,me=ve.attr("theme"),Oe(ve.attr("personalizationmode")),e.page.name&&!V||p(e.page,{id:q,name:X}),n?(de=ve,Me.page(n,i,null,Ue("pageService")).then(function(e){var t,n,i,r=Le(),o=de.children("resources").first(),a=e.xml;if(r)return r;ve=c.makeXMLDoc(a),fe=ve.attr("theme"),n=ve.attr("personalizationmode"),(t=de.attr("title"))&&ve.attr("title",t);var s="true"===ve.attr("disableoffline");function d(e,t){return function(n){var i,r,o=e.children(n).first();o.length&&(i=o.children()).length&&((r=t.children(n).first()).length||(r=h("<"+n+"/>").appendTo(t)),r.append(i))}}l.disable(s),!n||""!==Ne&&"default"!==Ne||Oe(n),["interactions","models","pageregioncontents"].forEach(d(de,ve)),o.length&&((i=ve.children("resources").first()).length||(i=h("<resources/>").appendTo(ve)),["actionsequences","css","javascript","labels"].forEach(d(o,i)))})):void 0)}).then(function(){return f.when.all(Pe)}).then(function(){e.ui._loadHammer();var t=Le();if(t)return t;var n="skuid"===K;e.page.params.usetheme?be=e.page.params.usetheme:me?be=me:fe&&(be=fe),be||(be=n&&!be?e.settings.theme&&e.settings.theme("Mobile"===te?"mobileBuilderDefault":"builderDefault"):e.settings.theme&&e.settings.theme("Mobile"===te?"mobileDefault":"default")),be||(be=n&&!be?"BuilderLight":"Mobile"===te?"MobileClassic":"Modern"),(ye=e.platform.get("themeServiceDFD"))||(ye=Me.theme(be,Ue("themeService")).then(function(t){return l.isEnabled()&&l.networkDown()&&e.platform.isCordova()?function(t,n){var i=n.themeinfo;return _("themeCSS:"+t).then(function(t){return e.webfonts.load(i),!e.themeSettings.getAll()&&i&&i.themeSettings&&e.themeSettings.load(i.themeSettings),t})}(be,t).then(function(e){return Ae+=e}):function(t,n){var i=t.themeinfo,r=t.themeurl;i&&i.loadResourcesOnClient&&(r=x({resource:i.fileName,namespace:i.fileNamespace,modstamp:i.fileModstamp,path:"skuidtheme.css"})),r&&n.push({href:r,attrs:{id:"themeLink"}}),e.webfonts.load(i),!e.themeSettings.getAll()&&i&&i.themeSettings&&e.themeSettings.load(i.themeSettings)}(t,Te)}),e.platform.set("themeServiceDFD",ye)),f.each(ve.children("models").children(),function(){I(f(this),Se)}),R(ve,Ie,Re,te),f.each(ve.children("resources").children(),function(){var e=D(f(this),Re.jsDependencyGraph.pageResources);f.each(e.jsLoads,function(){k(this,xe)}),f.each(e.cssLoads,function(){k(this,Te)}),De+=e.inlineJS,Ae+=e.inlineCSS,e.labels&&f.extend(ke,e.labels)}),e.settings.globalFeedback&&e.settings.globalFeedback("enabled")&&!e.mobile&&R(h("<globalfeedback />"),Ie,Re,te);var i={dataSources:Se,components:Ie};return V||(i.path=window.location.pathname,i.personalization={pageId:q,mode:Ne},y.forEach(function(e){i[e]={}})),f.when(Me.meta(i),Me.labels(Object.keys(ke),Ue("labelsService")).then(N),ye)}).then(function(t){var n=Le();if(n)return n;f.isPlainObject(t)||(t=JSON.parse(t)),pe=t;var i,r,o,a=t.runningUserInfo;if(a&&((i=a.userLocale||{}).monthNames?(r={},["monthNames","monthNamesShort","dayNames","dayNamesShort","dayNamesMin","amPm"].forEach(function(e){r[e]=i[e]})):(r={monthNames:g("month_names_long").split(","),monthNamesShort:g("month_names_short").split(","),dayNames:g("day_names_long").split(","),dayNamesShort:g("day_names_short").split(","),dayNamesMin:g("day_names_min").split(","),amPm:g("am_pm_markers").split(",")},p(i,r)),e.time.setUserTimeZone(a.timeZone),c.userInfo=a,c.isMultiCurrencyOrganization=!1,c.userLocale=i,e.settings.init("userLocale",i),a.isAuthenticated||(Ne="client"),p(e.time,r),f.datepicker.setDefaults(p({},{closeText:"Done",currentText:"Today",prevText:"Prev",nextText:"Next",weekHeader:"Wk"},i)),p(e.page,{useComponentPacks:e.settings.components("useComponentPacks"),currentSiteUrl:location.protocol+"//"+location.host,editable:a&&a.canEditPages||!1}),e.page.sitePrefix||(e.page.sitePrefix="")),o="server"===Ne?t.personalization:f.cookie("sk-pf-"+(q||X)),e.personalization.initializeSettings({pageSettings:c.parseAsJSONIfString(o)||{},mode:Ne,pageId:q||X}),t.apps&&(c.apps=t.apps),t.dataSourceTypes){var s=Ce.dataSourceTypes;f.each(t.dataSourceTypes,function(){if(this.js)if(f.isArray(this.js)){var e=[];this.js.forEach(function(t){var n=k(t,xe);if(n&&d){var i=[];e.push(new S(n,function(){return c.loadJS(n)},i)),e.length>1&&i.push(e[e.length-2])}}),d&&e.length&&Array.prototype.push.apply(s,e)}else{var t=k(this.js,xe);t&&d&&s.push(new S(t,function(){return c.loadJS(t)}))}})}if(t.components&&(f.each(t.components,function(e,t){var n=t.js,i=t.css,r=t.packs;f.isArray(n)&&n.forEach(function(e){return k(e,xe)}),f.isArray(i)&&i.forEach(function(e){return k(e,Te)}),r&&f.each(r,function(e,t){E(t,Re)})}),e.components={config:U.meta().components}),t.features&&(e.features=t.features),t.cssLoads&&(Te=t.cssLoads.concat(Te)),e.page._parametersByPage[we]=p({page:X},Q),d){var l=Te.map(function(e){return c.loadCSS(e,{})}),u=Ce.componentPacks,h=Ce.dataSourceTypes,m=Ce.pageResources,y=[],b=function(e){return e.map(function(e){return e.process()})};return h.length&&Array.prototype.push.apply(y,b(h)),c.size(u)&&f.each(u,function(e,t){Array.prototype.push.apply(y,b(t))}),f.when.all(l.concat(y)).then(function(){return m.length?f.when.all(b(m)):v()})}return f.each(Te,function(e,t){Fe.push(c.loadCSS(t,{}))}),f.each(xe,function(e,t){t&&Fe.push(c.loadJS(t))}),f.when.all(Fe)}).then(function(){return e.platform.hasFeature("Native")&&"true"===ve.attr("ask-location-on-page-load")?e.native.initializeUserLocation():f.when()}).then(function(){return e.platform.isCordova()?e.native.getPreferences().then(function(t){return e.native.preferences=t,e.native.push.init()}):f.when()}).then(function(){if(!d)return Ae&&f('<style type="text/css">'+Ae+"</style>").appendTo(document.body),void(De&&f("<script>"+De+"<\/script>").appendTo(document.body));if(Ae||De){var t=Ae&&e.platform.getResourceUrl({name:(0,r.getFileNameForPage)(q,X),path:"inlineresources.css",modstamp:ge}),n=t&&c.loadCSS({href:t,timeout:1e4}).then(null,function(){throw new Error(["Cannot add Inline CSS in the Lightning Runtime, ","and no Page Support File was found or there was a timeout."].join(""))}),i=De&&e.platform.getResourceUrl({name:(0,r.getFileNameForPage)(q,X),path:"inlineresources.js",modstamp:ge}),o=i&&c.loadJS({src:i,timeout:1e4}).then(null,function(){throw new Error(["Cannot add Inline Javascript in the Lightning Runtime, ","and no Page Support File was found or there was a timeout."].join(""))});return f.when.all([n,o])}}).then(function(){pe.dataSourceTypes&&f.each(pe.dataSourceTypes,function(){this.dataSources&&f.each(this.dataSources,function(){new e.dataSource.DataSource(this)})}),V&&e.region.unregisterAll(),f.each(ve.children("pageregioncontents").first().children("pageregioncontent"),function(){var t=f(this),n=t.attr("uniqueid");"__header"===n||"__footer"===n?e.region.register(t,X):e.region.register(t)});var t=Le();return t||(T||(T=f('<div class="nx-page">')),he=e.component.factory({element:T,xmlDefinition:ve,options:{uniqueId:we},state:p({},se,{_parentPageId:ne,_pageRecord:{Id:q||X,Name:X,LastModifiedDate:ge},isInclude:O,isReplace:V,previousPageComponent:ie})}),T.appendTo(re),ue[we]=he,he.subscribe("stop.loading",function(){delete ue[we],he.unregister()}),he.once("rendered"))}).then(function(t){if(delete ue[we],e.utils.inPlatform([e.constants.NATIVE])&&!O&&t.get("rendered")){var n,i=V&&!B,r={isReplace:!0,parameters:Q};z&&(r.namespace=z),K&&(r.pageModule=K),Z&&!e.platform.isCordova()?r.routeName=Z:r.pageName=X,n=e.platform.isCordova()?e.platform.getPageNavigateUrl(X,z,Q):V?Z?e.platform.getRouteNavigateUrl(Z,z,Q):e.platform.getPageNavigateUrl(X,z,Q):window.location.href,window.history[i?"pushState":"replaceState"](r,"",n),document.title||(document.title=X)}return e.utils.inPlatform(e.constants.LIGHTNING)||l.init(),l.isEnabled()&&!l.networkDown()&&l.sync(),W(),t}).always(function(){e.NProgress.done()}).catch(function(i){if("Load terminated"!==i)if(i&&i.stack)c.log(i.stack,w);else if(i&&i.status&&i.statusText){if((401===i.status||403===i.status)&&e.platform.getName()===e.constants.NATIVE)return e.platform.attemptLogin(0,!0);if(404===i.status){if(!O)return void e.platform.handlePageLoaderNotFound();if(re)return void f('<div class="nx-page">').text(g("not_found")||"No Page Found").appendTo(re)}c.log(i.statusText,w)}else H?c.log(i||"Unknown error",w):n.checkNetworkStatus().then(function(){l.networkDown()?($(),t.secondTry=!0,M(t)):c.log(i||"Unknown error",w)})})}function _(t){return e.storage.getDb(a.default.id).getTable("queries").get(t).then(function(e){return e&&e.data})}function P(t,n){return e.storage.getDb(a.default.id).getTable("queries").add(t,{data:n})}function O(t){return e.storage.getDb(a.default.id).getTable("queries").get(b+":"+t)}function L(t,n){return e.storage.getDb(a.default.id).getTable("queries").add(b+":"+t,{data:n})}var U={componentPack:function(e){return i.componentPack[e]},events:function(){return i.events},labels:function(){return i.labels},meta:function(){return i.meta},page:function(e,t,n){return i.page[e||n]},theme:function(e){return i.theme[e]}},B={componentPack:function(e){return _("componentPackService:"+e)},events:function(){return _("eventsService")},labels:function(){return _("labelsService")},meta:function(e){return f.when.all(y.concat(["components","dataSourceTypes"]).map(O)).then(function(t){var n={};return f.each(t,function(t,i){if(!c.isUndefined(i)){var r=i.id.replace(b+":","");if("dataSourceTypes"===r){var o=e.dataSources,a=i.data,s={};c.size(o)&&f.each(a,function(e,t){var n={},i=t.dataSources,r={js:t.js,label:t.label,dataSources:n};f.each(i,function(e,t){var i=t.name;c.isObject(o[i])&&(n[i]=t)}),c.size(n)&&(s[e]=r)}),i.data=s}else if("components"===r){var l=e.components,d=i.data,u={};f.each(d,function(e,t){c.isObject(l[e])&&(u[e]=t)}),i.data=u}n[r]=i.data}}),n})},page:function(t,n,i){var r,o;return t?(r="name",o=t):(r="route",o=i),e.storage.getDb().getTable("pages").get(o,r).then(function(e){if(e)return e.data})},theme:function(e){return _("themeService:"+e)}},j={componentPack:function(e,t){i.componentPack[t]=e},events:function(e){i.events=e},labels:function(e){i.labels||(i.labels={}),f.extend(i.labels,e)},meta:function(e,t){y.forEach(function(t){var n=e[t],r=i.meta[t];n&&(r||(r=i.meta[t]={}),f.extend(r,n))}),e.components&&(i.meta.components||(i.meta.components={}),f.extend(i.meta.components,e.components)),e.dataSourceTypes&&f.each(e.dataSourceTypes,function(e,t){t.dataSources&&(i.meta.dataSources||(i.meta.dataSources={}),f.extend(i.meta.dataSources,t.dataSources))}),e.personalization&&(i.meta.personalization||(i.meta.personalization={}),i.meta.personalization[t.personalization.pageId]=e.personalization)},page:function(e,t){i.page[t||e.metadata.pageName]={xml:e.xml,metadata:e.metadata}},theme:function(e,t){i.theme[t]=e}},V={componentPack:function(e,t){return P("componentPackService:"+t,i.componentPack[t])},events:function(){return P("eventsService",i.events)},labels:function(){return P("labelsService",i.labels)},meta:function(e){var t=[O("dataSourceTypes"),O("components")];return f.when.all(t).then(function(t){var n=t[0],i=t[1];if(y.forEach(function(t){return e[t]&&L(t,e[t])}),e.dataSourceTypes)if(n){var r=n.data;f.each(e.dataSourceTypes,function(e,t){if(r[e]){var n=r[e].dataSources;t.dataSources&&!n&&(n=r[e].dataSources={}),f.each(t.dataSources,function(e,t){n[e]=t})}else r[e]=t}),L("dataSourceTypes",r)}else L("dataSourceTypes",e.dataSourceTypes);if(e.components)if(i){var o=i.data;f.each(e.components,function(e,t){o[e]=t}),L("components",o)}else L("components",e.components)})},page:function(t,n,i,r){var o=t.metadata;if(o&&o.pageId)return e.storage.getDb().getTable("pages").add(o.pageId,{name:n||o.pageName,route:r,data:t})},theme:function(e,t){return P("themeService:"+t,i.theme[t])}},G={componentPack:function(t,n){return e.platform.services.componentPack(t,n).then(function(e){return e&&e.length?f.when.all(e.map(function(e){var t=e.file;return t&&t.path?f.getJSON(c.getStaticResourceUrl(t.resource,t.namespace,t.path,t.modstamp)).then(function(e){return f.extend(e,{file:t})}):v(e)})):[]})},events:function(){return e.platform.services.events()},page:function(t,n,i,r){return e.platform.services.page(t,n,i,r)},theme:function(t,n){return e.platform.services.theme(t,n).then(function(n){var i=n.themeinfo,r="skuid-core/"+e.version.path;if(n.themeurl)if(e.platform.isCordova()&&n.themeurl.indexOf("/api/v1")>-1)n.themeurl=e.native.instanceUrl+n.themeurl;else if(e.platform.isLocalCordova()&&n.themeurl.indexOf(r)>-1){var o=n.themeurl;o=o.split(r),n.themeurl="v1"+o[1]}return i&&i.loadResourcesOnClient?f.getJSON(c.getStaticResourceUrl(i.fileName,i.fileNamespace,"resources.json",i.fileModstamp)).then(function(e){return p(i,e),n},function(){return n}):(e.offline.isEnabled()&&e.platform.isCordova()&&e.ajax.direct({method:"GET",url:n.themeurl,cache:!0}).then(function(e){return P("themeCSS:"+t,e.body)}),n)})}};function H(e){return function(){var t=this,n=Array.prototype.slice.call(arguments),i=l.networkDown(),r=U[e].apply(t,n);return r?v(r):i?B[e].apply(t,n).then(function(i){return i&&j[e].apply(t,[i].concat(n)),i}):G[e].apply(t,n).then(function(i){return i=d(i),j[e].apply(t,[i].concat(n)),V[e].apply(t,[i].concat(n)),i})}}function z(t){var n,r,o=i.meta,a=l.networkDown(),s={},d=t.personalization,u=o.personalization;return y.forEach(function(e){t[e]&&o[e]&&(delete t[e],s[e]=o[e])}),d&&u&&d.pageId&&u[d.pageId]&&(delete t.personalization,s.personalization=u[d.pageId]),["components","dataSources"].forEach(function(e){var n={},i=t[e],r=o[e];i&&r&&(f.each(i,function(e,t){r[e]||(n[e]=t)}),t[e]=n),i&&!f.isEmptyObject(t[e])||delete t[e]}),t&&c.size(t)?a?B.meta(t).then(function(e){return e&&j.meta(e,t),f.extend(s,e)}):1===c.size(t)&&t.path?(n=function(){e.platform.services.meta(t)},r=5,e.utils.runningTests()||setTimeout(n,1e3*r),s):e.platform.services.meta(t).then(function(e){return j.meta(e,t),V.meta(e,t),f.extend(s,e)}):v(s)}function q(t){if(!t||!t.length)return m("No data source name provided.");var n,i={},r=[],o=f.map(t,function(t){var n=e.dataSource.get(t);if(n)return n;i[t]||(i[t]={})});return c.size(i)?z({dataSources:i}).then(function(e){return n=e,e.dataSourceTypes&&f.each(e.dataSourceTypes,function(){this.js&&(f.isArray(this.js)?f.each(this.js,function(e,t){r.push(c.loadJS(x(t)))}):r.push(c.loadJS(x(this.js))))}),f.when.all(r)}).then(function(){var i=[];return f.each(n.dataSourceTypes,function(){this.dataSources&&f.each(this.dataSources,function(n,r){f.inArray(r.name,t)>-1&&i.push(new e.dataSource.DataSource(r))})}),i}):v(o)}function $(){i={componentPack:{},page:{},theme:{},meta:{}},e&&e.platform&&e.platform.set("themeServiceDFD",null)}function W(){return f.when.all(f.map(e.storage.getDb(a.default.id).getTables(),function(e){return e.clean()}))}n={checkNetworkStatus:function(){return l.check()},componentPack:H("componentPack"),events:H("events"),labels:function(t,n){var i,r,o,a,s,c=U.labels(),d=(r=t,a={},s={},(i=c)?(r.forEach(function(e){var t=i[e];t?a[e]=t:s[e]=1}),o=Object.keys(s)):o=r.map(function(e){return e}),{foundAll:0===o.length,missingEntries:o,cumulativeEntries:a}),u=d.cumulativeEntries,p=l.networkDown();return d.foundAll?v(u):p?B.labels().then(function(e){return e&&!U.labels()&&j.labels(e),e}):e.platform.services.labels(d.missingEntries,n).then(function(e){return j.labels(e),V.labels(e),f.extend(u,e)})},loadDataSourceAndDependencies:function(e){return q([e]).then(function(e){return e[0]})},loadDataSourcesAndDependencies:q,page:H("page"),meta:z,theme:H("theme")},$(),t={memory:{add:j,clear:$},persistent:{add:V,clear:W}},e.loader={cache:t,load:function(e){return M(e.pageRequest?e:{pageRequest:e})},service:n}}(window.skuid)},function(e,t,n){"use strict";!function(e){var t=e.$(document.body),n={init:function(t){t||(t={});var n,i={text:!0!==t.notext,label:t.label,disabled:t.disabled};if(t.icon&&((n=t.icon.indexOf("sk-webicon")>-1)||(i.icons||(i.icons={}),i.icons.primary=t.icon)),t.secondaryIcon&&(i.icons||(i.icons={}),i.icons.secondary=t.secondaryIcon),this.button(i),n){var r=e.ui.createIcon(t.icon,{isWebIcon:!0,additionalClass:"right"===t.iconPosition?"sk-webicon--right":null});t.iconPosition&&"right"===t.iconPosition?this.append(r):this.prepend(r)}return this.attr({role:"button",tabindex:0}),this.find(".ui-icon").addClass("sk-icon inline"),t.hoverText&&this.skootip(t.hoverText),this.data("object",this),this},option:function(){var e,t,n,i;if(0===arguments.length)return{icon:(e=this.button("option")).icons&&e.icons.primary,secondaryIcon:e.icons&&e.icons.secondary,disabled:e.disabled,notext:!e.text};e=this.button("option"),1===arguments.length?(t=arguments[0],h.extend(e,{text:!0!==t.notext,label:t.label,disabled:t.disabled}),t.icon&&(e.icons.primary=t.icon),t.secondaryIcon&&(e.icons.secondary=t.secondaryIcon)):(n=arguments[0],i=arguments[1],"icon"===n?e.icons.primary=i:"secondaryIcon"===n?e.icons.secondary=i:e[n]=i),e.icons.primary||delete e.icons.primary,e.icons.secondary||delete e.icons.secondary,e.icons.primary||e.icons.secondary||delete e.icons,this.button("option",e),this.find(".ui-icon").addClass("sk-icon inline");var r=t&&t.hoverText||"hoverText"===n&&i;r&&this.skootip(r)},destroy:function(){return this.button("destroy"),this.removeData("object"),this.removeAttr("tabindex"),this}};e.utils.registerPlugin("skooButton",n);var i="multi",r="save",o="cancel",a="delete",s="clone",l="share",c="sfdcweblink",d="group",u="click.skuid",f="keydown.action.skuid",p=e.$.ui.keyCode,h=e.$,g=e.utils,m=e.hotkeys,v=e.componentType,y=g.mergeAsText,b=e.label.read,w=e.actions,S={createFields:!0,registerFields:!1},C=function(e,t){var n=t.model,i=t.row,r=n?i?"row":"model":"global";return void 0!==e?"row"==r?y("row",e,S,n,i):"model"==r?y("model",e,S,n):y("global",e,S):""},I=function(e,t,n){var i=e.attr("type"),r=e.attr("label")||t.label||b(i);return C(r,n)},k=function(e,t,n){var i=e.attr("type"),c=e.attr("icon")||t.icon;return c||-1===h.inArray(i,[r,o,a,s,l])||(c="sk-icon-"+i),C(c,n)},x=function(e,t){var n=e.children(".ui-button-text");return n.length&&(t?n.skootip(t):n.tooltip("instance")&&n.tooltip("destroy").removeAttr("title")),e},T=function(t){var n=new e.ui.Editor(t,{showSaveCancel:!1});return n.handleCancel=function(){e.ui.Editor.prototype.handleCancel.call(this),t.button("disable"),t.attr("tabindex",-1)},n.handleSave=function(n){e.ui.Editor.prototype.handleSave.call(this,n),n&&(!0===this.hasModelWithChanges()?(t.button("enable"),t.attr("tabindex",0)):(t.button("disable"),t.attr("tabindex",-1)))},n.handleChange=function(n){e.ui.Editor.prototype.handleChange.call(this,n),!0===this.hasModelWithChanges()?(t.button("enable"),t.attr("tabindex",0)):(t.button("disable"),t.attr("tabindex",-1))},n},R=function(n,d){switch(n){case i:return function(){var e=d(),t=e.actionDef,n=e.element,i=e.component,r=e.model,o=e.row,a=e.editor;w.runActionsNode(t.children("actions").first(),i,{button:n,model:r,row:o,editor:a,initiatorId:a&&a.id(),component:e.context.component}).always(function(){i.publish("actionComplete")})};case"custom":return function(){var t=d(),n=t.actionDef,i=t.element,r=t.component,o=t.context,a=t.model,s=t.row,l=t.editor,c=e.snippet.get(C(n.attr("snippet"),o));c&&c({button:i,model:o.model||a,row:o.row||s,editor:l,initiatorId:l&&l.id(),component:o.component||r})};case r:return function(){var t=d(),n=t.actionDef,i=t.model,r=t.row,o=t.editor,a=t.buttonEditor,s=t.component,l="true"===n.attr("rollbackonanyerror");a.models&&a.models.length&&(o&&o.setStatus(b("saving")),e.model.save(a.models,{callback:function(e){e.totalsuccess&&n.attr("afterSave")&&g.redirect({row:r,model:i,url:n.attr("afterSave"),window:n.attr("window")}),s.publish("actionComplete")},initiatorId:o&&o.id(),rollbackOnAnyError:l}))};case o:return function(){var t=d(),n=t.actionDef,i=t.model,r=t.row,o=t.editor,a=t.buttonEditor,s=n.attr("afterCancel");a.models&&a.models.length&&(e.model.cancel(a.models,{initiatorId:o&&o.id()}),s&&g.redirect({row:r,model:i,url:s,window:n.attr("window")}))};case a:return function(){var n,i,r,o=d(),a=o.component,s=o.model,l=o.row,c=o.editor,u=(s.getNameFieldValueForRow(l)+"").trim(),f=o.actionDef.attr("afterDelete");!f&&g.inPlatform([e.constants.VISUALFORCE,e.constants.LIGHTNING])&&(f="/{{Model.keyPrefix}}/o"),n=b("delete")+" "+(u||s.label)+"?",i=h("<div>").attr("title",n).html(e.label.merge(b("confirm_delete"),s.label,u?"<b>'"+u+"'</b>":"")),r=[{icons:{primary:"ui-button-icon-primary ui-icon sk-icon-cancel sk-icon inline"},text:b("no_dont_delete_anything"),click:function(){i.dialog("close")}}];var p=e.model.list();h.each(p,function(n,o){if(o.hasChanged&&o.deleteable){var s=!0;if(h.each(o.changes,function(e,t){if(g.size(t))return s=!1,!1}),s){var l=e.utils.size(o.changes),d=1===l?o.label:o.labelPlural;r.push({text:e.label.merge(b("no_but_i_would_like_to_delete"),l,d),icons:{primary:"ui-button-icon-primary ui-icon sk-icon-save sk-icon inline"},click:function(){i.dialog("close"),t.block({message:b("deleting")+" "+l+" "+d+"..."}),o.save({callback:function(){a.publish("actionComplete"),t.unblock()},initiatorId:c&&c.id()})}})}}}),r.push({text:b("yes")+", "+b("delete")+" "+s.label+(u?" '"+u+"'":""),icons:{primary:"ui-button-icon-primary ui-icon sk-icon-save sk-icon inline"},click:function(){s.deleteRow(l),t.block({message:b("deleting")+" "+s.label+(u?" '"+u+"'":"")+"..."}),e.model.save([s],{callback:function(e){e.totalsuccess?window.sforce&&sforce.console?(t.unblock(),sforce.console.getEnclosingTabId(function(e){sforce.console.closeTab(e.id)})):g.redirect({url:f,model:s,row:l}):t.unblock(),a.publish("actionComplete")}}),i.dialog("close")}}),i.dialog({close:function(){h(this).remove()},modal:!0,resizable:!1,width:"500px",buttons:r})};case s:return function(){var e=d();g.redirect({url:"/"+e.model.getRowId(e.row)+"/e?clone=1"})};case l:return function(){var e=d(),t=e.model,n={"001":"Acc","003":"Con","006":"Opp","00Q":"Lead",500:"Case",701:"Campaign"},i=t.keyPrefix in n?n[t.keyPrefix]:"CustomObject";g.redirect({url:"/p/share/"+i+"SharingDetail?parentId="+t.getRowId(e.row)})};case"redirect":return function(){var e=d(),t=e.actionDef,n=e.model,i=e.row,r=e.label;g.redirect({row:i,model:n,url:t.attr("url"),window:t.attr("window"),title:r})};case"popup":return function(){var e=d(),t=e.actionDef,n=e.element,i=e.component,r=e.model,o=e.row;g.createPopupFromAction(t,{button:n,model:r,row:o,component:i})};case c:return function(){var e=d(),t=e.model,n=e.row,i=e.label,r=e.weblink,o=e.isOnClickJS;o||g.redirect({row:n,model:t,url:"/servlet/servlet.Integration?"+g.param({lid:r.Id,eid:t.getRowId(n),ic:1,retURL:window.location}),title:i,window:"newWindow"===r.OpenType||!o&&g.startsWith(r.Url,"http://",!0)?"blank":"parent"})}}};v.register("button",{render:function(t,n,v){var y,b,S,D,A,E,F,N,M,_,P,O=v.options||{},L=v.context||{},U=O.editor,B=O.buttonEditors||[],j=n.attr("type")||O.type,V=n.attr("cssclass")||O.cssClass,G=n.attr("usefirstitemasdefault")?"true"===n.attr("usefirstitemasdefault"):O.useFirstItemAsDefault,H=n.attr("openonhover")?"true"===n.attr("openonhover"):O.openOnHover,z=v.id(),q="true"===n.attr("secondary")||O.isSecondary,$=O.model||L.model,W="function"==typeof O.row?O.row():O.row||L.row,Y=W&&$&&!$.isRowNew(W),K=!1,X=(O.customTypes||{})[j],J={doMerge:C},Q=n.children("enableconditions"),Z=R(j,function(){return{actionDef:n,component:v,element:t,label:D,isOnClickJS:_,weblink:M,context:L,model:$,row:W,editor:U,buttonEditor:b}}),ee=function(e){Z.apply(this,arguments),e&&e.stopPropagation&&e.stopPropagation()},te=n.attr("weblinkname"),ne=n.attr("weblinkobject"),ie=function(){return v&&(v.addProblem("Invalid Salesforce Custom Button/Link requested"+(ne&&te?" on "+ne+": "+te:" on Page Title on Model "+$.id)),v.unrender()),!1},re=function(){return e.sfdc?e.sfdc.weblink:null},oe=!1,ae=!1;switch(v.afterUnrender=function(){z&&($&&$.unregisterField(z),e.hotkeys.unbind(z)),j===d||(t.off("click.skuid"),t.hasClass("ui-button")&&t.skooButton("destroy")),t.css("display","none"),X&&"function"==typeof X.unrender&&X.unrender(n,v,J)},j){case r:y=n.children("models").first(),b=T(t),B.push(b),$&&b.registerModel($),y&&h.each(y.children("model"),function(){var t=e.$M(h(this).text());t&&b.registerModel(t)}),K=!b.hasModelWithChanges();break;case o:y=n.children("models").first(),b=T(t),B.push(b),$&&b.registerModel($),y&&h.each(y.children("model"),function(){var t=e.$M(h(this).text());b.registerModel(t)}),K=!b.hasModelWithChanges();break;case i:U&&w.registerEditorWithModelsForActionsNode(n.children("actions").first(),U);break;case a:case l:$&&$.deleteable?W&&Y||(oe=!0,ae=!0):oe=!0;break;case s:$&&$.createable?W&&Y||(oe=!0,ae=!0):oe=!0;break;case c:if(!te||!ne)return void ie();if($?W&&Y||(oe=!0,ae=!0):oe=!0,oe)break;2===(E=te.split("__")).length?(N=E[0],F=E[1]):F=E[0],re().get({weblinkName:F,objectName:ne,namespacePrefix:N,callback:function(e){(M=e)?(_="javascript"===M.LinkType,D=re().getLabel(M),le()):ie()}});break;case d:S=[],h.each(n.children("actions").first().children("action"),function(){var e=h(this),n=e.attr("type"),i=I(e,O,L),r=k(e,O,L),o=R(n,function(){return{actionDef:e,buttonEditor:b,component:v,context:L,editor:U,element:t,isOnClickJS:_,label:i,model:$,row:W,weblink:M}});S.push({label:i,value:e,icon:r,renderConditionsXML:e.children("renderconditions").first(),hotkeysXML:e.children("hotkeys").first(),onSelect:function(e){o.apply(this,arguments),e&&e.stopPropagation&&e.stopPropagation()}})})}if(oe||le(),ae&&$&&W){var se=$.getRowId(W);P=e.events.subscribe("models.saved",function(e){var t,n=e.insertResults;e.totalsuccess&&e.models.hasOwnProperty($.id)&&n&&n.length&&h.each(n,function(e,n){n.oldId===se&&n.success&&n.hasOwnProperty("id")&&(P.unsubscribe(),t=h.extend({},v.context,{row:$.getRowById(n.id)}),v.unrender().conditionallyRender({context:t}))})})}function le(){if(X&&"function"==typeof X.render)X.render(n,v,J);else if(W="function"==typeof O.row?O.row():O.row||L.row,Y=W&&$&&$.isRowNew(W),t&&t.off(u).empty(),t.css("display","inline-block"),void 0===D&&(D=I(n,O,L)),void 0===A&&(A=k(n,O,L)),j!==d){t.skooButton({icon:A,label:D,disabled:K}),K&&t.attr("tabindex",-1),t.off(u).on(u,ee),t.off(f).on(f,function(e){e.which!==p.ENTER&&e.which!==p.SPACE||(ee(),e.preventDefault())}),V&&t.addClass(V),q&&t.addClass("nx-button-secondary"),z&&t.attr("id")!==z&&t.attr("id",z);var i=function(){e.page.disableHotkeys||(r(),m.bind(n.children("hotkeys").first(),z,ee,t))},r=function(){m.unbind(z)};if(Q.length&&Q.children().length){var o=Q.attr("message");g.conditionallyDo(function(){t.hasClass("ui-button")&&(t.button("enable"),t.attr("tabindex",0),o&&(x(t),t.css("cursor",""),t.attr("title")===o&&t.removeAttr("title")),i())},function(){t.hasClass("ui-button")&&(t.button("disable"),t.attr("tabindex",-1),o&&(x(t,o),t.css("cursor","not-allowed"))),r()},Q,t,{row:W,model:$})}else i()}else t.actionDropdown({uniqueId:z,items:S,type:"button",onSelect:ee,openOnHover:H,useFirstItemAsDefault:G,label:D,icon:A})}v.unregisterChildComponents=function(){return h.each(B,function(){this.unregister()}),e.component.Component.prototype.unregisterChildComponents.call(v)},v.unregister=function(){return P&&P.unsubscribe(),e.component.Component.prototype.unregister.call(v)}}})}(skuid)},function(e,t,n){"use strict";!function(e){var t=e.$,n=e.utils,i=e.$.ui.keyCode,r=function(e,n,r,o){n&&n.off("click.skuid").empty();var a=o.actionDropdown,s=o.selectItem,l=o.itemDefinition;n.addClass(o.baseClass+"-dropdown-item").attr("tabindex",-1).on("click.skuid",function(e){s.onSelect&&s.onSelect(),a.selectBox&&a.selectBox.hide("fast"),e.stopPropagation()}).data("rendered",!0).on("blur.skuid",function(){a.actionDropdown("hideDropdown")}).on("focus.skuid",function(){a.actionDropdown("cancelHideDropdown")}),n.off("keydown.navigation.skuid").on("keydown.navigation.skuid",function(e){var n=t(this);if(e.which===i.ESCAPE)a.selectBox&&a.selectBox.hide("fast"),a.config.useFirstItemAsDefault?a.actionArrow.trigger("focus.skuid"):a.actionButton.trigger("focus.skuid");else if(e.which===i.ENTER||e.which===i.SPACE)e.stopPropagation(),n.trigger("click.skuid",!0);else if(e.which===i.UP||e.which===i.DOWN){var r=n.parent().children(),o=n.index();o=(e.which===i.UP?o-1:o+1)%r.length,r.eq(o).trigger("focus.skuid")}}),n.off("focus.skuid.custom"),s.onFocus&&"function"==typeof s.onFocus&&n.on("focus.skuid.custom",function(){s.onFocus.apply(this,arguments)}),s.content?n.append(s.content):n.text(s.label),t("<div>").addClass(o.baseClass+"-icon sk-icon inline "+(l.icon||"icon-spacer")).prependTo(n),o.isInitialDraw||a.actionDropdown("redraw")},o=function(e,t,n,i){var r=i.actionDropdown;t.empty().removeClass(i.baseClass+"-dropdown-item").data("rendered",!1),i.isInitialDraw||r.actionDropdown("redraw")},a={init:function(i){var r=this;r.data("component",r),r.config=i||{},r.config.baseClass=r.config.baseClass||"nx-actiondropdown",r._GUID=r.config.uniqueId||n.generateGUID(),r.prop("id",r._GUID),r.addClass(r.config.baseClass),r.list=new e.utils.SelectList,r.selectOptionsById={};var o={isInitialDraw:!0};return i.items&&t.each(i.items,function(e,t){r.actionDropdown("addItem",t,o)}),r.actionDropdown("draw"),r},addItem:function(i,a){a||(a={});var s=new e.utils.SelectItem(i),l=a.prependInsteadOfAppend||!1,c=a.redrawAfterAdd||!1,d=i.renderConditionsXML,u=i.hotkeysXML,f=t("<div>"),p={selectItem:s,actionDropdown:this,itemDefinition:i,renderConditions:d,isInitialDraw:a.isInitialDraw,baseClass:this.config.baseClass};return this.list.addItem(s,l),s.onSelect=i.onSelect||!1,s.onFocus=i.onFocus||!1,d?n.conditionallyRender(r,o,null,f,s.id(),p):r(0,f,s.id(),p),delete p.isInitialDraw,u&&(e.hotkeys.unbind(s.id()),e.hotkeys.bind(u,s.id(),function(){f.trigger("click.skuid")},this)),this.selectOptionsById[s.id()]=f,c?this.actionDropdown("draw"):this},prepend:function(e){return this.actionDropdown("addItem",e,{prependInsteadOfAppend:!0,redrawAfterAdd:!0})},append:function(e){return this.actionDropdown("addItem",e,{prependInsteadOfAppend:!1,redrawAfterAdd:!0})},safeEmpty:function(){var e=this.selectOptionsById;this.actionButton&&this.actionButton.hasClass("ui-button")&&this.actionButton.skooButton("destroy"),this.actionArrow&&this.actionArrow.hasClass("ui-button")&&this.actionArrow.skooButton("destroy"),n.size(e)&&t.each(e,function(e,t){t.detach()}),this.empty()},redraw:function(){return this.needsRedraw=!1,this.actionDropdown("draw"),this},draw:function(){var e,r=this,o=r.config,a=!0===o.openOnHover,s=r.useFirstItemAsDefault=!0===o.useFirstItemAsDefault,l=r.list,c=0,d=r.selectOptionsById,u=r.actionButton||(r.actionButton=t("<div>")),f=r.actionArrow||(r.actionArrow=t("<div>")),p=r.selectBox||(r.selectBox=t("<div>"));if(r.actionDropdown("safeEmpty"),r.on("mouseout.skuid",function(e){r.is(e.target)||t.contains(r[0],e.relatedTarget)||r.actionDropdown("hideDropdown")}).on("mouseover.skuid",function(){r.actionDropdown("cancelHideDropdown")}),u.skooButton().off("click.skuid").on("click.skuid",function(t,n){s&&e&&"function"==typeof e.onSelect?e.onSelect():r.actionDropdown("toggleDropdown",{isKeyboardInitiated:n})}).off("keydown.navigation.skuid").on("keydown.navigation.skuid",function(e){if(u.is(":focus"))if(e.which===i.ENTER||e.which===i.SPACE)u.trigger("click.skuid",!0),e.stopPropagation();else if(e.which===i.UP||e.which===i.DOWN){var t,n=p.children();r.actionDropdown("showDropdown"),t=(e.which===i.UP?n.length-1:0)%n.length,n.eq(t).trigger("focus.skuid"),e.stopPropagation()}}).off("blur.skuid").on("blur.skuid",function(){r.actionDropdown("hideDropdown")}).off("focus.skuid").on("focus.skuid",function(){r.actionDropdown("cancelHideDropdown")}).appendTo(r),a&&!s&&u.off("mouseover.skuid").on("mouseover.skuid",function(e){r.actionDropdown("isDropdownOpen")||(r.actionDropdown("showDropdown",{isHoverInitiated:!0}),e.stopPropagation())}),n.size(d)&&t.each(d,function(e,t){t.data("rendered")&&c++}),c&&(s||1===c?(e=l&&l.items&&l.items[0],u.skooButton("option","label",e.label),e.icon&&u.skooButton("option","icon",e.icon)):(u.skooButton("option",{label:o.label,secondaryIcon:"fa-caret-down"}),o.icon&&u.skooButton("option","icon",o.icon)),!s||c>1)){s?(r.addClass("ui-buttonset"),f.skooButton({notext:!0,icon:"fa-angle-down"}).addClass(r.config.baseClass+"-expand-button").off("click.skuid").on("click.skuid",function(e,t){r.actionDropdown("toggleDropdown",{isKeyboardInitiated:t})}).off("keydown.navigation.skuid").on("keydown.navigation.skuid",function(e){e.which!==i.ENTER&&e.which!==i.SPACE||(f.trigger("click.skuid",!0),e.stopPropagation())}).off("blur.skuid").on("blur.skuid",function(){r.actionDropdown("hideDropdown")}).off("focus.skuid").on("focus.skuid",function(){r.actionDropdown("cancelHideDropdown")}).attr("aria-haspopup",!0).attr("aria-expanded",!1).appendTo(r),a&&f.off("mouseover.skuid").on("mouseover.skuid",function(e){r.actionDropdown("showDropdown",{isHoverInitiated:!0}),e.stopPropagation()})):u.attr("aria-haspopup",!0).attr("aria-expanded",!1),p.addClass(r.config.baseClass+"-dropdown").css("min-width","100%").hide().appendTo(r),r.config.maxHeight&&p.css({"max-height":r.config.maxHeight,"overflow-y":"auto"});var h=s;t.each(l.getItems(),function(t,n){if(h&&n===e)return!0;var i=d[n.id()];i&&p.append(i)})}return r},isDropdownOpen:function(){var e=this.selectBox;return e&&e.is(":visible")},toggleDropdown:function(e){var t=e.isKeyboardInitiated,n=this.actionDropdown("isDropdownOpen")?"hideDropdown":"showDropdown";this.actionDropdown(n,{focusFirstItem:t,focusActionArrow:t,immediate:!0}),this.actionDropdown("cancelHideDropdown")},showDropdown:function(e){e||(e={});var t=this.selectBox,n=this.useFirstItemAsDefault,i=this.actionArrow,r=this.actionButton,o=n?i:r;return!0===e.isHoverInitiated&&t.data("skuid.isHoverInitiated",!0),t.show("fast").position({my:"left top",at:"left bottom",of:r}),o.attr("aria-expanded",!0),e.focusFirstItem&&t.children().first().trigger("focus.skuid"),this},hideDropdown:function(e){e||(e={});var t=this,n=t.selectBox,i=t.useFirstItemAsDefault,r=t.actionArrow,o=t.actionButton,a=i?r:o,s=e.focusActionArrow,l=function(){t.hideDropdownTimeout=null,n.data("skuid.isHoverInitiated",!1),n.hide("fast"),a.attr("aria-expanded",!1),s&&a.trigger("focus.skuid")};return e.immediate||!0===n.data("skuid.isHoverInitiated")?l():t.actionDropdown("isDropdownOpen")&&!t.hideDropdownTimeout&&(t.hideDropdownTimeout=setTimeout(l,1e3)),t},cancelHideDropdown:function(){return this.hideDropdownTimeout&&(clearTimeout(this.hideDropdownTimeout),this.hideDropdownTimeout=null),this}};n.registerPlugin("actionDropdown",a)}(skuid)},function(e,t,n){"use strict";!function(e){var t=e.$,n=e.utils,i={init:function(i){i||(i={});var r,o,a,s,l=this.addClass("nx-actionselect nx-actionautocomplete"),c=i.refField,d=i.model.dataSource,u={},f=!1;return l.config=i,l.onItemSelect=i.onItemSelect||!1,l.list=new n.SelectList,c&&c.accessible&&(s=(a=c.referenceTo).length&&a[0],o=s&&s.objectName,r=s&&s.keyField||d.getIdField(i.model),t.each(c.referenceTo,function(e,t){var n=t.objectName,r=d.getNameField(n),o=["Id"];r&&o.push(r),t.searchable&&(f||(f=!0),u[n]={objectName:n,fields:o,recordsLimit:50,model:{objectMapKey:d.name+"__"+l.config.model.objectName},orderBy:r,conditions:i.additionalConditions})}),l.sourceFunction=function(n,s){if(n.term.length<2)return!1;if(f&&d.getDataSourceType().name===e.constants.SALESFORCE)d.search({query:n.term,includeMetadata:!0,searching:"NAME FIELDS",returning:u}).done(function(n){var i=[];t.each(n.results,function(n,o){var a=o.objectName,s=e.ui.getReferenceLookupModel(d,{metadata:c},a,null,r);t.each(o.records,function(t,n){e.data.add(n,"Id"),n.__templabel=s.getRowName(n),i.push(n)})}),s(i)});else if(a.length){var l=e.ui.getReferenceLookupModel(d,{metadata:c},o,null,r),p=l.getNameField();l.buildSearchCondition("_autocomplete_search",n.term,[{id:p}],{useSOSLSearch:!1,searchOperator:"contains"}),t.each(i.additionalConditions,function(e,t){l.addCondition(t)}),l.load(function(){var n=[];t.each(l.getRows(),function(t,i){e.data.add(i,r),i.__templabel=l.getRowName(i),n.push(i)}),s(n)})}},l.optionRenderer=function(e,i){return t("<li>").data("ui-autocomplete-item",i).html("<a>"+n.encodeHTML(i.__templabel)+"</a>").appendTo(e)},l.onChangeFunc=function(e,t){var n=t.item[r];return l.list.contains(n)||l.actionAutocomplete("addItem",{value:n,label:t.item.__templabel,affectDefaultCondition:!0}),l.actionAutocomplete("selectItem",n),!1}),i.items&&t.each(i.items,function(){l.actionAutocomplete("addItem",this)}),l.actionAutocomplete("draw"),l},addItem:function(e,t){t||(t={});var i=new n.SelectItem(e),r=t.prependInsteadOfAppend||!1;return this.list.addItem(i,r),i.onSelect=e.onSelect||!1,this},getSelectedItem:function(){return this.list.getSelected()},resetItem:function(e){var n=this;n.config.refField?(t.each(n.actionAutocomplete("getSelectedItems"),function(){this.inactive=!0}),e&&t.map(e.split(";"),function(e){n.actionAutocomplete("selectItem",e,{triggerHandlers:!1})}),n.actionAutocomplete("buildResetMenu"),n.input.val(n.actionAutocomplete("getLabel"))):n.actionAutocomplete("selectItem",e)},selectItem:function(e,t){var n=this.list.selectedIndex,i=this.list.getSelected(),r=this.list.itemsMap[e],o=!1;this.list.selectItem(r),r.inactive=!1,this.input.val(this.actionAutocomplete("getLabel")),o=!this.isMultiselect||this.list.selectedIndex!==n,this.config.refField&&!this.config.isMultiselect&&i!==r&&this.actionAutocomplete("unselectItem",i,{triggerHandlers:!1}),o&&(t&&!1===t.triggerHandlers||(r&&r.onSelect&&r.onSelect(r),this.onItemSelect&&this.onItemSelect(r),this.actionAutocomplete("buildResetMenu")))},unselectItem:function(e,t){e.inactive=!0,this.input.val(this.actionAutocomplete("getLabel")),t&&!1===t.triggerHandlers||(e&&e.onSelect&&e.onSelect(e),this.onItemSelect&&this.onItemSelect(e),this.actionAutocomplete("buildResetMenu"))},getLabel:function(){var e=this.actionAutocomplete("getSelectedItems");return(e.length>2?e.length+" Items":t.map(e,function(e){return e.label}).join(", "))||this.config.defaultOptionLabel},getSelectedItems:function(){if(this.config.refField)return t.map(this.list.items,function(e){return!0===e.inactive?null:e});var e=this.list.getSelected();return e?[e]:[]},draw:function(){var n=this,i=e.ui.getRenderer("AUTOCOMPLETE").edit({minLength:1,value:n.actionAutocomplete("getLabel"),source:n.sourceFunction||t.map(n.list.items,function(e){return{value:e.value,label:e.label}}),onChange:n.onChangeFunc||function(e,t){n.actionAutocomplete("selectItem",t.item.value)},onFocus:function(e,t){return n.config.refField?i.val(t.item.__templabel):i.val(t.item.label),!1},optionRenderer:n.optionRenderer}).on("click",function(){i.select()}).appendTo(n);return n.input=i,n.resetMenu=t("<div>"),n.resetMenu.insertAfter(i),n.resetMenuItemsWrapper=null,n.actionAutocomplete("buildResetMenu"),n},buildResetMenu:function(){var e=this;if(e.resetMenu.empty().removeClass("clearfilter-btn nx-actionselect-arrow"),e.config.refField){e.resetMenuItemsWrapper||(e.resetMenuItemsWrapper=t("<div>").addClass("nx-actionselect-dropdown nx-actionautocomplete-resetitemswrapper").hide(),e.append(e.resetMenuItemsWrapper));var n=e.actionAutocomplete("getSelectedItems");0===n.length?(e.resetMenuItemsWrapper.empty().hide(),e.removeClass("nx-actionautocomplete-has-menu-action"),e.resetMenu.css("display","none")):1===n.length?(e.resetMenuItemsWrapper.empty().hide(),e.addClass("nx-actionautocomplete-has-menu-action"),e.resetMenu.addClass("clearfilter-btn").text("x").off().on("click",function(){e.hasClass("unavailable")||e.actionAutocomplete("unselectItem",n[0])}),e.resetMenu.css("display","inline-block")):n.length>1&&(e.addClass("nx-actionautocomplete-has-menu-action"),e.resetMenuItemsWrapper.empty(),t.each(n,function(n,i){var r=t("<div>").addClass("nx-actionselect-dropdown-item"),o=t("<div>").addClass("nx-actionautocomplete-resetitembutton").text("x"),a=t("<div>").addClass("nx-actionautocomplete-resetitemlabel").text(i.label);r.append(o,a),e.resetMenuItemsWrapper.append(r),r.off().on("click",function(){e.actionAutocomplete("unselectItem",i)})}),e.resetMenu.addClass("nx-actionselect-arrow").append(t("<div>").addClass("ui-icon ui-icon-triangle-1-s")).off().on("click",function(){e.resetMenuItemsWrapper.is(":visible")?e.resetMenuItemsWrapper.hide():e.resetMenuItemsWrapper.show()}),e.resetMenu.css("display","inline-block"))}else e.list&&0===e.list.selectedIndex?(e.resetMenu.css("display","none"),e.removeClass("nx-actionautocomplete-has-menu-action")):(e.addClass("nx-actionautocomplete-has-menu-action"),e.resetMenu.css("display","inline-block").addClass("clearfilter-btn").text("x").off().on("click",function(){e.hasClass("unavailable")||e.actionAutocomplete("selectItem",e.list.items[0].value)}))}};n.registerPlugin("actionAutocomplete",i)}(skuid)},function(e,t,n){"use strict";!function(e){var t,n=e.$,i=e.utils,r="focus.skuid",o="click.skuid",a="keydown.navigation.skuid",s=o+" "+a,l=e.$.ui.keyCode;function c(t,i,s,c){i&&i.off("click.skuid").empty();var d=c.actionSelect,u=c.selectItem,f=c.itemDefinition;i.addClass(c.baseClass+"-dropdown-item").attr("tabindex",-1).on(o,function(e){"button"!==d.type&&d.list.getSelected()===u||(d.hasClass("unavailable")||(d.actionSelect("selectItem",u),d.selectBox&&d.selectBox.hide("fast")),e.stopPropagation())}).data("rendered",!0),i.off(a).on(a,function(e){var t=n(this),i=u===d.actionSelect("getSelectedItem");if(!i||e.which!==l.ENTER&&e.which!==l.SPACE)if(e.which!==l.ESCAPE||i){if(e.which===l.ENTER||e.which===l.SPACE)e.stopPropagation(),d.actionSelect("selectItem",u,{event:e});else if(e.which===l.UP||e.which===l.DOWN){var r=t.parent().children(),a=t.index();a=(e.which===l.UP?a-1:a+1)%r.length,r.eq(a).trigger("focus.skuid")}}else d.selectBox&&d.selectBox.hide("fast"),"button"===d.type?d.actionArrow.attr("aria-expanded",!1).trigger("focus"):d.actionText.children().first().attr("aria-expanded",!1).trigger("focus");else t.trigger(o,!0),e.stopPropagation()}),i.off(r).on(r,function(e){e.stopPropagation(),u.onFocus&&"function"==typeof u.onFocus&&u.onFocus.apply(this,arguments)}),u.content?i.append(u.content):i.text(u.label),f.icon&&i.prepend(e.ui.createIcon(f.icon,{additionalClass:c.baseClass+"-icon inline"})),d.list.getSelected()||d.actionSelect("selectItem",u,{triggerHandlers:!1}),c.isInitialDraw||d.actionSelect("redraw")}function d(e,t,n,i){var r=i.actionSelect,o=i.selectItem;t.empty().removeClass(i.baseClass+"-dropdown-item").data("rendered",!1),r.list.unselectItem(o),i.isInitialDraw||r.actionSelect("redraw")}t={init:function(t){var r=this;r.data("component",r),r.config=t||{},r.config.baseClass=r.config.baseClass||"nx-actionselect",r._GUID=r.config.uniqueId||i.generateGUID(),r.type=r.config.type?r.config.type:"state-selector",r.addClass(r.config.baseClass).prop("id",r._GUID),r.list=new e.utils.SelectList,r.onItemSelect=t.onItemSelect||!1,r.selectOptionsById={};var o={isInitialDraw:!0};return t.items&&n.each(t.items,function(e,t){r.actionSelect("addItem",t,o)}),r.actionSelect("draw"),r},getSelectedItem:function(){return this.list.getSelected()},addItem:function(t,r){r||(r={});var o=new e.utils.SelectItem(t),a=r.prependInsteadOfAppend||!1,s=r.redrawAfterAdd||!1,l=t.renderConditionsXML,u=n("<div>"),f={selectItem:o,actionSelect:this,itemDefinition:t,renderConditions:l,isInitialDraw:r.isInitialDraw,baseClass:this.config.baseClass};return this.list.addItem(o,a),o.onSelect=t.onSelect||!1,o.onFocus=t.onFocus||!1,l?(i.conditionallyRender(c,d,null,u,o.id(),f),!0!==u.data("rendered")&&this.list.unselectItem(o)):c(0,u,o.id(),f),delete f.isInitialDraw,t.hotkeysXML&&(e.hotkeys.unbind(o.id()),e.hotkeys.bind(t.hotkeysXML,o.id(),function(){u.trigger("click.skuid")},this)),this.selectOptionsById[o.id()]=u,s?this.actionSelect("draw"):this},prepend:function(e){return this.actionSelect("addItem",e,{prependInsteadOfAppend:!0,redrawAfterAdd:!0})},append:function(e){return this.actionSelect("addItem",e,{prependInsteadOfAppend:!1,redrawAfterAdd:!0})},selectItem:function(e,t){var i,r,o=this.list,a=o.size(),s=!1,l=o.selectedIndex,c=o.items[l];if(void 0===e)throw"No Item provided.";if(i=void 0!==e.value?o.indexOf(e):e,a>1){if(c&&(r=n(this.selectOptionsById[c.id()])),o.selectItem(i),o.selectedIndex!==l&&(s=o.items[o.selectedIndex],"button"!==this.type&&!this.config.preventLabelChangeOnSelect)){if(c){var d=l-1;-1!==d?r.insertAfter(this.selectBox.children().eq(d)):r.prependTo(this.selectBox)}n(this.selectOptionsById[s.id()]).appendTo(this.actionText)}}else 1===a&&o.selectItem(i);s||(s=c),"button"!==this.type&&o.selectedIndex===l&&1!=a||t&&!1===t.triggerHandlers||(s&&s.onSelect&&s.onSelect(s,t),this.onItemSelect&&this.onItemSelect(s))},safeEmpty:function(){this.actionText&&this.actionText.children().detach(),this.selectBox&&this.selectBox.children().detach(),this.empty()},redraw:function(){var e=this;return e.needsRedraw||(e.needsRedraw=!0,e.actionSelect("safeEmpty"),setTimeout(function(){e.needsRedraw&&(e.needsRedraw=!1,e.actionSelect("draw"))},1)),e},draw:function(){var t,o=this,a=o.list,c=0,d=o.selectOptionsById;o.actionSelect("safeEmpty"),i.size(d)&&n.each(d,function(e,t){t.data("rendered")&&c++});var u=function(){return n(window).innerHeight()/2+"px"};if(c){if((t=a.getSelected())||n.each(a.items,function(e,n){var i=n.id();if(d[i].data("rendered"))return o.actionSelect("selectItem",e,{triggerHandlers:!1}),t=a.getSelected(),!1}),!t)return o;if(o.actionText=n('<div class="'+o.config.baseClass+'-text">'),"button"===o.type?o.actionText.append(d[t.id()].clone(!0,!0)):o.actionText.append(d[t.id()]),o.append(o.actionText),c>1){var f=o.config.baseClass.indexOf("dropnav")>-1?"":"ui-icon ui-icon-triangle-1-s";o.actionArrow=n('<div class="'+o.config.baseClass+'-arrow">').append(n("<div>").addClass(f)),o.append(o.actionArrow);var p=[];"button"===o.type?(p.push(o.actionArrow),o.actionText.on(s,function(e){if("click"===e.type||e.which===l.ENTER||e.which===l.SPACE){e.stopPropagation(),o.list.selectItem(o.actionText.index());var t=a.getSelected();t.onSelect&&t.onSelect(t),o.onItemSelect&&o.onItemSelect(t)}}),o.actionText.attr("tabindex",0)):p.push(o);var h="button"===o.type?o.actionArrow:o.actionText.children("."+o.config.baseClass+"-dropdown-item");h.attr({tabindex:0,"aria-haspopup":!0,"aria-expanded":!1}),n.each(p,function(){n(this).on(s,function(t,i){if(o.config.displayAsActionSheetOnMobile&&e.platform.isCordova())e.native.actionSheet.createActionSheet(o.config.items);else if("click"===t.type||t.which===l.ENTER||t.which===l.SPACE){var s=this,c=n("<div>").addClass("sk-subnavigation-inner");if(i=i||!1,h.attr("aria-expanded",!0),t.which!==l.ENTER&&t.which!==l.SPACE||(i=!0),t.stopPropagation(),!o.hasClass("unavailable")){if(o.selectBox&&o.selectBox.children().length)o.selectBox.parent().length||o.append(o.selectBox),o.selectBox.toggle("fast");else{o.selectBox=n('<div class="'+o.config.baseClass+'-dropdown">').css("min-width","100%"),o.config.maxHeight&&(o.selectBox.find(".sk-subnavigation-inner").length||(o.selectBox.css({"max-height":u}),o.selectBox.wrapInner(c.css({"max-height":u}))),o.selectBox.hasClass("nx-actionselect-dropdown")&&(o.selectBox.css({"max-height":o.config.maxHeight,"overflow-y":"auto"}),o.selectBox.find(".sk-subnavigation-inner").css("max-height",""))),n.each(a.items,function(e,t){if(!0!==t.isSelected){var n=d[t.id()];n&&n.data("rendered")&&(o.config.maxHeight?(n.children().css({position:"static"}),c.append(n)):o.selectBox.append(n))}}),o.selectBox.appendTo(o),o.trigger("actionselect.populate");var f,p=n(window).width();o.selectBox.offset().left+o.selectBox.width()+8>p&&o.selectBox.css("right","0px"),o.selectBox.css("display","none").show("fast"),o.mouseleave(function(){f=setTimeout(function(){o.selectBox.hide("fast"),n(s).attr("aria-expanded",!1)},1e3)}).mouseenter(function(){clearTimeout(f)})}i&&o.selectBox.children().length>0&&o.selectBox.children().first().trigger(r)}}})})}else o.actionText.attr("tabindex",0),o.actionText.on(s,function(e){"click"!==e.type&&e.which!==l.ENTER&&e.which!==l.SPACE||(t.onSelect&&t.onSelect(t),o.onItemSelect&&o.onItemSelect(t))})}return o.config.maxHeight&&e.events.subscribe("ui.reflow",function(){n(".sk-subnavigation-inner").css({"max-height":u})}),o}},i.registerPlugin("actionSelect",t)}(skuid)},function(e,t,n){"use strict";!function(e){var t=e.$,n=e.utils,i=e.actions,r=n.getContextToUse;function o(t,n,i,o){var a,s,l=r(n,i),c=t.children("panel").first().attr("uniqueid"),d=n||i&&i.component,u=d?d.getParentPage():e.component.getByType("skuidpage")[0],f=u.panel.getById(c);f?(o&&!f.isOpen()||!o)&&(a=f.context.row,(s=f.context.model)&&a&&l.row&&l.model&&s.getRowId(a)!==l.model.getRowId(l.row)&&f.updateContext(l),f.toggle(o)):u.panel.createFromAction(t,n,l),e.events.publish("ui.panel.toggled",{id:c})}e.interactions.register(["tap","hold","doubletap","pinch","pinchin","pinchout","swipeleft","swiperight","swipedown","swipeup","swipe","drag"]),i.register({closeTopmostPopup:function(){t(t(".ui-dialog-content").get().reverse()).each(function(){try{return t(this).dialog("close"),!1}catch(e){}})},closeAllPopups:function(){t(t(".ui-dialog-content").get()).each(function(){try{t(this).dialog("close")}catch(e){}})},showPopup:function(e,t,i){n.createPopupFromAction(e,r(t,i))},openSlidingPanel:function(e,t,n){"open"===e.attr("openbehavior")?o(e,t,n,!0):o(e,t,n)},toggleSlidingPanel:function(e,t,n){o(e,t,n)},closeSlidingPanel:function(n,i,r){var o=i||r&&r.component;"topmost"===n.attr("closebehavior")?t(t(".sk-pagepanel-open").get().reverse()).each(function(){try{var n=t(this).attr("id");return e.component.getById(n).close(),!1}catch(e){}}):o?o.getParentPage().panel.closeAll():t.each(e.component.getByType("skuidpage"),function(e,t){t.panel.closeAll()})},toggleRenderComponent:function(t){var i=t.attr("componentid"),r=t.attr("behavior"),o=n._getRenderOverride(i),a=e.$C(i),s={componentId:i,component:a},l={scope:e.constants.EVENT_SCOPES.SKUID,qualifyEventName:!1};o&&(o.override=!0,o.doRender="toggle"===r?!o.doRender:"hide"!==r,a?a.publish("actions.conditionaloverride",s,l):e.events.publish("actions.conditionaloverride",[s],l))},runComponentAction:function(t,n,i){return e.actions.runAction(t.attr("action"),t,e.$C(t.attr("componentid")),i)}})}(skuid)},function(e,t,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){var t=e.$,n=e.utils,r=e.constants.LOG_LEVELS.WARNING,o=e.personalization={},a={};function s(r){var o,a,s,l,d,u=r.pageId,f="apex__sk-pf-"+u,p="sk-pf-"+u;function h(e){var n=e&&e.key;if(!t.isArray(n)||0===n.length)return null;var i,r,a=o;for(i=0;i<n.length;i++){if(!a[r=n[i]]){if(!0!==e.createNodes)return null;a[r]={}}a=a[r]}return a}function g(n,i){var r={};return function t(n,i,r){var o=Object.keys(n);if(o.length>0)for(var a=o.length-1;a>=0;a--){var s=o[a],l=Object.prototype.toString.call(n[s]);if("[object Array]"===l){var c=r+e.utils.generateGUID();i[c]=n[s],n[s]=c}else"[object Object]"===l&&t(n[s],i)}}(i,r,"personalMerge-"),t.extend(!0,n,i),function e(t,n){var i=Object.keys(t);if(i.length>0)for(var r=i.length-1;r>=0;r--){var o=i[r],a=Object.prototype.toString.call(t[o]);"[object Object]"===a?e(t[o],n):n[t[o]]&&(t[o]=n[t[o]])}}(n,r),n}function m(e){var n=e.settings,r=t.isEmptyObject(n),o=e&&e.hasOwnProperty("createNodes")?e.createNodes:!r,a=h(t.extend(e,{createNodes:o})),s=e&&e.deferUpdate;return a?"object"!==(void 0===n?"undefined":i(n))?(new t.Deferred).resolve():(n=c(n),!1!==e.deepMerge?a=g(a,n):t.extend(a,n),!0===e.removeNulls&&function e(n){var r,o;for(r in o=[],n)o.push(r);t.each(o,function(t,r){void 0===n[r]||null===n[r]?delete n[r]:"object"===i(n[r])&&e(n[r])})}(a),!0===s?(new t.Deferred).resolve():v()):(new t.Deferred).resolve()}function v(){if(a&&"pending"===a.state())return s||(s=new t.Deferred),l=!0,s.promise();a=s||new t.Deferred,s=null,void 0===o.m&&(o.m={}),"client"===d&&(o.m.lastModifiedDate=Date.now());var i=JSON.stringify(o);if("server"===d)e.remote().updatePersonalizationSettings(u,i,function(t,n){if(n.status){var i={personalization:o},r={personalization:{pageId:u,mode:d}};e.loader.cache.memory.add.meta(i,r),e.loader.cache.persistent.add.meta(i,r),a.resolve()}else a.reject(n);!0===l&&(l=!1,v())});else{var r=JSON.stringify({m:o.m}),c=JSON.stringify({c:o.c,z:o.z});t.cookie(f,r,{secure:!0,path:"/"}),n.sessionStorage(p,c),a.resolve()}return a.promise()}return function(e){var i,r;"client"===(d=e.mode||"server")?(!0===e.isModelCookieObsolete?(t.removeCookie(f),i={}):i=JSON.parse(t.cookie(f)||"{}"),r=JSON.parse(n.sessionStorage(p)||"{}"),o=t.extend({},i,r)):o=t.extend({},e.pageSettings||{})}(r),{_createService:function(e){e||(e={});var i=e.itemId,r=function(e){e||(e={});var t=[];return e.id&&(e.namespace&&t.push(e.namespace),e.type&&t.push(e.type),t.push(e.id)),t}({namespace:e.namespace,type:e.type,id:i});return{getSetting:function(e){var t=h({key:r})||{};return c(e?n.getObjectProperty(t,e):t)},getSettings:function(){return c(h({key:r})||{})},updateSettings:function(e,n){return m(t.extend(n,{key:r,settings:e}))},deleteSetting:function(e){if("string"==typeof e){var t={};t[e]=null,m({key:r,settings:t,removeNulls:!0,createNodes:!1})}}}},_savePageSettings:v,_getMode:function(){return d},_getPageSettings:function(){return c(o)}}}function l(t){t||(t={});var i=t.getParentPage&&t.getParentPage(),o=i&&i._pageRecord,l=o&&o.Id,c=t.pageId||l||e.page.id;return a[c]?a[c]:(c&&!t.pageId&&(t.pageId=c),t.mode||n.log('Warning: Skuid Personalization Page Context for "'+c+'" was intialized without a "mode" property.',r),a[c]=s(t))}function c(e){if(void 0!==e)return JSON.parse(JSON.stringify(e))}t.extend(o,{getPageSettings:function(e){return l(e)._getPageSettings()},createService:function(t){return l({pageId:t.pageId||e.page.id})._createService({namespace:"x",type:t.type,itemId:t.id})},createComponentService:function(e){var t,n=l(e);return e&&e.xmlDefinition&&e.xmlDefinition.attr?t=e.xmlDefinition.attr("uniqueid"):e&&e.definition&&(t=e.definition.uniqueId),t?n._createService({namespace:"c",type:e._componentType,itemId:t}):n._createService({})},createModelService:function(e){var n=l(e)._createService({namespace:"m",type:"sf",itemId:e&&e.id});return n=t.extend(n,{getCondition:function(e){return n.getSetting("conditions."+e)},setCondition:function(e){var i,r=e&&e.name,o=e&&e.value;return r?((i={conditions:{}}).conditions[r]=o,n.updateSettings(i)):(new t.Deferred).reject()},resetCondition:function(e){var i,r=e&&e.name;return r?((i={conditions:{}}).conditions[r]=null,n.updateSettings(i,{removeNulls:!0})):(new t.Deferred).reject()},getOrderBy:function(){return n.getSetting("orderBy")},setOrderBy:function(e){var t={orderBy:e.newValue};return n.updateSettings(t)},resetOrderBy:function(){return n.updateSettings({orderBy:null},{removeNulls:!0})}})},initializeSettings:function(e){e||(e={}),l(e)}})}(skuid||(window.skuid={}))},function(e,t,n){"use strict";!function(e){var t=void 0,n={},i=e.$,r=e.utils;function o(){return t||(t=i(document.body)),t}function a(e,t,a,s,l){var c=void 0;e&&e.children?(c=[],i.each(e.children(),function(){var e=i(this);c.push({key:e.attr("key"),ignoreTextInputs:"true"===e.attr("ignoretextinputs"),modifiers:e.attr("modifiers")})})):c=i.isArray(e)?e:[e],c&&c.length&&(l||(l=o()),c.forEach(function(e){var o,c,d=void 0,u=void 0,f=void 0;r.isString(e)?(u=!1,f=e):(d=e.modifiers,u=!0===e.ignoreTextInputs,f=(d?d.replace(",","+")+"+":"")+e.key),function(e){var t=e.bindString;(n[t]||(n[t]={}))[e.uniqueId]=e}(o={actionFunction:a,bindString:f,uniqueId:t,visibleElement:s}),c="keydown.skuid"+(t?"."+t:""),l.on(c,null,{keys:f,filterTextInputs:u},function(e){if((!u||"true"!==i(e.target).attr("contenteditable"))&&s&&s.is(":visible")&&a){var t=n[f],l=void 0,c=o;t&&r.size(t)>1&&((l=function(e){var t=e.visibleElement,n=void 0,i=-1;return t&&t.length?(n=t&&t.closest&&t.closest(".ui-dialog-content")).length?i=n.zIndex():t.closest("body").length||(i=-2):i=-2,e.zIndex=i,i})(o),i.each(t,function(e,t){c.uniqueId!==e&&t!==c&&t.actionFunction&&l(t)>c.zIndex&&(c=t)})),e.preventDefault(),e.stopImmediatePropagation(),c.actionFunction()}})}))}function s(){var e=void 0,t=void 0;2===arguments.length?(e=arguments[0],t=arguments[1]):(t=arguments[0],e=o()),e.off("keydown.skuid"+(t?"."+t:"")),function(e){i.each(n,function(t,n){n&&e in n&&delete n[e]})}(t)}e.hotkeys={bind:a,getFromCache:function(e){return n[e]},off:s,on:function(e,t,n,i,r){a(t,n,i,r,e)},unbind:function(e){s(e)}}}(skuid)},function(e,t,n){"use strict";!function(e){var t=e.utils,n=e.$,i="CURRENCY",r=e.constants.AGGREGATION_TYPES;function o(e,t){switch(e){case r.SUM:return t.reduce(function(e,t){return e+t},0);case r.AVERAGE:return t.reduce(function(e,t){return e+t},0)/t.length;case r.MAXIMUM:return t.reduce(function(e,t){return t>e?t:e},-1/0);case r.MINIMUM:return t.reduce(function(e,t){return t<e?t:e},1/0);case r.MEDIAN:var n=t.sort(function(e,t){return e-t});return t.length%2==0?(n[Math.floor(t.length/2)]+n[Math.floor(t.length/2)-1])/2:n[Math.floor(t.length/2)];case r.COUNT:return t.length}}e.aggregations={aggregate:function(e,r,a,s){s=n.extend({countBlanks:!1,rows:r.getRows()},s);var l=r.getField(a);if(!l)return null;var c=t.isMultiCurrencyOrganization,d=t.userInfo.defaultCurrency,u=!1,f=!0,p=[];return s.rows.forEach(function(e){var n,o=r.getFieldValue(e,a,!0);if(!o&&0!==o){if(!s.countBlanks)return!0;o=0}if(l&&(n=l.displaytype,c&&n===i&&o)){var h,g=t.getRowCurrency({model:r,row:e,field:a});g&&g!==d&&(h=t.convertCurrency(o,g,d))&&h!==o&&(o=h),f&&(g||(g=d),u?u!==g&&(f=!1):u=g)}p.push(o)}),o(e,p)},aggregateValues:o}}(skuid)},function(e,t,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){var t=e.$,n=e.constants,r=e.utils,o=r.mergeAsDataInContext,a=r.makeXMLDoc,s=function(t,n){return n?e.$M(o(t,n)):e.$M(t)},l=function(e,t,n,i){if(e&&t)return n?e.getConditionByName(o(t,n),i):e.getConditionByName(t,i)},c=e.actions={},d=e.interactions={},u={},f={},p={swipe:"drag",swipeleft:"dragleft",swiperight:"dragright",swipeup:"dragup",swipedown:"dragdown"},h=n.DISPLAY_TYPES,g=h.BOOLEAN,m=h.DATE,v=h.DATETIME,y=n.EVENT_SCOPES,b=c.register=function(e){t.extend(u,e)},w=r.getContextToUse,S=function(e,n,i,r){var o=this.getModel(),a="all"===n.attr("affectedrows")?"model":"row",s=this.getContextToUse(a),l=s.row,c=s.list,d=!!c&&t.map(c.getSelectedItems(),function(e){return e.row});!d&&s&&s.rows&&(d=s.rows),l&&o&&o.getRowById(o.getRowId(l))?o[e]([l]):d&&d.length&&o&&c&&c.model===o?o[e](d):d&&d.length&&r.model&&!c?r.model[e](d):o&&o.data.length&&o[e](o.data)},C=function(e){var t=r.isPromise;return e&&(e.deferred&&t(e.deferred)||t(e))};function I(n){var i=e.dataSource.get(n);return(i?t.when(i):e.loader.service.loadDataSourceAndDependencies(n)).then(function(e){return e?e.isAuthenticated()?e:e.authenticate().then(function(){return e}):void 0})}d.register=function(e){t.each(e,function(){f[this]=1})},d.processInteractionsNode=function(e,n,i){e.children().each(function(){d.processInteractionNode(t(this),n,i)})},d.processInteractionNode=function(e,n,i){if(!e||!e.children)return!1;var r=e.attr("type"),o=e.children("actions").first();if(r in f==!1)return!1;i&&i.selector?n.element.on(r,i.selector,function(e){var i=t(this),r=i&&i.data?i.data("component"):null;r||(r=n),c.runActionsNode(o,r),e&&e.gesture&&e.gesture.preventDefault()}):(n.element.on(r,function(e){c.runActionsNode(o,n),e&&e.gesture&&e.gesture.preventDefault()}),p[r]&&n.element.on(p[r],function(e){e.gesture.stopPropagation(),e.gesture.preventDefault()}))},d.runInteractionsNode=function(n,i,r,o){var s=a("<actions></actions>");return r=r.length?r:[r],n.clone().children("interaction").each(function(e,n){var i=(n=t(n)).attr("type")+("swipe"==n.attr("type")?n.attr("direction"):"");r.indexOf(i)>-1&&s.append(n.children())}),e.actions.runActionsNode(s,i,{model:o.model,item:o.item,row:o.row,list:o.list,initiatorId:o.initiatorId})},d.enableInteractions=function(t,n){var i=n.customInteractionsEvaluator,r=n.context||{},o=n.component;function a(a,s){function l(t){var o=this;if(!(t.target!==t.currentTarget&&["INPUT","BUTTON","SELECT","TEXTAREA"].includes(t.target.tagName)||t.target.getAttribute&&"button"===t.target.getAttribute("role"))){var l,c=function(e){return n.component.publish("interaction.run",{eventName:a,event:t,item:o}),e};if(i?(n.validGestures=s,n.eventName=a,n.event=t,n.item=this,l=i(n)):l=e.interactions.runInteractionsNode(n.interactionsDef,n.component,s,r),t.stopPropagation(),C(l))return l.then(c);c()}}function c(){t.off("click.skuid"),t.hammer({}),t.on(a,l)}if(("tap"==s||s.indexOf("tap")>-1)&&t.on("click.skuid",l),e.ui.hammerJSLoaded)c();else{var d=e.events.subscribeOnce("skuid.resources.hammerjsloaded",c);o&&o.storeSubscription(d)}}a("tap.skuid","tap"),a("swipeleft.skuid",["swipeleft","swipeeither"]),a("swiperight.skuid",["swiperight","swipeeither"]),a("press.skuid","press")},d.disableInteractions=function(e){e.off("tap.skuid click.skuid swipeleft.skuid swiperight.skuid press.skuid")},c.runActionsNode=function(n,i,o){var a="true"===n.attr("continuesequenceonerror"),s=n.children(),l=[],d=function(e,n){n&&(l.length=0),Array.prototype.push.apply(l,e.get().reverse().map(function(e){return t(e)}))};return i&&i.xmlDefinition&&i.xmlDefinition.attr&&i.xmlDefinition.attr("buttonset")&&(t(".sm-buttonset-"+i.xmlDefinition.attr("buttonset")).removeClass("sm-active"),i.element.addClass("sm-active")),s.length?(d(s),function n(o){var s,u=l.pop(),f=o&&o.$Output||{};return u?c.runActionNode(u,i,o).then(function(e,i){var a=u.children("iftrueactions").children();return a.length?(!0===e&&(s=u.attr("whenfinished"),d(a,"continue"!==s)),n(t.extend(o,e))):!1===e?r.reject():n(t.extend(o,e,{$Output:t.extend(f,i)}))}).catch(function(i,r){if(!0===r)return t.Deferred().reject(i,r);var s=u.children("onerroractions").children();if(s.length)d(s,!0);else if(!a)return e.mobile&&e.mobile.processResponsiveElements(),t.Deferred().reject(t.extend(o,i),!0);return n(t.extend(o,i))}):(e.mobile&&e.mobile.processResponsiveElements(),t.when(o))}(o)):t.when()},c.runActionNode=function(e,t,n){var i=e&&e.attr("type");return c.runAction(i,e,t,n)},c.runAction=function(n,i,a,s){if(n){var l,d,f={};n in u?l=u[n]:a&&a.type()&&(d=e.componentType.get(a.type()).actions)&&n in d&&(l=d[n]);var p={getContextToUse:function(e){var t={};return e&&(t.mode=e),w(a,s,t)},getModelId:function(e){e||(e={});var t=e.attributeName||"model",n=e.modelId||i&&i.attr(t),r=this.getContextToUse();return r?o(n,r):n},getModel:function(t){return e.$M(this.getModelId(t))},runAction:function(e,t){return t||(t={}),c.runAction(e,t.actionDef||i,t.component||a,t.context||s)},recordOutput:function(t,n){var o=Array.prototype.reduce.call(i.find("> outputs > output"),function(t,n){var i=e.$(n);return t[i.attr("id")]=i.attr("name"),t},{}),a={};r.isString(t)?a[t]=n:a=t,Object.getOwnPropertyNames(a).forEach(function(e){var t=o[e];t&&(f[t]=a[e])})}};return t.when(l&&l.call(p,i,a,s)).then(function(e){return C(e)&&e.deferred||e}).then(function(e){return t.when(e,f)})}},c.registerEditorWithModelsForActionsNode=function(n,i){var r=n.find("action"),o=function(e,n){var i=e.find('action[type="save"], action[type="requeryModel"], action[type="requeryModels"]');i.length&&i.each(function(){var e=t(this);"requeryModel"===e.attr("type")?n.registerModel(s(e.attr("model"))):e.children("models").children().each(function(){n.registerModel(s(t(this).text()))})})};if("action-sequence"===r.attr("type")){var a=r.attr("action-sequence-id");o(e.actionSequences.getById(a).getActions(),i)}else o(n,i)},b({branch:function(e){var t=this.getModel(),n=this.getContextToUse();return t&&(n.model=t,n.model===t&&-1===t.data.indexOf(n.row)&&(n.row=t.getFirstRow())),r.mergeInContext(e.children("formula").text(),n,{evaluateFormulas:!0,outputType:g,asData:!0,createFields:!1})},blockUI:function(n){var i={},o=n.attr("message"),a=n.attr("timeout");if(o&&(i.message=r.mergeInContext(o,this.getContextToUse(),{createFields:!0,registerFields:!1,nl2br:!0})),a&&(i.timeout=parseInt(a,10)),e.platform.isCordova())return e.native.action.blockUI(i.message.text(),a);t.blockUI(i)},unblockUI:function(){if(e.platform.isCordova())return e.native.action.unblockUI();t.unblockUI()},deactivateFilterableConditions:function(e){var n=this,i=e.children("models").first();t.each(i.children("model"),function(){n.getModel({modelId:t(this).text()}).deactivateFilterableConditions()})},save:function(n,i,r){var o,a=this,s=[],l=n.children("models").first(),c="true"===n.attr("rollbackonanyerror"),d=t.Deferred(),u=r?r.initiatorId:null,f={rollbackOnAnyError:c};return u&&(f.initiatorId=u),l.length?t.each(l.children("model"),function(){(o=a.getModel({modelId:t(this).text()}))&&s.push(o)}):(o=a.getModel())&&s.push(o),i&&i.button&&i.button.startProcessing(),t.when(e.model.save(s,f)).then(function(e){e.totalsuccess?d.resolve(e):d.reject(e),i&&i.button&&i.button.stopProcessing()},function(e){d.reject(e),i&&i.button&&i.button.stopProcessing()}),d.promise()},cancel:function(n){var i,r=this,o=[],a=n.children("models").first();a.length?t.each(a.children("model"),function(){(i=r.getModel({modelId:t(this).text()}))&&o.push(i)}):(i=r.getModel())&&o.push(i),e.model.cancel(o)},markRowsForDeletion:function(e,t,n){S.call(this,"deleteRows",e,t,n)},unmarkRowsForDeletion:function(e,t,n){S.call(this,"undeleteRows",e,t,n)},unmarkAllRowsForDeletion:function(e){var n=this,i=e.children("models").first();i.length&&t.each(i.children("model"),function(){var e=n.getModel({modelId:t(this).text()});e&&e.undeleteRows()})},createRow:function(e){var n=this,i=n.getModel();if(i){var r="all"===e.attr("affectedrows")?"model":"row",a=n.getContextToUse(r),s=a.model,l=a.row,c=a.list,d=a.editor,u=a.rows,f="append"===e.attr("appendorprepend"),p="edit"===e.attr("defaultmodefornewitems"),h=e.children("defaults").first().children(),g=[],m=function(e,n){var r=[],s={createFields:!1,registerFields:!1},l={row:e,model:n},u=c?c.conditions:null,m=d?d.conditions:null;return t.extend(l,a),d&&m&&m.length&&d.models&&t.inArray(n,d.models)>-1?t.each(m,function(){r.push(this)}):c&&u&&u.length&&c.model===i&&t.each(u,function(){r.push(this)}),h&&h.length&&h.each(function(){var e=t(this),n=o(e.attr("field"),a),i=e.attr("value"),c=o(i,l,s);r.push({field:n,value:c})}),i.createRowAsync({additionalConditions:r,doAppend:f,editModeForNewItems:p}).then(function(e){g.push(e)})},v=[];return l?v.push(m(l,s)):u&&u.length?t.each(u,function(e,t){v.push(m(t,s))}):v.push(m(null,s)),t.when.all(v).then(function(){var e={};return g.length&&(1===g.length?e.row=g[0]:e.rows=g),n.recordOutput("rows",g),e})}},adoptRows:function(e){var t=this.getModel({attributeName:"sourcemodel"}),n=this.getModel({attributeName:"targetmodel"}),i="all"===e.attr("affectedrows")?"model":"row",r=this.getContextToUse(i),o=r.list,a=r.rows,s=r.row,l=[];t&&n&&t.data&&t.data.length&&(l=s&&t.getRowById(t.getRowId(s))?n.adoptRows([s]):a&&a.length&&o&&o.model===t?n.adoptRows(a):n.adoptRows(t.data)),this.recordOutput("rows",l)},"voice-command":function(t,n,i){return e.platform.hasFeature("Voice")?e.voiceCommands.globalVoiceAction(t,n,i):r.reject("Voice feature flag is not active")},updateRow:function(n){var i,a,s,l,c=this,d=n.attr("field"),u=n.attr("valuesource"),f=n.attr("userinfotype"),p=n.attr("value"),h=c.getModel({attributeName:"fieldmodel"}),y=n.attr("datasource")||h&&h.getDataSourceName()||e.platform.getDefaultDataSourceName(),b="all"===n.attr("affectedrows")?"model":"row",w=c.getContextToUse(b),S=w.list,C=w.rows,k=w.model,x=w.row,T=["fieldvalue","datasourceuserinfo","formula","param","userinfo","modelmerge"];return d=o(d,w),t.inArray(T,u)||(u="fieldvalue"),!k&&S&&(k=S.model),h&&(i=h.getField(d))&&(a=i.displaytype),I(y).then(function(i){i||(i=e.dataSource.get(y));var b=function(s,l){var h,y,b,S,C,I,k={};if("fieldvalue"===u&&"REFERENCE"===a){y=l.getReferenceFieldRelationshipName(d);var x,T,R=r.extractFieldsFromTemplate(p);if(R&&1===R.length)if(x=R[0],r.startsWith(x,"$Model.")&&r.contains(x,".data.")){T=x.split(".");var D,A=c.getModel({modelId:T[1]}),E=parseInt(T[3],10),F=x.indexOf("."+T[3]+".")+2+T[3].length,N=x.substring(F,x.length);A&&(D=A.data[E])&&(b=N===A.getIdField()?D:A.getFieldValue(D,A.getReferenceFieldRelationshipName(N),!0))}else b=x===l.getIdField()?s:l.getFieldValue(s,l.getReferenceFieldRelationshipName(x),!0)}switch(u){default:case"fieldvalue":p?(h=o(p,t.extend(w,{model:l,row:s}),{createFields:!1,registerFields:!1}),a===g&&("false"===h?h=!1:"true"===h&&(h=!0))):a&&-1!==t.inArray(a,[g,m,v])?a===g&&(h=!1):h="";break;case"datasourceuserinfo":var M;h=(M=i&&i.getDataSourceType())&&M.evaluateUserInfoConditionSourceType?M.evaluateUserInfoConditionSourceType(i,f):i&&i.getUserInfoProperty(f);break;case"formula":h=e.formula.evaluate(n.children("formula").text(),t.extend(w,{model:l,row:s}),{outputType:a});break;case"param":h=e.page.params[p];break;case"userinfo":h=r.getUserInfoPropValue(f);break;case"modelmerge":if(S=c.getModel({attributeName:"sourcemodel"}),C=n.attr("sourcefield"),I=S.getFirstRow(),h=S&&S.getFieldValue(I,C,!0),!(y=l.getReferenceFieldRelationshipName(d)))break;b=C===S.getIdField()?I:S.getFieldValue(I,S.getReferenceFieldRelationshipName(C),!0)}return k[d]=h,y&&b&&(k[y]=b),k};h&&(x&&h.getRowById(h.getRowId(x))?s=[h.updateRow(x,b(x,k))]:C&&C.length&&k===h?(l={},t.each(C,function(e,t){l[k.getRowId(t)]=b(t,k)}),r.size(l)&&(s=h.updateRows(l))):(l={},t.each(h.data,function(e,t){l[h.getRowId(t)]=x?b(x,k):b(t,h)}),r.size(l)&&(s=h.updateRows(l)))),c.recordOutput("rows",s)})},requeryModel:function(e,n,i){var o=this,a=o.getModel(),s=t.Deferred();if(!a)return r.reject('The model "'+o.getModelId()+'" could not be resolved.');n&&n.button&&n.button.startProcessing(),a.hasChanged&&a.cancel();var l="loadmore"!==e.attr("behavior")?"updateData":"getMoreData";return t.when(a[l](void 0,i)).then(function(e){o.recordOutput("rows",e.updatedRows[a.id]),s.resolve(e),n&&n.button&&n.button.stopProcessing()},function(e){s.reject(e),n&&n.button&&n.button.stopProcessing()}),s.promise()},requeryModels:function(n,i,r){var o=this,a=[],s=n.children("models").first(),l=t.Deferred();s.length&&t.each(s.children("model"),function(){var e=o.getModel({modelId:t(this).text()});e&&a.push(e)}),i&&i.button&&i.button.startProcessing(),t.each(a,function(){this.hasChanged&&this.cancel()});var c="loadmore"!==n.attr("behavior")?"updateData":"getMoreData";return t.when(e.model[c](a,void 0,r)).then(function(e){o.recordOutput("idxrows",e.updatedRows),l.resolve(e),i&&i.button&&i.button.stopProcessing()},function(e){l.reject(e),i&&i.button&&i.button.stopProcessing()}),l.promise()},sortModel:function(e,n,i){var r=this.getModel(),a=o(e.attr("field"),i),s=t.Deferred(),l="true"===e.attr("client-side"),c="false"!==e.attr("should-query");return r?(r.toggleOrdering(a,{explicitOrder:e.attr("method")||"toggle",clientSide:l,shouldQuery:c,shouldUpdatePersonalization:!1},function(){s.resolve()}),s.promise()):s.reject("Invalid model provided for Sort Model action.").promise()},searchModel:function(e,n,i){var r,a=this.getModel();function s(e){return t.Deferred().promise().reject(e)}if(!a){var l=this.getModelId();return s(l?"Invalid Model: "+l+" does not exist, so it cannot be searched.":"No Model specified to Search.")}return(r=a.getDataSourceType())&&r.modelsCanSearch()?(a.buildSearchCondition(!1,o(e.attr("search"),i),a.getSearchableFields()),this.runAction("requeryModel")):s("The selected Model's Data Source does not support search.")},emptyModelData:function(e){var n=this,i=e.children("models").first(),r={};i.length&&(t.each(i.children("model"),function(){var e=t(this).text(),i=n.getModel({modelId:e});r[e]=i?i.emptyData():[]}),n.recordOutput("idxrows",r))},abandonRows:function(e){var t=this.getModel(),n="all"===e.attr("affectedrows")?"model":"row",i=this.getContextToUse(n),r=i.list,o=i.rows,a=i.row;t&&t.data&&t.data.length&&(a&&t.getRowById(t.getRowId(a))?this.recordOutput("rows",t.abandonRows([a])):o&&o.length&&r&&r.model===t?this.recordOutput("rows",t.abandonRows(o)):this.recordOutput("rows",t.emptyData()))},redirect:function(e){r.redirect(t.extend(this.getContextToUse(),{url:e.attr("url"),window:e.attr("window")}))},pageredirect:function(n,i,o){var a={},s=n.attr("page"),l=n.attr("route"),c=n.attr("module"),d=n.attr("namespace");t.each(n.children("params").children(),function(e,n){var i=t(n);a[i.attr("key")]=r.mergeAsDataInContext(i.attr("value"),o,{createFields:!1,registerFields:!1})}),(s||l)&&e.loader.load({isReplace:!0,namespace:d,pageName:s,pageModule:c,parameters:a,routeName:l})},custom:function(n,r,o){var a,s,l=e.snippet.get(n.attr("snippet"));if(l){if(a=this.getContextToUse(),t.extend(a,{component:r,context:o}),!1===(s=l(a)))return!1;if(s&&"object"===(void 0===s?"undefined":i(s)))return s}},"sfdc-custom-apex":function(e){return e.attr({actionname:"apex",datasource:n.SALESFORCE}),this.runAction("datasource-action")},"action-sequence":function(t,n){return e.actionSequences.runActionSequenceAction(t,n,this.getContextToUse())},"datasource-action":function(e,t){var n=e.attr("datasource"),i=this.getContextToUse(),o=e.attr("actionname");return I(n).then(function(n){return n?n.runAction(o,e,t,i):r.reject("Invalid Data Source Name for action: "+o)})},"platform-action":function(t,n,i){var o=t.attr("platform-action"),a=(e.platform.getActions?e.platform.getActions():[]).find(function(e){return e.name===o});return a?a.run(t,n,i):r.reject("Invalid Platform Action name: "+o)},"offline-syncing":function(t,n){return e.offline.runAction("offline-syncing",t,n,this.getContextToUse())},"go-online":function(t,n){return e.offline.runAction("go-online",t,n,this.getContextToUse())},"go-offline":function(t,n){return e.offline.runAction("go-offline",t,n,this.getContextToUse())},"show-pending-syncs":function(t,n){return e.offline.runAction("show-pending-syncs",t,n,this.getContextToUse())},publish:function(n,i){var o=this,a=n.attr("event"),s=n.attr("scope")||y.SKUID,l=n.children("params").children(),c=n.attr("channel"),d={scope:s,qualifyEventName:!1},u={},f=i&&i.getParentPage&&i.getParentPage();l.length&&t.each(l,function(e,n){var i=t(n),a=i.attr("name"),s=i.attr("value");u[a]=r.mergeAsDataInContext(s,o.getContextToUse())}),c&&(d.channel=c),f&&f.publish?f.publish(a,u,d):e.events.publish(a,u?[u]:void 0,d)},setCondition:function(e,n){var i,a,s,c=this.getContextToUse(),d=this.getModel(),u=c.model,f=c.row,p=c.rows,h=e.attr("value");return!!d&&(!!(i=l(d,e.attr("condition"),c,!0))&&(!u&&n&&n.model&&(u=n.model),u||(u=d),!f&&p&&p.length&&(f=p[0]),f||(n&&n.row&&!r.isFunction(f)&&(f=n.row),!f&&u&&(f=u.getFirstRow())),s=t.extend({},c,{row:f,model:u}),a=o(h,s,{createFields:!1,registerFields:!1}),void d.setCondition(i,a)))},deactivateCondition:function(e,t,n){var i=this.getModel();if(!i)return!1;var r=l(i,e.attr("condition"),n);r&&i.deactivateCondition(r)},activateCondition:function(e,t,n){var i,r=this.getModel();if(!r)return!1;(i=l(r,e.attr("condition"),n))&&r.activateCondition(i)},updateIncludePanel:function(n,i,r){var o=e.component.getById(n.attr("panelid")),a=n.attr("pagename"),s=n.attr("querystring"),l=n.attr("module"),c=r.model,d=r.row,u=t.Deferred();return o?(o.pagename=e.utils.mergeAsText("row",a,{createFields:!1,registerFields:!1},c,d),o.includeType="skuid",l&&(o.modulename=l),o.querystring=s?"?"+e.utils.mergeAsText("row",s,{createFields:!1,registerFields:!1},c,d):"?"+n.attr("parameter")+"="+d.Id,o.load(u.resolve)):u.resolve(),u.promise()}}),b(e.native.action.getActionsToRegister())}(skuid)},function(e,t,n){"use strict";!function(e){var t=e.$,n=e.native=e.native||{},i=e.utils,r="skuid-native-update-user-location",o="skuid-native-sort-by-proximity",a="skuid-native-add-distance-and-time-data",s="skuid-native-open-in-map",l="skuid-native-send-push-notifications",c="skuid-native-share";function d(){return e.platform.hasFeature("Native")}function u(){var i=t.when();return e.utils.userInfo.location||(i=n.initializeUserLocation()),i}function f(n,r,o){if(!e.platform.isCordova())return t.when();var a=i.mergeAsTextInContext(n.attr("url"),o),s=i.mergeAsTextInContext(n.attr("message"),o),l=i.mergeAsTextInContext(n.attr("title"),o);if(!a&&!s)return i.reject("No content for share screen specified");var c={message:s,subject:l,url:a,chooserTitle:l},d=t.Deferred();return window.plugins.socialsharing.shareWithOptions(c,function(){d.resolve()},function(){d.reject()}),d.promise()}function p(){return d()?n.geo.updateCurrentUserPosition():t.when()}function h(n){if(!d())return t.when();var r=n.attr("model"),o=n.attr("address"),a=e.model.getModel(r);if(!a)return i.reject("Invalid Model ID");if(!o)return i.reject("Must specify address template");var s=a.getRows();if(s.length>50)return i.reject("Model has too many rows to perform this action");var l=[];return t.each(s,function(e,t){var n=a.getRowId(t),r=i.mergeAsTextInContext(o,{row:t,model:a});l.push({id:n,address:r})}),u().then(function(){return m(l)}).then(function(){var e=i.keyBy(l,"id");a._customSortData(function(t,n){var r=i.grab(e[a.getRowId(t)],"distance","value"),o=i.grab(e[a.getRowId(n)],"distance","value");return r||0===r?o||0===o?r-o:-1:1})})}function g(n){if(!d())return t.when();var r=n.attr("model"),o=n.attr("address"),a=n.attr("units"),s=n.attr("duration-field"),l=n.attr("distance-field"),c=e.model.getModel(r);if(!c)return i.reject("Invalid Model ID");if(s&&!c.fieldsMap[s])return i.reject("Invalid duration field");if(l&&!c.fieldsMap[l])return i.reject("Invalid distance field");if(!l&&!s)return i.reject("Must have a duration or distance field set");if(!o)return i.reject("Must specify address template");var f=c.getRows();if(f.length>50)return i.reject("Model has too many rows to perform this action");var p=[];return t.each(f,function(e,t){var n=c.getRowId(t),r=i.mergeAsTextInContext(o,{row:t,model:c});p.push({id:n,address:r})}),u().then(function(){return m(p,a)}).then(function(e){t.each(e,function(e,n){var i=c.getRowById(n.id),r={};s&&n.time&&(r[s]=n.time.text),l&&n.distance&&(r[l]=n.distance.text),t.extend(i,r)}),c.notifyEditorsOfDataRefresh()})}function m(e,i){var r=t.map(e,function(e){return e.address});return n.geoAPI.getDrivingDistanceAndTripTimeFromAddresses(r,i).then(function(n){return t.each(e,function(e,t){n[t.address]&&(t.distance=n[t.address].distance,t.time=n[t.address].time)}),e})}function v(n,r,o){var a=n.attr("address"),s=e.platform.isCordova(),l=encodeURIComponent(i.mergeAsTextInContext(a,o)),c=void 0;return!s||e.native.isAndroid()?c=t('<a href="http://maps.google.com?q='+l+'"></a>'):e.native.isIOS()&&(c=t('<a href="https://maps.apple.com/?address='+l+'"></a>')),c&&c[0].click(),t.when()}function y(n,r,o){var a=n.attr("method")||"model",s=n.attr("model"),l=n.attr("app"),c=n.attr("field"),d=i.mergeAsDataInContext(n.attr("title"),o),u=i.mergeAsDataInContext(n.attr("body"),o),f=e.$M(s);return e.native.push.sendNotifications(l,{title:d,body:u,method:a,users:"model"===a&&t.map(f.data,function(e){var t=e[c];if(t)return t})})}n.action={getActionsToRegister:function(){var e={};return e[r]=p,e[o]=h,e[a]=g,e[s]=v,e[l]=y,e[c]=f,e},blockUI:function(e,n){window.SpinnerDialog.show(null,e||null,!0,{overlayOpacity:.6,textColorRed:1,textColorGreen:1,textColorBlue:1});var i=t.Deferred();return n?(window.setTimeout(function(){window.SpinnerDialog.hide(),i.resolve()},n),i.promise()):i.resolve()},unblockUI:function(){window.SpinnerDialog.hide()}}}(window.skuid)},function(e,t,n){"use strict";!function(e){var t=e.utils,n=e.$,i={},r=e.constants.ACTION_SEQUENCE_TYPES,o=e.constants.EVENT_SCOPES;function a(a,s){this._id=a.attr("id"),this._name=a.attr("label"),this._type=a.attr("type")||r.REUSABLE,this._description=a.children("description").text(),this._actionNodes=a.children("actions"),this._pageComponent=s,this._inputs=a.children("inputs").children(),this._voiceCommand=a.attr("voice-command"),this._type===r.EVENT_TRIGGERED&&s?function(i,r){var a=i.getPageComponent(),s=r.attr("event-name"),l=r.attr("event-channel"),c=r.attr("event-scope")||o.PAGE,d={scope:o.PAGE},u={scope:c},f={};if(!s)return;function p(e){var o,s=arguments[arguments.length-1],l=s.uniqueId;e&&n.isPlainObject(e)&&t.size(e)&&(o={},n.each(e,function(e,t){o[e]=t})),f[l]||(f[l]=1,setTimeout(function(){delete f[l]},5),i._run(a,{},r,o))}l&&(u.channel=d.channel=l);a.subscribe(s,p,d),(c===o.SKUID||c===o.GLOBAL)&&a.storeSubscription(e.events.subscribe(s,p,u))}(this,a):this._type===r.HOTKEY_TRIGGERED&&s&&function(t,n){var i=n.children("hotkeys").first(),r=t.getId(),o=t.getPageComponent();e.hotkeys.unbind(r),i.length&&e.hotkeys.bind(i,r,function(){t._run(o,{},n)},o?o.getElement():null)}(this,a),i[this._id]=this}function s(e){return e&&e.$Input||{}}function l(e,t){var i=s(t);t.$Input=n.extend({},i,e)}function c(){return n.map(i,function(e){return e})}function d(e){var t="id"===(e=e||"id")?"getId":"getName",r={};return n.map(i,function(e){r[e[t]()]=e}),r}function u(e){var t=d("id");return e?t[e]:t}function f(e){return n.map(e,function(e){var t;if(e)return t=e.definition&&e.getType&&"skuidpage"===e.getType()?e.definition:e,n.map(function(e){if(e)return e.find("resources > actionsequences > actionsequence")}(t),function(e){return n(e)})})}function p(){return n.map(e.component.getByType("skuidpage"),function(e){return e.definition})}a.prototype={getId:function(){return this._id},getName:function(){return this._name},getVoiceCommandId:function(){return this._voiceCommand},getDescription:function(){return this._description},getPageComponent:function(){return this._pageComponent},getType:function(){return this._type},getInputs:function(e){var t=this._inputs;if(!e)return t;var i=[];return n.each(t,function(e,t){(t=n(t)).attr("type")&&i.push(t)}),i},run:function(e,t){return this._run(null,t,null,e)},_run:function(i,r,o,a){r=r||{};var c=o&&o.children("inputs").children(),d=s(r);return c&&c.length&&function(e,i){var r={};n.each(e,function(n){var o=e.eq(n);r[o.attr("name")]=t.mergeAsDataInContext(o.attr("value"),i)}),l(r,i)}(c,r),a&&l(a,r),e.actions.runActionsNode(this.getActions(),i,r).then(function(e){return r.$Input=d,e}).catch(function(e){throw r.$Input=d,e})},getActions:function(){return this._actionNodes},unregister:function(){delete i[this._id],this._type===r.HOTKEY_TRIGGERED&&e.hotkeys.unbind(this._id)}},e.actionSequences={ActionSequence:a,getAll:c,getAllActionSequencesFromPages:f,getAllVoiceCommandListeners:function(){return c().filter(function(e){if(e.getVoiceCommandId())return e})},getById:u,getByName:function(e){var t=d("name");return e?t[e]:t},getSequenceXMLFromId:function(e,n){e=t.escapeSelector(e),n=n||p();for(var i,r=0;r<n.length;r++)if((i=n[r].find("actionsequence#"+e).first()).length)return i},initializeActionSequences:function(e){return f(e?[e]:p()).map(function(t){return new a(t,e)})},map:d,runActionSequenceAction:function(e,t,n){var i=u(e.attr("action-sequence-id"));if(!i)throw"Invalid Action Sequence specified.";return i._run(t,n,e)}}}(skuid)},function(e,t,n){"use strict";!function(e){var t=e.$,n=e.utils,i=n.grab,r=e.constants;function o(){return"chatbotfulloverlay"}function a(e,n){var r=e.find("example-command");return function(e,t){if(i(e,"length")<=t)return e;var n=[];for(;t>0;){var r=s(0,e.length);n.push(e[r]),e.splice(r,1),t--}return n}(t.map(r,function(e){return t(e).attr("value")}),n=n||5)}function s(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e))+e}function l(e){if(e)return e.replace(/\s/g,"").toLowerCase()}function c(e,n){var i={};return e&&n?(t.each(n,function(n,r){t.each(e,function(e,t){var n=l(t[r]);n&&(i[n]||(i[n]=t))})}),i):{}}function d(e){return!!e&&"true"===e.attr("voice-enabled")}function u(e){if(e)return e.attr("voice-datasource")}function f(){return n.inPlatform(r.NATIVE)}e.voiceCommands={getExampleVoiceCommands:a,getDataSourceConfiguredForVoiceOnPage:function(t){var n=d(t),i=u(t);if(f()&&n&&i)return e.dataSource.getDataSource(i)},getVoiceDataSourceName:u,getUIComponentType:o,globalVoiceAction:function(n,i,r){var o=n.closest("skuidpage"),s=u(o),d=a(o);return e.loader.service.loadDataSourceAndDependencies(s).then(function(){var t,o,a,l,c=e.dataSource.getDataSource(s),u=c&&c.getDataSourceType(),f={conversationKillSwitch:u.voiceCommands.methods.conversationKillSwitch,examples:d},p=i&&i.getParentPage&&i.getParentPage(),h={};if(p&&(h._parentPageId=p.id()),l={listeningHandler:(a=(o=e.component.factory({definition:f,state:h,type:"chatbotfulloverlay"}))._getCPI()).listeningHandler||function(){},processingHandler:a.processingHandler||function(){},textSubmissionHandler:a.textSubmissionHandler||function(){},responseHandler:a.responseHandler||function(){},endOfConversationHandler:a.endOfConversationHandler||function(){}},p&&(p.getContentElement().append(o.element),p.childComponents.push(o)),!u||!u.supportsVoiceCommands())throw"Data source does not support voice iteraction";if(!p)throw"No page component available";return t=u.getPageParametersForVoiceCommands(p.definition),u.voiceCommands.methods.beginConversation(c,n,t,l,r)}).then(function(o){var a=o.inputs,s=o.actionSequence;if(!s)throw"No Action Sequence configured for voice command";return function(n,i){var r=i,o=r.getInputs("model"),a=r.getInputs("model-field"),s=r.getInputs("model-condition"),d=e.model.map(),u=c(d,["id","label","labelPlural"]);t.each(o,function(e,t){var i,r=t.attr("name"),o=n[r];o=l(o),(i=u[o])&&(n[r]=i.id)}),t.each(a,function(e,t){var i=t.attr("name"),r=t.attr("model-source"),o=n[r],a=d[o],s=a&&a.fields,u=n[i],f=c(s,["id","label"]);u=l(u),(f=f[u])&&(n[i]=f.id)}),t.each(s,function(e,t){var i=t.attr("name"),r=t.attr("model-source"),o=n[r],a=d[o],s=a&&a.conditions,u=n[i],f=c(s,["name","field"]);u=l(u),f[u]&&(n[i]=f.name)})}(a,s),s._run(i,r,n,a)})},pageIsVoiceEnabled:d,voiceIsConfigurableForOrg:f}}(skuid)},function(e,t,n){"use strict";!function(e){var t=e.$,n=e.ui,i=n.getRenderer,r=e.utils,o=e.time,a=r.isUndefined,s=o.parseDateString,l=o.resolveDateTimeValue,c=o.getSFDate,d=o.getSFDateTime,u=e.label.read,f=r.makeXMLDoc,p=e.model.Condition,h="keydown.action.skuid",g=e.$.ui.keyCode,m=e.constants.DISPLAY_TYPES,v=m.CURRENCY,y=m.PERCENT,b=m.MULTIPICKLIST,w=m.DATE,S=m.DATETIME,C="server",I="client";function k(n){n||(n={});var m,x,T,R,D,A,E,F=n.xml,N=n.list,M=N.model,_=M.getDataSource(),P=M.getDataSourceName(),O=this,L=O.element=n.element||t("<div>"),U=F.attr("condition"),B=O.type=F.attr("type"),j=!1,V=O.items=[],G=!!N&&N.options.delayFilterExecution,H=F.attr("labelmode"),z=F.attr("filtermethod")||C,q=F.attr("filteroffoptionlabel"),$=n.cssClass||"";function W(e){var n=O.filterCondition;return!(!n||n.inactive)&&(O.isMultiselect?t.inArray(e,n.values)>-1:e===n.value)}H||"daterange"!==B&&"numericrange"!==B||(H="auto"),"New Filter"===q&&F.attr("filteroffoptionlabel",""),O.affectCookies="false"!==F.attr("affectcookies"),O.isReferenceFilter=!1,L.addClass("nx-conditiontoken"),O.list=N,O.model=N.model,O.sources=[],$&&O.element.addClass($),O.affectedConditions={},U&&(O.filterCondition=M.getConditionByName(U,!0),!m&&O.filterCondition&&(m=M.getField(O.filterCondition.field))),O.filterCondition&&(O.affectedConditions[U]=O.filterCondition),F.find("effect").each(function(){var e=t(this).attr("condition"),n=M.getConditionByName(e,!0);n&&(O.affectedConditions[e]=n)});var Y,K,X,J,Q,Z,ee,te,ne,ie,re,oe,ae,se,le,ce,de,ue,fe,pe,he=function(e,t){if(!e)return"";var n=e;return t===v&&(n="$"+e),t===y&&(n=e+"%"),n},ge=function(e){var t=e.keyCode?e.keyCode:e.which;-1!==[8,9,13,27,46,110,190].indexOf(t)||65==t&&(e.ctrlKey||e.metaKey)||t>=35&&t<=40||t>=48&&t<=57&&!e.shiftKey&&!e.altKey||t>=96&&t<=105||e.preventDefault()},me=function(e,t,n){var i,r,o,a;return e.length>1?(i=n.getValueKeyPrefix(t),r=(a=e.find(function(e){return e.keyPrefix===i})).objectName,o=a.keyField||"Id"):(r=(a=e[0]).objectName,i=n.getValueKeyPrefix(t,r),o=a.keyField||n.getIdField(M)),{keyPrefix:i,targetObjName:r,keyField:o}};if("select"===B||"multiselect"===B){O.isMultiselect="multiselect"===B;var ve,ye,be,we="auto"===F.attr("conditionsource");if(we){if(!(ve=F.attr("conditionfield")))return;if(m=M.getField(ve),O.isReferenceFilter=!1,"REFERENCE"!==m.displaytype||r.endsWith(m.id,"RecordTypeId")||(O.isReferenceFilter=!0),U="__autofilter__"+ve,O.filterCondition=ye=M.getConditionByName(U,!0),ye){if(ye&&O.isReferenceFilter&&!0!==ye.inactive){var Se=[],Ce=O.isMultiselect&&ye.values,Ie={};Ce?t.each(ye.values,function(e,t){Se.push(t)}):ye.value&&Se.push(ye.value);var ke=M.getField(ye.field).referenceTo;if(Se.length){t.each(Se,function(e,t){var n=me(ke,t,_),i=Ie[n.keyPrefix];i||(i=Ie[n.keyPrefix]={objectType:n.targetObjName,dataSourceName:P,idField:n.keyField,fields:[_.getNameField(n.targetObjName)],records:[]}),i.records.push(t)});var xe=e.data.getSync(Ie);xe?(t.each(Se,function(e,t){var n=me(ke,t,_),i=xe[n.keyPrefix],r=!!i&&i[t],o=Ie[n.keyPrefix].fields[0];V.push({label:r?r.record[o]:"Invalid record",value:t,isSelected:!0})}),Ce||(j=!0)):(t.each(Se,function(t,n){V.push({label:e.$L("loading"),value:n,isSelected:!0})}),Ce||(j=!0),e.data.get(Ie).then(function(){L.empty(),new k({element:L,xml:F,list:N})}))}}}else{O.filterCondition=ye=new p;var Te=F.attr("conditionoperator");Te||(Te=O.isMultiselect?"MULTIPICKLIST"===m.displaytype?"includes":"in":"="),O.isMultiselect&&"fieldvalue"===ye.type&&(ye.type="multiple",delete ye.sourceType),ye.operator=Te,ye.field=ve,ye.inactive=!0,ye.name=U,ye.encloseValueInQuotes=!0,z===I&&(ye.processOnClient=!0),ye.originalValue="",ye.value="",ye.originalInactive=!0,M.addCondition(ye)}O.affectedConditions[U]=ye}z===I&&(O.filterCondition.processOnClient=!0),("true"===F.attr("createfilteroffoption")||we)&&(be=r.mergeAsText("global",F.attr("filteroffoptionlabel")||"",{createFields:!0,registerFields:!1}),O.isMultiselect||O.isReferenceFilter||(this.filterCondition&&this.filterCondition.value===this.filterCondition.originalValue&&(j=!0),this.filterCondition||(j=!0),V.push({label:be,value:"__reset",affectDefaultCondition:!0,isSelected:j})));var Re=F.children("sources").first();if(!we||Re.length&&Re.children().length||(Re.length||(Re=f("<sources/>")),Re.append(f('<source type="metadata"/>'))),Re.children().each(function(){var n,i=t(this),o=i.attr("effectsbehavior"),a={};if(O.sources.push(a),"defaultandothers"!==o&&"justothers"!==o||(n=i.children("effects").children()).length&&(a.effects=n),"manual"===i.attr("type"))i.children("options").children().each(function(){var e,n,i=t(this);if("simple"===i.attr("type")&&O.filterCondition){var o=i.attr("value");void 0===o?o="":r.isString(o)&&(o=r.mergeAsDataInContext(o,{model:O.model})),n=W(o),e={label:r.mergeAsText("global",i.attr("label")||o||"",{createFields:!0,registerFields:!1}),value:o,isSelected:n,affectDefaultCondition:!0,source:a},n&&(j=!0)}else if("complex"===i.attr("type")){var s=i.children("effects").children(),l=r.mergeAsText("global",i.attr("label")||"",{createFields:!0,registerFields:!1});e={label:l,effects:s,value:l,isSelected:n=O.isSelectedFromEffects(s),source:a},n&&(j=!0)}e&&V.push(e)});else{var s="justothers"!==i.attr("effectsbehavior");if("model"===i.attr("type")){var l=e.$M(i.attr("model")),c=i.children("labeltemplate").text(),d=i.children("valuetemplate").text();l&&(a.model=l,t.each(l.data,function(e,t){var n=r.mergeAsText("row",c||"{{{"+r.getNameField(l.objectName)+"}}}",{createFields:!0,registerFields:!1},l,t),i=r.mergeAsText("row",d||"{{{Id}}}",{createFields:!1,registerFields:!1},l,t),o=W(i);V.push({label:n,value:i,isSelected:o,affectDefaultCondition:s,source:a,row:t}),o&&(j=!0)}))}else if("metadata"===i.attr("type")){if(O.filterCondition){var u=m,f=r.mergeAsText("model",i.attr("prefix")||"",{createFields:!0,registerFields:!1},M),p=r.mergeAsText("model",i.attr("suffix")||"",{createFields:!0,registerFields:!1},M),h={};if(t.each(V,function(e,t){h[t.value]=t}),u){var g=M.recordTypeInfos;u.picklistEntries&&u.picklistEntries.length?t.each(u.picklistEntries,function(e,t){var n=t.value,i=W(n),r=t.label?t.label:n;h[n]||V.push({label:f+r+p,value:n,isSelected:i,affectDefaultCondition:s,source:a}),i&&(j=!0)}):g&&g.length&&r.endsWith(u.id,"RecordTypeId")&&t.each(g,function(e,t){var n=t.recordTypeId;if(t.isAvailable&&(1===g.length||!t.isMaster)){var i=W(n);h[n]||V.push({label:f+t.name+p,value:n,isSelected:i,affectDefaultCondition:s,source:a}),i&&(j=!0)}})}}}else if("custom"===i.attr("type")){var v=i.attr("snippet");if(v){var y=e.snippet.get(v);y&&t.each(y({list:O,model:M}),function(e,n){var i=t("<div>").append(n.label?M.mergeModel(n.label):""),r=W(n.value);V.push({label:i.text(),value:n.value,isSelected:r,affectDefaultCondition:s,source:a}),r&&(j=!0)})}}}}),j||O.isMultiselect||O.isReferenceFilter||V.push({label:" - - - - ",value:"",isSelected:!0}),O.activateFilter=function(){O.isMultiselect||O.isReferenceFilter?(O.resetAffectedConditions(),O.isReferenceFilter?(V.length=0,Array.prototype.push.apply(V,t.map(L.actionAutocomplete("getSelectedItems"),function(e){return e.isSelected=!0,e.affectDefaultCondition=!0,e}))):O.setOriginalValue(L.val()),V.length&&(O.hasSelected=!1,t.each(V,function(){this.isSelected?(O.hasSelected=!0,O.applyFilterForItem(this,{fireSourceEffects:!1})):O.unApplyFilterForItem(this,{fireSourceEffects:!1})})),O.hasSelected||(O.filterCondition.inactive=!0),O.handleSourceEffects(V)):O.selectedItem&&(O.resetAffectedConditions(),O.applyFilterForItem(O.selectedItem),O.setOriginalValue(O.selectedItem))},O.isMultiselect&&!O.isReferenceFilter){var De=!1,Ae=t.map(V,function(e){if(e.isSelected)return De=!0,e.value}).join(";"),Ee=function(){var e=L.data("multiselect-newvalues"),n=L.data("multiselect-oldvalues");if(!1===M.hasChanged){var i={};a(e)||t.each(e.split(";"),function(){i[this]=1}),t.each(V,function(e,t){t.isSelected=t.value in i}),G?(a(n)&&(n="__reset"),O.setOriginalValue(n),O.list.showFilterActions()):(O.activateFilter(),O.executeFilter())}},Fe=function(){O.restoreOriginalValue()};O.setOriginalValue(De?Ae:"__reset"),i(b).edit({position:{my:"right top",at:"right bottom"},element:L.addClass("nx-actionselect"),entries:V,value:Ae,selectedText:m?m.label+": "+u("number_selected"):null,selectedList:n.selectedList||3,noneSelectedText:be,onChange:function(e,t){L.data({"multiselect-newvalues":e,"multiselect-oldvalues":t}),G&&Ee()},onClose:function(){0!==M.isProcessing||G||Fe()},onCreate:function(){var e=t(this),n=e.multiselect("widget");G||n.append(t("<div>").addClass("ui-widget-footer ui-multiselect-footer ui-helper-clearfix").append(t("<div>").attr({role:"button",tabindex:0}).text(u("apply")).addClass("sk-timefilter-button").css("cursor","pointer").on("click "+h,function(t){"click"!==t.type&&t.which!==g.ENTER&&t.which!==g.SPACE||(Ee(),e.multiselect("close"))}),t("<div>").attr({role:"button",tabindex:0}).text(u("cancel")).addClass("sk-timefilter-button-grey").css("cursor","pointer").on("click "+h,function(t){"click"!==t.type&&t.which!==g.ENTER&&t.which!==g.SPACE||(Fe(),e.multiselect("close"))})))}}),O._reflowEventSubscription=e.events.subscribe("ui.reflow",O.multiSelectMaxWidth=function(){var e=L.find("div[type=button]").find("span").not(".ui-icon"),t=e.closest(".ui-multiselect"),n=L.find("div[type=button]").find(".nx-actionselect-arrow"),i=function(){var e=L.closest(".nx-panel-left");if(e.length||(e=L.closest(".nx-panel-right")),e.length>0)return e.width()}();i&&(t.css({"max-width":i-10+"px"}),e.css({"max-width":i-n.width()-10+"px","text-wrap":"none",overflow:"hidden","box-sizing":"border-box"}),L.css({"max-width":i+"px"}))}),L.find(".ui-multiselect").append('<div class="nx-actionselect-arrow"><div class="ui-icon ui-icon-triangle-1-s"/></div>')}else{var Ne=function(e){if(!1===M.hasChanged){var n=O.selectedItem;O.selectedItem=e,G?(O.isReferenceFilter?(t.each(O.affectedConditions,function(){this.values=[]}),O.setOriginalValue(t.map(V,function(e){return e.value}).join(";")),V.length=0,Array.prototype.push.apply(V,t.map(L.list.items,function(e){return e.isSelected=!0,e.affectDefaultCondition=!0,e}))):O.setOriginalValue(n),O.list.showFilterActions()):(O.activateFilter(),O.executeFilter())}},Me=parseInt(F.attr("autocompthreshold"),10);if(m&&O.isReferenceFilter){var _e=F.children("conditions").children("condition").map(function(e,n){return new p(t(n))}).toArray();L.actionAutocomplete({refField:m,model:M,items:V,onItemSelect:Ne,isMultiselect:O.isMultiselect,defaultOptionLabel:be,additionalConditions:_e})}else if(V.length<(Me||25)){var Pe=F.attr("maxheight");L.actionSelect({items:V,onItemSelect:Ne,maxHeight:Pe})}else L.actionAutocomplete({model:M,items:V,onItemSelect:Ne})}}else if("toggle"===B){var Oe=F.children("effects").children(),Le=O.isSelectedFromEffects(Oe);Le||L.addClass("disabled"),O.activateFilter=function(){if(!1===M.hasChanged&&O.selectedItem){var e=L.is(".disabled");O.resetAffectedConditions(),e?O.unApplyFilterForItem(O.selectedItem):O.applyFilterForItem(O.selectedItem),O.setOriginalValue(e)}},L.actionSelect({items:[{label:r.mergeAsText("model",F.attr("label")||"",{createFields:!0,registerFields:!1},M),effects:Oe,value:"",isSelected:Le}],onItemSelect:function(e){var t=L.is(".disabled");L.toggleClass("disabled"),O.selectedItem=e,G?(O.setOriginalValue(t),O.list.showFilterActions()):(O.activateFilter(),O.executeFilter())}})}else if("daterange"===B){if(Y=F.attr("startcondition"),K=F.attr("endcondition"),Y&&K&&"auto"!==F.attr("conditionsource"))X=M.getConditionByName(Y,!0),J=M.getConditionByName(K,!0);else if(Y="__autofilter__start__"+(Q=F.attr("conditionfield")),K="__autofilter__end__"+Q,X=M.getConditionByName(Y,!0),J=M.getConditionByName(K,!0),!X||!J){if(!Q)return!1;(X=new p).operator="gte",X.field=Q,X.inactive=!0,X.name=Y,X.encloseValueInQuotes=!1,(J=new p).operator="lte",J.field=Q,J.inactive=!0,J.name=K,J.encloseValueInQuotes=!1,M.addCondition(X),M.addCondition(J)}if(z===I&&(X.processOnClient=!0,J.processOnClient=!0),x=M.getField(X.field),T=M.getField(J.field),!x||!T){if("param"!==X.sourceType||"param"!==J.sourceType)return!1;x=T={}}Z=x.displaytype,ee=T.displaytype,X.inactive?te="":(A=l(X.value,{fieldType:Z,useLocalTimezone:!0}),te=c(A)),J.inactive?ne="":(E=l(J.value,{fieldType:ee,useLocalTimezone:!0}),ne=c(E)),pe=function(){Ue.datepicker("getDate")||Be.datepicker("getDate")?de.css("display","block"):de.css("display","none")};var Ue=i(w).edit({value:te,onChange:pe}).addClass("sk-timefilter-input"),Be=i(w).edit({value:ne,onChange:pe}).addClass("sk-timefilter-input");L.addClass("nx-actionselect nx-conditiontoken"),ie=t("<div>"),re=t("<div>").addClass("nx-actionselect-text").append(ie),oe=t("<div>").addClass("nx-actionselect-arrow").append(t("<div>").addClass("ui-icon ui-icon-triangle-1-s")),ae=t("<div>").addClass("nx-actionselect-dropdown sk-timefilter-body").hide(),se=t("<div>").text(u("start_date")).addClass("sk-timefilter-label"),le=t("<div>").text(u("end_date")).addClass("sk-timefilter-label"),ce=t("<div>"),(de=t("<div>").addClass("sk-timefilter-clearfilter-button").text("Clear Filter")).click(function(){Ue.datepicker("setDate",null),Be.datepicker("setDate",null),pe()}),G?(fe=t("<div>").text(u("done")).addClass("sk-timefilter-button").attr({role:"button",tabindex:0}),ce.append(fe)):(ue=t("<div>").text(u("cancel")).addClass("sk-timefilter-button-grey").attr({role:"button",tabindex:0}),fe=t("<div>").text(u("apply")).addClass("sk-timefilter-button").attr({role:"button",tabindex:0}),ce.append(fe,ue)),O.updateDisplayValue=function(t,n){var i,a=o.makeFormattedDateFromLocal,s=e.label.merge;return i=t&&n?a(t)+" - "+a(n):t&&!n?s(u("after_this"),a(t)):!t&&n?s(u("before_this"),a(n)):r.mergeAsText("global",F.attr("filteroffoptionlabel")||u("all_time")),ie.text(i),t instanceof Date&&Ue.datepicker("setDate",t),n instanceof Date&&Be.datepicker("setDate",n),pe(),O},O.updateDisplayValue(A,E),ue&&ue.click(function(){ae.hide("fast")}),O.activateFilter=function(){var t,n,i=Ue.datepicker("getDate"),r=Be.datepicker("getDate");if(i&&(t=c(i)),r&&(n=c(r)),t?(Z===S&&(t=d(e.time.getRealJSDateTimeFromLocal(s(t)))),M.setCondition(X,t,O.affectCookies)):M.deactivateCondition(X,O.affectCookies),n){if(ee===S){var o=e.time.getRealJSDateTimeFromLocal(s(n));o.setDate(o.getDate()-0+1),n=d(o)}M.setCondition(J,n,O.affectCookies)}else M.deactivateCondition(J,O.affectCookies);O.setOriginalValue({start:i,end:r})},fe.on("click "+h,function(e){if("click"===e.type||e.which===g.ENTER||e.which===g.SPACE){var t=Ue.datepicker("getDate"),n=Be.datepicker("getDate");G?O.list.showFilterActions():(O.activateFilter(),O.executeFilter()),O.updateDisplayValue(t,n),ae.hide("fast")}}),ae.append(se,Ue,le,Be,de,ce),L.addClass("nx-actionselect-haslabel").append(re,oe,ae),re.attr("tabindex",0),oe.attr("tabindex",0),re.add(oe).on("click "+h,function(e){"click"!==e.type&&e.which!==g.ENTER&&e.which!==g.SPACE||L.hasClass("unavailable")||(ae.is(":visible")?ae.toggle("fast"):(ae.css("min-width",Math.max(L.width(),180)+"px"),ae.show("fast"),ae.position({my:"left top",at:"left bottom",of:L,collision:"flip"})))}),ae.on(h+" focusout",function(e){e.which===g.ESCAPE&&(ae.toggle("fast"),re.trigger("focus"))})}else if("numericrange"===B){var je,Ve=function(){var e,t,n,i,r;if(e=F.attr("startcondition"),n=F.attr("endcondition"),e&&n&&"auto"!==F.attr("conditionsource"))t=M.getConditionByName(e,!0),i=M.getConditionByName(n,!0);else if(e="__autofilter__nstart__"+(r=F.attr("conditionfield")),n="__autofilter__nend__"+r,t=M.getConditionByName(e,!0),i=M.getConditionByName(n,!0),!t||!i){if(!r)return!1;t=new p({operator:"gte",field:r,inactive:!0,name:e,encloseValueInQuotes:!1}),i=new p({operator:"lte",field:r,inactive:!0,name:n,encloseValueInQuotes:!1}),M.addCondition(t),M.addCondition(i)}return z===I&&(t.processOnClient=!0,i.processOnClient=!0),[t,i]}();if(X=Ve[0],J=Ve[1],x=M.getField(X.field),T=M.getField(J.field),!x||!T)return!1;je=x.displaytype,te=X.inactive?"":X.value,ne=J.inactive?"":J.value;var Ge=t("<input>").val(te).addClass("sk-timefilter-input"),He=t("<input>").val(ne).addClass("sk-timefilter-input");Ge.on(h,ge),He.on(h,ge),pe=function(){Ge.val()||He.val()?de.css("display","block"):de.css("display","none")},L.addClass("nx-actionselect nx-conditiontoken"),ie=t("<div>"),re=t("<div>").addClass("nx-actionselect-text").append(ie),oe=t("<div>").addClass("nx-actionselect-arrow").append(t("<div>").addClass("ui-icon ui-icon-triangle-1-s")),ae=t("<div>").addClass("nx-actionselect-dropdown sk-timefilter-body").hide(),se=t("<div>").text("Min. Value").addClass("sk-timefilter-label"),le=t("<div>").text("Max. Value").addClass("sk-timefilter-label"),ce=t("<div>"),(de=t("<div>").addClass("sk-timefilter-clearfilter-button").text("Clear Filter")).click(function(){Ge.val(""),He.val(""),pe()}),G?(fe=t("<div>").text(u("done")).addClass("sk-timefilter-button").attr({role:"button",tabindex:0}),ce.append(fe)):(ue=t("<div>").text(u("cancel")).addClass("sk-timefilter-button-grey").attr({role:"button",tabindex:0}),fe=t("<div>").text(u("apply")).addClass("sk-timefilter-button").attr({role:"button",tabindex:0}),ce.append(fe,ue)),O.updateDisplayValue=function(t,n){var i,o=e.label.merge;return t=he(t,je),n=he(n,je),i=t&&n?t+" - "+n:t&&!n?o(u("greater_than"),t):!t&&n?o(u("less_than"),n):r.mergeAsText("global",F.attr("filteroffoptionlabel")||u("all_values")),ie.text(i),pe(),O},O.updateDisplayValue(te,ne),ue&&ue.click(function(){ae.hide("fast")}),O.activateFilter=function(){var e=Ge.val(),t=He.val();e?M.setCondition(X,e,O.affectCookies):M.deactivateCondition(X,O.affectCookies),t?M.setCondition(J,t,O.affectCookies):M.deactivateCondition(J,O.affectCookies),O.setOriginalValue({start:e,end:t})},fe.on("click "+h,function(e){if("click"===e.type||e.which===g.ENTER||e.which===g.SPACE){var t=Ge.val(),n=He.val();G?O.list.showFilterActions():(O.activateFilter(),O.executeFilter()),O.updateDisplayValue(t,n),ae.hide("fast")}}),ae.append(se,Ge,le,He,de,ce),L.addClass("nx-actionselect-haslabel").append(re,oe,ae),re.attr("tabindex",0),oe.attr("tabindex",0),re.add(oe).on("click "+h,function(e){if(("click"===e.type||e.which===g.ENTER||e.which===g.SPACE)&&!L.hasClass("unavailable"))if(ae.is(":visible"))ae.toggle("fast");else{var t=Math.max(L.width(),180);ae.css("min-width",t+"px").show("fast")}}),ae.on(h+" focusout",function(e){e.which===g.ESCAPE&&(ae.toggle("fast"),re.trigger("focus"))})}"toggle"===B||"auto"!==H&&"manual"!==H||(D=t("<div>").addClass("nx-actionselect-label"),"auto"===H?"daterange"===B?R=x.label:"numericrange"===B?R=x.label:m&&(R=m.label):"manual"===H&&(R=F.attr("label"))&&(R=r.mergeAsTextInContext(R,{model:M})),R&&(D.text(R),L.addClass("nx-actionselect-haslabel").prepend(D))),O.selectedItem||O.isMultiselect||(m&&O.isReferenceFilter?O.selectedItem=L.actionAutocomplete("getSelectedItem"):"daterange"===B?O.setOriginalValue({start:A,end:E}):"numericrange"===B?O.setOriginalValue({start:te,end:ne}):O.selectedItem=L.actionSelect("getSelectedItem")),e.events.publish("_skuid.filter.rendered",[{event:"_skuid.filter.rendered",filter:O}])}t.extend(k.prototype,{setOriginalValue:function(e){void 0===this.element.data("originalValue")&&this.element.data("originalValue",e)},restoreOriginalValue:function(){var e=this.element,n=e.data("originalValue");if(this.isMultiselect&&!this.isReferenceFilter){if(e=e.find("select"),"__reset"===n)e.val("");else if(n){var i=n.split(";");t.each(e.children("option"),function(e,n){t(n).prop("selected",t.inArray(n.value,i)>-1)})}e.data("echMultiselect")&&e.multiselect("refresh")}else void 0!==n&&("toggle"===this.type?e.toggleClass("disabled",n):"daterange"===this.type?this.updateDisplayValue(n.start,n.end):this.isReferenceFilter?e.actionAutocomplete("resetItem",n):n&&void 0!==n.value&&(this.element.is(".nx-actionautocomplete")?e.actionAutocomplete("resetItem",n.value):e.actionSelect("selectItem",n,{triggerHandlers:!1})))},isSelectedFromEffects:function(e){var n=this,i=!1;return e.each(function(){var e=t(this),o=n.affectedConditions[e.attr("condition")];if(o)if("deactivate"===e.attr("action")){if(!o.inactive)return i=!1,!1}else if("set"===e.attr("action")){if(r.mergeAsText("global",e.attr("value")||"",{createFields:!0,registerFields:!1})!==o.value||o.inactive)return i=!1,!1}else if("activate"===e.attr("action")&&o.inactive)return i=!1,!1;i=!0}),i},resetAffectedConditions:function(){var e=this;t.each(e.affectedConditions,function(){e.model.resetCondition(this,e.affectCookies)})},handleSourceEffects:function(e){var n,i=this,r=[],o=[];t.each(e,function(e,t){t.source&&-1===o.indexOf(t.source)&&o.push(t.source),t.source&&t.isSelected&&-1===r.indexOf(t.source)&&r.push(t.source)}),n=o.filter(function(e){return-1===r.indexOf(e)}),t.each(r,function(e,n){n.effects&&n.effects.length&&t.each(n.effects,function(e,r){i.applyEffect(t(r),n)})}),t.each(n,function(e,n){n.effects&&n.effects.length&&t.each(n.effects,function(e,n){i.unApplyEffect(t(n))})})},applyEffect:function(e,t,n){var i=this.model,o=this.affectedConditions[e.attr("condition")];if(o)if("deactivate"===e.attr("action"))i.deactivateCondition(o,this.affectCookies);else if("set"===e.attr("action")){var a,s={};n&&n.row&&(s.row=n.row),t&&t.model&&(s.model=t.model),e.attr("value")?a=e.attr("value"):n.value&&(a=n.value),a=r.mergeAsTextInContext(a,s,{createFields:!1,registerFields:!1}),i.setCondition(o,a,this.affectCookies)}else"activate"===e.attr("action")&&i.activateCondition(o,this.affectCookies)},unApplyEffect:function(e){var t=this.model,n=this.affectedConditions[e.attr("condition")];n&&("deactivate"===e.attr("action")?t.activateCondition(n,this.affectCookies):t.deactivateCondition(n,this.affectCookies))},applyFilterForItem:function(e,n){n=n||{};var i=this,o=i.model,s=!1!==n.fireSourceEffects,l=[],c=e.effects,d=e.source,u=d&&d.effects,f=e.affectDefaultCondition;if(c&&c.length&&t.each(c,function(){l.push(this)}),s&&u&&u.length&&t.each(u,function(){l.push(this)}),l&&l.length&&t.each(l,function(){i.applyEffect(t(this),d,e)}),f&&!a(e.value)&&i.filterCondition)if("__reset"===e.value)o.resetCondition(i.filterCondition,i.affectCookies);else{var p,h=r.mergeAsText("global",e.value||"",{createFields:!1,registerFields:!1}),g=i.filterCondition.operator;i.isMultiselect?((p=i.filterCondition.values)?(r.isString(p)&&(p=p.split(";")),-1===t.inArray(h,p)&&p.push(h)):p||(p=[h]),r.isMultiValueOperator(g)||("="===g?g="in":"!="===g&&(g="not in"),i.filterCondition.operator=g)):p=h,o.setCondition(i.filterCondition,p,i.affectCookies)}},unApplyFilterForItem:function(e,n){n=n||{};var i=this,o=i.model,a=!1!==n.fireSourceEffects,s=[],l=e.effects,c=e.source,d=c&&c.effects,u=e.affectDefaultCondition;if(l&&l.length&&t.each(l,function(){s.push(this)}),a&&d&&d.length&&t.each(d,function(){s.push(this)}),s&&s.length&&t.each(s,function(){i.unApplyEffect(t(this))}),u&&void 0!==e.value&&i.filterCondition)if("__reset"===e.value){var f=r.mergeAsText("global",e.value||"",{createFields:!1,registerFields:!1});o.setCondition(i.filterCondition,f,i.affectCookies)}else if(i.isMultiselect){var p=i.filterCondition.values,h=t.inArray(e.value,p);h>-1&&(p.splice(h,1),o.setCondition(i.filterCondition,p,i.affectCookies))}else o.resetCondition(i.filterCondition,i.affectCookies)},executeFilter:function(){var t,n=this.list,i=n.searchBox;i&&(t=i.val()),"remove"!==n.options.emptySearchBehavior||t?n.updateData({message:u("applying_filter"),failmessage:u("filter_could_not_be_applied"),showerror:!0,successcallback:function(){e.events.publish("filter.executed")}}):n.model.abandonAllRows()},getItems:function(){return this.items.map(function(e){return e})},unregister:function(){var e=this._reflowEventSubscription;return e&&e.unsubscribe(),this}}),n.Filter=k}(skuid)},function(e,t,n){"use strict";!function(e){var t,n,i=e.$,r=e.constants,o=e.ui,a=e.utils,s=e.time,l=r.DISPLAY_TYPES,c=r.FIELD_TYPES,d=s.parseSFDate,u=s.parseSFDateTime,f=s.getSFDate,p=s.getSFDateTime,h=e.$L,g=a.encodeHTML,m=a.startsWith,v="placeholder",y=e.$.ui.keyCode,b=l.ANYTYPE,w=l.ARRAY,S=l.BOOLEAN,C=l.COMBOBOX,I=l.CURRENCY,k=l.CUSTOM,x=l.DATE,T=l.DATETIME,R=l.DOUBLE,D=l.EMAIL,A=l.ID,E=l.INTEGER,F=l.LOCATION,N=l.MULTIPICKLIST,M=l.NUMBER,_=l.PERCENT,P=l.PHONE,O=l.PICKLIST,L=l.REFERENCE,U=l.RICHTEXT,B=l.STRING,j=l.TEXT,V=l.TEXTAREA,G=l.URL,H=c.BUTTON,z=c.CHILDREL,q=c.COMBO,$=c.FILE,W=c.IMAGE,Y=[S,I,x,T,R,A,E,_,l.TIME];function K(e,t){var n=e.options&&e.options.addfocusbox;e.element.html('<div class="nx-fieldtext">'+t+(n?'<div class="focusbox" tabindex="0"/>':"")+"</div>")}function X(e){var t,n=e.model,i=e.row,r=n.getFieldValue(i,e.id),o=n.objectName,a=n.getNameFieldValueForRow(i);window.sforce&&sforce.interaction&&window.sendCTIMessage&&(t=window.sendCTIMessage),t&&t("/CLICK_TO_DIAL?DN="+encodeURIComponent(r)+(i.Id?"&ID="+i.Id:"")+"&ENTITY_NAME="+o+"&OBJECT_NAME="+encodeURIComponent(a))}function J(e){var t=e.options;return t&&t[v]||e.metadata[v]}function Q(e,t){return a.mergeAsTextInContext(e||h("select_option_none"),t||{})}function Z(t,n,r){var o=!1,a=[];function s(t,n,o){var a=i("<div>").addClass("nx-radiowrapper"),s=e.utils.generateGUID(),l=i('<input type="radio" name="'+r.buttonSetName+'">').addClass("nx-radio").prop("id",s).prop("checked",o).prop("disabled","read"===r.mode||"readonly"===r.mode).val(t),c=i("<label>").prop("for",s).addClass("nx-radiolabel").html(g(n)).appendTo(a);return a.append(l,c),a}if(r.makeNoneOption&&a.push(s("",Q(r.noneLabel),!t)),i.each(n,function(e,n){if(n.value){var i=n.value==t&&""!==n.label;i&&!o&&(o=!0),a.push(s(n.value,n.label,i))}}),!o&&(t||"0"===t||"false"===t)){var l=s(t,t,!0);r.makeNoneOption?a.splice(1,0,l):a.unshift(l)}return a}function ee(e){e||(e={});var t,n=e.value,r=a.userLocale,o=e.decimalPlaces||0,s=e.decimalsSeparator||r.decimalsSeparator,l=e.thousandsSeparator||r.thousandsSeparator,c=e.prefix||"",d=e.suffix||"";return n||0===n||(n=""),t=""!==n&&i.isNumeric(n)?isFinite(n)?c+i.number(n,o,s,l)+d:"-":n,e.wrapInElement?i("<div>").text(t):t}function te(e){var t={},n=function(n,i){var r=e[n];void 0!==r&&(t[i]=r)};return n("showYearPicker","changeYear"),n("showMonthPicker","changeMonth"),n("yearPickerRange","yearRange"),t}function ne(e,t){var n,r;return n=i('<div class="nx-field-lengthcounter"></div>'),(r=function(e){n.text(+e+"/"+t.length),e>t.length?n.addClass("nx-field-lengthcounter-error"):n.removeClass("nx-field-lengthcounter-error")})(t.value?t.value.length:0),e.append(n),r}function ie(n){n||(n={});var i,r=e.platform;i=a.isString(n)?n:n.displayType;var o=r.getRenderers&&r.getRenderers();return o&&i in o?o[i]:i in t?t[i]:void 0}function re(e,t){var i,s,l;e||(e={}),a.isString(e)?(i=e,s=t):e instanceof o.Field||a.isString(t)?(l=e,i=t):e.displayType&&(i=e.displayType,s=e.dataSource,l=e.field),!s&&l&&(s=l.model.getDataSource()),!i&&l&&(i=l.metadata.displaytype);var c=s&&s.getFieldRenderers();return c&&i in c?c[i]:i in n?n[i]:(a.log('Unable to find an appropriate renderer for "'+i+'"',r.LOG_LEVELS.WARNING),n[j])}t={AUTOCOMPLETE:{edit:function(e){(e=e||{}).minLength||0===e.minLength||(e.minLength=2);var t,n=i("<input>"),r=function(){t&&(t.removeClass("ui-icon ui-icon-search"),t.addClass("nx-spinner-small"))},o=function(){t&&(t.removeClass("nx-spinner-small"),t.addClass("ui-icon ui-icon-search"))};return n.autocomplete({minLength:e.minLength,source:"function"==typeof e.source?function(t,n){e.source(t,n,r,o)}:e.source,select:e.onChange,focus:e.onFocus,close:e.onClose,appendTo:e.appendTo}).val(e.value),e.menuRenderer&&(n.data("ui-autocomplete")._renderMenu=e.menuRenderer),e.optionRenderer&&(n.data("ui-autocomplete")._renderItem=e.optionRenderer),n.on("keyup",function(t){""===i(this).val()&&9!==t.keyCode&&e.onClear&&e.onClear()}),n.focus(function(){n.autocomplete("widget").css("z-index",parseInt(n.closest(".ui-front").css("z-index"),10)+1)}),n.blur(function(){e.onBlur&&e.onBlur()}),e.parentElem&&(t=i("<div>").addClass("ui-icon ui-icon-search nx-field-reference-search").css({cursor:"pointer"}),e.parentElem.append(t),e.parentElem.is(n)&&n.css("padding-right","22px")),n}},BOOLEAN:{edit:function(e){var t=i('<input type="checkbox">').prop("checked",e.value).change(function(){e.onChange&&e.onChange(i(this).is(":checked")),t.focus()});return t}},COMBOBOX:{edit:function(t){var n,r=function(e){var n=t.entries;return a.isFunction(n)&&(n=n(e)),a.isPromise(n)?n:i.Deferred().resolve(n).promise()},o=function(e){return{value:s(e),label:l(e)}},s=function(e){return a.isString(e)?e:e.value},l=function(e){return a.isString(e)?e:e.label?e.label:e.value},c=(t=t||{}).getErrorContainer,d=t.invalidEntryMessage||"Only entries in this list are allowed.",u=t.onChange,f=t.parentElem,p=t.showLabelInTextInput,h=t.originalValue,g=t.restrictToEntries,m=i("<div>").addClass("ui-icon ui-icon-search nx-field-reference-search").css({cursor:"pointer"}),v=i("<select/>"),y=function(){var e=f.find(".nx-combobox-renderer-button");m&&(e.css("display","none"),m.removeClass("ui-icon ui-icon-search").addClass("nx-spinner-small").css({top:"5px"}))},b=function(){var e=f.find(".nx-combobox-renderer-button");m&&(m.removeClass("nx-spinner-small").addClass("ui-icon ui-icon-search"),e.css("display","block"))},w=t.label,S=t.value,C=p&&w?w:S,I={appendDropdown:t.appendDropdown,originalValue:t.originalValue,showLabelInTextInput:p,parentElem:f,required:t.required,searchicon:m,source:function(t,n){y(),r(t.term).then(function(r){b(),n(r.filter(function(e){var n=t.term?t.term.toLowerCase():"",r=function(e){return e.toString().toLowerCase().indexOf(n)>-1};return a.isObject(e)?i.map(e,function(e){if(r(e))return e}).length>0:r(e)}).map(function(e){return o(this||e)})),a.runningTests()&&e.events.publish("combobox.entries.ready")}).catch(function(e){c().show().text(e),b(),n([])})},value:C,onBlur:function(t){var n=c(),l=i(t.target),f=l.data("value"),m=t.target.value;p&&f&&f!==m&&w&&m==w&&(m=f),(m||S)&&r(m).then(function(t){var i=t.filter(function(e){return m===s(e)}),r=i.length>0,c=r?o(i[0]):{value:m,label:m};if(g&&!r)n.show().text(d),a.runningTests()&&e.events.publish("combobox.entry.error");else{if(n.hide(),S===m)return;h=S,S=c.value,w=c.label,p&&r&&w&&(l.data("value",S),l.val()!==w&&l.val(w)),u&&u(S,h,{item:c})}}).catch(function(e){n.show("Error fetching entries: "+e)})},onChange:function(e,t){var n=i(this);h=S,w=t.item.label,S=t.item.value,c().hide(),u&&u(S,h,{item:t.item}),p&&w&&(n.data("value",S),t.item.value=w)},onFocus:function(e){e.target.select()}};return!p||!S||p&&t.label?(n=v.combobox(I),C!==S&&f.find("input").data("value",S),n):r(S).then(function(e){var t,r,o=e.filter(function(e){return a.isObject(e)?i.map(e,function(e){if(S===e)return e}).length>0:S===e})[0];return a.isObject(o)?(r=s(o),t=l(o)):r=o,r&&(S=r),t&&(w=t),C=p&&w?w:S,n=v.combobox(i.extend(I,{value:C,getInputValue:function(){return S}})),C!==S&&f.find("input").data("value",S),n})}},CURRENCY:{read:function(t){t||(t={});var n,r,o=a.userLocale,s=a.userInfo.defaultCurrency,l=t.value,c=t.decimalPlaces||0,d=t.decimalsSeparator,u=t.thousandsSeparator,f=t.valueCurrencyCode;return void 0===d&&(d=o.decimalsSeparator),void 0===u&&(u=o.thousandsSeparator),l||0===l||(l=""),r=""!==l&&i.isNumeric(l)?i.number(l,c,d,u):l,""!==l&&i.isNumeric(l)&&(a.isMultiCurrencyOrganization?(r=f+" "+r,f&&f!=s&&(n=a.convertCurrency(l,f,s))&&n!=l&&(r+=" ("+s+" "+i.number(n,c,d,u)+")")):r=e.currency.getSymbol(s)+r),t.wrapInElement?i("<div>").text(r):r}},DOUBLE:{read:ee},DATE:{edit:function(e){var t,n,r=!1,o=(e=e||{}).value&&d(e.value);return(t=i("<input>").datepicker(i.extend(te(e),{onSelect:function(i,o){var a,s=o.selectedMonth-0+1+"",l=o.selectedDay+"";1===s.length&&(s="0"+s),1===l.length&&(l="0"+l),a=o.selectedYear+"-"+s+"-"+l,n=t.val(),e.onChange&&e.onChange(a),r=!0,t.focus(),setTimeout(function(){r=!1},200)},beforeShow:function(){if(setTimeout(function(){i(".ui-datepicker").css("z-index",parseInt(t.closest(".ui-front, .sk-pagepanel").css("z-index")||0,10)+1)},0),r)return!1}})).on("click",function(){t.datepicker("show")})).datepicker("widget").click(function(e){e.stopPropagation()}),o&&t.datepicker("setDate",o),n=t.val(),t.bind("change keyup",function(){var r,o=i(this).val();o!=n&&(n=o,r=""!==o?f(t.datepicker("getDate")):"",e.onChange&&e.onChange(r))}),t}},DATETIME:{edit:function(e){var t,n=i("<div>"),r=i("<input>"),o=!1;e.value&&(t=u(e.value),n.data("usedate",t)),r.datepicker(i.extend(te(e),{onSelect:function(t,i){var a,l,c,d=new Date,u=n.data("usedate");u?a=s.getLocalDateTime(u):(a=s.getLocalDateTime(d)).setHours(0,0,0,0),a.setFullYear(i.selectedYear,i.selectedMonth,i.selectedDay),l=s.getRealJSDateTimeFromLocal(a),c=p(l),e.onChange&&e.onChange(c),n.data("usedate",l),o=!0,r.focus(),setTimeout(function(){o=!1},200)},beforeShow:function(){if(setTimeout(function(){i(".ui-datepicker").css("z-index",parseInt(r.closest(".ui-front, .sk-pagepanel").css("z-index")||0,10)+1)},0),o)return!1}})).click(function(){r.datepicker("show")}),e.value&&t&&r.datepicker("setDate",s.getLocalDateTime(t)),r.datepicker("widget").click(function(e){e.stopPropagation()});var l,c,d,f,h,g=r.val(),m=i("<div>").addClass("nx-dt-timewrapper");r.bind("change keyup",function(){if(i(this).val()!=g){var t;if(g=i(this).val(),""!==i(this).val()){var o,a,l=r.datepicker("getDate")||new Date;l.setHours(0,0,0,0),(o=s.getLocalDateTime(n.data("usedate")||l)).setFullYear(l.getFullYear(),l.getMonth(),l.getDate()),a=s.getRealJSDateTimeFromLocal(o),t=p(a),n.data("usedate",a)}else t="",n.data("usedate",null);e.onChange&&e.onChange(t)}}).addClass("nx-dt-dateinput"),l=new Date,t?c=s.getLocalDateTime(t):(c=s.getLocalDateTime(l)).setHours(0,0,0,0);var v,y,b=a.userLocale,w=b.timeFormat,S=s.amPm,C=function(e){var t=v+1<w.length&&w.charAt(v+1)===e;return t&&v++,t},I=!1,k=function(){var t,i=s.getLocalDateTime(n.data("usedate")||new Date);i.setHours((parseInt(d.val(),10)+(h&&"pm"===h.val()?12:0))%24),i.setMinutes(f.val()),t=s.getRealJSDateTimeFromLocal(i),n.data("usedate",t),e.onChange&&e.onChange(p(t))},x=function(e){m.append(i("<span>"+e+"</span>"))},T=function(e,t,n,r){e.append(i("<option "+(n?"selected ":"")+'value="'+t+'">'+(r&&t<10?"0"+t:t)+"</option>"))};for(v=0;v<w.length;v++){var R,D;if(y=w.charAt(v),I)"'"!==y||C("'")?x(y):I=!1;else switch(y){case"a":if(!h){var A=c&&c.getHours()>=12;h=i("<select>").html("<option "+(A?"":"selected ")+'value="am">'+S[0]+"</option><option "+(A?"selected ":"")+'value="pm">'+S[1]+"</option>").appendTo(m).on("change",k)}break;case"h":case"K":case"k":case"H":if(!d){d=i("<select>"),D=C(y);for(var E,F="h"===y||"K"===y?12:24,N=0;N<F;N++)E="h"===y&&0===N?12:"k"===y?N-0+1:N,R=!1,c?R=N===(F>12?c.getHours():c.getHours()%12):8===N&&(R=!0),d.append(i("<option "+(R?"selected ":"")+'value="'+N+'">'+(D&&E<10?"0"+E:E)+"</option>"));d.appendTo(m).on("change",k)}break;case"m":if(!f){f=i("<select>"),D=C("m");var M,_=e.minuteIncrement||5,P=c?c.getMinutes():0,O=c&&P%_==0;for(M=0;M<60;M+=_)R=M===P,!O&&M>P&&(T(f,P,!0,D),O=!0),T(f,M,R,D);f.appendTo(m).on("change",k)}break;case"'":C("'")?x("'"):I=!0;break;default:x(w.charAt(v))}}return b&&b.showTimeBeforeDate?n.append(m,r):n.append(r,m),n}},ENTITY:{edit:function(t){t||(t={});var n,r,o,s,l=i('<div style="position: relative;">'),c=t.value,d=t.readOnly,u=function(){var n=t.dataSource;return a.isFunction(n)?n():n||e.dataSource.get(e.platform.getDefaultDataSourceName())},f=t.getErrorContainer||function(){var e=l.parent(),t=e.find(".nx-property-error");return t.length||(t=i("<div>").addClass("nx-property-error").css("margin-top","8px").insertAfter(l),e.css("display","block")),t},p=t.invalidEntryMessage||"Please select a valid entity.";return d?(r=u(),n=c,r&&r.dataSourceType&&(r.dataSourceType.prop&&a.size(r.dataSourceType.prop("x-metadata"))?(o=r.dataSourceType.prop("x-metadata")[c])&&o.label&&(n=o.label):r.dataSourceType.getEntityLabel&&(s=r.dataSourceType.getEntityLabel(c,r))&&(n=s)),l.addClass("nx-fieldtext").css("margin-top","6px").text(n||"")):l.append(ie(C).edit({appendDropdown:!0,entries:function(e){var n=t.filter;return a.isFunction(n)?n(e):u().getEntityList()},getErrorContainer:f,invalidEntryMessage:p,onChange:function(e,n){u().getEntityMetadata({entities:{objectName:e},ignoreMetadataOverrides:!0}).then(function(){c=e,t.onChange&&t.onChange(e,n)}).catch(function(e){f().show().text(e)})},parentElem:l,restrictToEntries:!0,showLabelInTextInput:t.showLabelInTextInput,value:c})),l}},INTEGER:{read:function(e){return e||(e={}),i.extend(e,{decimalPlaces:0}),ee(e)}},MULTIPICKLIST:{edit:function(e){e.valueDelimiter||(e.valueDelimiter=";");var t,n=e.value,r=e.checkboxSetName,o=e.entries,s=e.maxSelected,l=e.valueDelimiter,c=e.selectedList||0===e.selectedList?e.selectedList:3,d=e.selectedText||h("number_selected"),u=e.noneSelectedText||h("none_selected"),f=!1,p=e.required||!1;n||(n="");var m,v=n.length?n.split(l):[],b=s&&v.length>=s,w=e.element||i("<div>"),S=n;if("CHECKBOXES"===e.renderas)w.addClass("nx-fieldtext").css("padding","0px"),t=function(){if(!f){f=!0;var t,n=w.find('input[type="checkbox"]'),r=n.filter(function(){return i(this).prop("checked")}).map(function(){return this.value}).get();if(s)if(r.length>=s){t=[];var o=0;n.each(function(){var e=i(this);if(e.prop("checked")){if(o++<s)return t.push(e.val()),!0;e.prop("checked",!1)}e.prop("disabled",!0)})}else n.each(function(){i(this).prop("disabled")&&i(this).prop("disabled",!1)});m=(s&&t?t:r).join(l),e.onChange&&e.onChange(m,S),S=m,f=!1}},i.each(o,function(e,t){if(t.value){var n="";-1!==i.inArray(t.value,v)&&""!==t.value&&(n='checked="yes"');var o=i("<div>").addClass("nx-checkboxwrapper"),a=i("<input "+n+' type="checkbox">').val(t.value).prop("id","mscb_"+r+"_"+t.value).addClass("nx-checkbox").appendTo(o),s=i("<div>").addClass("nx-checkboxlabel").appendTo(o);b&&!n&&a.prop("disabled",!0),s.append(i("<label>").html(g(t.label)).prop("for","mscb_"+r+"_"+t.value)),w.append(o)}}),w.off(),w.on("change","input",function(){t()});else{var C=i('<select multiple="multiple">').appendTo(w);i.each(o,function(e,t){var n,r="";-1!==i.inArray(t.value,v)&&""!==t.label&&(r='selected="selected"'),n=i("<option "+r+">").attr("value",t.value).text(t.label),C.append(n)}),t=function(){if(!f){f=!0;var t,n,r,o={},a=C.multiselect("getChecked").map(function(){return o[this.value]=1,this.value}).get();s&&(n=C.multiselect("widget").find('input[type="checkbox"]'),a.length>=s?(t=[],r=0,n.each(function(){var e=i(this),n=e.val();if(e.prop("checked")){if(r++<s)return t.push(n),o[n]=1,!0;delete o[n],this.click()}e.prop("disabled",!0).closest("label").addClass("ui-state-disabled")}),C.children().each(function(){var e=i(this);o[e.val()]?e.attr("aria-selected","true"):e.prop("disabled",!0).removeAttr("aria-selected")})):(C.children().each(function(){var e=i(this);e.prop("disabled",!1).attr("aria-selected",o[e.val()]?"true":"false")}),n.each(function(){i(this).prop("disabled",!1).closest("label").removeClass("ui-state-disabled")}))),m=(s&&t?t:a).join(l),e.onChange&&e.onChange(m,S),S=m,f=!1}},C.multiselect({selectedText:d,noneSelectedText:u,checkAllText:h("check_all"),uncheckAllText:h("uncheck_all"),selectedList:c,position:e.position,autoOpen:!1,classes:p?"required":"",close:function(){i(this).parent().find("button.ui-multiselect").removeAttr("tabindex").focus(),a._ie&&i(this).multiselect("disable")&&i(this).multiselect("enable"),e.onClose&&e.onClose.call(this)},click:function(e,n){t(e,n)},open:function(){i(this).parent().find("button.ui-multiselect").attr("tabindex","-1"),C.multiselect("widget").find("li").on("keydown.action.skuid",function(e){e.which===y.TAB&&e.stopPropagation()})},create:function(){C.val()&&C.val().length>=s&&C.children().each(function(){var e=i(this);e.prop("selected")||e.prop("disabled",!0).removeAttr("aria-selected")}),e.onCreate&&e.onCreate.call(this)}}).on("multiselectcheckall multiselectuncheckall",function(e,n){t(e,n)});var I=C.data("echMultiselect")||C.data("ech-multiselect");I&&I.menu&&I.menu.on("focusin",function(e){e.stopPropagation()}),C.multiselect("getButton").attr({role:"button",tabindex:0}).on("keydown.action.skuid",function(e){if(e.which===y.ENTER||e.which===y.SPACE){var t=C.multiselect("isOpen")?"close":"open";C.multiselect(t)}}),o.length>5&&C.multiselectfilter({label:"",placeholder:h("enter_keywords")})}return w}},PERCENT:{read:function(e){return e||(e={}),i.extend(e,{suffix:"%"}),ee(e)}},PICKLIST:{edit:function(e){var t,n,r,o,s=e.entries,l=e.onChange;if(a.isFunction(s)&&(s=s()),"RADIO_BUTTONS"===e.renderas)t=i("<div>").addClass("nx-fieldtext").css("padding","0px"),r=function(){return t.find("input:checked").first().val()},n=Z(e.value,s,{makeNoneOption:!e.required||e.addNoneOption,mode:e.mode,buttonSetName:e.buttonSetName,noneLabel:e.noneLabel}),i.each(n,function(){t.append(this)}),l&&(o=r(),t.off("change.skuid").on("change.skuid","input",function(){l(r(),o),o=r()}));else{t=i("<select>");var c=!1,d=e.value||""===e.value||0===e.value,u={},f=e.defaultValue,p=!1,h=[],g=d?e.value:"",m=a.isString(g)?g.replace(/\"/g,'\\"'):g,v=a.isString(f)?f.replace(/\"/g,'\\"'):f;s&&i.each(s,function(e,t){var n=t.value,r=i("<option>").attr("value",n).text(t.label);!0===t.disabled&&r.prop("disabled",!0),u[n]=r,h.push(r)}),g&&a.isUndefined(u[g])&&(u[g]=i("<option>").attr("value",g).text(e.label?e.label:g),h.unshift(u[g])),e.required&&!e.addNoneOption||h.unshift(i("<option>").attr("value","").text(Q(e.noneLabel))),h.length&&t.append(h),d&&g in u&&(c=!0),d&&c?(t.val(g),t.children('[value="'+m+'"]').attr("selected",!0)):void 0!==f&&f in u&&(t.val(f),t.children('[value="'+v+'"]').attr("selected",!0),p=!0),l&&(o=t.val(),t.off("change.skuid").on("change.skuid",function(){l(t.val(),o),o=t.val()})),!e.required||d&&c||(p=!0),p&&l&&t.val()&&l(t.val())}return t}},TEXT:{edit:function(e){var t=e.inputType,n=e.onChange,r={},o=i("<input "+(t?' type="'+t+'"':"")+">").val(e.value),s=i("<div>");if(["inputMode","maxLength",v].forEach(function(t){e[t]&&(r[t.toLowerCase()]=e[t])}),a.size(r)&&o.attr(r),n&&a.delayInputCallback(o,function(e,t){n(e,t)},{dataPropertyName:e.dataPropertyName}),s.append(o),void 0!==e.length){var l=ne(s,e);o.on("input",function(){l(o.val().length)})}return s}},TEXTAREA:{edit:function(e){var t=e.onChange,n=e.displayRows,r=e[v],o=i("<div>"),s=i("<textarea>").val(e.value).appendTo(o);if(n?s.attr("rows",n).css({height:"100%"}):s.flexText(),r&&s.attr(v,r),a.delayInputCallback(s,function(e,n){t&&t(e,n)}),void 0!==e.length){var l=ne(o,e);s.on("input",function(){l(s.val().length)})}return o}},RICHTEXT:{edit:function(t){t||(t={});var n,r=i("<div>").append(i('<div class="nx-spinner">'));return t.initialize=function(){t.initialize._initializeWhenReady=!0},e.utils.loadRichTextApi(function(){var o,s,l=t.config||{},c=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);function d(){if(!r.parent().hasClass("disabled")&&!n){s.off("click.sk-richtext focus.sk-richtext"),o.removePlugins="ckeditor-gwf-plugin",n=e.CKEDITOR.inline(s[0],o),r.parent().attr("sk-ckeditorname",n.name),n.config.customConfig=a.getStaticResourceUrl("CKEditor","skuid","config.js",a.getCacheTimestamp()),n.config.uiColor="#DDDDDD",e.utils._oniOS()&&e.utils._inIframe()&&(n.on("contentDom",d),i(s[0]).on("click",d));var l=2,c=function(e){t.onChange&&t.onChange(e,l)};n.on("change",function(){c(n.getData())}),n.on("mode",function(){l=2!==l&&!l}),n.on("key",function(){l&&c(n.getData())}),t.onCreated&&t.onCreated(n),t.afterInit&&t.afterInit({ckInstance:n})}function d(){var e=i(".cke"),t=i(e[e.length-1]);t.insertAfter(i(s[0])),t&&(t.removeClass("cke-sf1-fix"),t.addClass("cke-sf1-fix"))}}l instanceof Array&&(l=i.extend.apply(this,i.map(l,function(e){return"function"==typeof e&&(e=e()),e}))),o={allowedContent:!0,disallowedContent:"style script iframe",toolbar:c?"Mobile":"FieldEditor"},"function"==typeof l?l(o):o=i.extend(o,l),s=i('<div class="nx-richtext-input" id="'+a.generateUniqueId()+'">').on("click.sk-richtext focus.sk-richtext",d),t.value&&s.html(t.value),r.parent().hasClass("disabled")?s.attr("sk-contenteditabledisabled","true"):s.attr("contenteditable","true"),r.empty().append(s),!0===t.initialize._initializeWhenReady?(d(),t.initialize=function(){}):t.initialize=d}),r}},COLOR:{read:function(e){e||(e={});var t=e.color||e.value;return i('<div class="sk-colorpicker"><div class="sk-colorpicker-wrapper"><div class="nx-field">'+t+'</div><div><div class="sk-colorpicker-preview-wrapper sk-transparency-background"><div class="sk-colorpicker-preview" style="background-color:'+t+'; cursor:default"></div></div></div></div></div>')},edit:function(e){e||(e={});var t=e.color||e.value;void 0===t&&(t="#000000");var n=e.onChange,r=i('<div class="sk-colorpicker"><div class="sk-colorpicker-wrapper"><div class="nx-field"><input placeholder="'+(e.placeholder?e.placeholder:"")+'"></div><div><div class="sk-colorpicker-preview-wrapper sk-transparency-background"><div class="sk-colorpicker-preview"></div></div></div></div></div>'),o=r.find("input").val(t),s=r.find(".sk-colorpicker-preview").css({"background-color":t}),l={black:"#000000",white:"#ffffff",red:"#ff0000",orange:"#ffa500",yellow:"#ffff00",green:"#008000",blue:"#0000ff",purple:"#800080",violet:"#ee82ee",rebeccapurple:"#663399"},c=e.colorSwatches||["transparent","rgba(0%,0%,0%,0.5)","\t","red","orange","yellow","green","blue","purple","violet","#663399","\n","\n","white","black","\t","#c0504d","#f79646","#eeece1","#9bbb59","#1f497d","#4f81bd","#4bacc6","#8064a2","\n","#f2f2f2","#7f7f7f","\t","#f2dcdb","#fdeada","#ddd9c3","#ebf1dd","#c6d9f0","#dbe5f1","#dbeef3","#e5e0ec","\n","#d8d8d8","#595959","\t","#e5b9b7","#fbd5b5","#c4bd97","#d7e3bc","#8db3e2","#b8cce4","#b7dde8","#ccc1d9","\n","#bfbfbf","#3f3f3f","\t","#d99694","#fac08f","#938953","#c3d69b","#548dd4","#95b3d7","#92cddc","#b2a2c7","\n","#a5a5a5","#262626","\t","#953734","#e36c09","#494429","#76923c","#17365d","#366092","#31859b","#5f497a","\n","#7f7f7f","#0c0c0c","\t","#632423","#974806","#1d1b10","#4f6128","#0f243e","#244061","#205867","#3f3151"];function d(e){r.trigger("sk-colorselected",[e])}function u(e){void 0===e&&(e=t),r.trigger("sk-colorpreview",[e])}a.delayInputCallback(o,function(e){d(e)}),r.on("sk-colorpreview",function(e,n){s.css({"background-color":n||t})}).on("sk-colorselected",function(e,i){if(i!==t){var r=t;t=i,o.val()!==t&&o.val(t),s.css({"background-color":t}),n&&n(t,r)}});var f=e.popup=function(){var e=null;function n(){e&&(r.trigger("sk-popup-hide"),i(window).off("resize.sk-colorpicker scroll.sk-colorpicker"),i(document.body).off("mousedown.sk-colorpicker keyup.sk-colorpicker"),e.fadeOut(function(){e.remove(),e=null,u()}))}function a(){e&&e.position({my:"left top",at:"left bottom",of:o,collision:"fit flip"})}function s(e,t,n){var i=t/150,r=(150-n)/150*(1-t/150*.5),o=g(p(e.hue/360,i,r),{alpha:e.aplha});return e.sat=Math.round(100*i),e.lum=Math.round(100*r),o}function f(e){return{hue:Math.round(360*e[0]),sat:Math.round(100*e[1]),lum:Math.round(100*e[2]),alpha:i.isNumeric(e[3])?e[3]:1}}function p(e,t,n){var i,r,o;if(0===t)i=r=o=n;else{var a=n<.5?n*(1+t):n+t-n*t,s=2*n-a;i=l(s,a,e+1/3),r=l(s,a,e),o=l(s,a,e-1/3)}return[Math.min(255,Math.max(0,Math.round(255*i))),Math.min(255,Math.max(0,Math.round(255*r))),Math.min(255,Math.max(0,Math.round(255*o)))];function l(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}}function h(e,t,n,i){var r=1;e instanceof Array&&(i=t,r=e[3],n=e[2],t=e[1],e=e[0]),i||(i={hue:0,sat:0}),e/=255,t/=255,n/=255;var o,a,s=Math.max(e,t,n),l=Math.min(e,t,n),c=(s+l)/2;if(s==l)o=a=0;else{var d=s-l;switch(a=c>.5?d/(2-s-l):d/(s+l),s){case e:o=(t-n)/d+(t<n?6:0);break;case t:o=(n-e)/d+2;break;case n:o=(e-t)/d+4}o/=6}return 0===a&&(o=i.hue/360),0!==c&&1!==c||(a=i.sat/100),[o,a,c,r]}function g(e,t){var n=e[0],r=e[1],o=e[2],a=e[3];return i.isNumeric(a)||(a=i.isNumeric(t.alpha)?t.alpha:1),a<1||!0===t.ignoreAlpha?"rgba("+n+","+r+","+o+","+a+")":"#"+("0"+n.toString(16)).slice(-2)+("0"+r.toString(16)).slice(-2)+("0"+o.toString(16)).slice(-2)}function m(e){if(e in l&&(e=l[e]),/^\s*#/.test(e))return e=(/[a-f0-9]{6}/.exec(e)||[""])[0],[parseInt(e.slice(0,2),16)||0,parseInt(e.slice(2,4),16)||0,parseInt(e.slice(4,6),16)||0,1];if(/^\s*rgb/i.test(e)){for(var t,n=[],r=/(\d*\.)?\d+%?/g;t=(r.exec(e)||[""])[0];)n.push(-1===t.indexOf("%")?parseFloat(t):parseFloat(2.55*t.replace("%","")));return[Math.round(n[0]),Math.round(n[1]),Math.round(n[2]),i.isNumeric(n[3])?n[3]:1]}return[0,0,0,1]}return{show:function(){e||(e=function(){var e=i('<div class="sk-colorpicker-popup ui-widget ui-widget-content ui-corner-all"><div class="sk-colorpicker-popup-contents"><div class="sk-colorpicker-popup-panel sk-swatch-panel"></div><div class="sk-colorpicker-popup-panel sk-gradient-panel"></div></div></div>').on("click",function(e){e.stopPropagation()}),o=e.find(".sk-swatch-panel"),a=e.find(".sk-gradient-panel");return function(e){for(var t,r,o,a=e.colors.slice(0),s=e.panel,l=function(e){return function(){u(e)}},c=function(){return function(){u()}},f=function(e){return function(){d(e)}},p=function(e){return function(){d(e),n()}},h=i("<div>").addClass("sk-colorpicker-table").appendTo(s),g=0;a.length>0;){for(r=i("<div>").addClass("sk-colorpicker-row sk-row-"+g).appendTo(h),t=0;a.length>0;t++){var m,v=a.shift();if("\n"===v)break;o=i("<div>").addClass("sk-colorpicker-cell sk-cell-"+t).appendTo(r),"\t"!==v&&(o.addClass("sk-transparency-background"),m=v,i("<div>").css({"background-color":m}).addClass("sk-colorpicker-swatch").on("mouseover",l(m)).on("mouseout",c()).on("click",f(m)).on("dblclick",p(m)).appendTo(o))}g++}}({colors:c,panel:o}),function(e){var o=e.panel,a=f(h(m(t))),l=!1,c=i('<div class="sk-colorpicker-gradient"><div class="sk-colorpicker-gradient-layer1"><div class="sk-colorpicker-gradient-layer2"></div></div></div>').appendTo(o).on("mousemove",function(e){u(s(a,e.offsetX,e.offsetY))}).on("mouseout",function(){u()}).on("click",function(e){d(s(a,e.offsetX,e.offsetY)),I()}).on("dblclick",function(e){d(s(a,e.offsetX,e.offsetY)),n()}),v=i('<div class="sk-colorpicker-hsl"><div class="sk-hsl-preview"></div><div class="sk-colorpicker-slider sk-hsl-h"></div><div class="sk-colorpicker-slider sk-hsl-s"></div><div class="sk-colorpicker-slider sk-hsl-l"></div><div class="sk-colorpicker-slider sk-alpha"></div></div>').appendTo(o),y=v.find(".sk-hsl-preview").css("background-color",t),b=v.find(".sk-hsl-h").slider({orientation:"vertical",min:0,max:360,step:1,slide:k,change:k}),w=v.find(".sk-hsl-s").slider({orientation:"vertical",min:0,max:100,step:1,slide:k,change:k}).append(i('<div class="layer1"><div class="layer2"></div></div>')),S=v.find(".sk-hsl-l").slider({orientation:"vertical",min:0,max:100,step:1,slide:k,change:k}).append(i('<div class="layer1"><div class="layer2_1"></div><div class="layer2_2"></div></div>')),C=v.find(".sk-alpha").slider({orientation:"vertical",min:0,max:1,step:.01,slide:k,change:k}).append(i('<div class="layer1 sk-transparency-background"><div class="layer2"></div></div>'));function I(e){l=!0,b.slider("value")!==a.hue&&b.slider("value",360-a.hue),w.slider("value")!==a.sat&&w.slider("value",a.sat),S.slider("value")!==a.lum&&S.slider("value",a.lum),C.slider("value")!==a.alpha&&C.slider("value",a.alpha),l=!1,k({supressEventNotification:e})}function k(e){if(!l){var t=Math.round(360-b.slider("value")),n=Math.round(w.slider("value")),i=Math.round(S.slider("value")),r=C.slider("value");a.hue!==t&&(a.hue=t),a.sat!==n&&(a.sat=n),a.lum!==i&&(a.lum=i),a.alpha!==r&&(a.alpha=r),function(e){var t="hsl("+e.hue+",100%,50%)",n={"background-color":t};c.css(n),w.find(".layer1").css(n),S.find(".layer1").css(n),C.find(".layer2").css({"background-image":"linear-gradient(to bottom, "+t+", rgba(204, 154, 129, 0))"})}(a),!0!==e.supressEventNotification&&d(g(p(a.hue/360,a.sat/100,a.lum/100),{alpha:a.alpha}))}}i.each(new Array(6),function(e){b.append(i('<div class="layer1_'+(e+1)+'">'))}),I(!0),r.on("sk-colorselected.gradientbox",function(e,t){y.css("background-color",t),a=f(h(m(t),a)),I(!0)}).on("sk-popup-hide",function(){r.off("sk-colorselected.gradientbox")})}({panel:a}),e}().appendTo(document.body),a(),i(window).on("resize.sk-colorpicker scroll.sk-colorpicker",a),i(document.body).on("mousedown.sk-colorpicker",function(t){var r=t.clientX,o=t.clientY,a=e.offset(),s=a.left-i(window).scrollLeft(),l=a.top-i(window).scrollTop(),c=s+e.outerWidth(),d=l+e.outerHeight();(r<s||r>c||o<l||o>d)&&n()}).on("keyup.sk-colorpicker",function(e){27===e.keyCode&&n()}))},hide:n}}();return s.on("click",f.show),r}}},n={TEXT:{read:function(e,t){t||0===t||(t=""),e.options&&"PASSWORD"===e.options.type&&(t=Array(t.length+1).join("*")),a.isString(t)||(t=""+t);var n,i=e.options.maxDisplayCharacters,r=e.metadata,o=r&&r.displaytype===G,s=e.model.getDataSourceType(),l=!1;if(o&&(!t||a.contains(t,"//")||m(t,"/")||(t="http://"+t),i||(i=40)),n=t,i&&(i-=0),!isNaN(i)&&i>0&&i<t.length&&(t=t.substring(0,i)+"..."),s&&s.getNameFieldURLForTextField){var c=s.getNameFieldURLForTextField(e,n,t);c&&(l=!0,t=c)}o&&!c&&(t='<a href="'+g(n)+'">'+g(t)+"</a>"),K(e,r&&r.htmlFormatted?a.removeScriptTags(t):a.nl2br(l?t:g(t)))},readonly:function(e,t){re(j).read(e,t)},edit:function(e,t,n){var r,o=e.options,a=J(e);t||0===t||(t=""),r={inputType:n,value:t,onChange:function(t){e.model.updateRow(e.row,e.id,t,e._getUpdateRowOptions())}},o&&"PASSWORD"===o.type&&(r.inputType="password"),a&&(r[v]=a),e.options.showLengthCounter&&e.metadata.length&&(r.length=e.metadata.length),e.element.append(ie(j).edit(r),i("<div>").addClass("sk-focusbar"))}},TEXTAREA:{read:function(e,t){e._ckInstance&&(e._ckInstance.destroy(),delete e._ckInstance),re(e,j).read(e,t)},readonly:function(e,t){re(V).read(e,t)},edit:function(e,t){var n=e.options||{},i=J(e),r=n.displayRows,o=n.showLengthCounter?e.metadata.length:void 0;t||0===t||(t=""),e.metadata.htmlFormatted?(e.disableBlur=!0,e.element.append(ie(U).edit({afterInit:function(t){e._ckInstance=t.ckInstance},config:[{uiColor:"#DDDDDD"},n.ckEditorConfig||{}],field:e,length:o,onChange:function(t){e.model.updateRow(e.row,e.id,t,e._getUpdateRowOptions())},value:t}))):e.element.append(ie(V).edit({displayRows:r,length:o,onChange:function(t){e.model.updateRow(e.row,e.id,t,e._getUpdateRowOptions())},placeholder:i,value:t}))},destroy:function(e){var t;e.metadata.htmlFormatted&&(t=ie(U)).destroy&&t.destroy({field:e})}},RICHTEXT:{read:function(e,t){return e.metadata.htmlFormatted=!0,re(e,V).read(e,t)},readonly:function(e,t){return re(U).read(e,t)},edit:function(e,t){return e.metadata.htmlFormatted=!0,re(e,V).edit(e,t)}},DOUBLE:{read:function(e,t,n,i){var r,o=e.metadata,s=e.options.decimalPlaces;s||"0"===s?r=parseInt(s,10):o&&o.scale&&(r=o.scale),r&&a.isNumber(r)||(r=0),K(e,ie(R).read({value:t,decimalPlaces:r,prefix:n,suffix:i}))},readonly:function(e,t){re(R).read(e,t)},edit:function(e,t){t||0===t||(t="");var n=a.userLocale,r=i('<input inputmode="numeric">').val(""!==t&&i.isNumeric(t)?i.number(t,e.metadata&&e.metadata.scale?e.metadata.scale:0,n.decimalsSeparator,n.thousandsSeparator):t);a.delayInputCallback(r,function(t){var i,o,s=e.metadata.displaytype,l=!1,c=n.thousandsSeparator,d=n.decimalsSeparator,u=t.indexOf(d),f=t.split(d),p=f[0],h=parseInt(f[1],10),g=f[1]?f[1].length:0,m=h.toString().length,v=r.val(),y=v.toLowerCase().charAt(v.length-1),b=Math.pow(10,{k:3,m:6,b:9,t:12}[y]),w=b/10,S=null===new RegExp("[^\\dbkm"+("."===d?"\\"+d:d)+("."===c?"\\"+c:c)+"-]|[bkm"+d+"]{2,}","ig").exec(v);if("."===c&&(c="\\."),t=t.toString().replace(new RegExp(c,"g"),"").replace(d,"."),i=parseInt(t,10),""===p?p=0:"-"===p&&(p=-0),S&&0==isNaN(b))if(-1!==u){for(;m>1;m--)w/=10;for(o=0;o<g&&"0"===f[1][o];o++)w/=10;t=p*b+(w=p>=0&&1/p>0?h*w:-h*w)}else t=i*b;t&&(l=s===E?parseInt(t,10):parseFloat(t)),!1===l||a.isExactlyNaN(l)||(t=l),e.model.updateRow(e.row,e.id,t,e._getUpdateRowOptions())}),e.element.append(r)}},INTEGER:{read:function(e,t){K(e,ie(E).read({value:t}))},readonly:function(e,t){re(E).read(e,t)},edit:function(e,t){re(e,R).edit(e,t)}},PERCENT:{read:function(e,t){re(e,R).read(e,t,"","%")},readonly:function(e,t){re(_).read(e,t)},edit:function(e,t){re(e,R).edit(e,t)}},CURRENCY:{read:function(e,t){var n,i,r=e.metadata,o=e.options?e.options.decimalPlaces:null,s=e.row;o||"0"===o||0===o?n=parseInt(o,10):r&&r.scale&&(n=r.scale),n&&a.isNumber(n)||(n=0),""!==t&&s&&a.isMultiCurrencyOrganization&&(i=a.getRowCurrency({row:s,model:e.model,field:e.id})),K(e,ie(I).read({value:t,decimalPlaces:n,valueCurrencyCode:i}))},readonly:function(e,t){re(I).read(e,t)},edit:function(e,t){re(e,R).edit(e,t)}},BOOLEAN:{read:function(e,t){var n=i("<div>").addClass("nx-fieldtext").css("padding","0px"),r=i('<input type="checkbox">').prop({checked:t,disabled:"true"});n.append(r),e.editable&&"readonly"!==e.mode&&n.append('<div class="focusbox" tabindex="0"/>'),e.element.append(n)},readonly:function(e,t){re(S).read(e,t)},edit:function(e,t){"true"===t&&(t=!0),e.element.append(ie(S).edit({value:t,onChange:function(t){e.model.updateRow(e.row,e.id,t,{initiatorId:e._GUID})}}))}},DATE:{read:function(e,t){K(e,s.makeFormattedDate(t))},readonly:function(e,t){re(x).read(e,t)},edit:function(e,t){var n=e.options;e.element.append(ie(x).edit({value:t,renderas:n.type,showMonthPicker:n.showMonthPicker,showYearPicker:n.showYearPicker,yearPickerRange:n.yearPickerRange,onChange:function(t){e.model.updateRow(e.row,e.id,t,e._getUpdateRowOptions())}}))}},DATETIME:{read:function(e,t){K(e,s.makeFormattedLongDateTime(t))},readonly:function(e,t){re(T).read(e,t)},edit:function(e,t){var n=e.options;e.element.append(ie(T).edit({value:t,showMonthPicker:n.showMonthPicker,showYearPicker:n.showYearPicker,yearPickerRange:n.yearPickerRange,minuteIncrement:n.minuteIncrement,onChange:function(t){e.model.updateRow(e.row,e.id,t,e._getUpdateRowOptions())}}))}},EMAIL:{read:function(e,t){t||0===t||(t=""),""!==t&&(t='<a href="mailto:'+(t=g(t))+'">'+t+"</a>"),K(e,t)},edit:function(e,t){re(e,j).edit(e,t,"email")},readonly:function(e,t){re(D).read(e,t)}},LOCATION:{read:function(e,t){var n,r,o,a,s="",l=e.options.type||e.metadata.type||"DECIMAL";t&&(r=t.latitude,o=t.longitude,"DECIMAL"===l?(r=(a=function(e){var t=(e+"").split(".");return i.number(e,t.length>1?t[1].length:1,".","")+""})(r),o=a(o),r&&(s+=r),s+=" ",o&&(s+=o)):(n="&#39;",r=(a=function(e,t){var i=e<0,r=Math.abs(e),o=Math.floor(r),a=60*(r-o),s=Math.floor(a),l=Math.round(60*(a-s));return o+"&deg;"+s+n+l+n+n+(t?i?"S":"N":i?"W":"E")})(r,!0),o=a(o),r&&(s+=r),s+=" ",o&&(s+=o))),K(e,s)},edit:function(t){var n=t.row,i=t.model,r=t.id,o=r.substring(0,r.length-1),a=o+"Latitude__s",s=o+"Longitude__s",l=new e.ui.Field(n,i,null,{fieldId:a}),c=new e.ui.Field(n,i,null,{fieldId:s});l.render(),c.render(),t.element.append(l.element,c.element)},readonly:function(e,t){re(F).read(e,t)}},PHONE:{read:function(e,t){if(window.sforce&&t&&o.showClick2Dial){re(e,j).read(e,t);var n=o.click2Dial;n||(n=X),e.element.css("white-space","nowrap").append(i('<div class="sk-click2dial-wrapper">').append(i('<span class="ui-icon sk-icon sk-icon-phone inline">').attr("title","Click to dial")).on("click.skuid",function(){n(e)}).css("cursor","pointer")),e.element.children().css({display:"inline-block"})}else{var r;t||"0"===t?r=(t+="").replace(/\D+/g,""):(t="",r=!1),""!==t&&(t=g(t),(r||"0"===r)&&(t='<a href="tel:'+r+'">'+t+"</a>")),K(e,t)}},edit:function(e,t){re(e,j).edit(e,t,"tel")},readonly:function(e,t){re(P).read(e,t)}},PICKLIST:{read:function(e,t,n){var r,o,a,s,l=i.extend({},e.options,n),c=e.metadata&&e.metadata.nameField,d=c?e.model.getDataSourceType():null,u=t,f=n&&n.picklistEntries||l.entries||l.picklistEntries;!0!==t&&!1!==t||(u=t+=""),f&&0!=f.length||(f=e.getValidPicklistEntries()),"RADIO_BUTTONS"===l.type?(a=i("<div>").addClass("nx-fieldtext").css("padding","0px"),s=Z(t,f,{makeNoneOption:!e.required||l.addNoneOption,mode:e.mode,buttonSetName:e.id+"_"+e._GUID,noneLabel:l.noneLabel}),i.each(s,function(){a.append(this)}),e.editable&&"readonly"!==e.mode&&a.append('<div class="focusbox" tabindex="0"/>'),e.element.append(a)):(f&&f.length&&i.each(f,function(){if(this.value==t)return this.label&&(u=this.label),!1}),c&&d&&d.getNameFieldURLForTextField&&(o=d.getNameFieldURLForTextField(e,t,u))&&(r=!0,u=o),K(e,u?r?u:g(u):""))},readonly:function(e,t,n){re(O).read(e,t,n)},edit:function(e,t,n){var r=i.extend({},e.options,n);!0!==t&&!1!==t||(t+=""),e.element.append(ie(O).edit({addNoneOption:e.options.addNoneOption,buttonSetName:e.id+"_"+e._GUID,entries:r.picklistEntries||e.getValidPicklistEntries(),mode:e.mode,noneLabel:e.options.noneLabel,onChange:function(t){e.model.updateRow(e.row,e.id,t,{initiatorId:e._GUID})},renderas:e.options.type,required:e.required,value:t}))}},MULTIPICKLIST:{read:function(e,t,n,r){var o=i.extend({},e.options,r),a=r&&r.picklistEntries||o.entries||o.picklistEntries;n||(n=";");var s=i("<div>").addClass("nx-fieldtext"),l=t||"",c=l.split(n);if(a||(a=e.getValidPicklistEntries()),"CHECKBOXES"===e.options.type)s.css("padding","0px"),i.each(a,function(e,t){if(t.value){var n="";-1!==i.inArray(t.value,c)&&""!==t.value&&(n='checked="yes"');var r=i("<div>").addClass("nx-checkboxwrapper");r.append(i("<input "+n+' type="checkbox" value="'+t.value+'">').addClass("nx-checkbox").prop("disabled",!0)),r.append(i("<div>"+g(t.label)+"</div>").addClass("nx-checkboxlabel")),s.append(r)}});else if(l){var d={},u=[];i.each(a,function(e,t){d[t.value]=t.label}),i.each(c,function(){u.push(d[this]||this)}),s.html(g(u.join(", ")))}else s.html("");e.editable&&"readonly"!==e.mode&&s.append('<div class="focusbox" tabindex="0"/>'),e.element.append(s)},readonly:function(e,t,n,i){re(N).read(e,t,n,i)},edit:function(e,t,n){var i=";";n=n||{},a.isString(n)?(i=n,n={}):i=n.valueDelimiter||i;var r=e.options;"CHECKBOXES"!==r.type&&(e.disableBlur=!0),e.element.append(ie(N).edit({value:t,defaultValue:e.metadata.defaultValue,entries:n.picklistEntries||e.getValidPicklistEntries(),renderas:r.type,onChange:function(t){e.model.updateRow(e.row,e.id,t,{initiatorId:e._GUID})},valueDelimiter:i,checkboxSetName:e.id+"_"+e._GUID,maxSelected:r.maxSelected,required:e.required,selectedList:r.selectedList}))}},BUTTON:{read:function(t){var n=t.options,i=t.model.getRowMergeResult(t.row,n.text,{asText:!0}),r=e.component.factory({element:t.element,xmlDefinition:e.utils.makeXMLDoc("<button/>").attr({type:"multi",label:i,icon:n.icon}).append(n.actionsXML.clone()),state:{_parentComponentId:n.parentComponentId},context:{model:t.model,row:t.row}});t.subComponents.push(r)},readonly:function(e,t){re(H).read(e,t)},edit:function(e,t){re(H).read(e,t)}},COMBOBOX:{read:function(e,t){re(e,O).read(e,t)},readonly:function(e,t){re(C).read(e,t)},edit:function(t,n){t.element.off("click.skuidLinkHandler"),t.element.append(ie(C).edit({entries:function(){return t.getValidPicklistEntriesAccountingForDataSource()},getErrorContainer:function(){var e=t.element.find(".nx-error-inline");return e.length||(e=i("<div>").addClass("nx-error-inline").appendTo(t.element)),e},onChange:function(i){n=i;var r=t.model.updateRow(t.row,t.id,n,{initiatorId:t._GUID});return a.runningTests()&&e.events.publish("combobox.onchange"),r},parentElem:i("<div>").appendTo(t.element),restrictToEntries:t.metadata.limitEntries||!1,showLabelInTextInput:!0,value:n}))}},ARRAY:{read:function(e,t,n){n||(n={});var r,o,s=i("<div>").addClass("nx-fieldtext").appendTo(e.element),l=e.row,c=e.model.getFieldValue(e.row,e.id,!0),d=e.options.delimiter,u=n.dataPath||e.metadata.dataPath;d||(d=""),c&&(r=c,u&&(r=a.getObjectProperty(r,u)),o=r.length,i.each(r,function(t,n){var i=e.model.mergeRow(n,e.options.template,{parentRow:l,childRelName:e.id,allowHTML:e.options&&e.options.allowHTML,registerFields:!1});i.css("display","inline"),s.append(i),t+1!==o&&s.append("<span>"+d+"</span>")})),e.element.append(s)},readonly:function(e,t){re(w).read(e,t)}},CHILDREL:{read:function(e,t){re(e,w).read(e,t,{dataPath:e.metadata.dataPath||"records"})},readonly:function(e,t){re(z).read(e,t)}},COMBO:{read:function(e){var t=i("<div>").addClass("nx-fieldtext").appendTo(e.element),n=e.options;t.append(e.model.mergeRow(e.row,n.template,{allowHTML:n&&n.allowHTML,registerFields:!1})),e.editable&&"readonly"!==e.mode&&t.append('<div class="focusbox" tabindex="0"/>'),e.element.append(t).off("dblclick.skuid mouseenter.skuid mouseleave.skuid").css("cursor","auto")},readonly:function(e,t){re(q).read(e,t)},edit:function(e,t){re(q).read(e,t);var n,r=e.options,s=e.element,l=s.find(".focusbox").prop("tabindex","-1"),c=i('<input type="text">').addClass("nx-visuallyhidden");l.before(c),n=function(){var t,n,d="custompopup"===r.editModeBehavior,u=[{text:h("done"),icons:{primary:"sk-icon-save sk-icon"},click:function(){i(this).dialog("close")}}];function f(){i(this).click().find(":input").first().focus()}function p(){var e=s.find("input"),t=s.find(".focusbox");e.length&&e[0]===c[0]&&e.attr("data-preventaction","true"),t.length&&t[0]===l[0]&&t.attr("data-preventaction","true")}function g(){var e=s.find("input"),t=s.find(".focusbox");e.length?e[0]!==c[0]&&e.attr("data-preventaction","true").focus():t[0]!==l[0]&&t.attr("data-preventaction","true").focus(),setTimeout(function(){e.removeAttr("data-preventaction"),t.removeAttr("data-preventaction")},100)}d?n=a.createPopupFromPopupXML(r.editModePopupXML,e,{open:f,close:g,beforeClose:p,buttons:u,modal:!0,resizable:!0}):(t=e.model.getRowMergeResult(e.row,r.template).fields,(n=i('<div title="'+r.label+'" class="nx-editor"/>')).append(o.createFieldSet(t,{editor:e.editor})),n.dialog({resizable:!0,modal:!0,width:450,open:f,beforeClose:p,close:function(){g(),n.dialog("destroy").remove()},buttons:u})),e.editor.editModePopup=n},c.on("focus.skuid",function(){var e=i(this);e.attr("data-preventaction")?e.removeAttr("data-preventaction"):n()}),s.on("mouseenter.skuid mouseleave.skuid","> .nx-fieldtext",function(e){"mouseenter"===e.type?i(this).append(i("<div>").addClass("nx-edithover sk-icon-edit sk-icon inline").click(function(e){n(),e.stopPropagation()})):i(this).find("div.nx-edithover").remove()}).css("cursor","pointer")}},CUSTOM:{read:function(t,n){var r=e.snippet.get(t.options.snippet);r&&r(t,function(e,t){var n=e.metadata;return n&&n.displaytype&&-1!=i.inArray(n.displaytype,Y)?t:g(t)}(t,n))},readonly:function(e,t){re(k).read(e,t)},edit:function(e,t){re(k).read(e,t)}},FILE:{read:function(e){var t=i("<div>").addClass("nx-fieldtext").css({padding:"0px","min-height":"26px"}).appendTo(e.element);new a.FileComponent(t,{model:e.model,row:e.row,displayAs:"filename",storeAs:"field",idField:e.id,deleteable:!1,editable:!1,_GUID:e._GUID})},readonly:function(e,t){re($).read(e,t)},edit:function(t,n){if(e.offline.networkDown())return re($).read(t,n),!1;var r=i("<div>").addClass("nx-fieldtext").appendTo(t.element);t.model.isRowNew(t.row)?(r.css({"font-size":"8pt",color:"#aaa"}),r.text("Save record before uploading files.")):(r.attr("id",a.generateGUID()).css("padding","0px"),new a.FileComponent(r,{model:t.model,row:t.row,displayAs:"filename",storeAs:"field",idField:t.id,deleteable:!0,editable:!0,_GUID:t._GUID}))}},REFERENCE:{read:function(e,t){var n,i=t||0===t?g(e.calculateReferenceText()):"",r=e.model.getDataSourceType();if("skuid__Image__c"===e.metadata.ref)return re(e,$).read(e,t),!1;i=a.nl2br(i),r&&r.getNameFieldURLForReferenceField&&(n=r.getNameFieldURLForReferenceField(e,t,i)),K(e,n||i)},readonly:function(e,t){re(L).read(e,t)},edit:function(t,n){if(e.offline.networkDown())return re(L).read(t,n),!1;if("skuid__Image__c"===t.metadata.ref)return re(t,$).edit(t,n),!1;n||0===n||(n="");var r,o,s,l,c=t.element,d=t.options,u=i("<input>"),f=t.metadata.ref,p=t.metadata.referenceTo,v=f&&-1!=f.indexOf(","),y=t.metadata.dataSourceName?e.dataSource.getDataSource(t.metadata.dataSourceName):t.model.getDataSource(),b=y.getDataSourceType(),w=b&&b.getReferenceHandler&&b.getReferenceHandler(),S=i('<div class="ui-autocomplete-container"></div>');if(i.isPlainObject(n)&&(s=!0,i.each(n,function(e,t){if(!a.isUndefined(t)&&null!==t)return s=!1,!1}),s&&(n="")),u.val(n),!w)return re(L).read(t,n),!1;var C=function(e){var n=a.extractFieldsFromTemplate(d.searchTemplate||d.template),r=t.calculateReferenceMerges({targetObject:e});o=i("<div>").append(r.merges).text(),l=[],i.each(n,function(e,n){l.push({id:t.metadata.rel&&0===n.indexOf(t.metadata.rel+".")?n.slice(t.metadata.rel.length+1):n})})};if(c.data("recordId",n),v){var I;t.element.addClass("nx-polymorphic"),r=i("<select>").on("change",function(){I=r.val(),c.data("selectedSObject",r.find('option[value="'+I+'"]').attr("data-sobject")),c.data("selectedSObjectPrefix",I),c.data("recordId",""),c.data("recordLabel",""),C(I),t.model.updateRow(t.row,t.id,null,{initiatorId:t._GUID});var e=r.next();e.val(""),c.data("recordId",""),c.data("recordLabel",""),"REFPICK"===d.type&&t.getReferenceOptions("",{searchFields:N(),returnFields:F(),referencedObject:c.data("selectedSObject")}).then(P),e.focus()});var k={},x=[];if(i.each(p,function(e,t){k[t.label+"_"+t.objectName]=t}),i.each(Object.keys(k).sort(),function(e,t){x.push(k[t])}),i.each(x,function(e,n){r["User"===n.objectName&&a.endsWith(t.id,"OwnerId")?"prepend":"append"](i("<option>").attr({value:n.keyPrefix,"data-sobject":n.objectName}).text(n.label))}),c.data("recordId")&&"undefined"!=c.data("recordId")){var T=t.model.getValueKeyPrefix(c.data("recordId"));T&&3===T.length&&c.data("selectedSObjectPrefix",T)}c.data("selectedSObjectPrefix")&&r.val(c.data("selectedSObjectPrefix"));var D=r.find('option[value="'+r.val()+'"]');0===D.length&&(D=r.find("option").first()),c.data("selectedSObject",D.attr("data-sobject"))}else c.data("selectedSObject",f);C(c.data("selectedSObject")),c.data("recordLabel",""===c.data("recordId")?"":o);var F=function(){var e=t.options.returnFields;return e&&e.length||(e=[],i.each(l,function(t,n){n.showInSearchDialog=!0,e.push(n)})),e},N=function(){var e=t.options.searchFields;return e&&e.length||(l&&l.length?(e=[],i.each(l,function(t,n){e.push(n)})):e=[{id:y.getNameField(c.data("selectedSObject")),displaytype:B,filterable:!0}]),e},_=function(e,n,r){if(e||0===e||""===e){c.data("recordId",e);var o=y.getNameField&&y.getNameField(c.data("selectedSObject")),a=r||w&&w.getRowFromReferenceValue(n,e,t.metadata)||n.getRowById(e);if(a){var s=n.getRowMergeResult(a,d.searchTemplate||d.template||"{{"+o+"}}",{registerFields:!1}).merges.text();c.data("recordLabel",s)}a&&o&&"Name"!==o&&"Id"!==o&&!("Name"in a)&&o in a&&(a.Name=a[o]);var l={},u=e;t.metadata&&a&&-1===i.inArray(t.metadata.displaytype,[L,A])&&a.__templabel&&(u=a.__templabel),l[t.id]=u,(u||0===u)&&(l[t.metadata.rel]=a),t.model.updateRow(t.row,l,{initiatorId:t._GUID})}},P=function(e){u.empty(),t.element.hasClass("disabled")||u.prop("disabled",!1);var r=!1;t.required&&e.data.length&&!d.addNoneOption||(r=!n,u.append(i("<option>").val("").text(Q(d.noneLabel,{model:t.model})).prop("selected",!n)));var o=y.getNameField(c.data("selectedSObject")),a=t.metadata.originalDisplayType,s=a===M||a===E||a===R,l=d.searchTemplate||d.template||"{{"+o+"}}";i.each(e.data,function(o,a){var s=w?w.getReferenceValue(a,t.metadata):a.Id;r||(r=n+""==s+"");var c=e.mergeRow(a,l,{registerFields:!1}).text();u.append(i("<option>").val(s).text(c).prop("selected",n===s))}),r||!n&&0!==n||u.append(i("<option>").val(n).text(c.data("recordLabel")).prop("selected",!0)),t.required&&!n&&0!==n&&_(s?parseInt(u.val(),10):u.val(),e,null),u.off("change.skuid").on("change.skuid",function(){var t=i(this).val();s&&(t=parseInt(t,10)),_(t,e,null)})};"REFPICK"===d.type?(u=i("<select>").prop("disabled",!0).append(i('<option value="">').text(n?o:Q(d.noneLabel,{model:t.model}))),t.getReferenceOptions("",{searchFields:N(),returnFields:F(),referencedObject:c.data("selectedSObject")}).then(P)):(u=e.ui.getRenderer("AUTOCOMPLETE").edit({minLength:t.metadata.minInputLength||2,source:function(e,n,r,o){r();var a,s=p&&p[0]&&p[0].objectName,l=function(){t.getReferenceOptions(e.term,{searchFields:N(),returnFields:F(),relMetadata:a,referencedObject:c.data("selectedSObject")}).then(function(e,t){if(t&&t.isStale)n([]);else{c.data("tempmodel",e);var r=y.getNameField&&y.getNameField(c.data("selectedSObject")),a=d.searchTemplate||d.template||"{{"+r+"}}",s=-1!==a.indexOf("Name}}");i.each(e.data,function(){s&&!this.Name&&r in this&&(this.Name=this[r]),this.__templabel=c.data("tempmodel").mergeRow(this,a,{registerFields:!1}).text()}),n(e.data),(!t||t&&t.isFinal)&&o()}})};t.options.searchFields&&s?y.getEntityMetadata({entities:[s]}).then(function(e){a=e._unwrap(),l()}):(a={},l())},onFocus:function(e,t){return u.val(t.item.__templabel),!1},onChange:function(e,n){var i=w?w.getReferenceValue(n.item,t.metadata):n.item.Id;_(i,c.data("tempmodel"),n.item);var r=t.element.find(".nx-error-inline");return t.render(),u=t.element.find("input"),r&&t.element.prepend(r),u.focus(),!1},onClose:function(){u.focus()},onBlur:function(){setTimeout(function(){u.val(c.data("recordLabel"))},200)},onClear:function(){var e=t.model.getFieldValue(t.row,t.id,!0);null!==e&&void 0!==e&&(t.model.updateRow(t.row,t.id,null,{initiatorId:t._GUID}),c.data("recordId",""),c.data("recordLabel",""))},optionRenderer:function(e,t){return i("<li></li>").data("ui-autocomplete-item",t).html("<a>"+g(t.__templabel)+"</a>").appendTo(e)},appendTo:e.mobile?S:void 0,value:c.data("recordLabel")||n,parentElem:c}),e.mobile&&S.insertAfter(c.children().last()),c.find(".ui-icon-search").on("click.skuid",function(n){if(n.stopPropagation(),!t.element.hasClass("disabled")){var r,o,s,l,f,p,g,v,y=function(){e.mobile?e.mobile.hidePopupPanel():r.dialog("close").remove(),p.unregister&&p.unregister(),m(g.id,"_TempModel_")&&g.unregister()};e.snippet.registerSnippet("skuid.__referencepopupselect",function(e){var n,i;e.row?n=e.row:e.component&&e.component.row?n=e.component.row:e.item&&(n=e.item.row),e.model?i=e.model:e.component&&e.component.list&&(i=e.component.list.model);var r=w?w.getReferenceValue(n,t.metadata):n.Id;_(r,i,n),t.render(),u=t.element.find("input"),y(),u.focus()}),l=c.data("selectedSObject"),t.options&&"model"===t.options.optionsource?(v=e.$M(t.options.optionmodel))&&v.objectName===l&&v.label&&(l=v.label):t.metadata&&t.metadata.referenceTo&&t.metadata.referenceTo.length&&i.each(t.metadata.referenceTo,function(){if(this.objectName===l)return this.label?l=this.label:i.each(e.model.list(),function(){if(this.objectName===l&&this.label)return l=this.label,!1}),!1}),!l&&t.metadata&&t.metadata.label&&(l=t.metadata.label),f=h("select")+" "+a.encodeHTML(l+""),r=i("<div>").attr("title",h("select")+" "+l),s=i("<div>").css("min-height","300px"),r.append(s),t.getReferenceOptions(u.data("uiAutocomplete").term,{searchFields:N(),returnFields:F(),referencedObject:c.data("selectedSObject")}).then(function(n){e.$M(n.id)||n.register(),g=n,i.each(g.fields,function(){this.nameField&&(this.nameField=!1)});var r,o=d.tokenizeSearch?' tokenizesearch="true"':"",a=n.getNameField(),c=F(a),u=[],m=N(a),v="";c&&c.length?i.each(c,function(e,t){t.showInSearchDialog&&u.push(t)}):u.push({id:a}),m&&m.length||d.useSOSLSearch?(v+="<searchfields"+(d.useSOSLSearch?' usesosl="true"':"")+(d.SOSLFields?' soslfields="'+d.SOSLFields+'"':"")+">",m&&m.length&&i.each(m,function(){v+='<searchfield field="'+this.id+'"/>'}),v+="</searchfields>"):v="",e.mobile?(r='<mobiledeck model="'+n.id+'"'+o+' pagesize="'+(t.options.pageSize||5)+'" mode="readonly" searchbox="true" showsavecancel="false" createrecords="false" precision="1" minwidth="300"><components>',i.each(u,function(e,t){r+='<mobilefield id="'+t.id+'"',t.label?r+=">"+t.label+"</mobilefield>":r+="/>"}),r+='</components><cardinteractions><interaction type="tap"><actions><action type="custom" snippet="skuid.__referencepopupselect"/></actions></interaction></cardinteractions>'+v+"</mobiledeck>"):(r='<skootable model="'+n.id+'"'+o+' pagesize="'+(t.options.pageSize||5)+'" mode="readonly" searchbox="true" showsavecancel="false" createrecords="false"><fields>',i.each(u,function(e,t){r+='<field id="'+t.id+'" allowordering="true"',t.label?r+=">"+t.label+"</field>":r+="/>"}),r+='</fields><rowactions><action type="custom" label="'+f+'" icon="sk-icon-add-reference" snippet="skuid.__referencepopupselect"/></rowactions>'+v+"</skootable>"),p=e.component.factory({xmlDefinition:r}),s.append(p.element),e.mobile?e.mobile.setPopupPanel(p.element,{title:h("select")+" "+l}):(s.append(p.element),s.find(".searchbox").focus().select())}),e.mobile||(o=[{icons:{primary:"ui-button-icon-primary ui-icon sk-icon-remove-reference sk-icon inline"},text:"Clear Value",click:function(){t.model.updateRow(t.row,t.id,null,{initiatorId:t._GUID}),c.data("recordId",""),c.data("recordLabel",""),y(),u.val("")}},{icons:{primary:"ui-button-icon-primary ui-icon sk-icon-cancel sk-icon inline"},text:h("cancel"),click:function(){y()}}],r.dialog({close:function(){y()},modal:!0,resizable:!0,width:"90%",buttons:o}),r.parent(".ui-dialog").addClass("sk-dialog-autocomplete"),i(".ui-widget-overlay").addClass("sk-overlay-autocomplete"))}}));if(c.addClass("editable"),r){var O=i("<label>").addClass("nx-basicfieldeditor-item-select-label");O.append(r),c.append(O,u)}else c.append(u)}},ID:{read:function(e,t){re(e,j).read(e,t)},readonly:function(e,t){re(A).read(e,t)},edit:function(e,t){e.model.isRowNew(e.row)&&(t=null),e.metadata.ref=e.model.objectName,re(e,L).edit(e,t)}},STRING:{read:function(e,t){re(e,j).read(e,t)},readonly:function(e,t){re(B).read(e,t)},edit:function(e,t){re(e,j).edit(e,t)}},IMAGE:{read:function(t){var n,i,r=t.options,o=e.component.getById(r.parentComponentId),a=e.utils.makeXMLDoc("<image/>").attr({alt:t.model.getRowMergeResult(t.row,r.alt||"",{asText:!0}),url:t.row[t.id]||t.model.getRowMergeResult(t.row,r.url||"",{asText:!0}),model:t.model.id,dataSource:t.model.dataSourceName,source:"url"});n=o?o.createChildComponent(a,t.element):e.component.factory({element:t.element,xmlDefinition:a}),r.height&&(n.element.css({height:r.height,overflow:"hidden"}),i=n.element.children().first(),r.fill&&i.addClass("nx-field-image-fill"),i.addClass("nx-field-image-withheight").attr("tabindex",0)),t.subComponents.push(n)},readonly:function(e,t){re(W).read(e,t)},edit:function(e,t){re(W).read(e,t)}},ANYTYPE:{read:function(e,t){re(e,a.getDisplayTypeOfEntity(t))[e.mode](e,t)},readonly:function(e,t){re(b).read(e,t)},edit:function(e,t){re(b).read(e,t)}}},i.each(n,function(t,n){n.loading=function(t){re(t,j).read(t,e.$L("loading"))}}),o.renderers=t,o.getRenderer=ie,o.fieldRenderers=n,o.getFieldRenderer=re,o.click2Dial=X}(skuid)},function(e,t,n){"use strict";!function(e){var t=e.$,n=t.extend,i=e.ui,r=e.utils,o=e.$L,a=e.$.ui.keyCode;function s(e,i){var o=[];i=this.options=n({showHeader:!0,showFooter:!1,showMessages:!0,showErrorsInline:!0,showErrorsOnHover:!1},i),this._GUID=r.generateGUID(),this.models=[],this.modelsById={},this.lists=[],e&&(this.element=e.addClass("nx-editor"),i.showHeader&&(this.header=t("<div>").addClass("nx-editor-header"),this.headerLeft=t("<div>").addClass("nx-header-left").appendTo(this.header),this.headerRight=t("<div>").addClass("nx-header-right").appendTo(this.header),this.submitwrapper=t("<div>").addClass("nx-editor-header-submitwrapper"),["block","center"].indexOf(i.buttonPosition)>-1?(this.submitwrapper.appendTo(this.header),"center"===i.buttonPosition&&this.header.addClass("nx-header-center")):this.submitwrapper.appendTo("left"===i.buttonPosition?this.headerLeft:this.headerRight),this.status=t('<div class="nx-status">').appendTo(this.header).hide(),this.statustext=t('<div class="nx-status-text"></div>').appendTo(this.status),o.push(this.header),i.heading&&(this.headingElement=t("<h2>").attr("id",r.generateUniqueId()).addClass("nx-editor-header-heading").append(i.heading),this.headerLeft.prepend(this.headingElement))),i.showMessages&&(this.messages=t('<div class="nx-messages">'),o.push(this.messages)),this.contents=t("<div>").addClass(i.customContentClass?i.customContentClass:"nx-editor-contents"),o.push(this.contents),i.showFooter&&(this.footer=t("<div>").addClass("nx-editor-footer"),this.footerSubmitWrapper=t("<div>").addClass("nx-footer-"+(i.buttonPosition||"right")).appendTo(this.footer),this.footerStatus=t('<div class="nx-status">').appendTo(this.footer).hide(),this.footerStatusText=t('<div class="nx-status-text"></div>').appendTo(this.footerStatus),o.push(this.footer)),this.element.append(o),this.element.data("editor",this))}s.prototype={id:function(){return this._GUID},registerModel:function(e){if(!e)return this;var n=this,i=n.modelsById,r=!e.hasChanged;return i[e.id]||(n.models.push(e),i[e.id]=e,e.registerEditor(n),n.options.showSaveCancel&&!n.submitbuttons&&(n.savebutton=t("<div>").addClass("sk-button-save").text(o("save")).skooButton({icon:n.options.saveIcon||"sk-icon-save",disabled:r}),n.cancelbutton=t("<div>").addClass("nx-button-secondary sk-button-cancel").text(o("cancel")).skooButton({icon:n.options.cancelIcon||"sk-icon-cancel",disabled:r}),r?(n.savebutton.attr("tabindex",-1),n.cancelbutton.attr("tabindex",-1)):(n.savebutton.attr("tabindex",0),n.cancelbutton.attr("tabindex",0)),n.savebutton.on("click.skuid keydown.action.skuid",function(e){"click"===e.type&&e.stopPropagation(),"click"!==e.type&&e.which!==a.ENTER&&e.which!==a.SPACE||(t(this).removeClass("ui-state-hover"),n.submitbuttons&&n.submitbuttons.filter(".ui-button").button("disable").removeAttr("tabindex"),n.save())}),n.cancelbutton.on("click.skuid keydown.action.skuid",function(e){"click"===e.type&&e.stopPropagation(),"click"!==e.type&&e.which!==a.ENTER&&e.which!==a.SPACE||(t(this).removeClass("ui-state-hover"),n.submitbuttons&&n.submitbuttons.filter(".ui-button").button("disable").removeAttr("tabindex"),n.cancel())}),n.options.showHeader&&(n.submitbuttons=n.savebutton.add(n.cancelbutton),n.submitwrapper.append(n.savebutton,n.cancelbutton)))),n},registerList:function(e){this.lists.push(e),this.registerModel(e.model)},unregister:function(){var e=this;return e.lists&&e.lists.length&&t.each(e.lists,function(){this.unregister&&this.unregister()}),e.models&&e.models.length&&t.each(e.models,function(){this.unregisterEditor(e)}),e},getParentPage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.component.getById(this.getParentPageId(t))},getParentPageId:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.options,i=n.parentComponent,r=this.element||[];!i&&r.length;)i=(r=r.parent()).data("component");return i?(n.parentComponent||(n.parentComponent=i),i.getParentPageId(t)):e.component.getByType("skuidpage")[0].id()},hasModelWithChanges:function(){var e=!1;return t.each(this.models,function(){if(this.hasChanged)return e=!0,!0}),e},handleChange:function(){this.submitbuttons&&this.submitbuttons.filter(".ui-button").button("enable").attr("tabindex",0),this.lists.length&&t.each(this.lists,function(e,t){t.disableFiltersAndSearch().disableLoadMore()})},clearMessages:function(){this.messages&&this.messages.empty(),this._uniqueMessages={}},clearInlineErrors:function(){this.element&&this.element.find(".nx-error-inline").remove().end().find(".nx-field-error").removeClass("nx-field-error nx-field-error-icon")},handleMessages:function(e,n){var i=this,r=i._uniqueMessages;return r||(r=i._uniqueMessages={}),!!i.messages&&((!n||!n.initiatorId||i._GUID===n.initiatorId)&&void t.each(e,function(e,n){var o,a,s,l,c="nx-message",d=n.message;n.showToAdminOnly&&!i.getParentPage()._getCPI().isUserPageAdmin()||("ERROR"===n.severity||"FATAL"===n.severity?c="nx-error":"WARNING"===n.severity&&(c="nx-warning"),(o=r[c])||(o=r[c]={}),(a=o[d])?a.count++:a=o[d]={count:1},a.element?l=a.element:(l=a.element=t("<div>").addClass(c),"DUPLICATE_VALUE"===n.status?l.append(d):l.append(t("<div>").text(d)),l.on("click.skuid",function(){t(this).remove()}),i.messages.append(l)),a.count>1&&((s=l.children(".nx-dupcounter")).length?s.text(a.count):l.prepend('<div class="nx-dupcounter" style="">'+a.count+"</div>")))}))},handleCancel:function(){var e=!1,n={};t.each(this.models,function(t,i){i.hasChanged&&(e=!0,n[i.id]=!0)}),!1===e&&(this.clearMessages(),this.submitbuttons&&this.submitbuttons.filter(".ui-button").button("disable")),this.lists.length&&t.each(this.lists,function(e,t){!t.model||t.model.id in n||t.enableFiltersAndSearch().enableLoadMore()})},handleSave:function(e){var n=!1,i={};t.each(this.models,function(e,t){t.hasChanged&&(n=!0,i[t.id]=!0)}),e?this.hideStatus(o("saved")):this.hideStatus("",0),this.clearMessages(),e&&!n&&this.submitbuttons&&this.submitbuttons.filter(".ui-button").button("disable"),!e&&n&&this.submitbuttons&&this.submitbuttons.filter(".ui-button").button("enable"),this.lists.length&&t.each(this.lists,function(e,t){!t.model||t.model.id in i||t.enableFiltersAndSearch().enableLoadMore()})},cancel:function(){e.model.cancel(this.models,{initiatorId:this._GUID})},save:function(t){var n="rollbackOnAnyError";!(n in(t=t||{}))&&n in this.options&&(t[n]=this.options[n]),this.setStatus(o("saving")),t.initiatorId=this._GUID,e.model.save(this.models,t)},setStatus:function(t){e.ui.setStatus(this.status,this.statustext,t)},hideStatus:function(t,n){e.ui.hideStatus(this.status,this.statustext,t,n)},createConditionsFromXml:function(t,n){if(t){var i,r=this.conditions,o=0;if(r||(r=this.conditions=[]),(i=n?n.createConditionsFromXml(t):e.component.Component.prototype.call(this,t))&&i.length)for(;o<i.length;o++)r.push(i[o]);else i=[];return i}},addConditions:function(e){var n=this;e&&e.length&&(n.conditions||(n.conditions=[]),t.each(e,function(e,t){n.conditions.push(t)}))},getConditions:function(){return this.conditions}},n(i,{Editor:s})}(skuid)},function(e,t,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){var t=e.$,n=t.extend,r=e.ui,o=e.utils,a=e.$L,s="server";function l(n,i,l){var c,d,u,f=this;if(f._GUID=o.generateGUID(),f.editor=n,f.model=i,f.options=l||{},f.views=l.views,f.mode=l.mode,f.showFooter=l.showFooter,f.filterCssClass=l.filterCssClass,f.personalizationService=l.personalizationService||l.component&&l.component.getPersonalizationService(),f.filtersPosition=l.filtersPosition||"top",f.filtersWidth=l.filtersWidth,f.component=l.component,c=f.personalizationService&&f.personalizationService.getSettings()._List||{},f.conditions=l.conditions,f.context=l.context,f.visibleItems=[],f.currentView=!1,f.views&&(d=Object.keys(f.views)),d&&(f.currentView=d[0]),d&&d.length>1){var p=c.lastViewId;t.each(f.views,function(e){if(e===p)return f.currentView=e,!1}),f.editor.header.append(f.makeViewSwitcher())}if(f.element=!1,f.contents=!1,f.conditionsBar=t("<div>").addClass("left"===f.editor.options.buttonPosition?"nx-conditioncontainer-left":"nx-conditioncontainer"),f.searchBox=!1,f.searchFields=l.searchFields||[],f.searchSubFields=l.searchSubFields||{},f.searchFieldsMap={},f.searchSubFieldsMap={},f.setupConfigPopup=l.setupConfigPopup,f.filters=[],f.searchFields&&f.searchFields.length){var h=f.searchFields;f.searchFields=[],t.each(h,function(e,t){f.addSearchField(t)})}if(f.searchSubFields&&e.utils.size(f.searchSubFields)>=1){var g=f.searchSubFields;f.searchSubFields={},t.each(g,function(e,n){t.each(n,function(t,n){f.addSearchSubField(e,n)})})}f.customFilter=l.customFilter||!1,f.customFilterValue=l.customFilterValue||"",f.searchMethod=l.searchMethod||s,f.searchConditionName=l.searchConditionName,f.searchPlaceholderText=l.searchPlaceholderText||null;var m=l.requiredFields;if(f.requiredFields=m&&o.size(m)?m:{},f.showFooter){f.footer=t("<div>").addClass("nx-list-footer"),f.footerleft=t("<div>").addClass("nx-list-footer-left").appendTo(f.footer),f.footercenter=t("<div>").addClass("nx-list-footer-center").appendTo(f.footer),f.footerright=t("<div>").addClass("nx-list-footer-right").appendTo(f.footer),f.currentPage=0;var v=l.pageSize;v&&("all"!=v?(l.pageSize=parseInt(l.pageSize,10),f.currentPageSize=c.pageSize||l.pageSize):f.currentPageSize="all")}f.editor.registerList(f),f.makeConditionsBar(),f.editor&&f.editor.header&&("left"===f.editor.options.buttonPosition?f.editor.headerLeft.append(f.conditionsBar):(f.editor.headerRight.prepend(f.conditionsBar),f.conditionsBar.addClass("nx-conditioncontainer-right")),f.options.showSearchBox&&!1===f.searchBox&&(f.searchBox=f.makeSearchBox(),f.searchBox&&f.editor.submitwrapper.append(f.searchBox)),f.options.showConfigIcon&&(f.listConfigButton=t("<button>"),f.listConfigButton.addClass("nx-button-list-config").skootip(f.options.configIconTip||""),t(r.createIcon(f.options.configIcon||"sk-icon-configure")).addClass("inline").appendTo(f.listConfigButton),f.listConfigButton&&f.editor.submitwrapper.append(f.listConfigButton),u=f.setupConfigPopup(f),f.listConfigButton.on("click",function(e){e.stopPropagation(),u()})),f.options.delayFilterExecution&&(f.applyFiltersBtn=t("<div>").addClass("sk-button-applyfilter").text(a("apply")).skooButton({icon:"sk-icon-search-go",disabled:!1,hoverText:a("apply")}).hide().on("click",function(){f.applyFiltersAndSearch()}),f.cancelFiltersBtn=t("<div>").addClass("sk-button-cancelfilter").text(a("cancel")).skooButton({icon:"sk-icon-cancel",disabled:!1,hoverText:a("cancel")}).hide().on("click",function(){f.cancelFiltersAndSearch()}),f.editor.submitwrapper.append(f.applyFiltersBtn,f.cancelFiltersBtn))),f.renderedItems={}}function c(e,t){var n=e.footerleft;return n&&n.find(".nx-list-loadmore").toggleClass("unavailable",t),e}n(l.prototype,{id:function(){return this._GUID},unregister:function(){return this.model&&this.model.unregisterList(this),this.removeModelListeners(),this.renderedItems&&t.each(this.renderedItems,function(){this.unregister&&this.unregister()}),this},getSelectedItems:function(){var e=[];return t.each(this.renderedItems,function(t,n){n.selected&&e.push(n)}),e},unSelectAll:function(){t.each(this.renderedItems,function(e,t){t.selected&&(t.selected=!1)})},isFieldSearchable:function(e){if(!e)return!1;var t,n=this.model.dataSource;return n&&(t=n.dataSourceType.searchableDisplayTypes),(!t||Object.keys(t).length<1)&&(t=r.searchableDisplayTypes),e.displaytype in t&&(e.filterable||"client"===this.searchMethod)},addSearchField:function(e,t){if(e){var i,r=this.model.getField(e.id);this.isFieldSearchable(r)&&(r.id in this.searchFieldsMap||(i=n({},r),t&&(i.searchOperator=t),this.searchFields.push(i),this.searchFieldsMap[r.id]=i))}},addSearchSubField:function(e,t){if("object"===(void 0===t?"undefined":i(t))&&(t=t.id),e&&t){var n=this.model.getField(t,e);if(this.isFieldSearchable(n)){var r=this.searchSubFieldsMap[e],o=this.searchSubFields[e];r||(r=this.searchSubFieldsMap[e]={},o=this.searchSubFields[e]=[]),n.id in r||(r[n.id]=1,o.push(n))}}},addRequiredField:function(e){var t=e._id||e.id;this.requiredFields[t]=e},removeRequiredField:function(e){var t=e._id||e.id;delete this.requiredFields[t]},validateRequiredFields:function(){var e=this,n=[],i=e.model,r=e.requiredFields;return t.each(i.changes,function(s){var l=i.getRowById(s);if(!i.isRowMarkedForDeletion(l)){var c={severity:"ERROR",status:"REQUIRED_FIELD_MISSING",fields:[],model:i},d="",u=!1;l&&s in e.renderedItems&&t.each(r,function(e,t){var n=t.id,r=t.label,a=i.getFieldValue(l,n,!0);(""===a||null===a||o.isUndefined(a))&&"BOOLEAN"!==t.displaytype&&(d&&(d+=", "),d+="["+r+"]",c.fields.push({id:n,label:r}),c.rowId=s,u=!0)}),u&&(c.message=a("required_fields_have_no_value")+" "+d,n.push(c))}}),n},getView:function(e){return e||(e=this.currentView),this.views[e]},callViewOperation:function(e,t){t||(t=this.getView()),t&&e&&e in t&&t[e](this)},setUp:function(e){this.callViewOperation("setUp",e)},beforeRender:function(e){this.callViewOperation("beforeRender",e)},renderComplete:function(e){this.callViewOperation("renderComplete",e)},tearDown:function(e){this.callViewOperation("tearDown",e)},getAllRows:function(){var e=this.model,t=e&&e._clientData||e.getRows(this.conditions,this.context),n=this.customFilter,i=this.customFilterValue;return n&&(i||"0"===i)&&(t=t.filter(function(e){return n(i,e)})),t},getRenderedItemByRowId:function(e){return this.renderedItems[e]},render:function(n){n=n||{};var i,r=this,o=r.model,s=r.options,l=[],c=n.previousView||!1,d=c&&c!==r.currentView,u=r.getView(),f=!r.element||n.doNotCache||u.alwaysFullRender,p=n.changedRows,h=!1!==this.options.showLoadMore,g=!0===n.resetItemModes,m=!1!==n.refreshFields,v=o.getConditionByName(r.searchConditionName||"__default_searchbox");if(r.searchbox&&v&&("group"===v.type||"search"===v.type))if(n.initiatorId&&n.initiatorId===r._GUID);else{var y;if(v.value&&"search"===v.type)if(r.options.tokenizeSearch){y="";var b=v.value.split(" AND ");t.each(b,function(e,t){y+=t.substring(1,t.length-2)+" "}),y=y.substring(0,y.length-1)}else y=v.value.substring(1,v.value.length-2);else y=v.value;y&&!v.inactive?(r.searchbox.val(y),r.searchbox.data("curval",y)):(r.searchbox.val(""),r.searchbox.data("curval",""))}u.alwaysFullRender&&(n.doNotCache=!0),d&&(c=r.getView(c))&&r.tearDown(c),n.resetPagination&&(r.currentPage=0);var w=(i=r.getAllRows()).length,S=r.currentPageSize,C=0,I=w;r.footer&&r.showFooter&&(r.footerleft.empty(),r.footercenter.empty(),r.footerright.empty()),r.element&&!d||(r.element&&r.element.remove(),r.element=t("<"+(u.nodeType||"div")+">").addClass("nx-list"),r.contents=t("<"+(u.contentsNodeType||"div")+">").addClass("nx-list-contents").appendTo(r.element),s.labeledBy&&r.element.attr("aria-labeledby",s.labeledBy),r.setUp(u));var k=e.utils.makeXMLDoc,x=r.filtersPosition;if("left"!==x&&"right"!==x||!r.component)"bottom"===x&&r.element.append(r.conditionsBar.css({display:"block",float:"none"}).addClass("nx-conditioncontainer-bottom"));else{if(!r.panelSet){var T=k("<panelset/>").attr("type","standard").append(k("<panels/>").append(k("<panel/>"),k("<panel/>").attr({type:x,width:r.filtersWidth})));r.panelSet=e.$("<div>").panelSet(T,r.component)}r.conditionsBar.css({float:x,"text-align":x})}if(r.showFooter&&S&&"all"!=S&&w>S){r.currentPage<0&&(r.currentPage=0);var R=Math.ceil(w/S);r.currentPage>R-1&&(r.currentPage=R-1),C=S*r.currentPage,I=S*(r.currentPage-0+1),r.currentPage==R-1&&(I=w),i=i.slice(C,I);var D=t("<div>").addClass("nx-buttonset"),A=t("<div>").addClass("first").text(a("first")).button(),E=t("<div>").addClass("prev").text(a("previous")).button(),F=t("<div>").addClass("next").text(a("next")).button(),N=t("<div>").addClass("last").text(a("last")).button(),M=r.currentPage<R-3?r.currentPage-2:R-5,_=r.currentPage>2?r.currentPage+2:4;D.append(A,E);for(var P=M;P<=_;P++)if(P>=0&&P<R){var O=t("<div>").text(P-0+1).attr("data-pn",P).button();P===r.currentPage&&O.addClass("nx-button-selected"),D.append(O)}D.append(F,N).buttonset(),D.children().filter('[data-pn="'+r.currentPage+'"]').button("disable"),0===r.currentPage?(A.button("disable"),E.button("disable")):r.currentPage==R-1&&(N.button("disable"),F.button("disable")),this.footerright.append(D),D.on("click",".ui-button",function(e){e.stopPropagation();var n=t(this);n.is(".first")?r.goToPage(0):n.is(".prev")?r.prevPage():n.is(".next")?r.nextPage():n.is(".last")?r.goToPage(R-1):r.goToPage(parseInt(n.data("pn"),10))})}if(r.showFooter&&S&&"all"!=S&&w){var L=[5,10,25,50];-1==L.indexOf(s.pageSize)&&L.push(s.pageSize),-1==L.indexOf(r.currentPageSize)&&L.push(r.currentPageSize);L.sort(function(e,t){return e-t});var U=t("<select>");U.on("click",function(e){e.stopPropagation()}),U.append(t.map(L,function(e){return t('<option value="'+e+'">'+e+"</option>")})),U.children().filter('[value="'+S+'"]').attr("selected","selected"),U.change(function(){var e=parseInt(t(this).val(),10);r.personalizationService&&r.personalizationService.updateSettings({_List:{pageSize:e}}),r.currentPageSize=e,r.render()});var B=t("<span>");B.append("<span>"+a("show")+" </span>",U,"<span> "+e.label.merge(a("objects_per_page"),o.labelPlural)+"</span>"),this.footerleft.append(B)}var j=a("pagination_limit_reached"),V=o.debug===j,G=!0===o.canRetrieveMoreRows;if(r.showFooter){if(w){var H=w+"";G&&(H+="+"),this.footercenter.append("<span>"+e.label.merge(a("showing_rows"),C+1,I,H)+(V?" ("+j+")":"")+"</span>")}if(G&&!V&&h){var z=t('<div class="nx-list-loadmore" role="button">').text(a("load_more")).on("click.skuid",function(){t(this).is(".unavailable")||(r.blockUI({message:a("loading")}),o.loadNextOffsetPage(function(){r.unblockUI()}))});this.footerleft.append(z)}w||(o.needsMetadataLoad&&o.loadAsync&&!o.doQuery?this.footercenter.append("<span>Loading Metadata for: "+o.label+"</span>").css("line-height","25px"):o.needsMetadataLoad&&o.loadAsync?this.footercenter.append("<span>Loading: "+o.label+"</span>").css("line-height","25px"):this.footercenter.append("<span>"+e.label.merge(a("no_objects_to_display"),o.labelPlural)+"</span>").css("line-height","25px"))}n.doNotCache&&(t.each(r.renderedItems,function(e,t){t&&t.destroy()}),r.renderedItems={},r.makeConditionsBar()),r.beforeRender(u),r.visibleItems=[],!0===n.destroyDeletedRows&&t.each(r.renderedItems,function(e,t){var n=o.record(e);!t||n&&!n.isMoribund()||(t.destroy(),delete r.renderedItems[e])});var q={};function $(e,t){q[t]||(q[t]=1,g&&e.resetMode(),m&&(p&&p[t]?e.refreshFields(p[t]):e.refreshFields()))}t.each(i,function(){var e=o.getRowId(this),t=o.record(e),i=r.renderedItems[e];i&&!n.doNotCache?$(i,e):i=r.newItem(this,n),i&&(i.element[(t.isMoribund()?"add":"remove")+"Class"]("deleted"),l.push(i.element),r.visibleItems.push(i))}),!n.doNotCache&&g&&r.getAllRows().forEach(function(e){var t=o.getRowId(e),n=r.renderedItems[t];n&&$(n,t)}),u.noAutoAppend||(r.contents.children().detach(),r.contents.append(l)),f&&r.attach(),r.renderComplete(u)},showRow:function(e){var t=!0;return this.conditions&&this.conditions.length&&(t=o.doesRowMeetConditions(e,this.conditions)),t},handleNewRow:function(e,t){var i={},r=this.model.getRowId(e);if(t&&n(i,t),!o.isUndefined(r)&&!(r in this.renderedItems)&&this.showRow(e)){var a=this.newItem(e,i);if(this.contents.prepend(a.element),this.render({resetPagination:!0,refreshFields:!1}),a&&"edit"===a.mode){var s=a.element.find(".nx-field > :input:visible:not(.nx-skootable-rowselect):not(.hasDatepicker):not(select)").first();s&&s.focus()}}},handleRowDeletion:function(e){e&&e in this.renderedItems&&this.renderedItems[e].destroy()},newItem:function(e,t){var n,i=this.model.getRowId(e);if(i)return n=new r.Item(this,e,{mode:t&&t.editModeForNewItems?"edit":this.mode,selected:t&&t.selected}),n.render(),this.renderedItems[i]=n,n},attach:function(){"right"===this.filtersPosition||"left"===this.filtersPosition?(this.panelSet.find(".nx-panel-fluid .nx-panel").append(this.element,this.footer),this.panelSet.find(".nx-panel-left-inner, .nx-panel-right-inner").append(this.conditionsBar),this.editor.contents.append(this.panelSet)):this.editor.contents.append(this.element,this.footer)},makeViewSwitcher:function(){var n=this,i=[];return t.each(n.views,function(e,t){i.push({value:e,label:t.label||e,icon:t.icon,isSelected:n.currentView===e})}),t("<div>").actionSelect({items:i,onItemSelect:function(i){var r=n.currentView;n.currentView=i.value,n.render({doNotCache:!0,previousView:r}),t.cookie("nx-list-view-"+e.page.name+"-"+n.model.id,i.value),n.personalizationService&&n.personalizationService.updateSettings({_List:{lastViewId:i.value}})}}).addClass("nx-viewswitcher")},makeSearchBox:function(){var e=this;if("client"===e.searchMethod&&(e.customFilter=function(n,i){var r=!1,a=n.toLowerCase(),s=function(t,n){var i,s=t.searchOperator,l=e.model.getFieldValue(n,t.id,!0)+"";null!==l&&(i=l.toLowerCase(),r="="===s?i===a:"starts with"===s?o.startsWith(i,a):o.contains(i,a))};return t.each(e.searchFields,function(e,t){return s(t,i),!r}),!r&&e.searchSubFields&&t.each(e.searchSubFields,function(e,n){var o=i[e];o&&o.totalSize&&n.length&&t.each(o.records,function(e,i){return t.each(n,function(e,t){return s(t,i),!r}),!r})}),r}),e.searchFields||"custom"===e.searchMethod){var n="placeholder"in document.createElement("input"),i=t('<input type="text" class="searchbox" />'),r=e.searchPlaceholderText?o.mergeAsText("model",e.searchPlaceholderText,{createFields:!0,registerFields:!1},e.model):a("search")+" "+e.model.labelPlural;return e.customFilterValue&&i.val(e.customFilterValue),e.searchbox=i,n?i.attr("placeholder",r):(i.addClass("unchanged").val(r),i.focus(function(){i.hasClass("unchanged")&&i.val("").removeClass("unchanged")}).blur(function(){""===i.val()&&i.val(r).addClass("unchanged")})),e.options.delayFilterExecution&&i.on("keyup",function(t){13===t.which&&e.applyFiltersAndSearch()}),o.delayInputCallback(i,function(t,n){e.options.delayFilterExecution&&void 0===i.data("originalValue")&&i.data("originalValue",n),"client"===e.searchMethod||"custom"===e.searchMethod?(e.customFilterValue=t,e.render()):e.options.delayFilterExecution?e.showFilterActions():(e.setSearchCondition(t),"remove"!==e.options.emptySearchBehavior||t?e.updateData({message:a("searching"),failmessage:a("error_performing_requested_search"),showerror:!0}):e.model.emptyData())},{dataPropertyName:"curval"}),i.on("click",function(e){e.stopPropagation()}),i}return!1},setSearchCondition:function(e){this.model.buildSearchCondition(this.searchConditionName,e,this.searchFields,{tokenize:this.options.tokenizeSearch,useSOSLSearch:this.options.useSOSLSearch,SOSLFields:this.options.SOSLFields})},showFilterActions:function(){var e=function(e){e.show("fast").css({display:"inline-block"})};e(this.applyFiltersBtn),e(this.cancelFiltersBtn),this.editor.options.showSaveCancel&&this.editor.submitbuttons.hide("fast");var n=t(".sk-pagepanel.filters-panel");return n.length&&(e(n.find(".sk-button-applyfilter")),e(n.find(".sk-button-cancelfilter"))),this},hideFilterActions:function(){this.applyFiltersBtn.hide("fast"),this.cancelFiltersBtn.hide("fast"),this.editor.options.showSaveCancel&&this.editor.submitbuttons.show("fast").css("display","inline-block");var e=t(".sk-pagepanel.filters-panel");return e.length&&(e.find(".sk-button-applyfilter").hide("fast"),e.find(".sk-button-cancelfilter").hide("fast"),this.editor.submitbuttons.css("display","inline-block")),this},applyFiltersAndSearch:function(){var e,n=this,i=n.searchBox;return i&&(e=i.is(".unchanged")?"":i.val(),i.data("originalValue",e),n.setSearchCondition(e)),n.filters&&t.each(n.filters,function(){var e=this.activateFilter;e&&e()}),"remove"!==n.options.emptySearchBehavior||e?n.updateData({message:a("searching"),failmessage:a("error_performing_requested_search"),showerror:!0,successcallback:function(){n.hideFilterActions()}}):(n.model.emptyData(),n.hideFilterActions()),n},cancelFiltersAndSearch:function(){var e=this.searchBox;return e&&e.val(e.data("originalValue")),this.filters&&t.each(this.filters,function(){this.restoreOriginalValue()}),this.hideFilterActions(),this},updateData:function(e){var t=this;return t.blockUI({message:e.message}),t.model.updateData(!1,{initiatorId:t._GUID}).always(function(){t.unblockUI()}).done(function(){t.editor.clearMessages(),e.successcallback&&e.successcallback()}).fail(function(n){t.editor.clearMessages(),t.editor.handleMessages([{message:e.failmessage+(e.showerror&&n?" "+n:""),severity:"ERROR"}])}),t},makeConditionsBar:function(){this.makeFiltersBar()},enableFiltersAndSearch:function(){return this.conditionsBar&&this.conditionsBar.find(".nx-conditiontoken").removeClass("unavailable").children(".ui-multiselect").siblings("select").multiselect("enable").end().children("input").prop("disabled",!1),this.searchMethod===s&&this.searchBox&&this.searchBox.prop("disabled",!1),this},disableFiltersAndSearch:function(){return this.conditionsBar&&this.conditionsBar.find(".nx-conditiontoken").addClass("unavailable").children(".ui-multiselect").siblings("select").multiselect("disable").end().children("input").prop("disabled",!0),this.searchMethod===s&&this.searchBox&&this.searchBox.prop("disabled",!0),this},enableLoadMore:function(){return c(this,!1)},disableLoadMore:function(){return c(this,!0)},blockUI:function(e){var t={message:(e=e||{}).message};this.options.blockUICSS&&(t.css=this.options.blockUICSS),this.options.blockOverlayCSS&&(t.overlayCSS=this.options.blockOverlayCSS),this.editor.element.block(t)},unblockUI:function(e){var t={};(e=e||{}).failmessage?(this.options.blockUICSS&&(t.css=this.options.blockUICSS),this.options.blockOverlayCSS&&(t.overlayCSS=this.options.blockOverlayCSS),t.timeout=e.timeout||4e3,t.message=e.failmessage,this.editor.element.block(t)):this.editor.element.unblock()},addModelListeners:function(){var e=this,t=e.modelListeners,n={},i=o.debounce(function(){e.makeFiltersBar()},1);return t||(t=e.modelListeners=[]),e.filters.forEach(function(e){e.sources&&e.sources.forEach(function(e){var r=e.model;r&&!n[r.id]&&(n[r.id]=1,["cancelled","loaded","saved","row.updated","row.created"].forEach(function(e){t.push(r.subscribe(e,i))}))})}),e},removeModelListeners:function(){var e=this.modelListeners;return e&&(e.forEach(function(e){e.unsubscribe()}),e.length=0),this},makeFiltersBar:function(){var e,n=this,i=n.options.listFilters,o=i&&i.closest("filterset"),a="right"===n.filtersPosition||"left"===n.filtersPosition;return n.removeModelListeners(),n.filters&&n.filters.length?(n.filters.forEach(function(e){e.unregister()}),n.filters.length=0):n.filters=[],!!i&&((e=n.conditionsBar).empty(),t.each(i.children(),function(i){var s=new r.Filter({xml:t(this),list:n,selectedList:o.length&&"vertical"===o.attr("layout")?2:3,cssClass:n.filterCssClass});s&&s.element&&(a&&0!==i&&e.append("<br>"),e.append(s.element),s.multiSelectMaxWidth&&s.multiSelectMaxWidth()),n.filters.push(s)}),n.addModelListeners(),a&&e.addClass("nx-conditioncontainer-vertical nx-conditioncontainer-vertical-"+n.filtersPosition),e)},nextPage:function(){this.currentPage++,this.render({refreshFields:!1})},prevPage:function(){this.currentPage--,this.render({refreshFields:!1})},goToPage:function(e){this.currentPage=e,this.render({refreshFields:!1})}}),n(r,{List:l})}(skuid)},function(e,t,n){"use strict";!function(e){var t=e.$,n=t.extend,i=e.ui,r=e.utils;function o(e,t,i){n(this,{_GUID:r.generateGUID(),list:e,row:t,defaultMode:e.mode||"read",deleted:!1,selected:i.selected||!1,element:!1,fields:[],fieldsByGUID:[]}),this.mode=i.mode||this.defaultMode,e&&e.model&&e.model.registerItem(this)}n(o.prototype,{id:function(){return this._GUID},render:function(){var e,n=this.list,i=!!n&&n.views,r=n.currentView;return n&&i&&r&&(e=i[r],this.element&&this.element.remove(),this.element=t("<"+(e.itemNodeType||"div")+">").addClass("nx-item").data("object",this),e.render(this)),this},refreshFields:function(e){var t=this;return t.fields.forEach(function(n){(t.mode!==n.mode||!e||n.id in e)&&(n.mode=t.mode,n.render())}),t},resetMode:function(){return this.mode!==this.defaultMode&&(this.mode=this.defaultMode),this},toggleEdit:function(){return"readonly"!==this.mode&&(this.mode="read"==this.mode?"edit":"read",this.refreshFields()),this},toggleDelete:function(e){return this.deleted?this.unMarkForDelete(e):this.markForDelete(e),this},handleUnmarkRowForDeletion:function(e){var t=this.list.model,n=this.row,i=!!n&&t.getRowId(n),r=!!e&&t.getRowId(e);return!n||n!==e&&i!=r||this.unMarkForDelete(!1),this},handleMarkRowForDeletion:function(e){var t=this.list.model,n=this.row,i=!!n&&t.getRowId(n),r=!!e&&t.getRowId(e);return!n||n!==e&&i!=r||this.markForDelete(!1),this},unMarkForDelete:function(e){return this.element.removeClass("deleted"),this.deleted=!1,e&&this.list.model.undeleteRow(this.row),this},markForDelete:function(e){return this.element.addClass("deleted"),this.deleted=!0,e&&this.list.model.deleteRow(this.row),this},getFieldById:function(e){for(var t,n=0;n<this.fields.length;n++)if((t=this.fields[n]).id===e)return t},registerField:function(e){this.fields.push(e),this.fieldsByGUID[e._GUID]=e},unregister:function(e){var n=this.fields,i=this.list;return i&&i.model&&i.model.unregisterItem(this),n&&n.length&&t.each(n,function(){this.destroy(e)}),this},destroy:function(){this.unregister({removeDOM:!1}),this.element&&this.element.remove()}}),n(i,{Item:o})}(skuid)},function(e,t,n){"use strict";!function(e){var t=e.$,n=t.extend,i=e.ui,r=e.utils,o="_ce_eventSubscriptions",a="DATETIME",s="_eventSubscriptions";function l(n,i,o,s){var l,c,d=this;if(d._GUID=r.generateGUID(),d.row=n,d.model=i,d.editor=o,d.options=s||{},d.doNotRender=d.options.doNotRender,d.subComponents=[],d.id=s.fieldId,d.name=s.fieldName,d.context=s.fieldContext,d.messages=[],d.id&&(d.metadata=i.getField(d.name?d.name:d.id,d.context)),l=d.metadata,d.options.labelText?d.label=d.options.labelText:d.options.label?d.label=d.options.label:l&&(d.label=l.label),d.options.required||l&&l.required?d.required=!0:d.required=!1,d.mode=s.mode||"read",d.element=t("<div>").addClass("nx-field").attr("data-uid",d._GUID),s.uniqueId&&d.element.attr("id",s.uniqueId),s.additionalClass&&d.element.addClass(s.additionalClass),d.element.data("object",d),d.editable=(!l||i.isRowNew(n)&&l.createable||l.editable)&&!1!==d.options.editable&&"readonly"!==d.mode,d.loading=s.loading,d.options.register&&i.registerField(d),c=s.controllingFields,l&&-1!==t.inArray(l.displaytype,["PICKLIST","MULTIPICKLIST","COMBOBOX"])){var u,f=l.controllingField,p=i.getField("RecordTypeId"),h=l.picklistSourceModel;c||(s.controllingFields=c=[]),p&&c.push(p.id),f&&c.push(f),"rowsinmodel"===l.picklistSource&&e.$M(h)&&["row.updated","row.created","row.deleted","row.undeleted","models.cancelled","models.loaded","models.saved"].forEach(function(e){d.subscribeToEvent(e,function(e){u!==e&&(u=e,e.modelId===h?d.render():e.models&&t.each(e.models,function(n,i){if(i.id===h)return e.insertResults&&t.each(e.insertResults,function(e,t){if(d.row[d.id]===t.oldId){var n={};n[d.id]=t.id,i.updateRow(d.row,n)}}),d.render(),!1}))})})}if(c&&c.length&&t.each(c,function(){var e=this;-1!==e.indexOf(".")&&(e=e.split(".")[0]),i.registerField(d,e)}),d.editable&&i.isRelationshipField(d.id)){var g=i.getReferenceFieldNameFromRelationshipField(d.id);i.fieldsMap.hasOwnProperty(g)&&i.registerField(d,g)}l&&l.displaytype===a&&d.subscribeToEvent("ui.timeZoneChanged",function(){d.render()})}n(l.prototype,{uid:function(){return this._GUID},register:function(e){return this.model&&this.model.registerField(this,e),this},subscribeToEvent:function(t,n){var i,r=this[s];return r||(r=this[s]=[]),i=e.events.subscribe(t,n),r.push(i),i},unregister:function(){var t=this,n=t.options,i=t._renderer;i&&(i.destroy&&i.destroy(t),delete t._renderer),t.model&&t.model.unregisterField(t,!!n&&n.controllingFields),[s,o].forEach(function(n){var i=t[n];i&&i.length&&i.forEach(function(t){e.events.unsubscribe(t)})})},calculateReferenceText:function(){return r.calculateReferenceText({model:this.model,row:this.row,template:this.options.template,fieldMetadata:this.metadata})},calculateReferenceMerges:function(e){return e||(e={}),r.calculateReferenceMerges(n(e,{model:this.model,row:this.row,template:this.options.template,fieldMetadata:this.metadata}))},getValidPicklistEntries:function(){var e=this,n=e.model.getDataSourceType(),i=e.metadata,r=i&&i.picklistEntries;return i?(n&&n.getValidPicklistEntriesSync&&(r=n.getValidPicklistEntriesSync(e)),i.deDupLabel&&t.each(e.row,function(n,i){e.metadata.id===n&&t.each(r,function(t,r){r.label===i&&(e.row[n]=r.value)})}),r):[]},getValidPicklistEntriesAccountingForDataSource:function(){var e=this,n=e.model.getDataSourceType();return n&&n.getValidPicklistEntries?n.getValidPicklistEntries(e):t.when().then(function(){return e.getValidPicklistEntries()})},addOrReplaceConditionsForLookupFiltersToModel:function(n){var i=this,o=[],a=!(!i.options||!i.options.filters)&&i.options.filters;return n||(n=i.model),a&&a.length&&t.each(a,function(a,s){var l,c,d=i.id+"_"+s.field+"_"+a,u=n.getConditionByName(d);if(u||((u=new e.model.Condition).name=d,n.addCondition(u)),u.field=s.field,u.operator=s.operator||"=",u.encloseValueInQuotes=s.encloseValueInQuotes,s.sourceParam&&(u.sourceParam=s.sourceParam),l=r.isMultiValueOperator(u.operator),"dependent"===s.type)void 0!==(c=i.model.getFieldValue(i.row,s.depfield,!0))&&(l?u.values=c&&-1!=c.indexOf(";")?c.split(";"):[c]:u.value=c),null===c||r.isUndefined(c)?(u.type="blank",u.value="null",u.encloseValueInQuotes=!1):u.type="fieldvalue";else if("userinfo"===s.type)delete u.type,u.value=r.getUserInfoPropValue(s.mergeField);else if("param"===s.type)void 0!==(c=e.page.params[s.mergeField])&&(l?u.values=c&&-1!=c.indexOf(";")?c.split(";"):[c]:u.value=c),u.type="fieldvalue";else if("modelmerge"===s.type){var f=e.model.getModel(s.mergeModel);if(f)l?(u.values=[],t.each(f.data,function(){u.values.push(f.getFieldValue(this,s.mergeField,!0))})):u.value=f.getFieldValue(f.getFirstRow(),s.mergeField,!0),delete u.type,u.model=s.mergeModel,!(void 0!==u.value&&null!==u.value||u.values&&u.values.length)&&"noquery"===s.noValueBehavior&&n&&(n.doQuery=!1),u.noValueBehavior=s.noValueBehavior}else u.type=s.type,s.values?u.values=s.values:u.value=s.value,s.mergeField&&(u.mergeField=s.mergeField,u.originalValue=null);o.push(u)}),o},_getUpdateRowOptions:function(){return"edit"===this.mode?{initiatorId:this._GUID}:{}},_toggleModified:function(){var e=this.element,t=this.model,n=this.row,i=t.getRowId(n),r=this.name?this.name:this.id,o=r?t.getFieldValue(n,r,!0):null,a=t.originals[i];return e.removeClass("nx-modified"),(a&&r&&r in a&&a[r]!==o||t.isRowNew(n)&&!t.isAggregate)&&e.addClass("nx-modified"),this},render:function(n){if(!this.doNotRender){var a,s,l,c=this,d=c.element,u=c.options,f=c.model,p=f.getDataSource().getFieldRenderers()||{},h=c.row,g=c.name?c.name:c.id,m=g?f.getFieldValue(h,g,!0):null,v=u.enableConditionsXML;if(d.empty(),c._toggleModified(),c.editable||(c.mode="readonly"),"edit"===c.mode&&c.required?d.addClass("required"):d.removeClass("required"),c.loading&&(c.mode="loading"),u&&"right"===u.valueHorizontalAlignment&&d.addClass("halignright"),c.metadata&&(l=c.metadata.displaytype),u.type&&(u.type in i.fieldRenderers||u.type in p)?a=i.getFieldRenderer(u.type,f.dataSource):l&&(l in i.fieldRenderers||l in p)&&(a=i.getFieldRenderer(l,f.dataSource)),s=c.mode,a||(a=i.getFieldRenderer("TEXT",f.dataSource)),!a||s in a||(s="read")in a||(a=i.getFieldRenderer("TEXT",f.dataSource)),c._renderer=a,a[s](c,m,n),v&&v.length&&v.children().length){var y,b=v.attr("message"),w="skuid__originalTooltip",S=u.valueHorizontalAlignment||"left",C=c[o];C?C.forEach(function(t){e.events.unsubscribe(t)}):C=c[o]=[],c.editor&&c.editor.element._columnsByGUID&&t.each(c.editor.element._columnsByGUID,function(){this.fieldId==c.id&&(this.disabled=!1)}),"edit"===c.mode&&r.conditionallyDo(function(){d.removeClass("disabled").find(":input").prop("disabled",!1).end().find("[sk-contenteditabledisabled=true]").attr("contenteditable","true").removeAttr("sk-contenteditabledisabled").end().find(".ui-button").button("enable").end().find(".ui-multiselect").animate({opacity:"1.0"},function(){t(this).css("opacity","")}).siblings("select").multiselect("enable"),d.attr("sk-ckeditorname")&&(e.CKEDITOR.instances[d.attr("sk-ckeditorname")].setReadOnly(!1),d.find(".sk-cke-hide").remove()),c._toggleModified(),c.labelElement&&c.labelElement.animate({color:"rgba(0,0,0,1)"}),b&&((y=d.data(w))&&"function"!=typeof y&&y!==b?(d.skootip(y),d.removeData(w)):d.tooltip("instance")&&d.tooltip("destroy")),I(!1),c.disabled=!1},function(){if(d.removeClass("nx-modified").addClass("disabled").find(":input").prop("disabled",!0).end().find(".ui-button").button("disable").end().find("[contenteditable=true]").attr("sk-contenteditabledisabled","true").removeAttr("contenteditable").end().find(".ui-multiselect").animate({opacity:"0.4"}).siblings("select").multiselect("disable"),d.attr("sk-ckeditorname")){var n=d.attr("sk-ckeditorname");e.CKEDITOR.instances[d.attr("sk-ckeditorname")].setReadOnly(!0),0===d.find(".sk-cke-hide").length&&d.append('<style class="sk-cke-hide">#cke_'+n+"{display:none!important;}</style>")}if(c.labelElement&&c.labelElement.animate({color:"rgba(0,0,0,0.3)"}),b){if(d.tooltip("instance")){var i=d.tooltip("option","content");i&&"function"!=typeof i&&i!==b&&d.data(w,i)}d.skootip(b,{position:{my:S+" bottom",at:S+" top-10"},open:function(e,n){var i=t("<div>").addClass("sk-hastooltip").css(S,"0px");n.tooltip.append(i)}})}I(!0),c.disabled=!0},v,null,{row:h,model:f,eventSubscriptions:C,renderOverride:u.renderOverride})}c.messages.length&&c.editor&&c.editor.options&&c.editor.options.showErrorsInline&&t.each(this.messages,function(e,t){c.renderMessage(t)})}function I(e){c.editor&&c.editor.element._columnSettingsByUID&&t.each(c.editor.element._columnSettingsByUID,function(){this.fieldId==c.id&&(this.disabled=e)})}},destroy:function(e){var n=this.element,i=this.options,o=i&&i.subscriptionElement,a=!e||!1!==e.removeDOM;n&&!n.jquery&&(n=t(n)),o&&r.removeEventSubscriptions(o),this.unregister(),n&&a&&n.remove()},handleUpdate:function(e,t){this.handleChange(e,t)},handleChange:function(e,n){var i=this,r=i.model,o=i.row,a=r.getDataSourceType(),s=i.id,l=i.options.controllingFields;if(l&&l.length&&n&&-1!==t.inArray(n,l)){var c,d=!1,u=i.metadata&&-1!==t.inArray(i.metadata.displaytype,["PICKLIST","MULTIPICKLIST","COMBOBOX"]),f=r.getFieldValue(o,s,!0),p=function(e){e&&t.each(e,function(e,t){if(f===t.value)return d=!0,!1}),d||r.updateRow(o,s,"",{initiatorId:i.uid()})};if(u&&a.getValidPicklistEntries)return a.getValidPicklistEntries(i).then(function(e){p(e),i.render()});u&&(c=i.getValidPicklistEntries()),p(c)}i.render()},handleMessage:function(e){this.messages.push(e),this.doNotRender?e.message=e.message?r.decodeHTML(e.message):"":this.editor&&this.editor.options&&this.editor.options.showErrorsInline&&this.renderMessage(e)},renderMessage:function(n){if(!this.doNotRender){this.errorElement||(this.errorElement=t("<div>"));var i=n.message;"REQUIRED_FIELD_MISSING"===n.status&&(i="This Field is Required"),this.editor.options.showErrorsOnHover?(this.element.children("input").addClass("input-with-error"),this.errorElement.skootip(e.utils.encodeHTML(i)),this.errorElement.addClass("sk-icon sk-icon-error sk-icon-inline-error nx-field-error-icon"),this.element.append(this.errorElement)):(this.errorElement.addClass("nx-error-inline").text(i),this.element.prepend(this.errorElement),this.element.addClass("nx-field-error"))}},getParentPage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.component.getById(this.getParentPageId(t))},getParentPageId:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.editor,i=this.element||[];!n&&i.length;)n=(i=i.parent()).data("component");return n?n.getParentPageId(t):e.component.getByType("skuidpage")[0].id()},getReferenceOptions:function(n,r){if(r=r||{},!this.metadata||"REFERENCE"!==this.metadata.displaytype)throw'Can not retrieve reference options of a non "REFERENCE" type field';var o,a=this,s=t.Deferred(),l=r.referencedObject,c=a.metadata.dataSourceName?e.dataSource.getDataSource(a.metadata.dataSourceName):a.model.getDataSource(),d=c.getNameField(l),u=r.relMetadata||{},f=r.returnFields||a.options.returnFields||[],p=r.searchFields||a.options.searchFields||[{id:d,displaytype:"STRING",filterable:!0}],h=function(e){var t,n,r=c.dataSourceType.searchableDisplayTypes;for((!r||Object.keys(r).length<1)&&(r=i.searchableDisplayTypes),t=e.length-1;t>=0;t--)n=e[t],!a.metadata.uiOnly&&Object.keys(r).indexOf(n.displaytype)<0&&e.splice(t,1)},g=a.options,m=0,v=0;if(g.optionsource){if("model"===g.optionsource){if(!(o=e.$M(g.optionmodel)))return;t.each(p,function(e,n){var i=u.fields,r=n.id,o=i&&i.filter(function(e){return e.id===r})[0]||a.model.getField(w+r);o?(t.extend(n,o),n.id=r):n.displaytype="STRING"}),h(p);var y=a.addOrReplaceConditionsForLookupFiltersToModel(o),b=y&&y.length;o.conditions&&o.conditions.length&&o.conditions.forEach(function(e){"modelmerge"===e.type?o.updateConditionValue(e)&&(b=!0):"join"===e.type&&e.subConditions&&t.each(e.subConditions,function(e,t){"modelmerge"===t.type&&o.updateConditionValue(t)&&(b=!0)})}),"REFPICK"===g.type?b?o.updateData(function(){s.resolve(o)}):s.resolve(o):(o.buildSearchCondition("__default_searchbox",n,p,{tokenize:"true"===g.tokenizeSearch,useSOSLSearch:g.useSOSLSearch,SOSLFields:g.SOSLFields,delimiter:g.delimiter,searchOperator:"contains"}),o.updateData(function(){s.resolve(o)}))}}else{var w;if(a.model)w=a.metadata&&a.metadata.rel?a.metadata.rel+".":"",t.each(p,function(e,n){var i=u.fields,r=n.id,o=i&&i.filter(function(e){return e.id===r})[0]||a.model.getField(w+r);o?(t.extend(n,o),n.id=r):n.displaytype="STRING"});h(p),o=e.ui.getReferenceLookupModel(c,a,l,f),m++,g.defaultOrdering?o.orderByClause="":g.order&&(o.orderByClause=g.order),a.addOrReplaceConditionsForLookupFiltersToModel(o),n&&o.buildSearchCondition("__default_searchbox",n,p,{tokenize:"true"===g.tokenizeSearch,useSOSLSearch:g.useSOSLSearch,SOSLFields:g.SOSLFields,delimiter:g.delimiter,searchOperator:"contains"});var S=m;o.load(function(){var e={};S>v?(v=S,e.isStale=!1):e.isStale=!0,e.isFinal=S===m,s.resolve(o,e)})}return s.promise()}}),n(i,{Field:l})}(skuid)},function(e,t,n){"use strict";var i=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();!function(e){var t,n=e.$,r=n.extend,o=e.ui={},a=e.utils,s=a.encodeHTML,l=a.decodeHTML,c=e.constants,d=c.DISPLAY_TYPES,u=c.FIELD_TYPES,f=d.DATETIME;function p(){return"ontouchstart"in window||navigator.maxTouchPoints}function h(e){if(e&&e.length){var t=[];return e.children().each(function(){var e=n(this),i="false"!==e.attr("enclosevalueinquotes"),o={field:e.attr("field"),type:e.attr("type"),operator:e.attr("operator"),value:e.attr("value"),depfield:e.attr("depfield"),sourceParam:e.attr("sourceparam"),model:e.attr("model"),mergeField:e.attr("mergefield"),encloseValueInQuotes:i};if("multiple"==o.type){o.values=[];var s=e.children("values");s.length&&s.first().children("value").each(function(){var e=a.getXML(this);e.length>8?(e=a.decodeXML(e.substring(7,e.length-8)),o.values.push(a.adjustValueBasedOnQuotedness(e,i))):o.values.push("")})}else"userinfo"==o.type?o.mergeField=e.attr("userinfotype"):"param"===o.type?o.mergeField=e.attr("value"):"modelmerge"===o.type&&r(o,{mergeField:e.attr("mergefield"),mergeModel:e.attr("model"),noValueBehavior:e.attr("novaluebehavior")});t.push(o)}),t}}function g(e){return e.indexOf("sk-webicon")>-1}function m(t){var n=t.split(":"),r=e.platform.preloadIconSetDependencies;if(n.length<=1)return"#"+t;var o=i(n,2),a=o[0],s=o[1];return r&&r(a),"#"+a+":"+s}function v(e,t,i){function r(){sforce.console.openPrimaryTab(null,e,!0,l(t))}if(e){var o,a=n.Deferred();sforce.console.getPrimaryTabIds(function(e){!function e(t,r,a){var s={tabsProcessed:0};t&&(s.numTabs=t.length,s.numTabs?n.each(t,function(t,l){sforce.console.getPageInfo(l,function(t){if("resolved"!==a.state())if(t.success){var c=JSON.parse(t.pageInfo);c&&i&&i(c)?(o={id:l},r&&(o.parentTabId=r),a.resolve()):r?sforce.console.getSubtabIds(l,function(t){if(t.success&&t.ids&&t.ids.length){var i=n.Deferred();e(t.ids,!1,i),n.when(i).then(function(){++s.tabsProcessed===s.numTabs&&a.resolve()})}else++s.tabsProcessed===s.numTabs&&a.resolve()}):++s.tabsProcessed===s.numTabs&&a.resolve()}else++s.tabsProcessed===s.numTabs&&a.resolve()})}):a.resolve())}(e.ids,null,a)}),n.when(a).then(function(){if(o){var e=o.parentTabId?o.parentTabId:o.id;sforce.console.focusPrimaryTabById(e,function(e){e.success?o.parentTabId&&sforce.console.focusSubtabById(o.id,function(){}):r()})}else r()})}}function y(e,t){v("/"+e,t,function(t){return t&&(t.objectId===e||e&&18===e.length&&t.objectId===e.substring(0,15))})}r(o,{createFieldSet:function(e,t){t||(t={});var i=t.mode||"edit",r=n("<div>").addClass("nx-editor-contents nx-basicfieldeditor-section-body");return n.each(e,function(e,o){var a=n("<div>").addClass("nx-basicfieldeditor-item"),s=n("<div>").addClass("nx-basicfieldeditor-item-label").text(o.metadata.label).appendTo(a);o.mode=i,o.editable=o.metadata.editable,o.editor=t.editor,o.wrapperElement=a,o.labelElement=s,o.render(),a.append(o.element),r.append(a)}),r},createIcon:function(n){var i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=(r.webIconClass||"")+" "+(r.additionalClass||""),s=a.onPageBuilder();return t||(t=e.themeSettings.getAll()),i=t&&t.iconMappings,s&&e.component.getByType("pagebuilder")[0]&&(i=e.component.getByType("pagebuilder")[0].get("iconMappings")||{}),n=t&&i&&i[n]||n,r.isWebIcon||g(n)?'<i class="sk-webicon '+o+'" aria-label="'+((n=n.split("sk-webicon-").join("")).split(":")[1]||n).split(/[_-]/).join(" ")+'" role="img"><svg viewBox="0 0 24 24"><use xlink:href="'+m(n)+'"></use></svg></i>':'<i class="sk-icon '+n+" "+o+'" aria-label="'+(r.ariaLabel||n.split("sk-icon-").join(""))+'" role="img"></i>'},getFieldOptionsFromXML:function(t,i){var r,o,s,l,c=i.model,p=t.attr("id"),g=t.attr("name"),m=t.attr("type"),v=t.attr("valuehalign"),y=t.attr("placeholder"),b={additionalClass:i.layoutClass,allowHTML:"true"===t.attr("allowhtml"),editable:"true"!==t.attr("readonly"),fieldId:p,fieldName:g,maxDisplayCharacters:t.attr("maxdisplaycharacters"),displayRows:t.attr("displayrows"),mode:i.mode||"read",pageSize:t.attr("pagesize")||5,register:!0,renderAs:t.attr("renderAs"),showLengthCounter:"true"===t.attr("showlengthcounter"),type:m,fieldXML:t},w=c.getField(g||p);if(p&&!w)return!1;if(w&&(r=w.displaytype),m===d.CUSTOM?b.snippet=t.attr("snippet"):m===d.BUTTON?(b.editable=!1,b.text=t.children("text").first().text(),b.icon=t.attr("icon")):m===u.IMAGE&&(b.editable=!1,b.url=t.children("url").first().text(),b.alt=t.children("alt").first().text(),b.height=t.attr("height"),b.fill="true"===t.attr("fill")),v&&(b.valueHorizontalAlignment="right"),r===d.MULTIPICKLIST?(b.maxSelected=t.attr("maxselected"),(o=t.attr("selectedlist"))&&(b.selectedList=parseInt(o,10))):-1!==n.inArray(r,[d.PICKLIST,d.REFERENCE])?(b.addNoneOption="true"===t.attr("addnoneoption"),t.attr("nonelabel")&&(b.noneLabel=t.attr("nonelabel"))):-1!==n.inArray(r,[d.DOUBLE,d.CURRENCY,d.PERCENT])?b.decimalPlaces=t.attr("decimalplaces"):a.startsWith(r,d.DATE)&&(void 0!==(s=t.attr("monthpicker"))&&s&&(b.showMonthPicker="true"===s),void 0!==(l=t.attr("yearpicker"))&&l&&(b.showYearPicker="true"===l),b.showYearPicker&&(b.yearPickerRange=(t.attr("yearpickermin")||"c-10")+":"+(t.attr("yearpickermax")||"c+10")),r===f&&(b.minuteIncrement=parseInt(t.attr("minuteincrement")||"5",10))),"REFERENCE"===r){b.optionsource=t.attr("optionsource"),b.optionmodel=t.attr("optionmodel"),b.template=t.attr("displaytemplate"),b.searchTemplate=t.attr("searchtemplate"),b.tokenizeSearch=t.attr("tokenizesearch"),b.delimiter=t.attr("delimiter");var S=[],C=h(t.children("filters")),I=t.children("searchfields").first(),k=I.children(),x=b.defaultOrdering="true"===I.attr("defaultordering"),T=I.attr("orderby");C&&C.length&&(b.filters=C,n.each(C,function(){"dependent"===this.type&&S.push(this.depfield)}),S.length&&(b.controllingFields=S)),b.useSOSLSearch="true"===I.attr("usesosl"),b.SOSLFields=I.attr("soslfields"),!x&&T&&(b.order=T),k.length&&(b.searchFields=[],b.returnFields=[],k.each(function(){var t,i,r=n(this),o=r.attr("return"),a=r.attr("show"),s=r.attr("query"),l=r.attr("field"),c=!1,d=!1;"true"===s&&b.searchFields.push({id:l,searchOperator:r.attr("operator")}),void 0!==o?"true"===o&&(c=!0,"true"===a&&(d=!0)):"true"===a&&(c=!0,d=!0),c&&(t={id:l,showInSearchDialog:d},(i=r.children("label").first())&&i.length&&(t.label=e.utils.getXML(i[0])),b.returnFields.push(t))}))}return t.children("enableconditions")&&(b.enableConditionsXML=t.children("enableconditions")),t.children("actions").length&&(b.actionsXML=t.children("actions")),"true"===t.attr("required")&&(b.required=!0),y&&(i.row?b.placeholder=a.mergeAsText("row",y,{createFields:!0,registerFields:!1},c,i.row):b.placeholder=y),b},getFocusableElements:function(e){return e.querySelectorAll("button, [href], input, select, textarea, [tabindex]")},getIconURLFromHandle:m,setStatus:function(e,t,n){e&&(e.css("opacity",1).show(),t.text(n))},hideStatus:function(e,t,n,i){e&&(t.text(n),0===i?e.hide():e.animate({opacity:"0"},i||500,function(){e.hide()}))},isWebIcon:g,searchableDisplayTypes:{ID:1,STRING:1,TEXT:1,EMAIL:1,PICKLIST:1,MULTIPICKLIST:1,COMBOBOX:1,PHONE:1,URL:1,REFERENCE:1,TEXTAREA:1},openConsoleTabForField:function(t,n,i){var r=e.$M(n),o=r?r.registeredFields[t]:null;o&&"REFERENCE"===o.metadata.displaytype&&y(i,i||0===i?s(o.calculateReferenceText()):"")},openConsoleTabForNameField:function(t,n){var i=e.$M(l(n));y(t,i.getNameFieldValueForRow(i.getRowById(t)))},openConsoleTabForUrl:function(e,t){v(e,t,function(t){return t&&a.endsWith(t.url,e)})},openConsoleTabForRow:y,getReferenceLookupModel:function(t,n,i,r,o){var a=t&&t.getDataSourceType(),s=a&&a.getReferenceHandler&&a.getReferenceHandler(),l=s&&s.coerceObjectName,c=t.getNameField(i);r||(r=[]),l&&(i=l(i,t));var d=new e.model.Model({dataSource:t,id:"_TempModel_"+(new Date).getTime(),objectName:i,fields:r.slice(),doQuery:!0,doClone:!1,recordsLimit:50,orderByClause:c});return s&&s.processReferenceLookupModel(d,n,i),o&&!d.fields.find(function(e){return e.id===o})&&(d.idFields=[o],d.fields.push({id:o})),c&&!d.fields.find(function(e){return e.id===c})&&(d.fields.push({id:c}),d.nameField=c),d.initialize(),d},isTouchDevice:p,_createLookupFiltersFromXML:h,_loadHammer:function(){e.mobile||!p()||o.hammerJSLoaded||a.loadJS(a.getStaticResourceUrl("HammerJS","skuid",null,a.getCacheTimestamp())).done(function(){o.hammerJSLoaded=!0,e.events.publish("skuid.resources.hammerjsloaded")})}})}(skuid)},function(e,t,n){"use strict";!function(e){var t="custom-props",n="custom-prop",i="id",r="value",o="type",a=e.$;a.extend(e.model,{initializeCustomProperties:function(e,s){var l=function(e){var t={};return e.length&&a.each(e.children(n),function(e,n){var s,l,c;n=a(n),t[n.attr(i)]=(l=(s=n).attr(o).toUpperCase(),(c=s.attr(r))?function(e,t){return"BOOLEAN"===e?"TRUE"===t.toUpperCase():"NUMBER"===e?1*t?1*t:0:t}(l,c):c)}),t}(function(e){return e.children(t)}(e));s._customProperties=l},getCustomPropertyValue:function(e,t){return e._customProperties&&e._customProperties[t]}})}(skuid)},function(e,t,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){var t,n=e.model||(e.model={}),r=e.$,o=e.events,a=o.publish,s=e.time,l=function(){return e.platform.getDefaultDataSourceName()},c=e.constants,d=c.SALESFORCE,u="Ui-Only",f=c.DISPLAY_TYPES,p=f.REFERENCE,h=f.COMBOBOX,g=f.INTEGER,m=f.TEXT,v=f.TEXTAREA,y=f.FORMULA,b=f.DATE,w=f.DATETIME,S=f.BOOLEAN,C=f.UUID,I="undefined",k="number",x="string",T="boolean",R=c.EVENT_SCOPES,D="_eventService",A="models.",E="childRelationship",F="array",N="_eventSubscriptionsActions",M="_eventData",_="_eventSubscriptionsGeneric",P="__id",O="__cloned",L="__new",U="__deleted",B="__skuid_record__",j=1,V={},G={},H={};function z(e){return r.map(e,function(e){if(e.textContent)return e.textContent;var t=q().getXML(e);return t.length>Z("field")?t=q().decodeXML(t.substring(7,t.length-8)):null})}function q(){return e.utils}function $(e){return[f.BUTTONGROUP,f.COMBOBOX,f.MULTIBUTTONGROUP,f.MULTIPICKLIST,f.PICKLIST].includes(e)}function W(e){return[f.CURRENCY,f.DOUBLE,f.PERCENT].includes(e)}function Y(e){return q().isUndefined(e)}function K(e){return q().isString(e)}function X(e){return q().size(e)}function J(t,n,i){var r=K(t)?t:t.id,o=!K(n),a=o?n.name:n;return i||(i=e.page.id),"apex__"+(o&&n.customCookie?n.customCookie:"nx-page-"+i+"-model-condition-"+r+"-"+a)}function Q(e){return q().isMultiValueOperator(e)}function Z(e){var t=H[e];return t||(t=H[e]=q().getXML(q().makeXMLDoc("<"+e+"/>")[0]).length),t}function ee(t){var n=t.dataSource;return n?n instanceof e.dataSource.DataSource||(n=t.dataSource=e.dataSource.getDataSource(n.name)):t.dataSource=n=e.dataSource.getDataSource(t.dataSourceName||l()),n}function te(t,n){var i=n&&n.getParentPage()||e.component.getByType("skuidpage")[0];i?i.addProblems(t):r(document).one("pageload",function(){te(t,n)})}function ne(e,t){return t?t+"("+e+")":e}function ie(e,t){var n=Array.prototype.push;if(t.length<32766)n.apply(e,t);else for(var i,r,o=Math.ceil(t.length/32766),a=0;a<o;a++)(r=(i=32766*a)+32766)>t.length&&(r=t.length),n.apply(e,t.slice(i,r))}function re(e,t,n,r,o){i(n.attr(r))!==I?e[t]=n.attr(r):(void 0===o?"undefined":i(o))!==I&&(e[t]=o)}function oe(e,t,n,i){return i=!1!==i,e&&(e=r.trim(e).toUpperCase()),i?(t&&t.length&&!e&&(e="",r.each(t,function(t){e+=t+1+" AND "}),q().endsWith(e," AND ")&&(e=e.substring(0,e.length-5))),e&&!q().startsWith(e,"(")&&n&&(e="("+e+")"),e):e||""}function ae(t){var n,i,o,a,s,c,u,f,p,h,g,m,v,y=t.model,b=t.xml,w=b.children("conditions"),S=b.children("havings"),C=b.children("actions"),I=b.children("groupby"),k=b.children("fields"),x=b.children("idfields").first().children(),T={};if(b.attr("_parentpageid")&&(y._parentPageId=b.attr("_parentpageid")),y.dataSourceName=b.attr("datasource")||b.attr("service")||l(),n=ee(y))if(m=n&&n.processModelXMLExtensions,i=n.getDataSourceType()){o=i?i.name:d,c=(s="local"===(a=i.prop("runtime.metadataSource")))||"hybrid"===a,Y(y.processOnClient)&&(y.processOnClient=!(y.dataSourceName===d&&!e.platform.requiresClientSideModelLoading())||"true"===b.attr("processonclient")),v="Ui-Only"===o?"true"===(b.attr("unloadwarningifunsavedchanges")||"false"):"false"!==b.attr("unloadwarningifunsavedchanges"),r.extend(y,{id:b.attr("id")||q().generateUniqueId(),objectName:b.attr("sobject"),type:b.attr("type"),createRowIfNoneFound:"true"===(b.attr("createrowifnonefound")||"false"),preventUnloadIfUnsavedChanges:v,recordsLimit:b.attr("limit")||null,orderByClause:b.attr("orderby"),rTypeFor:b.attr("rtypfor"),doQuery:"false"!==b.attr("query"),deferFieldRendering:"true"===b.attr("deferfieldrendering"),deferredFields:b.attr("fieldstodefer")?b.attr("fieldstodefer").split(","):"",loadAsync:"true"===b.attr("async"),readonly:b.attr("readonly"),pathToContent:b.attr("pathtocontent")}),r.extend(y,{fields:r.map(k.children(),function(e){return new Ee({model:y,xml:r(e)})}),havings:r.map(S.children(),function(e){return new Ae(r(e),y)}),methods:r.map(b.children("methods").children(),function(e){return new Fe(r(e))})}),r.each(y.fields,function(e,t){T[t.id]=t}),c||r.each(w.children(),function(e,t){(h=function(e){var t="";if(e&&(t=r(e).attr("field")),t)return q().makeXMLDoc('<field id="{id}" query="false"/>'.replace("{id}",t))}(t))&&(T[h.attr("id")]||y.fields.push(new Ee({model:y,xml:h})))}),g=he(y,w,T),y.conditions=g.conditions,y.uiOnlyConditions=g.uiOnlyConditions;var R=y.getPersonalizationService();r.each(y.conditions.concat(y.uiOnlyConditions),function(e,t){var n,i,o=R.getCondition(t.name);void 0!==o&&("-off-"===o?t.inactive=!0:"-on-"===o?t.inactive=!1:(r.isArray(o)?i=o:n=o,Q(t.operator)&&(t.values=i||n&&q().isString(n)&&(-1!==n.indexOf(";")?n.split(";"):[n])||[]),t.value=n,t.inactive=!1))});var D=R.getOrderBy();switch(D&&(y.orderByClause=D),b.attr("doclone")){case"yes":y.doClone=!0;break;case"no":y.doClone=!1}I.length&&(y.groupByFields=r.map(I.children(),function(e){return new Ee({model:y,xml:r(e)})}),y.groupByMethod=I.attr("method")||"simple"),y.groupByFields&&y.groupByFields.length&&(y.fields=y.fields.concat(y.groupByFields)),o===d&&(y.queryAllRows="true"===b.attr("queryallrows"),y.forView="true"===b.attr("forview")),C.length&&(y.actions=r.map(C.children("action"),function(e){return new function(e){var t=e.children("actions"),n=e.children("fields").first().children("field"),i=e.children("events").first().children("event"),o=e.children("conditions").first().children("condition"),a={};t.length&&(a.actions=t);n.length&&(a.fields=r.map(n,function(e){return e.textContent}));i.length&&(a.events=r.map(i,function(e){return e.textContent}));o.length&&(a.conditions=r.map(o,function(e){return e.textContent}));return a}(r(e))})),y.needsMetadataLoad=!s,!y.pathToContent&&y.methods&&y.methods.length&&(u=y.methods.filter(function(e){return"query"===e.type&&e.pathToContent})).length&&(y.pathToContent=u[0].pathToContent),f=b.attr("label"),p=b.attr("labelplural"),y.label||(y.label=f?q().mergeAsText("global",f):y.id),y.labelPlural||(y.labelPlural=p?q().mergeAsText("global",p):y.id),b.attr("namefield")&&(y.nameField=b.attr("namefield")),x.length&&(y.idFields=z(x)),y.serviceUrl=b.attr("serviceurl")||b.attr("endpoint"),y.verb=b.attr("verb"),w.length&&(y.conditionLogic=oe(w.attr("logic"),y.conditions,!1,i.prop("initializeConditionLogic"))),S.length&&(y.havingLogic=oe(S.attr("logic"),y.havings)),m&&m.call(n,y,b,t)}else te("Missing Data Source Type",y);else te("Missing Data Source: "+y.dataSourceName,y)}function se(e,t,n,i){var r=n.attr(i),o=!1;return r&&(o=q().escapeSingleQuotes(r),e[t]=o),o}function le(e,t){var n,o=t===b,a=t===w,l=t===S,c=void 0===e?"undefined":i(e),d=Y(e),u=null===e;if(o||a){if(c===x){if(o&&!s.parseSFDate(e)||a&&!s.parseSFDateTime(e)){var f=s.resolveDateKeyword(e);return r.isArray(f)?a?s.getSFDateTime(f[0]):s.getSFDate(s.getLocalDateTime(f[0])):null}}else if(d||u||""===e)return null}else{if(l&&c!==T&&!u&&!d)return c===x&&"true"===e.toLowerCase()||c===k&&0!==e;if(W(t)&&c!==k&&e)try{n=parseFloat(e),q().isExactlyNaN(n)||(e=n)}catch(e){}else if(t===g&&c!==k&&!d&&!u&&e)try{n=parseInt(e,10),q().isExactlyNaN(n)||(e=n)}catch(e){}}return d?null:e}function ce(e,t){e&&t&&e._GUID&&!(e._GUID in t)&&(t[e._GUID]=e)}function de(e,t){e&&t&&e._GUID&&e._GUID in t&&delete t[e._GUID]}function ue(t,n){n||(n={cloneRowsIfNeeded:!0,createDefaultRowIfNeeded:!0});var i,o,a="aggregate"===t.type,s=[],l={},c=q().createMapForArray;function u(){!1!==n.evaluateFormulaFields&&t.evaluateFormulaFields({preventTrackChanges:!0}),t.isInitialized=!0,t.publish("initialized")}(t.isAggregate=a,(i=t.getDataSourceType())&&(t.dataSourceTypeName=i.name||d,i.initialize&&i.initialize(t)),t.fields&&t.fields.forEach(function(t){var n,i,r,o=t.picklistSource,a=e.snippet.get(t.picklistSourceSnippet),c=function(){t.picklistEntries=function(e,t,n){return e.getRows().filter(function(t){return!e.getRecordForRow(t)||!e.getRecordForRow(t).isMarkedForDeletion()}).map(function(i){var r={model:e,row:i};return{value:t?q().mergeAsDataInContext(t,r):e.getRowId(i),label:n?q().mergeAsDataInContext(n,r):e.getRowName(i)}})}(n,i,r)};if(!0===function(e){return e&&e.type&&[F,E].includes(e.type)}(t)&&t.subFields&&s.push(t),t.uiOnly&&t.calculated&&(t.createable=t.editable=!1),"rowsinmodel"===o&&e.$M(t.picklistSourceModel))n=e.$M(t.picklistSourceModel),i=t.picklistEntryValue,r=t.picklistEntryLabel,n.getRows().length&&c(),["cancelled","loaded","saved","row.created","row.updated"].forEach(function(e){n.subscribe(e,c)});else if("snippet"===o&&a){var d=a();q().isPromise(d)?d.then(function(e){e&&e.length&&(t.picklistEntries=e)}):d.length&&(t.picklistEntries=d)}if(t.displaytype===p&&t.rel){var u=t.id.split(".");u.pop(),u.push(t.rel);var f=u.join(".");l[f]={id:f,displaytype:"OBJECT",uiOnly:!0,accessible:!0,editable:!0,createable:!0}}}),s.length&&c(s,"subFields","subFieldsMap","id"),l&&r.each(l,function(e,n){var i=!1;r.each(t.fields,function(t,n){if(n.id===e)return i=!0,!1}),i||t.fields.push(n)}),c([t],"fields","fieldsMap",["id","name"]),a||(!1!==n.cloneRowsIfNeeded&&t._cloneRowsIfNeeded(n.pageComponent),pe(t)),t._generateDataIndices(),t.processOnClient?ge(t):(o=he(t),t.conditions=o.conditions,t.uiOnlyConditions=o.uiOnlyConditions,ge(t),t.uiOnlyConditions.length&&(t.conditionLogic=oe(null,t.conditions)),t.data=function(e){if(e.uiOnlyConditions){var t=e.uiOnlyConditions.filter(function(e){return!e.inactive});return e.getRows(t)}return e.data}(t)),function(t){var n=t?t.actions:null,i=t?t.id:null,o=q().startsWith,a=t[N];a||(a=t[N]=[]);a.length&&(a.forEach(function(e){e.unsubscribe()}),a.length=0);n&&n.length&&n.forEach(function(n){var s=n.events,l=n.actions,c=n.fields,d=n.conditions;q().isString(l)&&(l=q().makeXMLDoc(l)),s&&s.length&&s.forEach(function(n){var s=q().startsWith(n,A)?n.substring(7):n;a.push(t.subscribe(s,function(n){var a=!0;if("saved"!==s||n.totalsuccess){if("row.updated"===s&&c&&c.length&&!q().doArraysIntersect(Object.keys(n.updates),c))a=!1;else if(o(s,"condition.")){var u=n.conditionName,f=t.getConditionByName(u);a=t.isFilterableCondition(f)&&(!d||-1!==r.inArray(u,d))}}else a=!1;if(a){var p=r.extend({model:ye(i),initiatorId:i},n),h=function(){e.actions.runActionsNode(l,t,p)},g=e.component.getByType("skuidpage");g&&g.length?h():r(document.body).one("pageload",h)}}))})})}(t),t.hasMetadataLoaded()&&!1!==n.createDefaultRowIfNeeded)?t._checkIfDefaultRowCreationNeedsToBeAsync()?t._createDefaultRowIfNeededAsync().then(function(){u()}):(t._createDefaultRowIfNeeded(),u()):u();return t}function fe(){return q().generateUniqueId()}function pe(e){e.dataSourceTypeName===d&&r.each(e.data,function(t,n){var i=e.getRowId(n);n.Id15=i?i.substring(0,15):null})}function he(e,t,n){var i=[],o=[],a=t?t.children():e.conditions,s=e.uiOnly;return e.uiOnlyConditions?{uiOnlyConditions:e.uiOnlyConditions,conditions:e.conditions}:(n=n||e.fieldsMap,r.map(a,function(a){var l=t?a.getAttribute("field"):a.field,c=t?new Ae(r(a),e):a;s||n[l]&&n[l].uiOnly?i.push(c):o.push(c)}),{conditions:o,uiOnlyConditions:i})}function ge(e){e.conditions||(e.conditions=[]),e.conditions.forEach(function(t){e.updateConditionValue(t);var n=t.subConditions;n&&n.length&&n.forEach(function(t){e.updateConditionValue(t)})})}function me(){return r.map(V,function(e){return e})}function ve(){return V}function ye(e){return V[e]}function be(t,n){n||(n={});var o,s,l,c,u,f,h=!1,g=r.Deferred(),m={},v={},y={},b={},w=[],S={},C=n.initiatorId,I=n.rollbackOnAnyError,k=function(e){var t={insertResults:[],updateResults:[],deleteResults:[],messages:[],totalsuccess:!0};return C&&(t.initiatorId=C),e&&r.each(e,function(e,n){t[e]=n}),t},x={},T={},R=function(){r.each(v,function(e,t){t.publish("saved",x[e])}),a(A+"saved",[o])},D=function(){r.each(v,function(e,t){t.publish("saveHandled",x[e])}),a(A+"saveHandled",[o])};if(a("skuid.ui.commitUserInput"),v=t.reduce(function(e,t){return!t.isBeingSaved&&t.hasChanged&&X(t.changes)&&(e[t.id]=t,t.isBeingSaved=!0),e},{}),o=k({models:v,event:A+"saved"}),a(A+"saveInitiated",[{event:A+"saveInitiated",models:v,initiatorId:C}]),r.each(v,function(){var t,n,o,a,s,l=this,c=l.id,d={modelId:c,model:l,initiatorId:C},u=!1;n=l.getDataSource(),o=l.getDataSourceName(),a=l.getIdField(),s=T[c]={},x[c]=k(d),l.publish("saveInitiated",d),t={id:c,type:l.objectName},r.each(l.registeredFields,function(e,t){t.messages=[]}),y[o]||(y[o]=[],b[o]=n),y[o].push(l),m[o]||(m[o]=[]),t.inserts={},t.updates={},t.deletes={},r.each(l.changes,function(e,n){var o,c,d=l.record(e),f=d.row(),p=d.isMoribund(),h=d.isNew();p&&h?(s[e]=n,delete l.changes[e]):p?(o=t.deletes[e]={},u=!0,a?r.isArray(a)?a.forEach(function(e){o[e]=l.getFieldValue(f,e,!0)}):o[a]=l.getFieldValue(f,a,!0):r.each(f,function(e,t){e===B||r.isPlainObject(t)||r.isArray(t)||(o[e]=t)})):(c=t[h?"inserts":"updates"][e]={},h&&(u=!0),r.each(n,function(e,t){var n=l.getField(e),o=[],a=!0,s=q().isObject(t);if(n&&n.uiOnly)return u=!0,!0;n||!s?(c[e]=t,u=!0):!n&&s&&(u=!0,function e(t,n,o){r.each(t,function(t,r){if(null!==r&&"object"===(void 0===r?"undefined":i(r))){if(r instanceof Ne)return!0;e(r,n,o?o+"."+t:t)}else n.push(o?o+"."+t:t)})}(t,o,e),r.each(o,function(){return l.getField(this)||(a=!1),-1}),a&&(c[e]=t))}))}),w=w.concat(this.validateRequiredFields()),t.returning=l.fields?r.map(l.fields.filter(function(e){return e.type!==E&&!1!==e.query&&!0!==e.uiOnly}),function(e){return e.id}):[],l&&l.extensions&&e.offline.networkDown()&&(t.extensions=l.extensions),m[o].push(t),u?(h=!0,l.publish("beforeSaveCommitted",{operation:t,modelId:c,model:l,initiatorId:C})):l.needsReset=!0}),(f=w.length>0)&&(h=!1),h)l=[],c={},u={},a(A+"beforeSaveCommitted",[{event:A+"beforeSaveCommitted",initiatorId:C,models:v,operations:m}]),r.each(m,function(t,n){var i,a=y[t],f=b[t],h={operations:n};!0===I&&(h.rollbackOnAnyError=!0),i=f.save(h).then(function(t){var n,i={},l={},f=function(e,t,n){r.each(e,function(){this.rowId=n,this.model=t;var e,i=this.fields,r=0;if(i&&i.length)for(;r<i.length;r++)e=t.getField(i[r]),i[r]={id:e.id,label:e.label};x[t.id].messages.push(this),o.messages.push(this)})};return t.totalsuccess=!0,r.each(a,function(e,t){l[t.id]=!0}),r.each(["delete","insert","update"],function(e,n){var i=t[n+"Results"];i&&i.length&&r.each(i,function(e,n){var i=n.source,r=v[i],o=n.id||n.oldId;n.success||(t.totalsuccess=!1,x[r.id].totalsuccess=!1,l[i]=!1,f(n.errors,r,o)),f(n.messages,r,o)})}),I&&t.totalsuccess||!I?(r.each(t.deleteResults,function(e,t){if(t.success){var n=t.source;u[n]||(u[n]={}),u[n][t.id]=t.id}}),r.each(t.insertResults,function(e,t){if(t.success){var n,r,o,a,s=t.source,l=v[s],u=t.oldId,f=l.getRowById(u),p=t.record=q().parseAsJSONIfString(t.record),h=l.registeredFieldsByRowThenField,g=l.registeredItemsByRow,m=l.record(u);u in l.changes&&delete l.changes[u],u in l.originals&&delete l.originals[u],n=t.hasOwnProperty("id")?t.id:p?l.getRowId(p):u,p&&m.setRow(p),m.setId(n).markSaved(),i[u]={row:f,id:n},l.dataSourceTypeName===d&&(f.Id15=n?n.substring(0,15):n),n===u&&l.dataMap[n]||(delete l.dataMap[u],delete l.recordsMap[u],l.dataMap[n]=f,l.recordsMap[n]=m),r=u in h&&h[u],o=u in g&&g[u],!1!==r&&(delete h[u],h[n]=r),!1!==o&&(delete g[u],g[n]=o),p&&((a=c[s])||(a=c[s]={}),a[n]=p)}}),r.each(t.updateResults,function(e,t){if(t.success){var n,i,r=t.id,o=t.record,a=t.source,s=v[a];r in s.changes&&delete s.changes[r],r in s.originals&&delete s.originals[r],n=s.getRowById(r),s.getRecordForRow(n).markSaved(),o&&(o=t.record=q().parseAsJSONIfString(o),(i=c[a])||(i=c[a]={}),i[s.getRowId(n)]=o)}}),s={},r.each([u,T],function(e,t){X(t)&&r.each(t,function(e,t){X(t)&&(s[e]||(s[e]=[]),r.each(t,function(t){s[e].push(t)}))})}),X(s)&&(r.each(s,function(t,n){e.$M(t).abandonRows(n,{notify:!1})}),s={},u={},T={}),X(c)&&r.each(c,function(e,t){v[e].updateRows(t,{preventSetActive:!1,preventTrackChanges:!0})}),n=e.model.list(),r.each(n,function(){var e=this,t=e.conditions,n={};e.hasChanged&&r.each(e.changes,function(t,o){r.each(o,function(r,o){if(o){var a,s,l=i[o];l&&(a=e.getField(r))&&a.displaytype===p&&((s=n[t])||(s=n[t]={}),s[r]=l.id,s[a.rel]=l.row)}})}),t&&t.length&&r.each(t,function(e,t){if("modelmerge"===t.type){var n,o=ye(t.model),a=o&&o.getIdField(),s=t.mergeField,l=o&&s?o.getField(s):null;(l&&l.displaytype===p||s===a)&&(Q(t.operator)?(n=t.values)&&n.length&&r.each(n,function(e,t){var r=i[t];r&&(n[e]=r.id)}):t.value&&t.value in i&&(t.value=i[t.value].id))}}),X(n)&&e.updateRows(n,{preventSetActive:!1,preventTrackChanges:!1})}),r.each(n,function(){this.evaluateFormulaFields({preventTrackChanges:!0})})):I&&!t.totalsuccess&&X(T)&&r.each(T,function(t,n){var i=e.$M(t).changes;r.each(n,function(e,t){i[e]=t})}),r.each(a,function(e,t){t.setHasChanged(!l[t.id]),r.each(t.registeredEditors,function(e,n){n._GUID in S||(S[n._GUID]=n),!0!==n.hadErrors&&(n.hadErrors=t.hasChanged)})}),r.each(a,function(e,t){t.isBeingSaved=!1}),{insertResults:t.insertResults,updateResults:t.updateResults,deleteResults:t.deleteResults,totalsuccess:t.totalsuccess}},function(e){K(e)&&(e=[e]);var t=r.map(e,function(e){var t=K(e)?{message:e}:e;return t.severity||(t.severity="ERROR"),t});return r.each(a,function(){var e=this;e.isBeingSaved=!1;var n=x[e.id];n.totalsuccess=!1,Array.prototype.push.apply(n.messages,t),r.each(e.registeredEditors,function(t,n){n._GUID in S||(S[n._GUID]=n),!0!==n.hadErrors&&(n.hadErrors=e.hasChanged)})}),o.totalsuccess=!1,Array.prototype.push.apply(o.messages,t),t.map(function(e){return e.message})}),l.push(i.promise())}),r.when.all(l).then(function(e){r.each(v,function(e,t){r.each(t.registeredLists,function(){this.render({resetItemModes:!0,resetPagination:this.options&&this.options.alwaysResetPagination,changedRows:c[t.id],destroyDeletedRows:!0})})}),r.each(e,function(e,t){["insert","update","delete"].forEach(function(e){var n=e+"Results",i=t[n];i&&i.length&&(r.merge(o[n],i),i.forEach(function(e){var t=x[e.source];t&&(t[n].push(e),e.success||(t.totalsuccess=!1))}))}),!1===t.totalsuccess&&(o.totalsuccess=!1)}),R(),g.resolve(o),n.callback&&n.callback(o)},function(e){R();var t=o.messages;t&&t.length?g.reject(r.map(t,function(e){return r.isPlainObject(e)&&e.message?e.message:e})):g.reject(e)}).always(function(){Te(o.messages,v,C);var e=Re(o.messages);if(D(),X(S)){var t=[];r.each(S,function(){this.handleSave(!this.hadErrors,o),this.hadErrors=!1}),r.each(S,function(){var i=n.initiatorId;this.clearInlineErrors(),i&&this._GUID!==i||(this.handleMessages(e,{initiatorId:i}),t.push(this._GUID)),r.each(e,function(){var n=this,o=n.model&&n.model.registeredFieldsByRowThenField[n.rowId];o&&!o[0]&&(o=[o]),o&&o.length&&r.each(o,function(){var o=this,a=n.fields;a&&a.length?r.each(a,function(){var e=this;r.each(o,function(){r.each(this,function(){this.id===e.id&&(this.handleMessage(n),t.push(this._GUID))})})}):r.each(o,function(n,r){var o=r[i];if(o){var a=o.editor,s=a.id();-1===t.indexOf(s)&&(a.handleMessages(e),t.push(s))}})})})})}});else{o.totalsuccess=!f,I&&!o.totalsuccess?X(T)&&r.each(T,function(t,n){var i=e.$M(t).changes;r.each(n,function(e,t){i[e]=t})}):X(T)&&(s={},r.each(T,function(e,t){X(t)&&(s[e]||(s[e]=[]),r.each(t,function(t){s[e].push(t)}))}),X(s)&&r.each(s,function(t,n){e.$M(t).abandonRows(n,{notify:!1})})),f&&(Array.prototype.push.apply(o.messages,w),r.each(w,function(e,t){t.model&&x[t.model.id]&&(x[t.model.id].totalsuccess=!1)}));var F={};r.each(v,function(e,t){var n=(!I||I&&o.totalsuccess)&&X(T)&&X(T[e]),i=t.registeredEditors,a=t.registeredLists;t.isBeingSaved=!1,t.setHasChanged(!!X(t.changes)),i&&X(i)&&r.each(i,function(e,t){t._GUID in S||(S[t._GUID]=t)}),(n||t.needsReset)&&a&&X(a)&&r.each(a,function(e,t){t._GUID in F||(F[t._GUID]=t)})}),Te(w,v,C);var N=Re(w);D(),X(S)&&r.each(S,function(){this.handleSave(o.totalsuccess,o),C&&this._GUID!==C||this.handleMessages(N,o)}),f&&r.each(w,function(){var e=this;r.each(e.model.registeredFieldsByRowThenField[e.rowId],function(){var t=this;e.fields&&r.each(e.fields,function(){var n=this;r.each(t,function(){this.id===n.id&&this.handleMessage(e)})})})}),X(F)&&r.each(F,function(){this.render({resetPagination:!0,resetItemModes:!0,destroyDeletedRows:!0})}),R(),n.callback&&n.callback(o),g.resolve(o)}return g.promise()}function we(e,t){if(e){e instanceof Array||(e=[e]),t||(t={});var n,i={},o={};r.each(e,function(e,a){if(!1===a.hasChanged)return!0;r.each(a.registeredFields,function(e,t){t.messages=[]});var s,l={},c={},d=[];r.each(a.changes,function(e){a.originals[e]||(e||"0"===e)&&d.push(a.getRowById(e))}),a.abandonRows(d,{notify:!1}),n=a.changes,a.changes={},r.each(a.originals,function(e,t){var i=a.getRowById(e),o=a.record(e),s=n[e],d=c[e]={};o.isNew()?(r.each(i,function(e){d[e]=""}),l[e]={}):(r.each(s,function(e){e in t||(d[e]=void 0)}),r.each(t,function(e,t){d[e]=t})),o.isMoribund()&&o.unmarkForDeletion()}),X(c)&&a.updateRows(c,{preventSetActive:!1,preventTrackChanges:!0}),s=r.extend(!0,{},a.originals),a.originals=l,a.setHasChanged(!1),a.evaluateFormulaFields({preventTrackChanges:!0}),a.notifyFieldsOfChange(s,t),a.registeredLists&&r.each(a.registeredLists,function(){this._GUID in i||(i[this._GUID]=this)}),a.registeredEditors&&r.each(a.registeredEditors,function(){this._GUID in o||(o[this._GUID]=this)})}),r.each(i,function(e,t){t.render({resetItemModes:!0,resetPagination:this.options&&this.options.alwaysResetPagination,changedRows:n,destroyDeletedRows:!0})});var s={},l={event:"models.cancelled",models:s,initiatorId:t.initiatorId};return e.forEach(function(e){s[e.id]=e,e.publish("cancelled",{event:"cancelled",model:e,modelId:e.id,initiatorId:t.initiatorId})}),r.each(o,function(e,t){t.handleCancel&&t.handleCancel(l)}),a("models.cancelled",[l]),e}}function Se(e,t,n){return n=n||{},r.extend(n,{loadAllMetadata:!0}),xe(e,t,n)}function Ce(e,t,n){return xe(e,t,n)}function Ie(e,t){return xe(e,t,{syncOnly:!0})}function ke(e,t,n){var i={addOnly:!0};return xe(e,t,n?r.extend(n,i):i)}function xe(n,i,o){o=o||{};var s=r.Deferred(),l=[],c={},u=[],f=o.initiatorId,p={},h=[],g={},m=[],v=A+"loaded",y={},b={},w={event:v,models:y,updatedRows:b,initiatorId:f},S={},C=o.loadAllMetadata,I=function(n,i,a){e.loader.service.loadDataSourceAndDependencies(i).then(function(e){return e.load(n,o)}).always(function(){r.each(n,function(e,t){t.isProcessing--})}).done(function(e){r.each(e,function(e,i){var a,s=n[e],l=!1,c=o.syncOnly&&s.lastSyncTime,u=i.errors,f={evaluateFormulaFields:!1,pageComponent:o?o.pageComponent:t};if(s.lastLoadTime=(new Date).getTime(),"function"==typeof s.lastSuccessfulCallout&&(s.lastSuccessfulCallout=s.lastSuccessfulCallout()),!(S[s.id]>s.lastSuccessfulCallout))return!0;if(s.lastSuccessfulCallout=S[s.id],o.addOnly||c||s._invalidateDataIndices(),u&&u.length&&(s.errors=u),o.loadAllMetadata||!s.hasMetadataLoaded()){if(s.hasMetadataLoaded()||(l=!0,s.setMetadataHasLoaded()),i.actions||delete i.actions,i.fields&&!s.isAggregate){var p={};i.fields&&i.fields.length&&r.each(i.fields,function(e,t){t.id&&(p[t.id]=t)}),r.each(s.fields,function(e,t){if(t.id){var n=p[t.id];n&&r.extend(!0,n,t)}}),s.fields=i.fields,delete i.fields}r.extend(s,i),s.initialize(f),l&&s.registerKeyPrefix(),s.loadAsync&&s.publish("loaded.async"),a=s.data}else{if(s.isInitialized||s.initialize(f),c){var h=s.getConditionByName("_sync",!1),g=[];s.deactivateCondition(h),s.queryAllRows=!1,i.data.forEach(function(e){s.dataSourceTypeName===d&&e.IsDeleted?s.removeRowById(s.getRowId(e)):g.push(e)}),a=s.adoptRows(g,{evaluateFormulaFields:!1,notify:!1})}else a=o.addOnly?s.adoptRows(i.data,{doAppend:!0,evaluateFormulaFields:!1,notify:!1}):s.data=i.data||[];s.isAggregate||(s._cloneRowsIfNeeded(o?o.pageComponent:t),s._createDefaultRowIfNeeded(),pe(s)),s.conditions&&i.conditions&&r.each(s.conditions,function(e,t){var n=i.conditions[e];n&&(t.values=n.values),r.extend(t,n)}),s._generateDataIndices(),["canRetrieveMoreRows","debug","lastQueryDuration","lastQueryString","lastSyncTime","recordsLimit","soql"].forEach(function(e){i.hasOwnProperty(e)?s[e]=i[e]:delete s[e]})}i.cachedData&&(s.cachedData=i.cachedData),s._checkIfDefaultRowCreationNeedsToBeAsync()?s.once("initialized").then(function(){s.publish("initially-loaded")}):s.publish("initially-loaded"),s.doQuery=!0,b[s.id]=a}),r.each(e,function(e){var t=n[e];if(t.evaluateFormulaFields({preventTrackChanges:!0,updatedRows:b[t.id]}),t.uiOnlyConditions){var i=t.uiOnlyConditions.filter(function(e){return!e.inactive});t.data=t.getRows(i)}}),r.each(n,function(e,t){t.lastLoadTime=(new Date).getTime()}),r.each(n,function(e,t){y[t.id]=t,r.each(t.getDependentConditions(),function(e,t){var n=ye(e);n&&r.each(t,function(e,t){n.updateConditionValue(t)})})});var i=[];r.each(n,function(e,t){t.batchLabelModels&&r.each(t.batchLabelModels,function(e,n){var o=n.getConditionByName("__reference_batch"),a={};r.each(t.data,function(t,n){var i=n[e];(i||0===i)&&(a[i]=!0)}),0!==Object.keys(a).length&&(n.setCondition(o,r.map(a,function(e,t){return t})),n.referenceFieldId=e,n.referenceModelId=t.id,i.push(n))})}),i.length?xe(i).then(function(e){r.each(e.models,function(e,t){var n=ye(t.referenceModelId),i=n.getField(t.referenceFieldId);i.rel&&r.each(n.data,function(e,n){var r=n[t.referenceFieldId];(r||0===r)&&(n[i.rel]=t.dataSource.getDataSourceType().getReferenceHandler().getRowFromReferenceValue(t,r,i))})}),a.resolve(w)},function(e){a.reject(e)}):a.resolve(w)}).fail(function(e){K(e)?m.push({message:e,severity:"ERROR"}):e instanceof Array&&r.each(e,function(e,t){m.push({message:t,severity:"ERROR"})}),r.each(n,function(){this.publish("initially-loaded"),this.registeredEditors&&r.each(this.registeredEditors,function(e,t){t._GUID in g||(g[t._GUID]=t)}),a.reject(e)})})};if(r.each(n,function(){var t=this,n=t.getDataSource(),i=t.getDataSourceName(),a=n&&!0===n.dataSourceType.prop("batchableEntityRequests"),s=n&&!0===n.dataSourceType.prop("serverSideModelMerge"),d=o.syncOnly&&t.lastSyncTime;if(t.publish("load-initiated"),t.hasChanged)throw"Model '"+t.id+"' has unsaved changes. To update this model's data, you must first save or cancel the changes.";if(d){var u=t.getConditionByName("_sync",!1);if(!t.fieldsMap.IsDeleted){var f={id:"IsDeleted"};t.fields.push(f),t.fieldsMap.IsDeleted=f}u||(u={name:"_sync",type:"fieldvalue",field:"LastModifiedDate",inactive:!1,operator:"gte",encloseValueInQuotes:!1},t.addCondition(u)),t.setCondition(u,t.lastSyncTime),t.queryAllRows=!0}t._dependsOn=[],t.getConditionsWithDependencies().forEach(function(n){var o=[];n.model&&o.push(n.model),n.locationModel&&o.push(n.locationModel),r.each(o,function(n,o){var l=e.$M(o);if(-1===r.inArray(o,t._dependsOn)){var d=l.getDataSourceName();(!a||!s||e.offline.networkDown()||d!==i||l&&l._dependsOn&&l._dependsOn.length>0)&&(t._dependsOn.push(o),c[t.id]=t)}}),t.updateConditionValue(n)}),o.addOnly||(delete t.offsetPageNumber,delete t.offsetPageSize),t.isProcessing++,S[t.id]=++t.calloutIterator,C||(t.doQuery=!0),delete t.errors,0===t._dependsOn.length&&(a&&!e.offline.networkDown()?(p[i]||(p[i]=[]),p[i].push(t)):l.push(t))}),X(c)){var k=r.map(n,function(e){return{name:e.id,links:r.map(e._dependsOn,function(t){return{name:t,parent:e.id}}),isCircular:!1}}),x=[];X(p)&&r.each(p,function(e,t){p[e];var n=[];r.each(t,function(e,t){t.getConditionsWithDependencies().forEach(function(e){e.model in c&&n.push(t.id)})}),0===t.filter(function(e){if(-1===r.inArray(e.id,n))return e;c[e.id]=e}).length&&delete p[e]}),r.each(k,function(e,t){t.isCircular||function e(t,n,i,o,a,s){var l,c=[i],d=!1;if(n||(n=[]),n.length)return n;for(a=a||[t[i].name];c.length>0&&(l=c.shift(),!n.length&&!t[l].isCircular);)r.each(t[l].links,function(i,l){if(n.length)return!1;r.each(t,function(i,u){if(u.name===l.name&&!u.isCircular)if(c.push(i),a.push(l.name),a.some(function(e,t){return a.indexOf(e)!==t})&&t[o].name!==s){for(var f,p={},h=0;h<a.length;h++)p.hasOwnProperty(a[h])?(f=a[h],p[a[h]].push(h)):a.lastIndexOf(a[h])!==h&&(p[a[h]]=[h]);var g=a.slice(p[f][0],p[f][1]);r.each(t,function(e,n){r.inArray(n.name,g)>-1&&(t[e].isCircular=!0)}),n.push(g)}else s=l.parent,e(t,n,i,o,a,s),d=!0})}),d&&(c=[]);return n}(k,x,e,e)}),x.length&&r.each(x,function(t,n){var i="Models ";r.each(n,function(t,o){var a=t===n.length-1;i+=(a?"and ":"")+o+(a?" ":", "),-1===r.inArray(o,u)&&u.push(o),l.push(e.$M(o))}),te([i+="have conditions that reference each other. These conditions may be set to inactive because the data has not been loaded yet from the referenced model."],e.$M(n[0]))})}r.each(n,function(t,i){if(i._dependsOn.length&&-1===r.inArray(i.id,u)){var o=r.Deferred(),a=!1,s=i.getDataSourceName();r.each(i._dependsOn,function(t,r){n.filter(function(e){return r===e.id}).length>0?(h.push(o),e.$M(r).subscribeOnce("initially-loaded",function(){0===i._dependsOn.filter(function(t){return e.$M(t).isProcessing>0}).length&&I([i],s,o)}),a=!0):a||i._dependsOn.length!==t+1||l.push(i)})}}),r.each(l,function(e,t){var n=r.Deferred(),i=t.getDataSourceName();h.push(n),I([t],i,n)});var T=[];return r.each(p,function(e,t){var n=[],i=r.Deferred(),o={};h.push(i),function e(t,i){var a=[],s=!1;i=i||1,r.each(t,function(e,t){var r=!1;t.getConditionsWithDependencies().forEach(function(e){var t=e.model;!t||o[t]&&1!==i||(r=!0)}),r?a.push(t):(s=!0,n.push(t),o[t.id]=1)}),a.length&&s?e(a,++i):a.length&&Array.prototype.push.apply(n,a)}(t=t.map(function(e){if(-1===r.inArray(e.id,u))return e})),I(n,e,i),T=T.concat(n)}),h.length&&r.settle(h).always(function(e){var t=[];if(r.each(e,function(e,n){n.success||t.push(n.results)}),t.length)return function(e){var t,n=[],a=!1;r.each(e,function(e,t){t instanceof Array?(r.merge(n,t),a=!0):K(t)?n.push(t):t&&t.stack?n.push(t.stack):t&&t.message&&n.push(t.message)}),Te(m,{},o.initiatorId);var l=Re(m);X(g)?r.each(g,function(){o.initiatorId&&this._GUID!==o.initiatorId||this.handleMessages(l,{initiatorId:o.initiatorId})}):r.each(n,function(e,t){te(t,T[e])}),t=!1===a&&1===n.length?n[0]:n,i&&i(t),s.reject(t)}(t);!1!==o.notify&&(r.each(y,function(e,t){var n=o.initiatorId,i=t.registeredItems,a=t.registeredFields,s=t.registeredLists,l=t.registeredEditors;i&&r.each(i,function(){this.fields&&r.each(this.fields,function(){o.addOnly||this.destroy()})}),a&&r.each(a,function(){this.render&&this.render(),t.unregisterField(this)}),s&&r.each(s,function(){this.render({doNotCache:!o.addOnly,initiatorId:n})}),l&&r.each(l,function(e,t){t._GUID in g||(g[t._GUID]=t),t.clearMessages()}),function(e,t){var n,i,o=e.registeredEditors,a=e.errors;if(a&&a.length&&(n=r.map(a,function(e){return{message:q().isString(e)?e:e.message||null,severity:e.severity||"ERROR",showToAdminOnly:e.showToAdminOnly||!1}})),X(n)){var s={};if(s[e.id]=e,Te(n,s,t.initiatorId),i=Re(n),X(o)){var l=t.initiatorId;r.each(o,function(){l&&this._GUID!==l||this.handleMessages(i,{initiatorId:l})})}else te(n,e)}}(t,{initiatorId:n})}),r.each(g,function(e,t){t.handleDataRefresh&&t.handleDataRefresh({updatedModels:r.map(y,function(e){return e})})})),r.each(y,function(e,t){!function(e,t){e.publish("loaded",{model:e,modelId:e.id,initiatorId:f,updatedRows:t})}(t,b[e])}),a(v,[w]),i&&i(w),s.resolve(w)}),s.promise()}function Te(e,t,n){r.each(t,function(t,i){i.publish("messages",{messages:e,modelId:t,model:i,initiatorId:n})}),a(A+"messages",[{initiatorId:n,messages:e,models:t}])}function Re(e){return e.filter(function(e){return!e.handled})}function De(t){return!t||t.displaytype in e.ui.searchableDisplayTypes&&t.filterable}function Ae(t,n){var i,o,a,s,l,c,d,u,f,p,h,g,m,v,y=this,b=n?n.getDataSourceType():null,w=n&&n.getParentPageId();if(b&&b.setDefaultConditionState?b.setDefaultConditionState(y):(y.sourceType="fieldvalue",y.type="fieldvalue",y.operator="=",y.inactive=!1,y.encloseValueInQuotes=!0),t)if(t.jquery&&t.attr){if(o="false"!==(v=t).attr("enclosevalueinquotes"),i=q().adjustValueBasedOnQuotedness,(g=v.attr("sourcetype"))&&g!==y.sourceType?y.sourceType=g:g=y.sourceType,c=v.attr("fieldmodel"),"fieldvalue"===g?(y.field=v.attr("field"),(u=v.attr("nosourcerowbehavior"))&&(y.noSourceRowBehavior=u),c&&(y.fieldModel=c,(p=e.$M(c))&&p.data&&p.data.length&&(h=p.data[0],y.fieldRow=p.getRowId(h)))):"param"===g?(y.sourceParam=v.attr("sourceparam"),y.sourceParam||v.attr("field")&&(y.field=v.attr("field"),y.sourceType=g="fieldvalue")):"snippet"===g?y.sourceSnippet=v.attr("sourcesnippet"):"userinfo"===g?y.sourceUserInfoType=v.attr("sourceuserinfotype"):"userhaspermission"===g?y.permissionNamespace=v.attr("permissionnamespace"):"datasourceuserinfo"===g?(y.sourceDataSourceTypeUserInfo=v.attr("sourcedatasourcetypeuserinfo"),y.dataSourceName=v.attr("datasource")):q().endsWith(g,"property")&&(y.sourceProperty=v.attr("sourceproperty"),c&&(y.fieldModel=c)),y.operator=v.attr("operator")||"=",y.type=v.attr("type")||"fieldvalue",y.encloseValueInQuotes=o,y.value=i(v.attr("value"),o),y.state=v.attr("state"),y.inactive="true"===v.attr("inactive")||!1,y.mergeField=v.attr("mergefield"),l=y.type,r.each(["name","fieldFunction","fieldTargetObjects","label","model","noValueBehavior","customCookie","units","locationSource","locationModel","latitudeField","longitudeField","locationNoValueBehavior","locationChangeBehavior","locationDelta"],function(e,t){re(y,t,v,t.toLowerCase())}),f=v.attr("row"))try{f=parseInt(f,10)}catch(e){f=0}y.row=f,"userinfo"===l||"datasourceuserinfo"===l?(y.userInfoType=v.attr("userinfotype"),y.mergeField=y.userInfoType,"userinfo"!==l||y.mergeField||(y.mergeField=y.value),y.value=null):"modelmerge"===l?(y.mergeField=v.attr("mergefield")||y.value,y.sourceParam=v.attr("sourceparam"),y.value=null):"multiple"===l?(m=y.values=[],v.children("values").first().children().each(function(){var e=q().getXML(this);e.length>Z("value")?(e=q().decodeXML(e.substring(7,e.length-8)),m.push(i(e,o))):m.push("")})):"join"===l&&(y.joinObject=v.attr("joinobject"),y.joinField=v.attr("joinfield"),s=v.children("conditions"),a=v.children("condition"),s.length&&(y.subConditions=r.map(s.children(),function(e){return new Ae(r(e),n)})),a.length&&(y.subConditions=r.map(a,function(e){return new Ae(r(e),n)})),y.subConditionLogic=oe(v.attr("logic"),y.subConditions))}else r.extend(y,t);"param"===y.type?(y.value?y.value=e.page.getParameter(y.value,w):delete y.value,y.value||(y.value="","noquery"===y.noValueBehavior?n&&(n.doQuery=!1):"deactivate"===y.noValueBehavior&&(y.inactive=!0,y.originalInactive=!0)),y.originalValue=y.value,y.type="fieldvalue"):"fieldvalue"===y.type&&(d=e.page.getParameters(w),y.name in d&&(y.originalValue=y.value,y.value=d[y.name],y.inactive=!1)),void 0===y.originalInactive&&(y.originalInactive=y.inactive),void 0===y.originalValue&&(y.originalValue="multiple"!==l?y.value:y.values.join(";"))}function Ee(t){var n,i,o,a,s,l,c,d,f,h,b,w,S,C,I,k,x,T,R=t.xml,D=t.field||{},A=t.model,N=t.dataSourceType?t.dataSourceType:A?A.getDataSourceType():null,M="true"===R.attr("uionly")||N&&N.name===u,_=q().isBlank,P=N&&N.prop("runtime.metadataSource"),O="local"===P||"hybrid"===P,L="true"===R.attr("overridemetadata"),U=R.attr("readonly");if(o=D.id=q().escapeSingleQuotes(R.attr("id")),re(D,"targetObjects",R,"targetobjects"),se(D,"name",R,"name"),se(D,"function",R,"function"),re(D,"type",R,"type"),se(D,"orderByClause",R,"orderby"),"true"===R.attr("sortable")&&(D.sortable=!0),"false"===R.attr("query")&&(D.query=!1),"true"===R.attr("convertToUserTimezone")&&(D.convertToUserTimezone=!0),(M||O)&&(D.accessible=!0),M&&(D.uiOnly=!0),L&&(D.overrideMetadata=!0),(L||M||O)&&(re(D,"displaytype",R,"displaytype"),re(D,"defaultvaluetype",R,"defaultvaluetype"),re(D,"mergefield",R,"mergefield"),re(D,"model",R,"model"),re(D,"userinfotype",R,"userinfotype"),R.attr("label")&&(D.label=R.attr("label")),R.attr("helptext")&&(D.inlineHelpText=R.attr("helptext")),"true"===R.attr("required")&&(D.required=!0),R.attr("placeholder")&&(D.placeholder=R.attr("placeholder")),D.createable="false"!==R.attr("createable"),D.editable="false"!==R.attr("editable"),"true"===U&&(D.createable=D.editable=!1),(a=D.displaytype)===y&&(a=D.displaytype=R.attr("returntype"),D.calculated=!0,M&&(D.createable=D.editable=!1,R.attr("readonly","true")),h="formula",w=(w=(b=R.children(h).first())&&b.length?q().getXML(b.get(0)):"").length>h.length+3?q().decodeXML(w.substring(h.length+2,w.length-h.length-3)):null,D.formula=w),$(a)?(R.attr("picklistsource")&&(D.picklistSource=R.attr("picklistsource")),R.attr("picklistmodel")&&(D.picklistSourceModel=R.attr("picklistmodel")),R.attr("snippet")&&(D.picklistSourceSnippet=R.attr("snippet")),R.attr("entryvalue")&&(D.picklistEntryValue=R.attr("entryvalue")),R.attr("entrylabel")&&(D.picklistEntryLabel=R.attr("entrylabel")),R.attr("limitentries")&&(D.limitEntries="true"===R.attr("limitentries")),R.attr("returntype")&&(D.returnType=R.attr("returntype")),(c=R.children("picklistentries").children()).length&&(D.picklistEntries=r.map(c,function(e){var t=r(e),n={value:t.attr("value"),label:t.attr("label"),defaultValue:"true"===(t.attr("defaultValue")||"false"),active:!0};return"true"===t.attr("disabled")&&(n.disabled=!0),n}),D.customPicklistEntriesProvided=!0)):W(a)?(_(s=R.attr("precision"))&&M?D.precision=8:_(s)||(D.precision=parseInt(s,10)),_(l=R.attr("scale"))&&M?D.scale=2:_(l)||(D.scale=parseInt(l,10))):a===g?_(d=R.attr("digits"))&&M?D.digits=8:_(d)||(D.digits=parseInt(d,10)):a===v||a===m?(_(f=R.attr("length"))&&M?D.length=255:_(f)||(D.length=parseInt(f,10)),a===v&&(R.attr("displayasrichtext")?D.htmlFormatted="true"===R.attr("displayasrichtext"):D.htmlFormatted=void 0!==D.htmlFormatted&&D.htmlFormatted)):a===p&&(i=(n=e.dataSource.getDataSourceFromXML(R)).getDataSourceType(),D.dataSourceName=n.name,i&&i.getReferenceHandler&&i.getReferenceHandler().getMetadataHandler(R,D,A,o,M)),re(D,"defaultValue",R,"defaultValue"),x=D.enclosedInQuotes="false"!==R.attr("enclosevalueinquotes"),T=D.defaultValues=[],R.children("values").first().children().each(function(){var e=q().getXML(this);e.length>Z("value")?(e=q().decodeXML(e.substring(7,e.length-8)),T.push(q().adjustValueBasedOnQuotedness(e,x))):T.push("")})),-1!==r.inArray(D.type,[E,F])&&(S=R.children("fields").first(),k=R.children("conditions").first(),S.length>0&&(C=D.subFields=[],S.children("field").each(function(){var e=r(this);C.push(new Ee({xml:e,field:t.field,model:t.model,dataSourceType:t.dataSourceType}))})),D.type===E)){if((I=R.attr("limit"))||"0"===I)try{D.recordsLimit=parseInt(I,10),D.recordsLimit&&D.recordsLimit<1&&(D.recordsLimit=1)}catch(e){}R.attr("keyfield")&&(D.keyField=R.attr("keyfield"),D.anchorField=R.attr("anchorfield"),D.childObject=R.attr("childobject")),D.subConditions=r.map(k.children(),function(e){return new Ae(r(e),A)}),D.subConditionLogic=oe(k.attr("logic"),D.subConditions)}return D}function Fe(e){var t,n;if(e){if(e.jquery){if(t=e.attr("type"),n={verb:e.attr("verb"),endpoint:e.attr("endpoint"),type:t,pathToContent:e.attr("pathtocontent"),useResponseSnippet:e.attr("useresponsesnippet"),payloadContentType:e.attr("payloadcontenttype"),sendChanges:e.attr("sendchanges"),successIf:e.attr("successif"),successField:e.attr("successfield"),successValue:e.attr("successvalue"),isBatch:"true"===e.attr("batch")},"insert"===t&&(n.insertResponse=e.attr("insertresponse"),n.createdRecordIdLocation=e.attr("createdrecordidlocation")),"update"===t&&(n.updateResponse=e.attr("updateresponse")),"update"===t||"delete"===t){var i=e.children("requestbodyfields").children("field");i&&i.length&&(n.requestBodyFields=z(i))}n.sendChanges&&(n.changeMapping=e.attr("changemapping"),n.changeMappingPrefix=e.attr("changemappingprefix"),"custompayloadinbody"===n.sendChanges&&(n.payloadSnippet=e.attr("payloadsnippet"),n.contentType=e.attr("contenttype")),"usetemplaterequest"===n.sendChanges&&(n.customRequestTemplate=e.attr("customrequesttemplate"))),"true"===n.useResponseSnippet&&(n.responseSnippet=e.attr("responsesnippet"))}else r.isPlainObject(e)&&(n=e);r.extend(this,n)}}function Ne(e,t,n){this._model=e,this._row=t||{},t[B]=this,Y(n)||(this[P]=n)}function Me(t,n){var i,a=this,s=!1;if(n&&r.extend(a,n),t)if(K(t))try{ae({model:a,xml:i=q().makeXMLDoc(t)})}catch(t){r(document.body).one("pageload",function(){e.component.getByType("skuidpage")[0].addProblem("Unable to create Model: invalid Model XML string provided to Model constructor. "+t)})}else t.jquery?(i=t,ae({model:a,xml:t})):(r.extend(a,t),s=!0);a.id||(a.id=q().generateUniqueId()),a.conditions||(a.conditions=[]),a.fields||(a.fields=[]),a.data||(a.data=[]),a.changes={},a.originals={},a.registeredFields={},a.registeredFieldsByRowThenField={},a.registeredItems={},a.registeredItemsByRow={},a.registeredLists={},a.registeredEditors={},a.setHasChanged(!1),"preventUnloadIfUnsavedChanges"in a||(a.preventUnloadIfUnsavedChanges=!0),a.isProcessing=0,a.calloutIterator=0,a.lastSuccessfulCallout=0,a.events={},a[D]=new o.EventService,a[_]=[],a[M]={},a.extensions||(a.extensions={}),a.recordsMap={},ee(a),!s&&i&&e.model.initializeCustomProperties(i,a)}function _e(e,t){this.list=e,this.map=t}function Pe(e,t,n,i,r){i=i.toUpperCase();var o=K(e),a=o?e:e.id,s=o?null:e.function,l=n.getField(a);l&&l.displaytype===p&&(a=q().getFieldReference(a,l,n.getDataSource()));var c=ne(a,s)+" "+i+" NULLS LAST,"+r;return t.suffix=i+" NULLS LAST",c}function Oe(e,t){var n=K(e),i=n?e:e.id,r=n?e:e.name?e.name:i,o=t.getField(r);return o&&o.displaytype===p?q().getFieldReference(i,o,t.getDataSource()):i}function Le(e,t,n){var i,r,o;return K(e)?(i=t,o=null):(t=e.id,i=e.name?e.name:t,o=e.function),(r=n.getField(i))&&r.displaytype===p?ne(t,o):i}function Ue(e,t,n){n=n.toUpperCase();var i=K(e);return ne(Oe(e,t),i?null:e.function)+" "+n+" NULLS LAST,"+(t.orderByClause||"")}function Be(e,t,n){var i=Oe(e,t),r=K(e),o=Le(e,i,t),a=r?null:e.function,s={fieldId:i,fieldName:o,suffix:n.toUpperCase()+" NULLS LAST"};return a&&(s.fieldFunction=a),s}Ne.prototype={id:function(){return this.getId()},getId:function(){if(this.hasOwnProperty(P))return this[P];var e=this.model(),t=this.isNew()?q().generateUniqueId():e.getDataSource().getRowId(this.row(),e);return this.setId(t),t},setId:function(e){return this[P]=e,this},name:function(){return this.model().getDataSource().getRowName(this.row(),this.model())},model:function(){return this._model},row:function(){return this._row},getRow:function(){return this._row},setRow:function(e){return this._row=e,e[B]=this,this},isNew:function(){return!0===this[L]},isClone:function(){return!0===this[O]},isMoribund:function(){return this.isMarkedForDeletion()},isMarkedForDeletion:function(){return!0===this[U]},markForDeletion:function(){return this[U]=!0,this},unmarkForDeletion:function(){return delete this[U],this},markNew:function(){return this[L]=!0,this},markCloned:function(){return this[O]=!0,this},markSaved:function(){var e=this;return[L,O,U].forEach(function(t){delete e[t]}),e},get:function(e){var t,n=this._row,i=q().getObjectProperty;return e?i(n,e):(t={},r.each(n,function(e,n){e!==B&&(t[e]=n)}),t)},set:function(){return 1===arguments.length?r.each(arguments[0],function(e,t){q().setObjectProperty(this._row,e,t)}):2===arguments.length&&q().setObjectProperty(this._row,arguments[0],arguments[1]),this}},_e.prototype={indexOf:function(e){var t=-1;return r.each(this.list,function(n,i){if(i.fieldName&&i.fieldName===e||i.fieldId===e)return t=n,!1}),t},size:function(){return this.list.length}},Me.prototype={addField:function(e){return this.fields.push(e),this.fieldsMap[e.id]=e,e.name&&(this.fieldsMap[e.name]=e),this},addFields:function(e){var t=this;return e.forEach(function(e){t.addField(e)}),t},addPageProblems:function(e){return te(e,this)},getDataSource:function(){return ee(this)},getDataSourceName:function(){var e=this.getDataSource();return e?e.name:this.dataSourceName},getDataSourceType:function(){var e=this.getDataSource();return e&&e.getDataSourceType()},setParentPageId:function(e){return this._parentPageId=e,this},getParentPage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.$C(this.getParentPageId(t))},getParentPageId:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this._parentPageId;return t.root?n&&e.$C(n).getParentPage(t).id():n},hasMetadataLoaded:function(){return!this.needsMetadataLoad},setMetadataHasLoaded:function(){return this.needsMetadataLoad=!1,this},isSingleRow:function(){var e=!1;return this.conditions&&this.conditions.length&&r.each(this.conditions,function(t,n){if(n.field&&"id"===n.field.toLowerCase()&&n.type&&"param"===n.type)return e=!0,!1}),e},getField:function(e,t){var n,i,r=this.fieldsMap,o=r;return o&&!(o=e in r&&r[e])&&t&&t in r&&(i=(n=r[t])&&n.type===E?n.subFieldsMap:null)&&e in i&&(o=i[e]),o},getFieldValue:function(e,t,n){if(!e)return null;var i,r=q().getObjectProperty(e,t);return void 0===r&&("Id"===t?(i=this.getRecordForRow(e))&&(r=i.id()):this.fieldsMap&&t in this.fieldsMap&&(r=null)),n?r:q().encodeHTML(r)},getFieldValues:function(e,t,n){var i=this;return t.map(function(t){return i.getFieldValue(e,t,n)})},getFirstRow:function(){return this.data[0]},getRowById:function(e){return e in this.dataMap&&this.dataMap[e]},getNameField:function(){var e=this.getDataSource();if(e.getNameField)return e.getNameField(this.objectName,this)},getNameFieldValueForRow:function(e,t){var n,i=this.objectName,o=this.getNameField();return this.dataSourceTypeName===d&&i&&-1!==r.inArray(i,["Lead","User","Contact"])?n=q().mergeAsText("row","{{#Name}}{{{Name}}}{{/Name}}{{^Name}}{{{FirstName}}} {{{LastName}}}{{/Name}}",{createFields:!1},this,e):o&&(n=this.getFieldValue(e,o,!0)),n&&!0!==t&&(n=q().encodeHTML(n)),n},load:function(e,t){return Se([this],e,t)},updateData:function(e,t){var n=this,i=[],o=function(e){if(e.length){var t=r.map(e,function(e){if(!e.inactive)return e});n._clientData=n.data.filter(function(e){return q().areConditionsMet(t,{row:e,model:n})})}n.notifyEditorsOfDataRefresh()};return n._serverConditions||(n._serverConditions={}),n._clientData&&delete n._clientData,r.each(n.conditions,function(e,t){if(t.processOnClient&&("values"in t||"value"in t))(t.value||t.values&&t.values.length)&&i.push(t);else if(!t.processOnClient&&!t.inactive){var r,o=n._serverConditions[t.name];t.values&&t.values.length?r=t.values:t.value&&(r=t.value),o?o.values===t.values?delete n._serverConditions[t.name]:o.value===t.value?delete n._serverConditions[t.name]:n._serverConditions[t.name]=r:t.name&&(n._serverConditions[t.name]=r)}}),i.length?q().size(n._serverConditions)?Ce([n],e,r.extend(t,{notify:!1})).then(function(e){return o(i),e}):r.when().then(function(){o(i)}):Ce([n],e,t)},getOverrideableFieldMetadata:function(e){var t,n,i;return!0===e.overrideMetadata&&(t=e.displaytype,n=["displaytype","defaultValue","label","inlineHelpText","idField","nameField","placeholder","htmlFormatted"],i={overrideMetadata:!0},!0===e.calculated&&void 0!==e.formula&&n.push("calculated","createable","editable","formula"),!1===e.createable&&n.push("createable"),!1===e.editable&&n.push("editable"),$(t)?n.push("picklistEntries"):W(t)?n.push("precision","scale"):t===g?n.push("digits"):-1!==r.inArray(t,[m,v,"STRING",h,"ANYTYPE"])?n.push("length"):t===p&&n.push("isNamePointing","relationshipName","referenceTo","rel","ref"),r.each(n,function(t,n){var o=e[n];void 0!==o&&(i[n]=r.isArray(o)?r.extend(!0,[],o):o)})),i},sync:function(e){return Ie([this],e)},getMoreData:function(e,t){return ke([this],e,t)},loadNextOffsetPage:function(e,t){var n=this.getDataSourceType();if(this.canRetrieveMoreRows&&!this.isProcessing){if(this.offsetPageNumber&&this.offsetPageSize)this.offsetPageNumber++;else if(n&&n.coerceStartingPageSize?n.coerceStartingPageSize(this):this.offsetPageSize=this.recordsLimit||100,this.data.length>0){var i=this.offsetPageSize>0?Math.ceil(this.data.length/this.offsetPageSize):1;this.offsetPageNumber=i>1?i:2}else this.offsetPageNumber=1;this.getMoreData(function(){e&&e()},t)}},loadAllRemainingRecords:function(e){var t=this,n=(e=e||{}).batchSize||t.recordsLimit;!function i(r){if(t.canRetrieveMoreRows){var o=t.data.length;e.stepCallback&&e.stepCallback(o+1,o+n),e.batchSize&&(t.offsetSize=o,t.recordsLimit=n),t.loadNextOffsetPage(i,{notify:!1})}else e.batchSize&&(delete t.offsetSize,t.recordsLimit=r),t.notifyEditorsOfDataRefresh(),e.finishCallback&&e.finishCallback(t.data.length)}(t.recordsLimit)},getRecords:function(){var e=this;return r.map(e.data,function(t){return e.getRecordForRow(t)})},getRows:function(e,t){return q().filterRowsByConditions(this.data,e,t,this)},getRawRows:function(){var e=this;return e.getRows.apply(e,arguments).map(function(t){return e.getRecordForRow(t).get()})},adoptRow:function(e,t){var n=this.adoptRows([e],t);return n&&n.length?n[0]:null},adoptRows:function(e,t){t||(t={});var n=this,i=n.data,o=n.dataMap,a=n.recordsMap,s=[],l=[],c=i.length>0,d=!!t.doAppend;if(r.each(e,function(e,t){var i=n.getRowId(t),d=c&&i&&n.getRowById(i);d?r.extend(d,t):(d={},d=r.extend(!0,d,t),l.push(d),o[i]=d,a[i]=new Ne(n,d,i)),s.push(d)}),l.length)if(c)if(d)ie(i,l);else{var u=i.splice(0,i.length);ie(i,l),ie(i,u)}else ie(i,l);return!1!==t.evaluateFormulaFields&&n.evaluateFormulaFields({preventTrackChanges:!0,updatedRows:s}),!1!==t.notify&&n.notifyEditorsOfDataRefresh(),s},abandonRow:function(e){return this.abandonRows([e]),e},abandonRows:function(e,t){var n=this,i=n.changes,o=n.originals,a=n.registeredItemsByRow,s=n.registeredFieldsByRowThenField,l=[],c=!(t&&!1===t.notify);if(e&&e.length)return r.each(e,function(e,t){var i=n._findRow(t);i&&l.push(i)}),l.length&&r.each(l,function(e,t){var l=n.getRowId(t),d=r.inArray(t,n.data),u=!!i&&i[l],f=!!o&&o[l];u&&delete i[l],f&&delete o[l],-1!=d&&(n.data.splice(d,1),delete n.dataMap[l],delete n.recordsMap[l]),c||n.registeredLists&&r.each(n.registeredLists,function(){this.handleRowDeletion&&this.handleRowDeletion(l)}),l in a&&(r.each(a[l],function(){n.unregisterItem(this)}),delete a[l]),l in s&&(r.each(s[l],function(e,t){t.length&&r.each(t,function(){n.unregisterField(this)})}),delete s[l])}),0===X(n.changes)&&n.setHasChanged(!1),c&&n.notifyEditorsOfDataRefresh(),e},_customSortData:function(e){var t=this,n=r.map(t.data,function(e){return e});n=n.sort(e),t.data.length=0,r.each(n,function(e,n){t.data[e]=n}),t.notifyEditorsOfDataRefresh()},sortData:function(e){var t,n=this,i=r.map(n.data,function(e){return e});n.originalOrderSaved||(n.originalDataOrder=r.map(this.data,function(e){return e})),n.originalOrderSaved=!0,e&&e.length?i=i.sort((t=r.map(e,function(e){return{name:e.name,func:(t=e.desc,n=function(e,n){return q().isString(e)&&q().isString(n)&&(e=e.toLowerCase(),n=n.toLowerCase()),e===n?0:e&&Y(n)?t?1:-1:n&&Y(e)?t?-1:1:e<n?-1:1},t?function(e,t){return-1*n(e,t)}:n)};var t,n}),function(n,i){for(var r,o,a,s=0;s<e.length&&(o=0,r=(a=t[s]).name,0===(o=a.func(n[r],i[r])));s++);return o})):n.originalOrderSaved&&(i=n.originalDataOrder),n.data.length=0,r.each(i,function(e,t){n.data[e]=t}),n.notifyEditorsOfDataRefresh()},emptyData:function(){var e=this,t=e.data.slice(0);return e.data.length=0,e.changes={},e.originals={},e.setHasChanged(!1),e._invalidateDataIndices(),e.notifyEditorsOfDataRefresh(),r.each(e.registeredItemsByRow,function(t,n){r.each(n,function(){e.unregisterItem(this)})}),e.registeredItemsByRow={},r.each(e.registeredFieldsByRowThenField,function(t,n){r.each(n,function(t,n){r.each(n,function(){e.unregisterField(this)})})}),e.registeredFieldsByRowThenField={},t},abandonAllRows:function(){return this.emptyData()},record:function(e){var t=q().isObject(e)?this.getRowId(e):e;return this.getRecordById(t)},getRecordById:function(e){return this.recordsMap[e]},applyAllConditionsToNewRow:function(e,t){var n=this;t.length&&r.each(t,function(i,r){if(!r.inactive&&r.field&&"blank"!==r.type){var o,a=n.getField(r.field),s=a?a.displaytype:null,l=r.operator||"=",c=n.getDataSourceType();if(a&&a.createable&&("="===l||"starts with"===l))if(n.updateConditionValue(r),o=r.value,"="===l&&s===p)c&&c.handleDefaultReferenceFieldValue&&c.handleDefaultReferenceFieldValue(e,r,n,a,t);else{if(o=le(o,s),q().startsWith(s,b)&&!o)return!0;n.updateRow(e,r.field,o)}}})},createRowAsync:function(e){var t=this;return r.when.all(r.map(t.fields,function(e){var n=t.getDataSourceType();return n&&n.loadDefaultValueMetadata?n.loadDefaultValueMetadata(e,t):r.Deferred().resolve().promise()})).then(function(){return t.createRow(e)})},createRow:function(e){e||(e={});var t,n,i=this,o=i.hasChanged,s={},l={},c=i.getDataSourceType(),d=[],u=e.additionalConditions;e.editModeForNewItems&&(l.editModeForNewItems=!0),i.setHasChanged(!0),n=(t=new Ne(i,s).markNew()).id(),e.doAppend?i.data.push(s):i.data.unshift(s),i.dataMap&&(i.dataMap[n]=s),i.recordsMap&&(i.recordsMap[n]=t),"ignoreDefaults"in e!=!1&&!0===e.ignoreDefaults||(["conditions","uiOnlyConditions"].forEach(function(e){var t=i[e];t&&t.length&&t.forEach(function(e){d.push(e)})}),u&&u.length&&r.each(u,function(e,t){d.push(t)}),c&&c.coerceCreateRow&&c.coerceCreateRow(t,i,d),i.fields&&r.each(i.fields,function(e,t){t.createable&&i.getDefaultValue(t,i)&&i.updateRow(s,t.id,t.evaluatedDefaultValue,{preventSetActive:!0})}),i.applyAllConditionsToNewRow(s,d)),n in i.changes||(i.changes[n]={}),i.evaluateFormulaFields({updatedRows:[s],updates:i.changes[n]}),i.registeredLists&&r.each(i.registeredLists,function(){e.initiatorId&&this._GUID===e.initiatorId||this.handleNewRow(s,l)}),i.notifyEditorsOfChange({hadPriorChanges:o,changes:i.changes[n]});var f={modelId:i.id,model:i,rowId:n,row:s,initiatorId:e?e.initiatorId:null,event:"row.created"};return r.extend(f,l),i.publish("row.created",f),a("row.created",[f]),s},updateRow:function(){var e=new function(e,t){var n,i,r=t[0],o={};if(t.length<2)return!1;K(t[1])?((i={})[t[1]]=t[2],n=t[3]):(i=t[1],n=t[2]),o[e.getRowId(r)]=i,this.updates=o,this.options=n}(this,arguments),t=this.updateRows(e.updates,e.options);return t&&t.length?t[0]:t},updateRows:function(e,t){var n,i,o,a,s=this,l=s.getDataSourceType(),c=s.hasChanged,d=[],u=q().getObjectProperty,f=q().hasObjectProperty,h=q().setObjectProperty;return!!e&&(t||(t={}),t.preventTrackChanges||(t.preventTrackChanges=!1),Y(i=t.notifyFields)&&(i=!0),Y(o=t.notify)&&(o=!0),l.coerceUpdateRows&&l.coerceUpdateRows(s,e,t),r.each(e,function(e,i){var o,a,l=s.getRowById(e),c=s.isNewRow(l),g=!1;if(!l||!i)return!0;r.each(i,function(d,m){var v,y,b,w,S=s.getField(d),C=S&&S.displaytype,I=(!(S&&S.id&&q().isString(S.id))||!!t._ignoreMetadata||(c?S.createable:S.editable))&&!t.preventTrackChanges,k=C===p,x=k&&!m,T=s.getDataSourceType(),R=k&&s.getReferenceFieldRelationshipName(d);if((s.getFieldValue(l,d,!0)===(b=C?le(m,$(C)&&S.returnType?S.returnType:C):m)||b!=b)&&!t.alwaysAddChanges)return!0;k&&!x&&(v=T&&T.getReferenceFieldRelatedData&&T.getReferenceFieldRelatedData(S,b,l,s,i)),I&&(d&&(o||(n||(n={}),n[e]={},o=s.changes[e],n[e].__hadPriorChanges=!!o,o||(o=s.changes[e]={})),w=b,s.isRelationshipField(d)&&(y=s.getReferenceFieldNameFromRelationshipField(d),f(o,y)||h(o,y,r.extend(!0,{},u(l,y)))),h(o,d,w),h(n[e],d,w),R&&(x&&R!==d?delete o[R]:!0===k&&v&&(h(o,R,v),h(n[e],R,v)))),s.hasChanged||t.preventSetActive||s.setHasChanged(!0),c||(a||(a=s.originals[e])||(a=s.originals[e]={}),s.isRelationshipField(d)?f(a,d)||(y=s.getReferenceFieldNameFromRelationshipField(d),a.hasOwnProperty(y)||(a[y]=r.extend(!0,{},u(l,y))),h(a,d,s.getFieldValue(l,d,!0))):a.hasOwnProperty(d)||(h(a,d,s.getFieldValue(l,d,!0)),x&&R&&h(a,R,u(l,R))))),h(l,d,b),R&&(x&&R&&R!==d?delete l[R]:!0===k&&v&&h(l,R,v)),g=!0}),g&&d.push(l)}),n&&(a=!1,r.each(n,function(e,t){if(t&&X(t)>1)return a=!0,!1}),a&&(s.evaluateFormulaFields({updatedRows:d,updates:e,preventTrackChanges:t.preventTrackChangesSecondTime}),!1!==o&&s.notifyEditorsOfChange({hadPriorChanges:c,changes:n}),!1!==i&&!1!==o&&(s.publish("update",n),s.notifyFieldsOfChange(n,{initiatorId:t.initiatorId,hadPriorChanges:c})))),d)},notifyFieldsOfChange:function(e,t){var n=this,i=n.registeredFieldsByRowThenField;t=t||{},r.each(e,function(e,o){var s=o.__hadPriorChanges;delete o.__hadPriorChanges,r.each(o,function(n,o){e in i&&n in i[e]&&r.each(i[e][n],function(){t.initiatorId&&this._GUID===t.initiatorId||this.handleChange&&this.handleChange(o,n)})});var l={event:"row.updated",modelId:n.id,model:n,rowId:e,row:n.getRowById(e),updates:o,rowHadPriorChanges:s,modelHadPriorChanges:t.hadPriorChanges,initiatorId:t?t.initiatorId:null};n.publish("row.updated",l),a("row.updated",[l])})},_findRow:function(e){var t,n=void 0===e?"undefined":i(e);return"object"===n?e:((t=this.getRowById(e))||n!==k||(t=this.data[e]),t)},deleteRows:function(e,t){t||(t={});var n=this,i={},o=n.hasChanged,s=!1!==t.notify;return e||(e=n.data),e.length&&(n.setHasChanged(!0),r.each(e,function(e,o){if(o=n._findRow(o)){var a=n.getRowId(o),l=n.changes[a],c=n.record(a);l||(n.changes[a]={},l=n.changes[a]),c.markForDeletion(),c.isNew()||n.originals[a]||(n.originals[a]={},n.originals[a]),a in n.registeredItemsByRow&&r.each(n.registeredItemsByRow[a],function(){t&&t.initiatorId&&this._GUID===t.initiatorId||this.handleMarkRowForDeletion&&this.handleMarkRowForDeletion(o)}),s&&(i[a]={},i[a][U]=!0,i[a].__notdeleted=!1)}}),s&&(n.notifyEditorsOfChange({hadPriorChanges:o,changes:i}),r.each(i,function(e){var i={event:"row.deleted",model:n,modelId:n.id,rowId:e,row:n.getRowById(e),initiatorId:t?t.initiatorId:null,modelHadPriorChanges:o};n.publish("row.deleted",i),a("row.deleted",[i])}))),n},deleteRow:function(e,t){return this.deleteRows([e],t),this},undeleteRows:function(e,t){t||(t={});var n=this,i={},o=n.hasChanged,s=!1!==t.notify;e||(e=n.data),e.length&&(n.setHasChanged(!0),r.each(e,function(e,o){if(o=n._findRow(o)){var a=n.getRowId(o);n.record(a).unmarkForDeletion(),a in n.registeredItemsByRow&&r.each(n.registeredItemsByRow[a],function(){t.initiatorId&&this._GUID===t.initiatorId||this.handleUnmarkRowForDeletion&&this.handleUnmarkRowForDeletion(o)}),s&&(i[a]={},i[a][U]=!1,i[a].__notdeleted=!0)}}),s&&(n.notifyEditorsOfChange({hadPriorChanges:o,changes:i}),r.each(i,function(e){var i={event:"row.undeleted",modelId:n.id,model:n,rowId:e,row:n.getRowById(e),initiatorId:t?t.initiatorId:null,modelHadPriorChanges:o};n.publish("row.undeleted",i),a("row.undeleted",[i])})))},undeleteRow:function(e,t){return this.undeleteRows([e],t)},removeRowById:function(e){if(e||0===e)return this.abandonRow(this.getRowById(e))},validateRequiredFields:function(){var e=[];return r.each(this.registeredLists,function(){e=e.concat(this.validateRequiredFields())}),e},getNewId:function(){var e=this.getDataSource();return e&&e.getNewId?e.getNewId():fe()},save:function(e){return be([this],e)},cancel:function(e){return we([this],e),this},notifyEditorsOfChange:function(e){this.registeredEditors&&r.each(this.registeredEditors,function(){this.handleChange&&this.handleChange(e)})},getConditionCookieName:function(e){return J(this,e)},setCondition:function(e,t,n){if(e){var i,o=!1,s="condition.valueChanged",l={event:s,conditionName:e.name,modelId:this.id,model:this,newValue:"",newValues:[],oldValue:"",oldValues:[]};e.inactive=!1,"modelmerge"===e.type&&(e.type="fieldvalue"),Q(e.operator)&&(Y(t)||(r.isArray(t)?(o=!0,e.values=t):K(t)&&-1!=t.indexOf(";")?e.values=t.split(";"):e.values=[t]),l.newValues=e.values),o||(e.value=t,l.newValue=t),(i=e.originalValue)instanceof Array?(l.oldValue="",l.oldValues=i):(l.oldValue=i,l.oldValues=[]),n&&e.name&&this.getPersonalizationService().setCondition({name:e.name,value:t}),this.publish(s,l),a(s,[l])}},deactivateCondition:function(e,t){if(e){var n,i="condition.deactivated";return e.inactive=!0,e.value=e.originalValue,Q(e.operator)&&(e.originalValue?-1!=e.originalValue.indexOf(";")?e.values=e.originalValue.split(";"):e.values=[e.originalValue]:e.values&&e.values.length||(e.values=[])),t&&e.name&&this.getPersonalizationService().setCondition({name:e.name,value:"-off-"}),n={event:i,conditionName:e.name,modelId:this.id,model:this},this.publish(i,n),a(i,[n]),this}},deactivateFilterableConditions:function(e){var t=this;t&&t.conditions&&t.conditions.length&&r.each(t.conditions,function(n,i){t.isFilterableCondition(i)&&t.deactivateCondition(i,e)})},isFilterableCondition:function(e){return e.state&&-1!==e.state.indexOf("filter")},activateCondition:function(e,t){if(e){var n,i="condition.activated";return e.inactive=!1,t&&e.name&&this.getPersonalizationService().setCondition({name:e.name,value:"-on-"}),n={event:i,conditionName:e.name,modelId:this.id,model:this},this.publish(i,n),a(i,[n]),this}},resetCondition:function(e,t){if(e){var n=e.originalValue||"",i={event:"condition.reset",conditionName:e.name,modelId:this.id,model:this,newValue:"",newValues:[],oldValue:"",oldValues:[],isActive:!e.inactive,wasActive:!e.originalInactive};return e.inactive=e.originalInactive,e.value=e.originalValue,Q(e.operator)&&(e.originalValue?-1!=e.originalValue.indexOf(";")?e.values=e.originalValue.split(";"):e.values=[e.originalValue]:e.values=[],i.newValues=e.values),Q(e.operator)?(i.oldValue="",i.oldValues=n.split(";")):(i.oldValue=n,i.oldValues=[]),t&&e.name&&this.getPersonalizationService().resetCondition({name:e.name}),this.publish("condition.reset",i),a("condition.reset",[i]),this}},getConditionValueResult:function(t){var n,o,a,s,l,c=t.noValueBehavior||(-1!==r.inArray(t.type,["param","multiple"])?"":"deactivate"),d={},u=q().startsWith(t.state,"filterable")&&t.name,f=t.value;return"userinfo"===t.type?s=q().getUserInfoPropValue(t.userInfoType):"modelmerge"===t.type?(n=(o=ye(t.model)).getFirstRow())&&(s=o.getFieldValue(n,t.mergeField,!0)):"blank"===t.type?s=null:"param"===t.type?(a=e.page.getParameters(this&&this.getParentPageId()),l=t.valueParamName,K(f)&&(f in a?(t.valueParamName=f,s=a[f]):f.toLowerCase()in a&&(t.valueParamName=f.toLowerCase(),s=a[t.valueParamName])),Y(s)&&l&&l in a&&(s=a[l])):s=t.value,u&&(void 0===f?"undefined":i(f))!==I&&f!==s&&(s=f),s||!1===s||0===s||null===s?d.value=t.value=s:t.values&&t.values.length?d.values=t.values:"noquery"===c?(this&&(this.doQuery=!1),d.status="noquery"):"deactivate"===c?(t.originalInactive&&(t.originalInactive=t.inactive),t.inactive=!0,d.value=t.value=null,d.status="deactivate"):d.value=t.value="",d},getConditionValue:function(e){return this.getConditionValueResult(e).value},updateConditionValue:function(e){var t,n,i,o,a,s=e.type,l=e.locationSource,c=e.mergeField,d=e.latitudeField,u=e.longitudeField,f="modelmerge"===s,p="modelmerge"===l,h=e.row,g=this,m=g.getDataSource(),v=!1;if(n=(t=f&&c&&ye(e.model))&&t.data,c&&n&&(Q(e.operator)?(o=e.values,e.values=r.map(n,function(e){return t.getFieldValue(e,c,!0)}),o&&o instanceof Array?o&&(o.length!==e.values.length?v=!0:o.length&&(a={},o.forEach(function(e){a[e]=1}),r.each(e.values,function(e,t){if(!a.hasOwnProperty(t))return v=!0,!1}))):v=!0):((!h||h<0||h>=n.length)&&(e.row=0),o=t.getFieldValue(n[e.row],c,!0),e.value!==o&&(e.value=o,v=!0))),(n=(t=p&&d&&u&&ye(e.locationModel))&&t.data)&&((!h||h<0||h>=n.length)&&(e.row=0),i=n&&n[e.row],o={lat:t.getFieldValue(i,d,!0),long:t.getFieldValue(i,u,!0)},e.latitudeValue===o.lat&&e.longitudeValue===o.long||(e.latitudeValue=o.lat,e.longitudeValue=o.long,v=!0)),!("userlocation"!==l||e.latitudeValue&&e.longitudeValue)){var y=e.locationDelta?parseInt(e.locationDelta,10):100;navigator.geolocation?(r.blockUI({message:"Determining your current location...",onOverlayClick:r.unblockUI}),navigator.geolocation[("false"===e.locationChangeBehavior?"getCurrent":"watch")+"Position"](function(t){r.unblockUI();var n,i,o,a,s,l,c,d,u,f=t.coords,p=f.latitude,h=f.longitude;n=e.latitudeValue,i=e.longitudeValue,g.isProcessing||n&&i&&!(n&&i&&(o=p,a=h,s=n,l=i,c=(s-o)*Math.PI/180,d=(l-a)*Math.PI/180,u=Math.sin(c/2)*Math.sin(c/2)+Math.cos(o*Math.PI/180)*Math.cos(s*Math.PI/180)*Math.sin(d/2)*Math.sin(d/2),2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u))*6378.137*1e3>=y))||(e.latitudeValue=p,e.longitudeValue=h,v=p!==n||h!==i,g.updateData())},function(t){r.blockUI({message:"Unable to determine your current location: "+t.message,timeout:2e3}),"noquery"===e.locationNoValueBehavior?g.emptyData():(e.inactive=!0,g.updateData())},{enableHighAccuracy:!0,timeout:15e3,maximumAge:36e5})):r.blockUI({message:"Your browser does not support GeoLocation. Some features may not work.",timeout:2e3})}return!c||"userinfo"!==s&&"datasourceuserinfo"!==s||("userinfo"===s?e.value=q().getUserInfoPropValue(c):"datasourceuserinfo"===s&&(e.value=m.getUserInfoProperty(c))),v},getDefaultValue:function(t,n){var i,o,a,s=t.defaultValue,l=t.defaultValues,c=Y(s),d=t.displaytype,u=t.mergefield,f=n.getDataSourceType(),p=ye(t.model),h=p&&p.data,g=t.row,m=t.defaultvaluetype,v="fieldvalue"===m||Y(m);if("modelmerge"===m&&u&&h&&h.length)"MULTIPICKLIST"===t.displaytype?(i=[],r.each(h,function(e,t){i.push(p.getFieldValue(t,u,!0))}),a=i.join(";")):((!g||g<0||g>=h.length)&&(t.row=0),a=p.getFieldValue(h[t.row],u,!0)),null!==a&&(o=a);else if(f&&f.coerceDefaultValue){var y=f.coerceDefaultValue(t,n);y&&(o=y)}return d===C&&!o&&v&&c?o=q().rfc4122v4GUID():!v||!Y(o)||c||K(s)&&!s?"datasourceuserinfo"!==m||Y(t.userinfotype)?"userinfo"!==m||Y(t.userinfotype)?"param"!==m||c?"multiple"===m&&!Y(l)&&l.length&&(o=l.join(";")):o=e.page.getParameter(s,n.getParentPageId()):o=q().getUserInfoPropValue(t.userinfotype):o=n.getDataSource().getUserInfoProperty(t.userinfotype):o=s,t.evaluatedDefaultValue=o,!Y(t.evaluatedDefaultValue)},registerEditor:function(e){ce(e,this.registeredEditors)},unregisterEditor:function(e){de(e,this.registeredEditors)},registerList:function(e){ce(e,this.registeredLists)},unregisterList:function(e){de(e,this.registeredLists)},registerItem:function(e){ce(e,this.registeredItems);var t,n=this.registeredItemsByRow,i=e.row;n&&i&&((t=this.getRowId(i))in n||(n[t]={}),n[t][e._GUID]=e)},unregisterItem:function(e){de(e,this.registeredItems);var t=this.registeredItemsByRow,n=e?e.row:0,i=n?this.getRowId(n):0,r=t[i];t&&r&&e._GUID in r&&(delete r[e._GUID],X(r)||delete t[i])},registerField:function(e,t){ce(e,this.registeredFields);var n=this.registeredFieldsByRowThenField,i=t||e.id,r=e.row,o=r?this.getRowId(r):0;if(n&&r&&i&&o){o in n||(n[o]={});var a=n[o];i in a||(a[i]={}),a[i][e._GUID]=e}},unregisterField:function(e,t){if((void 0===e?"undefined":i(e))===x&&(e=this.registeredFields[e]),e){de(e,this.registeredFields);var n,o,a=this.registeredFieldsByRowThenField,s=[],l=e._GUID,c=e.row,d=c?this.getRowId(c):0;a&&d&&(n=a[d])&&(t&&t.length&&r.each(t,function(){s.push(this)}),e.id&&s.push(e.id),r.each(s,function(e,t){(o=n[t])&&l in o&&(delete o[l],X(o)||delete n[t])}),X(n)||delete a[d])}},mergeRow:function(e,t,n){return q().merge("row",t,n,this,e)},getRowMergeResult:function(e,t,n){return q().getMergeResult("row",t,n,this,e)},mergeModel:function(e,t){return q().merge("model",e,t,this)},getMergeResult:function(e,t){return q().getMergeResult("model",e,t,this)},getOrderObject:function(e){var t=this,n="client"===e,i="server"===e,o=(t.orderByClause||"").split(","),a=(t.orderByClauseClient||"").split(","),s=[],l={},c=function(e,n){var i=r.trim(e);if(i){var o,a,c,d,u=i.split(" "),f=u[0],p={suffix:u.length>1?u.slice(1).join(" "):"ASC NULLS LAST"};-1!==f.indexOf("(")?(d=f.split("("),c=d[0],o=d[1].split(")")[0],p.fieldId=o,c&&(p.fieldFunction=c),r.each(t.fields,function(){if(this.name&&this.id===o&&this.function===c)return a=this.name,!1}),a&&(p.fieldName=a)):t.isAggregate?(o=f,r.each(t.fields,function(){if(this.name&&this.id===o)return a=this.name,!1}),p.fieldId=o,a&&(p.fieldName=a)):(p.fieldId=f,a=f),p.onClient=n,l[a]||(s.push(p),l[a]=p)}};return i||r.each(a,function(){c(this,!0)}),n||r.each(o,function(){c(this,!1)}),new _e(s,l)},toggleOrdering:function(e,t,n){var i=(t=t||{}).clientSide,o=this.getOrderObject(i?"client":"server"),a="",s=Oe(e,this),l=Le(e,s,this),c=o.map[l],d=t.explicitOrder||"toggle",u="toggle"===d,f=!1!==t.shouldQuery,p=!1!==t.shouldUpdatePersonalization,h=c&&-1!=c.suffix.toLowerCase().indexOf("asc"),g=c&&-1!=c.suffix.toLowerCase().indexOf("desc");if(function(e,t){var n=t.map[e];return!!n&&-1!==r.inArray(n,t.list)}(l,o)&&function(e,t){var n=t.map[e];if(n){var i=r.inArray(n,t.list);-1!=i&&t.list.splice(i,1),e in t.map&&delete t.map[e]}}(l,o),c&&(a=function(e){return e.list.map(function(e){return ne(e.fieldId,e.fieldFunction)+" "+e.suffix}).join(",")}(o)),u?c?h?a=Pe(e,c,this,"DESC",a):g&&(c=!1):(a=Ue(e,this,"ASC"),(c=Be(e,this,"ASC")).onClient=i):c||"clear"===d?"clear"!==d?a=Pe(e,c,this,d,a):c=!1:(a=Ue(e,this,d),c=Be(e,this,d)),a=(a=a.replace(/,+$/,"")).replace(/\s*,\s*/g,","),i){var m=this.orderByClauseClient,v=[];if(m=c?s+" "+c.suffix:"",r.each(o.list,function(e,t){t.fieldId!==s&&(m+=","+t.fieldId+" "+t.suffix)}),m){var y=m.split(",");r.each(y,function(e,t){t=t.split(" "),v.push({name:t[0],desc:"ASC"!==t[1]})})}this.orderByClauseClient=m,this.sortData(v),p&&this.getPersonalizationService().setOrderBy({newValue:m}),n()}else this.orderByClause=a,f&&this.updateData(n,{neverCache:!0}),p&&this.getPersonalizationService().setOrderBy({newValue:a});return c},orderBy:function(e,t){var n,i=this.getOrderObject(),r=K(e),o=r?e:e.id,a=r?e:e.name?e.name:o,s=r?null:e.function,l=this.getField(a),c="";return l.displaytype===p&&(a=ne(o=q().getFieldReference(o,l),s)),(n=i.map[a])?-1!=n.suffix.indexOf("ASC")?(c=ne(o,s)+" DESC NULLS LAST",n.suffix="DESC NULLS LAST"):n=!1:(c=ne(o,s)+" ASC NULLS LAST",n={fieldId:o,fieldName:a,suffix:"ASC NULLS LAST"},s&&(n.fieldFunction=s)),c=c.replace(/,+$/,""),this.orderByClause=c,this.updateData(t,{neverCache:!0}),this.getPersonalizationService().setOrderBy({newValue:c}),n},getSearchableFields:function(){return this.fields.filter(De)},createSearchSubConditions:function(e,t,n,i){return q().createSearchSubConditions(this,e,t,n,i)},buildSearchCondition:function(e,t,n,i){t=!!t&&r.trim(t),i||(i={}),e||(e="__default_searchbox");var o=i.affectCookies||!1,a=t&&t.length>(i.useSOSLSearch?1:0),s=this.getConditionByName(e,!1),l=this.getDataSourceType(),c=!1!==l.prop("canFieldsBeIndividuallySearched"),d=l.prop("hasDefaultSearch");return a?((c||d)&&(s||((s=new Ae).name=e,i.useSOSLSearch?s.type="search":s.type="group",this.addCondition(s))),c?(this.activateCondition(s,o),i.useSOSLSearch?(s.fieldfunction=i.SOSLFields,i.tokenize?s.value=r.map(t.split(i.delemiter||" "),function(e){return'"'+e+'*"'}).join(" AND "):s.value='"'+t+'*"'):this.createSearchSubConditions(s,t,n,i)):s&&this.setCondition(s,t,o),s&&"group"===s.type&&(s.value=t)):s&&(this.deactivateCondition(s,o),s.subConditions=[],s.subConditionLogic="",s.value=""),s},prepareSearchConditions:function(e,t,n,i){this.buildSearchCondition(null,t,e.searchFields,i)},_invalidateDataIndices:function(){return this.dataMap={},this.recordsMap={},this},isRowMarkedForDeletion:function(e){var t,n=this._findRow(e);return!!n&&((t=this.getRecordForRow(n))&&t.isMoribund())},getRowId:function(e){var t=this.getRecordForRow(e);return t?t.id():this.dataSource.getRowId(e,this)},getRowName:function(e){var t=this.getRecordForRow(e);return t?t.name():this.dataSource.getRowName(e,this)},getValueKeyPrefix:function(e){return this.dataSource.getValueKeyPrefix(e,this.objectName||"",this)},rowHasId:function(e){return!!this.getRowId(e)},getIdField:function(){return this.dataSource.getIdField(this)},getIdFieldForChildRelationship:function(e){return this.dataSource.getIdFieldForChildRelationship(this,e)},getKeyPrefix:function(){return this.dataSource.getKeyPrefix(this.objectName||"",this)},getDataSourceForReferenceField:function(t){var n=this.getField(t),i=this.dataSource;return n&&n.displaytype===p&&n.overrideMetadata&&n.dataSourceName!==i.name?e.dataSource.get(n.dataSourceName):i},getReferenceFieldNameFromRelationshipField:function(e){var t=this.getDataSourceType();return t&&t.getReferenceFieldNameFromRelationshipField?t.getReferenceFieldNameFromRelationshipField(e,this):e&&e.split(".")[0]},getReferenceFieldRelationshipName:function(e){return this.getDataSourceForReferenceField(e).getReferenceFieldRelationshipName(e,this)},getChildIdFromRow:function(e,t){var n=this.getDataSourceType();return n&&n.getChildIdFromRow?n.getChildIdFromRow(this,e,t):null},isRelationshipField:function(e){var t=this.getDataSourceType();return!(!t||!t.isRelationshipField)&&t.isRelationshipField(e)},getRowChanges:function(e){var t;return(e=this._findRow(e))&&(t=this.changes?this.changes[this.getRowId(e)]:null),t},getRowOriginals:function(e){var t;return(e=this._findRow(e))&&(t=this.originals?this.originals[this.getRowId(e)]:null),t},isRowChanged:function(e){var t;return!!(e=this._findRow(e))&&(t=this.getRowId(e),this.getRowById(t)&&t in this.changes)},doesRowHaveUnsavedChanges:function(e){return this.isRowChanged(e)},isRowNew:function(e){var t,n=this._findRow(e);return!!n&&((t=this.getRecordForRow(n))&&t.isNew())},isNewRow:function(e){return this.isRowNew(e)},isRowUnsavedClone:function(e){return function(e,t){var n,i=t._findRow(e);return i&&(n=t.getRecordForRow(i)),!!n&&n.isClone()}(e=this._findRow(e),this)},cancelRowChanges:function(e,t,n){if(n||(n={}),!e)throw"Row is required.";var i=this,r=i.getRowId(e),o=i.originals[r],a=i.changes[r],s={};return a&&(!t&&a?t=Object.keys(a):t&&K(t)&&(t=[t]),t.forEach(function(t){o&&t in o?s[t]=o[t]:i.isNewRow(e)&&(s[t]=void 0)}),X(s)&&(i.updateRow(e,s,{initiatorId:n.initiatorId}),X(a)||delete i.changes[r],X(o)||delete i.originals[r],X(i.changes)||i.setHasChanged(!1))),i},getPersonalizationService:function(){var t="_personalizationService",n=this[t];return n||(n=this[t]=e.personalization.createModelService(this)),n},notifyEditorsOfDataRefresh:function(e){!function(e,t){t||(t={});var n={};r.each(e,function(e,t){t.registeredFields&&r.each(t.registeredFields,function(){t.unregisterField(this)}),t.registeredItems&&r.each(t.registeredItems,function(){this.destroy()}),t.registeredLists&&r.each(t.registeredLists,function(){this.render({doNotCache:!0})}),t.registeredEditors&&r.each(t.registeredEditors,function(e,t){t._GUID in n||(n[t._GUID]=t)})}),r.each(n,function(t,n){n.handleDataRefresh&&n.handleDataRefresh({updatedModels:e})});var i={},o=A+"loaded",s={event:o,models:i,initiatorId:t.initiatorId};r.each(e,function(e,n){i[n.id]=n,n.publish("loaded",{modelId:n.id,model:n,initiatorId:t.initiatorId})}),a(o,[s])}([this],e)},exportData:function(t){t||(t={});var n=new Date,i=(t.fileName||this.id+"-export-"+n.getTime())+".csv",r=this.makeCSVFromModelData(t),o=e.utils.inPlatform(c.LIGHTNING)?"application/octet-stream":"text/csv";return q().downloadStringAsFile(r,i,o)},makeCSVFromModelData:function(e){var t=this,n=t.getIdField(),i=t.isAggregate,o=e.additionalConditions||!1,a=e.rows||t.data,s=(e.fields||t.fields).slice(0),l=a.length,c=s.length,d=e.useAPINamesForHeaders||!1,u=e.doNotAppendRowIdColumn||!1,f=!i&&!u,h="";if(c>0&&l>0){var g={},m=[];r.each(s,function(e,t){t.name?g[t.name]=t:t.id&&(g[t.id]=t)}),f&&n&&n in g&&(f=!1),f&&n&&(f=(r.isArray(n)?n:[n]).filter(function(e){return!(e in g)}).length>0),r.each(s,function(e,n){if(n.displaytype&&n.displaytype===p){var i=n.name?n.name:n.id,r=q().getFieldReference(i,n);if(!(r in g)&&r in t.fieldsMap){var o=t.getField(r);d||(o.label=q().mergeAsTextInContext(n.label+": "+o.label,{model:t})),m.push({atIndex:e+1,id:r,field:o})}}}),m.length&&r.each(m,function(e,t){s.splice(t.atIndex,0,t.field),c++}),f&&n&&r.each(r.isArray(n)?n:[n],function(e,n){if(n in g)return!0;t.getField(n)?s.push(t.getField(n)):s.push({id:n,name:n,label:n}),c++}),s.forEach(function(e,n){var i=d?e.name?e.name:e.id:q().mergeAsTextInContext(e.label,{model:t});h+=q().escapeCSVCell(i)+(n<c-1?",":"\r\n")}),a.forEach(function(e){var n=!0;o&&o.length&&(n=q().doesRowMeetConditions(e,o)),n&&s.forEach(function(n,i){var r,o=n.name?n.name:n.id,a=n.template,s=n.type===E;s&&a&&(a="{{#"+o+".records}}"+n.template+",{{/"+o+".records}}"),r=t.getFieldValue(e,o,!0),s||!r&&0!==r&&!1!==r?t.getField(o)&&!s||!a?r="":(r=t.mergeRow(e,a).text(),s&&r&&(r=r.substring(0,r.length-1))):r=""+r,h+=""===r?r:q().escapeCSVCell(r),h+=i<c-1?",":"\r\n"})})}return h},getSOQL:function(){return this.getQuery()},getQuery:function(){return this.lastQueryString||this.soql},getLastQueryDuration:function(){return this.lastQueryDuration},getConditionsWithDependencies:function(e){var t=[],n=this.conditions;return n&&n.length&&n.forEach(function(n){var i=n.subConditions;("modelmerge"!==n.type||e&&n.model!==e.id)&&("modelmerge"!==n.locationSource||e&&n.locationModel!==e.id)?"join"===n.type&&i&&i.length&&i.forEach(function(n){("modelmerge"!==n.type||e&&n.model!==e.id)&&("modelmerge"!==n.locationSource||e&&n.locationModel!==e.id)||t.push(n)}):t.push(n)}),t},getDependentConditions:function(){var e=this,t={};return r.each(n.list(),function(n,i){if(e!==i){var r=i.getConditionsWithDependencies(e);r&&r.length&&(t[i.id]=r)}}),t},updateDataSourceUserInfoConditions:function(){var e=this;function t(n){var i=n.subConditions;"datasourceuserinfo"===n.type?e.updateConditionValue(n):i&&i.length&&i.forEach(t)}return[e.conditions,e.havings,e.uiOnlyConditions].forEach(function(e){e&&e.length&&e.forEach(t)}),e},getConditionByName:function(e,t){var n,i,o,a,s=this,l=[],c=Array.prototype.push;if(r.each([s.conditions,s.havings,s.uiOnlyConditions],function(e,t){t&&t.length&&c.apply(l,t)}),l.length)for(o=0;o<l.length;o++){if((n=l[o]).name===e)return n;if(t&&n.subConditions&&n.subConditions.length)for(a=0;a<n.subConditions.length;a++)if((i=n.subConditions[a]).name===e)return i}return!1},hasCondition:function(e){return!1!==this.getConditionByName(e,!0)},addCondition:function(e,t){var n,i,r=this;return!e||e instanceof Ae||(e=new Ae(e)),r.conditions.push(e),!1!==r.getDataSourceType().prop("initializeConditionLogic")?(t&&"or"==t.toLowerCase()||(t="AND"),n="("+r.conditions.length+")",r.conditionLogic&&""!==r.conditionLogic?(i="and"===t.toLowerCase()&&-1===r.conditionLogic.toLowerCase().indexOf("or"),r.conditionLogic=(i?"":"(")+r.conditionLogic+(i?"":")")+t+n):r.conditionLogic=n,e):e},initialize:function(e){return ue(this,e),this},register:function(e){return V[e||this.id]=this,this.registerKeyPrefix(),this},registerKeyPrefix:function(){var e,t=this.keyPrefix;t&&((e=G[t])||(e=G[t]=[]),-1===r.inArray(e,this)&&e.push(this))},unregister:function(){var e,t=this,n=G[t.keyPrefix];return[N,_].forEach(function(e){var n=t[e];n&&n.length&&(n.forEach(function(e){e.unsubscribe()}),t[e].length=0)}),delete V[t.id],n&&-1!==(e=r.inArray(t,n))&&(n.splice(e,1),n.length||delete G[t.keyPrefix]),t},evaluateFormulaField:function(t,n){K(n)&&(n=this.getField(n));var i,r,o=n.__compiledFormula,a={model:this,row:t},s={outputType:n.displaytype};return o||(i=(o=n.__compiledFormula=new e.formula.CompiledFormula(n.formula||"")).__error)&&(r=i.location.start,this.getParentPage().addProblem('Syntax error in formula field "'+n.id+'" at line '+r.line+", column "+r.column+": "+i.message+".")),o.evaluate(a,s)},evaluateFormulaFields:function(e){e||(e={});var t,n,i=this,o={},a=e.updatedRows||i.getRows(),s=e.preventTrackChanges;return a.length&&(t={_ignoreMetadata:!0},s&&(t.notify=!1),n={},i.fields&&r.each(i.fields,function(e,t){t.calculated&&t.uiOnly&&(o[t.id]=t,r.each(a,function(e,r){var o=i.getRowId(r),a=n[o],s=i.getFieldValue(r,t.id,!0),l=i.evaluateFormulaField(r,t);(q().isDate(s)&&q().isDate(l)?s.getTime()!==l.getTime():s!==l)&&(a||(a=n[o]={}),a[t.id]=l)}))}),X(n)&&(t.preventTrackChangesSecondTime=s,i.updateRows(n,t),s&&(r.each(n,function(e){var t=i.changes[e],n=i.originals[e];t&&(r.each(t,function(e){e in o&&delete t[e]}),X(t)||delete i.changes[e]),n&&(r.each(n,function(e){e in o&&delete n[e]}),X(n)||delete i.originals[e])}),X(i.changes)||i.setHasChanged(!1)))),i},_cloneRowsIfNeeded:function(t){var n,i,o,a=this,s=!1;if(!a.isAggregate&&(Y(t)&&(t=a.getParentPage()||e.component.getByType("skuidpage")[0]),!0===a.doClone?s=!0:!1!==a.doClone&&(i=e.page.getParameters(t),o=i.id,!Y(i.clone)&&o&&a.conditions.length&&r.each(a.conditions,function(e,t){if(("param"===t.type||"fieldvalue"===t.type)&&t.value===o)return a.doClone=s=!0,!1;if("modelmerge"===t.type&&t.model){var n=ye(t.model),i=n&&n.getFirstRow(),r=i?n.getRowId(i):null,l=n?n.realToFakeIdMap:null;if(i&&(r===o||l&&l[o]===r))return a.doClone=s=!0,!1}})),s&&a.data&&a.data.length)){a._invalidateDataIndices(),a.realToFakeIdMap||(a.realToFakeIdMap={}),a.data.forEach(function(e){var t=a.getRowId(e),n=a.realToFakeIdMap[t]="clone_"+j++,i=a.getRecordForRow(e);i?i.setId(n):i=new Ne(a,e,n),i.markNew().markCloned(),a.getDataSourceType().name===d&&(e.Id=n)}),a._generateDataIndices();var l={};a.conditions&&r.each(a.conditions,function(e,t){var n=t.field,i=t.value,o=a.getField(n);if(o&&o.createable&&(-1!==n.indexOf(".")||!i&&!1!==i&&0!==i||r.each(a.data,function(e,t){n in t||(t[n]=i)}),o.displaytype===p&&"modelmerge"===t.type&&t.model)){var s=ye(t.model);s&&s.realToFakeIdMap&&(l[n]=s)}}),a.fields&&r.each(a.fields,function(e,t){if(t.displaytype===p){var n=[];l[t.id]?n.push(l[t.id].realToFakeIdMap):r.each(t.referenceTo,function(e,t){var i=G[t.keyPrefix];i&&i.length&&r.each(i,function(e,t){t.realToFakeIdMap&&n.push(t.realToFakeIdMap)})}),n.length&&r.each(a.data,function(e,i){r.each(n,function(e,n){if(i[t.id]in n)return i[t.id]=n[i[t.id]],!1})})}}),n=function(){var e={},t=a.fields,n=a.data;n&&n.length&&t&&t.length&&r.each(n,function(n,i){var o={};r.each(t,function(e,t){o[t.id]=a.getFieldValue(i,t.id,!0)}),e[a.getRowId(i)]=o}),a.updateRows(e,{alwaysAddChanges:!0,notifyFields:!1})},!0===t.isRendered?n():t.element.one("pageload",function(){n()})}},_checkIfNeedDefaultRow:function(){if(this.data&&this.data.length<1&&!0===this.createRowIfNoneFound&&(!this.doQuery||this.doQuery&&this.lastLoadTime))return!0},_createDefaultRowIfNeeded:function(){if(this._checkIfNeedDefaultRow())return delete this.createRowIfNoneFound,this.createRow()},_createDefaultRowIfNeededAsync:function(){return this._checkIfNeedDefaultRow()?(delete this.createRowIfNoneFound,this.createRowAsync()):r.Deferred().resolve().promise()},_checkIfDefaultRowCreationNeedsToBeAsync:function(){var e=this.getDataSourceType();return!!this._checkIfNeedDefaultRow()&&(!(!e||!e.determineIfCreateRowNeedsMetadata)&&e.determineIfCreateRowNeedsMetadata(this))},getRecordForRow:function(e){if(!e)throw"No row provided";return e[B]},_generateDataIndices:function(){var e=this,t=e.dataMap,n=e.recordsMap,i=e.data;return t||(e.dataMap=t={}),n||(e.recordsMap=n={}),i&&i.length&&i.forEach(function(i){var r,o,a;r=q().isString(i)?{value:i}:i,(o=e.getRecordForRow(r))||(o=new Ne(e,r)),a=o.id(),t[a]=r,n[a]=o}),e},storeSubscription:function(e){return this[_].push(e),this},publish:function(e,t,n){var i,o,s=n&&n.channel,l="model."+e,c=this.getParentPage(),d=this[D],u=q().rfc4122v4GUID(),f={scope:R.MODEL,uniqueId:u},p={scope:R.PAGE,uniqueId:u},h={uniqueId:u};return Y(t)&&(t={model:this,modelId:this.id}),i=r.isArray(t)?t:[t],o=n&&n.scope?n.scope:R.PAGE,h.scope=o,s&&[f,p,h].forEach(function(e){e.channel=s}),q().setObjectProperty(this[M],e,t),d.publish(e,i,f),o!==R.MODEL&&(c&&c.publish(l,i,f),o!==R.SKUID&&o!==R.GLOBAL||a(l,i,h)),this},subscribe:function(e,t,n){var i,r={scope:R.MODEL};return n&&n.channel&&(r.channel=n.channel),i=this[D].subscribe(e,t,r),this.storeSubscription(i),i},countEventSubscribers:function(e){return this[D].count(e)},once:function(e,t,n){var i,o=r.Deferred(),a=this,s=a[M],l=!(n&&!1===n.cache),c=q().getObjectProperty(s,e),d=this[D],u=function(e){t&&t(a,e),o.resolve(a,e)};return l&&c?u(c):(i=d.subscribeOnce(e,function(t){q().setObjectProperty(s,e,t),u(t)}),this.storeSubscription(i)),o.promise()},subscribeOnce:function(e,t){return this.once(e,t,{cache:!1})},setHasChanged:function(e){this.hasChanged=e},fieldIsSearchableServerSide:De},r.extend(Me,{cancel:we,getMoreData:ke,initialize:ue,load:Se,register:function(e,t){var n;return(n=t instanceof Me?t:new Me(t)).register(e),n},save:be,sync:Ie,unregister:function(e){var t;if(t=K(e)?ye(e):e)return t.unregister(),t},update:Ce}),r.extend(n,{Condition:Ae,Field:Ee,Method:Fe,Model:Me,Record:Ne,getModel:ye,getModelsByKeyPrefix:function(e){return G[e]},getModelsByName:ve,getModelsByDataSource:function(e){var t={};return r.each(V,function(n,i){var r=i.dataSource&&i.dataSource.name;t[r]||(t[r]=[]),e&&e!==r||t[r].push(i)}),void 0!==e?t[e]:t},getModelList:me,list:me,map:ve,getConditionCookieName:J,getModelsList:me,getNewId:fe,isNewId:function(e){return!(K(e)&&(15===e.length||18===e.length))},cancel:Me.cancel,getMoreData:Me.getMoreData,initializeModel:Me.initialize,load:Me.load,registerModel:Me.register,save:Me.save,sync:Me.sync,unregisterModel:Me.unregister,updateData:Me.update}),e.$M=ye}(skuid)},function(e,t,n){"use strict";!function(e){var t,n=e.$,i=e.utils,r=i.getInvokable,o=r(n,"Deferred"),a=r(n,"each"),s=r(n,"map"),l=i.mergeAsTextInContext,c=i.getObjectProperty,d=i.setObjectProperty,u=i.parseAsJSONIfString,f=function(e){var t={},n=p(e);return a(n,function(e,n){n.synonym&&(t[n.synonym]=n)}),t},p=function(e){return e.fieldsMap?e.fieldsMap:(e.fieldsMap=i.keyBy(e.fields,"id"),e.fieldsMap)};t=e.dataSource.utils={convertRequestObjToKey:function(e){return e.requestUri.split(".").join("\\.")},convertToNumber:function(e){var t=1*e;return isNaN(t)?0:t},mergeThenURLEncode:function(e,t,n){return encodeURIComponent(l(e,t,n))},getModelMergeConditions:function(e,t,n){t=t||{model:e},n=n||{};var i=e.conditions,r={},o={},s=!1!==n.urlEncode;return i&&i.length?(a(i,function(e,t){r[t.sourceParam||t.name]=t}),a(r,function(e,n){if(void 0!==n.value&&!n.inactive){var i=l(n.value||n.values&&n.values.join(",")||"",t);s&&(i=encodeURIComponent(i)),o[e]=i}}),o):o},applySynonym:function(e,t){var n=p(t),r=f(t);a(r,function(t,n){e[n.id]=c(e,t)}),a(e,function(t,r){var o,s,l,d,u="";n[t]&&(l=n[t].makeFlatList)&&r&&r.length&&(o=l.delimiter,s=l.fieldPath,d=i.isUndefined(l.space)?" ":l.space,o||(o=";"),s?a(r,function(e,t){if(t){var n=c(t,s);u&&(u+=o+d),u+=n+""}}):u=r.join(o+d),e[t]=u)})},revertSynonym:function(e,t){var n=p(t),r=f(t);a(e,function(t,r){var o,s,l,c,u,f=[];if(n[t]&&(l=n[t].makeFlatList)&&r&&i.isString(r)){if(!(r=r.replace(/\s/g,"")))return;o=l.delimiter,s=l.fieldPath,o||(o=";"),c=r.split(o),a(c,s?function(e,t){t&&(d(u={},s,t),f.push(u))}:function(e,t){t&&f.push(t)}),e[t]=f}}),a(r,function(t,n){e[n.id]&&(d(e,t,e[n.id]),delete e[n.id])})},getActionsStatic:function(e,n,i){return t.deferrable(this.createActions(e,n,i))},getEntityListStatic:function(e){return t.deferrable(s(this.prop("x-metadata"),function(t,n){if(!1!==t.queryable&&(!t.hidden||e.ignoreHidden)&&"__skuid_fieldDefaults"!==n)return{value:n,label:t.label}}))},makeLabelFromId:function(e){var t=e.replace(/\./g," ").replace(/_/g," ").split(/(?=[A-Z]|\s)/);var n=[],i=0,r=!1;return a(t,function(e,t){(t=function(e){if(e)return e[0].toUpperCase()+e.substring(1)}(t.trim()))&&(r?1===t.length?n[i]+=t:(r=!1,n[++i]=t):(i++,1===t.length&&(r=!0),n[i]=t))}),(n=s(n,function(e){if(e)return e})).join(" ")},queryEntityMetadataStatic:function(e){var i=this.getEntityMetadataCacheKey(e),r=this.prop("x-metadata"),s=r&&r[i],l=r&&r.__skuid_fieldDefaults,c=o();return s?(a(s.fields,function(e,r){l&&(r=s.fields[e]=n.extend({},l["*"],l[i],r)),r.createable=r.createable||r.writeable,r.editable=r.editable||r.writeable,r.label||(r.label=t.makeLabelFromId(r.id))}),c.resolve(s)):c.reject()},parseSuccessfulLoadResponseWithSynonyms:function(e,i,r){var o=u(e.body),a=i.pathToContent,s=a?c(o,a):o;return n.isArray(s)||(s=[s]),t.safeEach(s,function(e,n){t.applySynonym(n,r)}),s},parseSuccessfulSaveResponseWithSynonyms:function(e,n){var i,r,o=n.method,a=n.model,s=u(e.body);if(o&&a&&s)return r=(i=o.pathToContent)?c(s,i):s,t.applySynonym(r,a),r},safeEach:function(e,t){e instanceof Object&&a(e,t)},trimEmptyParameters:function(e){var t={};return a(e,function(e,r){i.isObject(r)&&n.isEmptyObject(r)||n.isArray(r)&&0===r.length||""!==r&&void 0!==r&&null!==r&&(t[e]=r)}),t},applyAccessTokenAsParam:function(e,t,n){-1===e.request.url.indexOf(n+"=")&&(-1===e.request.url.indexOf("?")?e.request.url+="?"+n+"="+t.access_token:e.request.url+="&"+n+"="+t.access_token)},downloadWithLink:function(e,t){var i=document.createElement("a");document.body.appendChild(i),i.style="display: none",i.href=t,i.target="__blank",i.download=e,i.click(),n(i).remove()},makeAWSRequest:function(t,n,i){var r={url:"/core/data/aws",type:"POST",headers:{"x-skuid-data-source-name":t}},o={method:n};return i&&(o.body=i),r.body=o,r.contentType="application/json",e.ajax.direct(r).then(function(e){return e.body},function(e){var t=u(e.body);return t?t.message:e.status})},compose:function(){var e,t=(e=arguments,Array.prototype.slice.call(e||[])).reverse();return function(e){return a(t,function(t,n){e=n(e)}),e}},deferrable:function(e){return e&&i.isPromise(e)?e:o().resolve(e).promise()},rejectable:function(e){return o().reject(e).promise()},extrapolateRowFromContext:function(e){return e.row?e.row:e.rows&&e.rows.length?e.rows[0]:e.model&&e.model.getFirstRow()?e.model.getFirstRow():void 0}}}(skuid)},function(e,t,n){"use strict";var i,r=n(0),o=(i=r)&&i.__esModule?i:{default:i};!function(e){var t,n,i=e.$,r=i(document.body),a=e.utils,s=window.applicationCache,l=e.label.read,c=e.constants,d=e.data.localStorage,u=e.offline={},f="There are no saves to sync.",p="Syncing cancelled",h=i('<div class="sk-offline-sync">'+l("saving_offline_changes","Saving your offline changes...")+"</div>"),g=a.grab,m=function(){return e.storage.getDb(o.default.id)instanceof e.storage.IndexedDB},v=e.settings,y=e.events,b=y.Event,w={scope:c.EVENT_SCOPES.GLOBAL,onlyGlobal:!0},S=y.subscribe,C=y.publish,I=u.networkDown=function(){return"disconnected"===u.state},k=u.isEnabled=function(){return!A&&v.offline&&!0===v.offline("enabled")},x=function(){u.setState("disconnected"),e.events.publish("network.disconnected"),u.reconnect.reset(),d.setItem("skuidStayOffline",!0)},T=function(t,n){n=n||e.component.getByType("skuidpage")[0];return e.snippet.register("offline.saveFailedSyncs",function(){return e.storage.getDb(o.default.id).getTable("saves").all().then(function(t){var n=e.model.map(),r=i.map(n,function(e){if(e.id.indexOf("OfflineSavesFor__")>-1)return e}),s=z(t);return i.map(r,function(e){var t=e.getDataSourceName(),n=s[t];i.map(n.operations,function(t){e.objectName===t.type&&i.map(e.changes,function(e,n){var r=!1;a.size(e)||(r=!0),t.updates[n]&&(r?delete t.updates[n]:t.updates[n]=i.extend(t.updates[n],e)),t.inserts[n]&&(r?delete t.inserts[n]:t.inserts[n]=i.extend(t.inserts[n],e)),t.deletes[n]&&r&&delete t.deletes[n]})})}),e.storage.getDb(o.default.id).getTable("saves").clear().then(function(){return i.when.all(i.map(s,function(t,n){return e.storage.getDb(o.default.id).getTable("saves").add(n,{data:t})}))}).then(function(){i.map(r,function(e){e.changes={},e.originals={},e.hasChanged=!1,e.notifyEditorsOfDataRefresh()})})})}),e.storage.getDb(o.default.id).getTable("saves").all().then(function(r){if(r.length){var o=[],s=[],l=i("<div>").attr("title","Pending Offline Saves"),c=i("<div>").css("min-height","300px").appendTo(l);i.map(r,function(t){var n=t.id;i.map(t.data.operations,function(t){var r=e.$M(t.id),s=new e.model.Model({id:"OfflineSavesFor__"+t.id,fields:r?r.fields:i.map(t.returning,function(e){return{id:e}}),updateable:!0,deleteable:!0,objectName:t.type,label:t.id,labelPlural:t.id,extensions:t.extensions,dataSource:e.dataSource.get(n)}).initialize().register();if(o.push(s),t.inserts){var l=i.map(t.inserts,function(e,t){return e[s.getIdField()]=t,e});s.adoptRows(l,{doAppend:!0})}var c=void 0;a.size(t.updates)&&(r?(c=i.map(t.updates,function(e,t){return r.getRowById(t)}),s.adoptRows(c,{doAppend:!0}),i.map(t.updates,function(e,t){var n=s.getRowById(t);s.updateRow(n,e),s.changes[t]=e})):(c=i.map(t.updates,function(e,t){return e.id=t,e}),s.adoptRows(c,{doAppend:!0})));var d=void 0;a.size(t.deletes)&&r&&(d=i.map(t.deletes,function(e,t){return r.getRowById(t)}),s.adoptRows(d,{doAppend:!0}),s.deleteRows(d)),a.size(t.insertResultErrors)&&i.map(t.insertResultErrors,function(e){i.map(e.errors,function(t){console.error(t.message+" -- in row with id ("+e.id+") in model ("+e.source+")")})}),a.size(t.updateResultErrors)&&i.map(t.updateResultErrors,function(e){i.map(e.errors,function(t){console.error(t.message+" -- in row with id ("+e.id+") in model ("+e.source+")")})}),a.size(t.deleteResultErrors)&&i.map(t.deleteResultErrors,function(e){i.map(e.errors,function(t){console.error(t.message+" -- in row with id ("+e.id+") in model ("+e.source+")")})})})});var d="";i.map(o,function(t){var n,r=i.map(t.fields,function(e){return a.isObject(e)&&(e=e.id),'<field id="'+e+'" allowordering="false"/>'}).join(""),o='\n<skootable model="'+t.id+'" pagesize="50" mode="readwrite" searchbox="false" showexportbuttons="true" showsavecancel="false" createrecords="false">\n\t<fields>'+r+'</fields>\n\t<rowactions>\n\t\t<action type="edit"/>\n\t\t<action type="delete"/>\n\t</rowactions>\n</skootable>\n';d+='<condition type="fieldvalue" enclosevalueinquotes="false" fieldmodel="'+t.id+'" sourcetype="modelproperty" nosourcerowbehavior="deactivate" sourceproperty="hasChanged" value="true" operator="="/>',n=e.component.factory({xmlDefinition:o}),s.push(n)});var u='\n<buttonset>\n\t<buttons>\n\t\t<button type="multi" label="Save" uniqueid="sk-3T9i-399">\n\t\t\t<actions>\n\t\t\t\t<action type="custom" snippet="offline.saveFailedSyncs"/>\n\t\t\t</actions>\n\t\t\t<renderconditions logictype="and"/>\n\t\t\t<enableconditions logictype="or">\n\t\t\t\t'+d+"\n\t\t\t</enableconditions>\n\t\t</button>\n\t\t"+(t?"":'\n\t\t\t<button type="multi" label="Re-Attempt Sync">\n\t\t\t\t<actions>\n\t\t\t\t\t<action type="closeTopmostPopup"/>\n\t\t\t\t\t<action type="offline-syncing"/>\n\t\t\t\t</actions>\n\t\t\t</button>\n\t\t')+"\n\t</buttons>\n</buttonset>\n",f=e.component.factory({xmlDefinition:u});c.append(f.element),i.map(s,function(t){var n=t.element.model,i=e.component.factory({xmlDefinition:'\n<pagetitle model="'+n.id+'">\n\t<maintitle>{{Model.label}}</maintitle>\n\t<actions/>\n</pagetitle>\n'});c.append(i.element),c.append(t.element)}),l.dialog({close:function(){l.dialog("close").remove(),i.map(s,function(e){e.unregister&&e.unregister()}),i.map(o,function(e){e.unregister()})},modal:!0,resizable:!0,width:"90%"}),e.events.publish("popup.created",{popupElement:l,component:n})}})},R=u.getSetting=function(e){return v.offline&&v.offline(e)},D=function(){return!R("syncAutomatically")&&R("syncDefaultStatusBarEnabled")},A=!1,E=e.dataSource.EntityMetadata,F="network.connected",N="network.disconnected",M="network.sync.started",_="network.sync.cancelled",P="network.conflicts",O="network.cancel.conflicts",L="network.send.conflicts",U="network.sync.success",B="network.sync.failure",j="network.sync.complete",V=u.reconnect={reset:function(){V.state&&"inactive"!==V.state&&clearInterval(t),V.state="inactive",V.remaining=10},timer:function(){if("connecting"!==V.state)return V.remaining-=1,0===V.remaining?V.checkNow():void 0},checkNow:function(){if("waiting"===V.state)return V.state="connecting",u.check()}};function G(e){return a.delay(a.runningTests()?1:e)}u.setState=function(e){u.state=e},u.getState=function(){return u.state},u.setState("connected"),u.shouldStayOffline=function(){return"true"===d.getItem("skuidStayOffline")};var H=!1;function z(e){var t={};return i.each(e,function(e,n){t[n.id]=n.data}),t}function q(){C(M,{syncElement:h})}function $(e){C(j),h.text(l("send"===e?"saved":"cancelled")),G(2e3).then(function(){h.animate({opacity:"0"},{duration:500,complete:function(){h.css({bottom:"-35px",opacity:"1"}),h.detach()}})})}function W(t){if(t!==f)return t===p?(C(_,{syncElement:h,message:t}),G(2e3).then(function(){h.animate({opacity:"0"},{duration:500,complete:function(){h.detach()}})})):void(t!==f&&(e.model.Model.prototype.addPageProblems([t]),h.text("Failed..."),C(B,{syncElement:h,error:t}),G(2e3).then(function(){h.animate({opacity:"0"},{duration:500,complete:function(){h.detach()}})})));h.detach()}u.init=function(){if(!u.initiated&&!a.inPlatform([c.LIGHTNING])){u.initiated=!0;var t,s=e.ui.createIcon("sk-icon-refresh",{ariaLabel:"Retry Connection"}),d=l("currently_offline")+'<span tabindex=0 class="sk-offline-retry">'+s+"</span>",f=l("reconnecting"),p=function(e){return e.preventDefault(),t.html(f),u.shouldStayOffline()?u.check():V.checkNow()},g=function(e){if(13===e.which)return n.find(".sk-offline-retry").click(),!1},m=function(e){e=e||{},(t=n.find(".sk-offline-content")).html(d),I&&r.prepend(n),n.removeClass("sk-offline-connected").addClass("sk-offline-disconnected"),n.find(".sk-offline-retry").on("click",p),n.find(".sk-offline-retry").on("keypress",g),e.noFadeIn?(n.css("top",0),r.find(".sk-headerwrapper-fixed").css("top","20px"),r.css("padding-top","20px")):(n.animate({top:"0"},500),r.find(".sk-headerwrapper-fixed").animate({top:"20px"},500),r.animate({"padding-top":"20px"},500))},v=function(e){var t=0;return e.length?(i.each(e,function(e,n){var r=n.data.operations;i.each(r,function(e,n){i.each(n.updates,function(){t++}),i.each(n.inserts,function(){t++}),i.each(n.deletes,function(){t++})})}),t):t},y=function(){if(D())return e.storage.getDb(o.default.id).getTable("saves").all().then(function(e){if(e&&e.length){var t=v(e);b(t)}})},b=function(e){u.setState("disconnected"),n.css("display","inline-block"),(t=n.find(".sk-offline-content")).html("You have "+e+' unsaved change(s) across your pages. <span class="sk-offline-retry">Begin Syncing Process</span>'),r.css("padding-top","20px"),r.find(".sk-headerwrapper-fixed").css("top","20px"),n.css("top",0),I&&r.prepend(n),t.find(".sk-offline-retry").on("click",function(e){e.preventDefault(),r.css("padding-top","0"),r.find(".sk-headerwrapper-fixed").css("top",0),n.detach(),I=!0,h.text(l("saving_offline_changes")),w=!1,u.check().then(function(){return w=!0,u.sync({action:!0})})}),a.runningTests()&&C("showSyncsWaitingToBeSavedBar")},w=!0,I=!0;(n=r.find(".sk-offline")).length||(n=i('<div role="alert" class="sk-offline"><div class="sk-offline-content">'+d+"</div></div>")),n.addClass("sk-offline-"+e.offline.state),S(F,function(){if(w)return(t=n.find(".sk-offline-content")).html(f),G(500).then(function(){return n.removeClass("sk-offline-disconnected").addClass("sk-offline-connected"),t.html(l("connected")),C("network.connected.marked"),G(1e3)}).then(function(){(D()?e.storage.getDb(o.default.id).getTable("saves").all().then(function(e){return v(e)}):i.when(!1)).then(function(e){if(e)return C("network.disconnected.stay",{savesToShow:e});r.animate({"padding-top":"0"},400),r.find(".sk-headerwrapper-fixed").animate({top:0},400),n.animate({top:"-20px"},{duration:400,complete:function(){n.detach(),I=!0}})})})}),u.shouldStayOffline()&&x(),"disconnected"===u.state?m({noFadeIn:!0}):y(),S(N,m),S("network.disconnected.confirmed",function(){(t=n.find(".sk-offline-content")).html()===f&&G(500).then(function(){t.html(d),n.find(".sk-offline-retry").on("click",p),n.find(".sk-offline-retry").on("keypress",g)})}),S("network.disconnected.stay",function(e){return H=!0,e.savesToShow?b(e.savesToShow):y()})}},u.check=function(t){if(!u.shouldCheck)return a.resolve();var n=function(){"connected"!==u.state&&(u.setState("connected"),C(F),a.inPlatform([e.constants.LIGHTNING])&&C("network.connected.marked"))};return t?e.platform.services.checkNetwork().then(n):e.platform.services.checkNetwork().then(n).catch(function(){C("network.disconnected.confirmed"),H=!1,u.setState("disconnected"),C(N)})},u.initiateServiceWorker=function(){return a.grab(window,"navigator","serviceWorker","register")&&a.inPlatform(c.NATIVE)&&!e.platform.isCordova()&&u.isEnabled()&&!a.runningTests()?(navigator.serviceWorker.addEventListener("message",function(e){"refresh"===e.data.command&&window.location.reload()}),navigator.serviceWorker.register("/sw.js").then(function(){if(!navigator.serviceWorker.controller)return navigator.serviceWorker.ready.then(function(){window.location.reload()})}).catch(function(e){console.log(e)})):i.when()},u.startEverything=function(){return u.init(),u.isEnabled()?e.offline.check():i.when()},s&&(s.addEventListener("updateready",function(){if(s.status==s.UPDATEREADY)try{s.swapCache(),confirm("A new version of this site is available. Load it?")&&window.location.reload()}catch(e){}}),s.addEventListener("obsolete",function(){window.location.reload()})),S(N,function(){V.reset(),V.state="waiting",t=setInterval(V.timer,1e3)}),S("network.disconnected.confirmed",function(){"connecting"===V.state&&(V.state="waiting",V.remaining=10)}),S(F,function(){u.state="connected",t&&clearInterval(t),V.reset()}),u.shouldCheck=!0,u.disable=function(e){A=e},u.load=function(t,n){if(n=n||{},!m())return a.resolve();var r=[];return i.when.all(i.map(t,function(t){return e.storage.getDb(o.default.id).getTable("entityData").get({objectName:t.objectName,dataSource:n.dataSource,conditions:t.conditions,data:{fields:t.fields,orderByClause:t.orderByClause,conditionLogic:t.conditionLogic}})})).then(function(e){return i.when(u.populateDataSourceMetadata(),u.populateMetadata()).then(function(){return e})}).then(function(n){var s=[],l=[];return i.each(n,function(n,c){var d;c&&a.size(c.data)?(d=i.extend({},c.data,{cachedData:!0,dataSourceName:c.dataSource}),s.push(d)):(d=t.filter(function(t){return e.storage.getDb(o.default.id).getTable("entityData").schema.buildIdField({objectName:t.objectName,dataSource:t.dataSource,conditions:t.conditions,data:{fields:t.fields,orderByClause:t.orderByClause,conditionLogic:t.conditionLogic}})===c.id})[0])&&l.push(d),d&&r.push(d)}),u.populateSaves(s)}).then(function(){return r})},u.save=function(t,n){var r=i.Deferred(),a=n.dataSource.name,s=t.operations,l={deleteResults:[],updateResults:[],insertResults:[],globalErrors:[]},c=function(e,t){l[e].push(i.extend({errors:[],messages:[],success:!0},t))};return i.each(s,function(t,n){n.originals||(n.originals={}),i.each(n.updates,function(t){n.originals[t]=e.$M(n.id).originals[t]})}),e.storage.getDb(o.default.id).getTable("saves").get(a).then(function(n){return n?(i.each(t.operations,function(e,t){var r=n.data.operations,o=r.find(function(e){return e.id===t.id});o?(i.each(t.deletes,function(e,t){var n=o.inserts[e];delete o.updates[e],delete o.originals[e],n?delete o.inserts[e]:o.deletes[e]=t}),i.each(t.updates,function(e,n){var r=o.updates[e],a=o.inserts[e];a?(i.extend(a,n),delete t.originals[e]):r?i.extend(r,n):o.updates[e]=n}),i.each(t.inserts,function(e,t){o.inserts[e]=t}),i.each(t.originals,function(e,t){var n=o.originals[e];n?i.extend(n,t):o.originals[e]=t})):r.push(t)}),e.storage.getDb(o.default.id).getTable("saves").add(a,{data:n.data}).then(function(){C("offline.saved"),r.resolve()})):e.storage.getDb(o.default.id).getTable("saves").add(a,{data:t}).then(function(){C("offline.saved"),r.resolve()}),i.each(t.operations,function(e,t){var n=t.id;i.each(t.deletes,function(e){c("deleteResults",{id:e,record:null,source:n})}),i.each(t.updates,function(e,t){c("updateResults",{id:e,record:JSON.stringify(t),source:n})}),i.each(t.inserts,function(e,t){c("insertResults",{id:e,oldId:e,record:JSON.stringify(t),source:n})})}),H&&C("network.disconnected.stay"),l})},u.getValidMetadataCache=function(t){return u.networkDown()?t:i.grep(t,function(t){var n=e.dataSource.get(t.dataSource),i=n?n._metadataCacheVersion:0;return function(e,t,n){return!(!g(e,"cacheStamp","cacheVersion")||e.cacheStamp.cacheVersion!==n||e.cacheStamp.userLang&&a.userInfo.language!==e.cacheStamp.userLang||0===t||null===t||e.cacheStamp.addedAt<t)}(t,i,n&&i&&g(n,"dataSourceType","getMetadataCacheVersion")?n.dataSourceType.getMetadataCacheVersion():0)})},u.populateMetadata=function(){if(!m()||u.populatedMetadata||a.onPageBuilder())return a.resolve();var t={};return e.storage.getDb(o.default.id).getTable("entityMetadata").all().then(function(n){if(n){var r=e.dataSource.map();n=(n=u.getValidMetadataCache(n)).sort(function(e,t){return(e=new Date(e.createdAt))>(t=new Date(t.createdAt))?-1:e<t?1:0}),i.each(n,function(e,n){var r=n.data,o=r.fields,a=n.id.split("--"),s=a[0],l=a[1],c=t[s];c?c&&!c[l]?t[s][l]=r:i.each(o,function(e,n){c[l].fields.filter(function(e){return n.id===e.id}).length||t[s][l].fields.push(n)}):(t[s]={},t[s][l]=r)}),i.each(r,function(e,n){var r=n.entityMetadataCache,o=t[e];a.size(r)?a.size(r)&&a.size(o)&&i.each(r,function(e,t){var n=t._unwrap();if(o[e]){var a=o[e].fields;i.each(a,function(e,t){(n.fields&&n.fields.filter(function(e){return t.id===e.id})).length||n.fields.push(t)}),r[e]=new E(n)}}):i.each(o,function(e,t){n.entityMetadataCache[e]=new E(t)})}),u.populatedMetadata=!0}})},u.populateDataSourceMetadata=function(){return!m()||u.populatedDataSourceMetadata?a.resolve():e.storage.getDb(o.default.id).getTable("dataSourceMetadata").all().then(function(t){var n=e.dataSource.map();i.each(n,function(e,n){var i=t.filter(function(t){return t.id===e})[0];i&&(n.metadata=i.data)}),u.populatedDataSourceMetadata=!0})},u.populateSaves=function(t){var n=[];return i.each(t,function(t,r){var a=i.Deferred();n.push(a.promise()),e.storage.getDb(o.default.id).getTable("saves").get(r.dataSourceName).then(function(t){if(!t)return a.resolve(r);var n=t.data.operations.filter(function(e){return e.type===r.objectName})[0];if(n){var o=e.$M(n.id);if(!o)return a.resolve(r);i.each(n.deletes,function(e){var t=r.data.findIndex(function(t){return o.getRowId(t)===e});t>-1&&r.data.splice(t,1)}),i.each(n.updates,function(e,t){var n=r.data&&r.data.find(function(t){return o.getRowId(t)===e});n&&i.extend(n,t)}),i.each(n.inserts,function(e,t){var n=r.data;t[o.getIdField&&o.getIdField()]=e,n.unshift(t)})}a.resolve(r)})}),i.when.all(n)},u.sync=function(t){t=t||{};var n,s,c=!1!==R("syncAutomatically"),d=!0===R("syncInteractionRequired"),u={},g={},m=[],v=t.action;return A||!v&&!c?i.when():(t.reAttempt?e.storage.getDb(o.default.id).getTable("syncedSaves").get(t.reAttempt).then(function(e){return i.map(e.data,function(e){return e})}):e.storage.getDb(o.default.id).getTable("saves").all()).then(function(n){return n&&n.length?t.reAttempt?n:e.storage.getDb(o.default.id).getTable("syncedSaves").add((new Date).toString(),{data:n}).then(function(){return n}):i.Deferred().reject(f).promise()}).then(function(e){return g=z(e),r.append(h),d?(t=i.Deferred(),h.text("Begin syncing changes made offline?"),h.append('<a href="#" class="sk-offline-send">'+l("start")+'</a><a href="#" class="sk-offline-cancel">'+l("cancel")+"</a>"),h.find("a").on("click",function(e){var n=e.target.classList;h.remove("a"),n.contains("sk-offline-send")?(h.text(l("saving_offline_changes")),t.resolve()):n.contains("sk-offline-cancel")&&(h.text("Cancelled..."),t.reject(p))}),h.animate({bottom:"30px"},{duration:500}),q(),t.promise()):function(){var e=i.Deferred();return h.text(l("saving_offline_changes")),h.animate({bottom:"30px",opacity:"1"},{duration:500,complete:function(){e.resolve()}}),q(),e.promise()}();var t}).then(function(){return e.loader.service.loadDataSourcesAndDependencies(i.map(g,function(e,t){return t}))}).then(function(){var t=[];return i.each(g,function(n,r){var o=e.dataSource.get(n),s=o.dataSourceType;i.each(r.operations,function(n,r){if(r.updates&&Object.keys(r.updates).length){var l=s.prop("offline.createConditionsForConflicts"),c=new e.model.Model({dataSource:o,id:a.generateUniqueId({prefix:"sk-offline"}),conditions:a.isFunction(l)?l(r):[],label:r.type,objectName:r.type,fields:i.map(r.returning,function(e){return{id:e}}),extensions:r.extensions});s.coerceConflictModel&&s.coerceConflictModel(c,r),c.initialize(),t.push(c)}})}),(t.length?e.model.load(t):i.when()).then(function(){return t}).catch(function(){return t})}).then(function(t){return u=function(t,n){var r={};return i.each(t,function(t,o){var s=e.dataSource.get(t).name,l=o.operations,c={};i.each(l,function(e,t){if(a.size(t.originals)){var o=n.find(function(e){return s===e.getDataSourceName()&&t.type===e.objectName}),l=o&&o.objectName,d=c[l];if(!o)return;i.each(t.originals,function(e,n){var r=o.getRowById(e);i.each(n,function(i,o){r[i]!==o&&r[i]!==t.updates[e][i]&&(d||(d={}),d[e]={},d[e].update=t.updates[e],d[e].original=n)})}),a.size(d)&&(r[s]||(r[s]={}),r[s][l]=d)}})}),r}(g,n=t),a.size(u)?function(e){var t,n=i.Deferred();return h.addClass("sk-offline-conflicts").text("Conflicts detected. Your changes may not be the most recent."),h.append('<a href="#" class="sk-offline-send">'+l("save_anyway")+'</a><a href="#" class="sk-offline-cancel">'+l("cancel")+"</a>"),h.find("a").on("click",function(e){var i=e.target;i.classList.contains("sk-offline-send")?(t="send",h.text(l("saving_offline_changes","Saving your offline changes..."))):i.classList.contains("sk-offline-cancel")&&(t="cancel",h.text("Canceling...")),h.remove("a"),h.removeClass("sk-offline-conflicts"),n.resolve(t)}),C(P,{syncElement:h,conflicts:e}),n.promise()}(u):i.when("send")}).then(function(t){return"cancel"===(s=t)?function(t,n){var r=e.model.list();i.each(t,function(e,t){i.each(t,function(t,o){var a=n.find(function(n){return n.objectName===t&&e===n.getDataSourceName()}),s=r.filter(function(n){return n.objectName===t&&e===n.getDataSourceName()});i.each(s,function(e,t){var n=!1;i.each(o,function(e){var i=a.getRowById(e);if(i){var r=a.getRecordForRow(i).get(),o=t.getRowById(a.getRowId(i));n=!0,t.updateRow(o,r,{notify:!0,notifyFields:!1,preventTrackChanges:!0})}}),n&&t.notifyEditorsOfDataRefresh()})})}),C(O,{syncElement:h,conflicts:t})}(u,n):"send"===s?function(t,n,r){var o=i.extend({},t),s=i.map(t,function(t,n){return e.dataSource.get(n).save(t).then(function(e){return e.dataSourceName=n,e})});return i.when.all(s).then(function(e){var t=e;if(i.map(t,function(e){var t=[],n=e.dataSourceName;i.map(e.insertResults,function(e){e.success?i.map(o[n].operations,function(t){e.source===t.id&&delete t.inserts[e.oldId]}):(i.map(e.errors,function(e){r.push(e.message)}),-1===i.inArray(e.source,t)&&t.push(e.source),i.map(o[n].operations,function(t){t.insertResultErrors=t.insertResultErrors||{},e.source===t.id&&(t.insertResultErrors[e.oldId]=e)}))}),i.map(e.updateResults,function(e){e.success?i.map(o[n].operations,function(t){e.source===t.id&&(delete t.updates[e.id],delete t.originals[e.id])}):(i.map(e.errors,function(e){r.push(e.message)}),-1===i.inArray(e.source,t)&&t.push(e.source),i.map(o[n].operations,function(t){t.updateResultErrors=t.updateResultErrors||{},e.source===t.id&&(t.updateResultErrors[e.id]=e)}))}),i.map(e.deleteResults,function(e){e.success&&i.map(o[n].operations,function(t){e.source===t.id&&delete t.deletes[e.id]})}),t.length?o[n].operations=i.map(o[n].operations,function(e){if(i.inArray(e.id,t)>-1)return e}):delete o[n]}),a.size(o))return o;a.size(n)&&C(L,{syncElement:h,results:t,conflicts:n}),C(U,{syncElement:h,results:t})})}(g,u,m):i.when()}).then(function(n){return t.reAttempt?$(s):n?e.storage.getDb(o.default.id).getTable("saves").clear().then(function(){return i.when.all(i.map(n,function(t,n){return e.storage.getDb(o.default.id).getTable("saves").add(n,{data:t})})).then(function(){var e,t=i.Deferred();return h.addClass("sk-offline-conflicts").text("Errors occurred while syncing.. Resolve now?"),h.append('<a href="#" class="sk-offline-send">Resolve</a><a href="#" class="sk-offline-cancel">'+l("cancel")+"</a>"),h.find("a").on("click",function(n){var i=n.target;i.classList.contains("sk-offline-send")?(e="resolve",h.text(l("saving_offline_changes","Saving your offline changes..."))):i.classList.contains("sk-offline-cancel")&&(e="cancel",h.text("Canceling... Resync to resolve at a later time.")),h.remove("a"),h.removeClass("sk-offline-conflicts"),t.resolve(e)}),C(B,{syncElement:h,saveRequests:n}),t.promise()}).then(function(e){return"resolve"===e?(h.detach(),h.css({bottom:"-35px"}),T()):$()})}):(e.storage.getDb(o.default.id).getTable("saves").clear(),$(s))}).catch(W)},u.addActions=function(){return v.offline&&v.offline("enabled")?[{value:"-",label:"",disabled:!0},{value:"-",label:"Offline mode actions",disabled:!0},{value:"offline-syncing",label:function(){return"Sync Changes Made Offline"}},{value:"go-online",label:function(){return"Enable Online Mode"}},{value:"go-offline",label:function(){return"Disable Online Mode"}},{value:"show-pending-syncs",label:function(){return"Show Pending Offline Saves"}}]:[]},u.runAction=function(t,n,i,r){switch(t){case"offline-syncing":return R("syncDefaultStatusBarEnabled")&&k()&&I()?u.check(!0).then(function(){return u.sync({action:!0,context:r})}).catch(function(){return a.resolve()}):k()&&!I()?u.sync({action:!0,context:r}):a.resolve();case"go-online":return d.removeItem("skuidStayOffline"),u.check().then(function(){if("connected"!==u.getState())throw"Still disconnected";e.offline.setState("connected"),e.events.publish("network.connected"),e.offline.reconnect.reset()});case"go-offline":return x();case"show-pending-syncs":return T(n,i)}},y.register([new b(F,"Network: Connected",[],w),new b(N,"Network: Disconnected",[],w),new b(M,"Offline Syncing: Started",[],w),new b(P,"Offline Syncing: Conflicts Detected",[],w),new b(O,"Offline Syncing: Cancelled with Conflicts",[],w),new b(L,"Offline Syncing: Approved with Conflicts",[],w),new b(U,"Offline Syncing: Successful",[],w),new b(B,"Offline Syncing: Failed",[],w)]),S(F,function(){var t=u.sync;return e.platform.forceSessionActivity?e.platform.forceSessionActivity().then(t,function(){e.platform.attemptLogin(0,!1,t)}):t()}),i(window).off("offline.skuid").on("offline.skuid",function(){u.check()})}(skuid)},function(e,t,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=a(n(7)),o=a(n(0));function a(e){return e&&e.__esModule?e:{default:e}}!function(e){var t=e.dataSource||(e.dataSource={}),n={},a=e.utils,s=e.data,l=e.$,c=l.extend,d=e.constants,u=d.MIME_TYPES.FORM_URL_ENCODED,f=d.SALESFORCE,p=a.isString,h=a.mergeAsTextInContext,g=a.contains,m=a.isUndefined,v=a.startsWith,y="skuidDataSourceMetadata",b={},w="_m",S="skuidOAuth",C=x("$Auth",["BasicAuth","Client_Id","Client_Secret","Password","Username"]),I=x("$User",["Email","FederationId","FirstName","Id","LastName","Username"]),k={firstname:"firstName",lastname:"lastName",userid:"userId",username:"userName"};function x(e,t){var n={};return t.forEach(function(t){n[t]="{{"+e+"."+t+"}}"}),n}function T(e,t){var n=e.authentication,i=e.name,r=n.authMethod;return r?a.startsWith(r,"oauth")?i+(t?"::"+t:""):"apex"===r?i:void 0:n.url}function R(t){return n[t||e.platform.getDefaultDataSourceName()]}function D(){return c({},n)}function A(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t={};return l.map(n,function(n){var i=n.getDataSourceTypeName(),r=t[i];r||(r=t[i]=e?[]:{}),e?r.push(n):r[n.name]=n}),t}function E(){return l.map(n,function(e){return e}).sort(function(e,t){var n=e.label||e.name,i=t.label||t.name;return n.localeCompare(i)})}function F(){return JSON.parse(s.localStorage.getItem(S)||"{}")}function N(t){var i=t.name,r=t.dataSourceTypeName;c(this,t),this.customConfig&&(this._c=this.customConfig,delete this.customConfig),this.dataSourceType=e.dataSource.getType(r||e.platform.getDefaultDataSourceTypeName()),this.entityMetadataCache={},this._cache={},this._hasBatchCaches={},this.dataSourceType&&this.dataSourceType.initializeDataSource&&this.dataSourceType.initializeDataSource(this),n.hasOwnProperty(i)||(n[i]=this)}function M(e){return e&&0!==e.length?e.length>1?e:1===e.length?e[0]:void 0:null}function _(e){this[w]=c(!0,{},e),this._isFull=!1}_.prototype={update:function(e){var t=this,n=this[w];n||(n=this[w]={}),delete this._fm,l.each(e,function(i,r){if(!e.hasOwnProperty(i))return!0;if(n.hasOwnProperty(i))if("fields"===i){var o=t.getFieldsMap({noCache:!0,onlyIdKey:!0});l.each(r,function(e,t){var n=t.id,i=o[n];i?l.each(t,function(e,t){null!==t&&void 0!==t&&(i[e]=t)}):o[n]=t}),n.fields=(a=o,l.map(a,function(e){return e}))}else n[i]=r;else n[i]=r;var a})},get:function(e){var t=this[w];if("string"==typeof e)return t[e];if(e instanceof Array){var n={};return l.each(e,function(e,i){n[i]=t[i]}),n}},getLabel:function(){return this[w].label},getLabelPlural:function(){return this[w].labelPlural},getPluralLabel:function(){return this.getLabelPlural()},getEntityName:function(){return this[w].objectName},getObjectName:function(){return this[w].objectName},getFieldsList:function(){return this[w].fields||[]},getSortedFieldsList:function(){var e=a.capitalizeFirst;return this.getFieldsList().slice().sort(function(t,n){var i=e(t.label||t.id)||"",r=e(n.label||n.id)||"";return i<r?-1:i>r?1:0})},getFieldsMap:function(e){var t=e&&e.noCache,n=e&&e.onlyIdKey,i=this.getFieldsList(),r=n?"id":["id","name"];return t?a.keyBy(i,r):(this._fm||(this._fm=a.keyBy(i,r)),this._fm)},getField:function(e){return this.getFieldsMap()[e]},getChildRelationshipsList:function(){return this[w].childRelationships||[]},getExtensions:function(e){var t=this[w].extensions||{};return e?a.getObjectProperty(t,e):t},_getCRMap:function(){return this._crm||(this._crm=a.keyBy(this[w].childRelationships,"relationshipName")),this._crm},getChildRelationship:function(e){return this._getCRMap()[e]},_unwrap:function(){return this[w]},setIsFullMetadata:function(){return this._isFull=!0,this},isFullMetadata:function(){return this._isFull}},N.prototype={save:function(t){var n=e.offline,i=this.dataSourceType.prop("neverCache");return n.isEnabled()&&n.networkDown()&&!i?n.save(t,{dataSource:this}):this.dataSourceType.save(t,{dataSource:this})},load:function(t,n){n=n||{};var i=this,r=e.offline,a=e.storage,s=i.dataSourceType.prop("neverCache");return r.isEnabled()&&r.networkDown()&&!s?r.load(t,c({},n,{dataSource:i})):i.dataSourceType.load(t,c({},n,{dataSource:i})).then(function(e){return!r.isEnabled()||s?e:(l.each(e,function(e,n){var r=t.filter(function(e){return e.id===n.id})[0];if(!r||!1!==r.doQuery){var s=l.extend({},n);r&&!s.fields&&(s.fields=r.fields),r&&!s.conditions&&(s.conditions=r.conditions);try{s=JSON.parse(JSON.stringify(s))}catch(e){s.data=r?r.getRawRows():l.map(s.data,function(e,t){delete t.__skuid_record__})}a.getDb(o.default.id).getTable("entityData").add(null,{dataSource:i,objectName:s.objectName||r&&r.objectName,data:s,conditions:s.conditions})}}),e)})},getRowId:function(e,t){var n;try{n=this.dataSourceType.getRowId(e,t,this)}catch(e){}return(m(n)||null===n)&&(n=a.generateUniqueId()),n},getIdField:function(e){var t=this.dataSourceType;return t&&t.getIdField?t.getIdField(e):null},getIdFieldForChildRelationship:function(e,t){var n=this.dataSourceType;return n&&n.getIdFieldForChildRelationship?n.getIdFieldForChildRelationship(e,t):null},getKeyPrefix:function(e,t){var n=this.dataSourceType.getKeyPrefix;return n&&n(e,t,this)||e+"__"+this.name},getValueKeyPrefix:function(e,t,n){var i=this.dataSourceType.getValueKeyPrefix;return i&&i(e,t,n,this)||t+"__"+this.name},getRowName:function(e,t){return this.dataSourceType.getRowName(e,t,this)},getNameField:function(e,t){return this.dataSourceType.getNameField(e,this,t)},getConditionSourceProperties:function(e,t){var n=this.dataSourceType.getConditionSourceProperties;return n&&n(e,t)},getDataSourceType:function(){return this.dataSourceType},getDataSourceTypeName:function(){return this.dataSourceType&&this.dataSourceType.name},getEntityList:function(){return this.dataSourceType.getEntityList({dataSource:this})},search:function(e,t,n){var i=this;return e.dataSource||(e.dataSource=this),i.authenticate().then(function(){return i.dataSourceType.search(e,t,n)})},searchableEntities:function(){return this.dataSourceType.searchableEntities()},getFieldRenderers:function(){return!!this.dataSourceType.fieldRenderers&&this.dataSourceType.fieldRenderers()},getReferenceFieldRelationshipName:function(e,t){var n=this.dataSourceType.getReferenceFieldRelationshipName;if(n)return n(e,t)},getActions:function(e,t){var n=this,i=n._cacheService().getCachedValue("actionsMetadata");return i?(a.isFunction(i)&&(i=i(n,e,t)),l.Deferred().resolve(i).promise()):n.dataSourceType.getActions(n,e,t).then(function(e){return n._cacheService().setCachedValue("actionsMetadata",e),e})},_cacheService:function(){var e=this,t="inMemoryOnly",n="sessionStorage",i="localStorage";function r(t){var n=e._cache[t];return n||(n=e._cache[t]={})}function o(e,n,i){var o=r(i=i||t);a.setObjectProperty(o,e,n)}function c(t,n){t=t||i;var r=e._cache[t];return r||(r=e._cache[t]=function(t){return d(t)[e.name]}(t)||{}),n?a.getObjectProperty(r,n):r}function d(e){return e!==n&&(e=i),JSON.parse(s[e].getItem(y)||"{}")}function u(t,r){t!==n&&(t=i);var o=d(t);o[e.name]=r,s[t].setItem(y,JSON.stringify(o))}function f(e,n){var i=function(e){var n=r(t);return a.getObjectProperty(n,e)}(e);return m(i)&&(i=c(n,e)),i}return{setPersistentCachedValue:function(t,n,i){o(t,n,i);var r=c(i);return a.setObjectProperty(r,t,n),u(i,r),e},setPersistentCachedValues:function(t,n){var i=c(n);return l.each(t,function(e,t){o(e,t,n),i[e]=t}),u(n,i),e},setCachedValue:function(t,n){return o(t,n),e},setCachedValues:function(t){return l.each(t,function(e,t){o(e,t)}),e},batchCacheValue:function(t,n,r){e._hasBatchCaches[r||i]=!0,o(t,n,r||i)},persistBatchedCaches:function(t){t=t||i,e._hasBatchCaches[t]&&(!function(e){u(e,c(e))}(t),e._hasBatchCaches[t]=!1)},getCachedValue:f,getCachedValues:function(e,t){var n={};return e.forEach(function(e){n[e]=f(e,t)}),n}}},batchCacheProperty:function(e,t,n){return this._cacheService().batchCacheValue(e,t,n)},persistBatchCache:function(e){return this._cacheService().persistBatchedCaches(e)},getCacheProperty:function(e,t){return this._cacheService().getCachedValue(e,t)},getCacheProperties:function(e,t){return this._cacheService().getCachedValues(e,t)},setCacheProperty:function(e,t){return this._cacheService().setCachedValue(e,t),this},setCacheProperties:function(e){return this._cacheService().setCachedValues(e),this},setPersistentCacheProperty:function(e,t,n){return this._cacheService().setPersistentCachedValue(e,t,n),this},setPersistentCacheProperties:function(e,t){return this._cacheService().setPersistentCachedValues(e,t),this},clearPropertiesCache:function(){var e=this.name;return this._cache={},["localStorage","sessionStorage"].forEach(function(t){var n=s[t].getItem(y);n&&(n=JSON.parse(n))[e]&&(delete n[e],s[t].setItem(y,JSON.stringify(n)))}),this},unregister:function(){var t;return(t=this.name)!==e.platform.getDefaultDataSourceName()&&delete n[t],this},runAction:function(e,t,n,i){return this.dataSourceType.runAction(e,t,n,i,this)},getConfigProperty:function(e){return a.getObjectProperty(this._c||{},e)},getUploadMethod:function(e){var t=this.getUploadMethods(),n=t&&t[e];return n?(n.dataSource=this,new function(e){c(this,e)}(n)):null},getUploadMethods:function(){var e=this.getDataSourceType();return e.getUploadMethods?e.getUploadMethods(this):{}},getImageSources:function(){var t=this.getDataSourceType(),n=t.getImageSources?t.getImageSources(this):{},i={label:"URL",optionalRecordContext:!0,getSrc:function(t){var n=l.Deferred(),i=t.context,r=t.mergeSettings,o=t.prefix||"",s=t.url||(t.definition?t.definition[o+"url"]:t.xmlDef.attr(o+"url")),c=a.getSafeRelativeUrl(a.mergeAsTextInContext(s,i,r));return e.platform.isCordova()&&-1===c.indexOf("http")&&(c=e.native.instanceUrl+c),c?n.resolve(c):n.reject(),n.promise()},builderProps:function(e,t,n){var i=n.additionalOnRefresh;return[{id:(n.prefix||"")+"url",label:"Image URL",type:"template",location:"attribute",onChange:function(){e.refresh(),i&&i()}}]}};return n.url=i,n||{}},getImageSource:function(e){this.name===f&&"external"===e&&(e="url");var t=this.getImageSources(),n=t&&t[e];return n?(n.dataSource=this,new function(e){c(this,e)}(n)):null},buildEntityMetadataRequest:function(e){var t=this.dataSourceType.buildEntityMetadataRequest(e);return t.dataSource=this,t},getEntityMetadataLoadingMessageFromBreadcrumb:function(e){return this.dataSourceType.getEntityMetadataLoadingMessageFromBreadcrumb(e)},prefillMetadataForObject:function(e,t){var n=this.dataSourceType.prefillMetadataForObject;n&&n({object:e,data:t,dataSource:this}),this.cacheEntityMetadata(this.getEntityMetadataCacheKey(e),t)},populateBreadcrumbFromEntityMetadata:function(e){var t=this.getDataSourceType().populateBreadcrumbFromEntityMetadata;return t?(e.dataSource=this,t(e)):e.crumb},getModels:function(){var t=this;return e.model.list().filter(function(e){return e.getDataSource()===t})},getEntityMetadataCacheKey:function(e){var t=this;return a.isString(e)?e:t.dataSourceType.getEntityMetadataCacheKey?(e.dataSource||(e.dataSource=t),t.dataSourceType.getEntityMetadataCacheKey(e)):void 0},reloadModels:function(e){var t=this,n=t._reloadModelsRequest,i=function(){delete t._reloadModelsRequest};return n||(t._reloadModelsRequest=a.delay(10).then(function(){return l.when.all(t.getModels().filter(function(t){return!t.hasChanged&&(!e||e(t))}).map(function(e){return e.updateData()}))}).then(i,i))},cacheEntityMetadata:function(t,n){var i=this,r=e.storage,s=a.onPageBuilder();if(1===arguments.length&&a.size(arguments[0]))return l.map(arguments[0],function(e,t){return i.cacheEntityMetadata(t,e)});var c=i.entityMetadataCache,d=c[t];if(d?d.update(n):d=c[t]=new _(n),!s&&(function(){var t=e.offline;if(t.isEnabled()&&!t.networkDown())return!0}()||i.dataSourceType.clientSideCacheIsEnabled&&i.dataSourceType.clientSideCacheIsEnabled(i))){var u=i.dataSourceType.getMetadataCacheVersion?i.dataSourceType.getMetadataCacheVersion(i):0,f=i.buildCacheStamp(u);r.getDb(o.default.id).getTable("entityMetadata").add(null,{dataSource:i,objectName:t,data:d._unwrap(),cacheStamp:f})}return d},getCachedEntityMetadata:function(e){var t,n=this,i=n.entityMetadataCache;return e?(t=e.entities?e.entities:a.isString(e)?[{objectName:e}]:[e],l.isArray(t)||(t=[t]),M(l.map(t,function(e){return i[n.getEntityMetadataCacheKey(e)]}))):i},clearEntityMetadataCache:function(){return this.entityMetadataCache={},this},buildCacheStamp:function(e){var t={addedAt:Date.now(),cacheVersion:e},n=this.dataSourceType.dataSourceProvidesLanguageDetails();return n&&(t.userLang=n),t},processEntityMetadataRequests:function(e){var t,n,i=e.entities,r=e.results,o=this.getDataSourceType().processEntityMetadataRequest;if(o){for(n=[],t=0;t<i.length;t++){var a=r[t];a?n.push(o({entity:i[t],result:a})):n.push(null)}return n}return r},getEntityMetadata:function(e){var t,n,i=this,r=l.Deferred(),o=e.entities,a=e.ignoreCache||!1,s=[],c=[],d=function(){r.resolve(M(c))};return o&&(l.isArray(o)||(o=[o]),l.each(o,function(e,n){try{n.dataSource=i}catch(e){}t=null,a||(t=i.getCachedEntityMetadata(n)),t&&t.isFullMetadata()?c.push(t):s.push(n)})),s.length?(n={entities:s,dataSource:i,ignoreCache:a},i.dataSourceType.getEntityMetadata(n).then(function(e){c=l.map(i.processEntityMetadataRequests({entities:s,results:e}),function(e,t){return i.cacheEntityMetadata(i.getEntityMetadataCacheKey(s[t]),e).setIsFullMetadata()}),d()},function(e){r.reject(e)})):d(),r.promise()},createHTTPRequest:function(e){e||(e={});var t,n,i=this.authentication,r=c({},this.requestHeaders,e.headers),o={},s=c({model:e.model,row:e.row},e.apiExtensions,e.context),d=this.requestBodyParameters,u=e.url,f=g(u,"?"),m=e.contentType,v=e.body,y=c({},this.requestUrlParameters||{},e.parameters||{});return i&&i.success&&(s.$Auth=l.extend({},C,{Response:{Body:i.responseBody,Headers:i.responseHeaders}}),s.$User=l.extend({},I)),l.each(y,function(e,t){e&&t&&(f?u+="&":(u+="?",f=!0),u+=e+"="+encodeURIComponent(h(t,s,{createFields:!1})))}),u=h(u,s,{createFields:!1}),l.each(r,function(e,t){var n=t&&p(t)?h(t,s,{createFields:!1}):t;o[e]=n}),(d&&a.size(d)||v&&a.size(v))&&(m&&g(m,"json")&&l.isPlainObject(v)?(n={},d&&c(n,d),v&&c(n,v)):n=v),t={url:u,headers:o,method:e.method,modelDataSource:this.name,originalRequest:e},n&&(t.contentType=m,t.body=n),t.method||(t.method=n?"POST":"GET"),e.accept&&(t.accept=e.accept),i&&i.success&&(t.isAuthenticated=!0),t},makeRequest:function(t,n){var i=this,r=i.name,o=t.hasOwnProperty("useProxy")?t.useProxy:i.useProxy,s=e.ajax[o?"proxy":"direct"],c=t.originalRequest;function d(e){return s.call(i,e||i.createHTTPRequest(c),n)}var u=l.Deferred();return d(t).done(function(e){return u.resolve(e)}).fail(function(n){var o,s=i.authentication;return function(n){if(v(n,"Invalid Request: Unauthorized endpoint")){var o=i.authentication&&i.authentication.url,s="To make this request, a System Administrator for this Organization will need to configure a Remote Site Setting for this Data Source in Salesforce Setup.",l=!e.page.runningOnForceSite&&e.utils.userInfo.isAuthenticated,c=i.serviceUrl||"",d="SkuidDS_"+i.name.replace(/[\W]+/g,"");if(o&&t.url===a.mergeAsTextInContext(o)&&(c=t.url,d=d.replace("SkuidDS_","SkuidDSAuth_")),l){if(window.confirm(s+"\n\nWould you like to do that now?\n")){var u=window.location.href+"",f=u.substring(u.indexOf("/",u.indexOf("//")+2),u.length);a.redirect({url:"/0rp/e?"+a.param({setupid:"SecurityRemoteProxy",IsActive:1,saveURL:f,cancelURL:f,EndpointUrl:c,SiteName:d.length>40?d.substring(0,40):d,DescriptionField:'Needed to make requests to Skuid Model Data Source "'+r+'"'})})}}else window.alert(s+"\n\nPlease add a Remote Site Setting for the following URL:\n\n"+c);return!0}return!1}(n.error)||401!==n.statusCode&&403!==n.statusCode||s&&"basicauth"===s.method?u.reject(n):(s.success?(i.invalidateAuthentication(),o=i.authenticate()):i.getPendingAuthenticationRequest()&&(o=i.getPendingAuthenticationRequest()),o?void o.then(function(){d().done(function(e){return u.resolve(e)}).fail(function(t){if(401!==t.statusCode&&403!==t.statusCode)return u.reject(t);i.logout().authenticate().then(function(){d().done(function(e){return u.resolve(e)}).fail(function(t){return e.platform.isPlatformSessionError(t.message,i)&&e.platform.attemptLogin(),u.reject(t)})})})},function(e){return u.reject(e)}):u.reject(n))}),u.promise()},processModelXMLExtensions:function(e,t){var n=this.getDataSourceType(),i=e.extensions={};l.each(t.attr(),function(e,t){if(!v(e,"x-"))return!0;i[e.slice(2)]=t}),t.children().each(function(e,t){var n=t.nodeName;if(!v(n,"x-"))return!0;n=n.slice(2),(i[n]||(i[n]=[])).push(function e(t){var n={};return l.each(t.attr(),function(e,t){n[e]=t}),t.children().each(function(t,i){var r=i.nodeName;(n[r]||(n[r]=[])).push(e(l(i)))}),n}(l(t)))}),n&&n.processModelXMLExtensions&&n.processModelXMLExtensions(e,t)},getPendingAuthenticationRequest:function(){return b[T(this)]},isAuthenticated:function(){var e=this.authentication;return!e||e.success},getStoredAuthData:function(e){return a.getObjectProperty(F(),this.name+(e?"."+e:""))},setStoredAuthData:function(e){var t=F();return a.setObjectProperty(t,this.name,e),s.localStorage.setItem(S,JSON.stringify(t)),t},removeStoredAuthData:function(){var e=F(),t=e[this.name];return delete e[this.name],s.localStorage.setItem(S,JSON.stringify(e)),t},authenticate:function(){var t=this,n=t.name,o=t.getDataSourceType(),s=t.authentication,d=l.Deferred(),f=t.useProxy,g=s&&s.hasOwnProperty("useProxy")?s.useProxy:f,m=void 0,y=void 0,w=void 0,S=void 0,I=void 0,k=void 0,x=void 0,R=void 0,D=void 0,A=void 0,E=void 0,F=void 0,N=void 0,M=void 0,_=void 0;function P(e,t){e&&a.size(e)&&l.each(e,function(n,r){p(r)?e[n]=h(r,t):"object"===(void 0===r?"undefined":i(r))&&P(r,t)})}function O(e){var t,n=[];return p(e)?t=e:e&&e.error?p(e.error)?t=e.error:e.error&&e.error.message&&(t=e.error.message):e&&e.body&&(p(e.body.error)&&n.push(e.body.error),p(e.body.message)&&n.push(e.body.message),p(e.body.description)&&n.push(e.body.description),t=n.join(": ")),d.reject(t||"Authentication Failed"),d.promise()}function L(){var e;return!o.getUserInfo||s&&s.responseBody&&s.responseBody.userInfo?d.resolve(s):o.getUserInfo(t).then(function(n){n&&((e=s.responseBody)||(e=s.responseBody={}),e.userInfo=n,t.setStoredAuthData(e)),t.getModels().forEach(function(e){e.updateDataSourceUserInfoConditions()}),d.resolve(s)}).catch(function(e){!e||403!==e.statusCode&&401!==e.statusCode?d.reject(e):(t.invalidateAuthentication(),t.authenticate().then(function(e){d.resolve(e)}).catch(function(){t.logout(),t.authenticate().then(function(e){d.resolve(e)}).catch(function(e){d.reject(e)})}))}),d.promise()}function U(){var i=s.providerType,r={force:!1},o=e.oauth(n),d=o?o.getAuthResponse():null,u=(s.defaultScopes||"").split(","),p={},h={id:s.clientId,name:n,type:i},g={},m={};if(d&&d.error&&t.logout(),l.each(u,function(e,t){t&&!p[t]&&(p[t]=1)}),a.size(p)&&(r.scope=Object.keys(p).join(",")),f||(s.grantType="implicit"),"implicit"!==s.grantType&&"client_credentials"!==s.grantType&&(r.response_type="code"),o.isSessionValid()||(d&&d.grantType&&d.responseBody&&(d=d.responseBody,t.setStoredAuthData(d.responseBody)),function(e){return e&&e.refresh_token}(d)&&(r.display="none")),R=T(t,r.scope||""),D=b[R])return D.done(L).fail(O);s.url&&(g.auth=s.url),s.tokenUrl&&(g.grant=s.tokenUrl),"code"===r.response_type&&(g.response_type="code"),a.size(g)&&(h.oauth=g),m[n]=c(!0,{},e.oauth.services[i]||{},h);var v,y=(v=s,e.platform.getOAuthRedirectUri(v));e.oauth.init(m,{redirect_uri:y}),N=e.oauth.login(n,r).then(function(e){s.responseBody=e.authResponse,s.success=!0,L(),delete b[R]},function(e){s.success=!1,O(e),delete b[R]}),b[R]=N}if(s)if(y=s.method,F=s.authMethod,x=s.verb||"POST",m=s.url,_=s.username,E=s.password,m&&v(m,"/")&&t.serviceUrl&&(m=a.combineUrls(t.serviceUrl,m)),s.success)L();else if("separateurl"===y){if(m&&(m=e.utils.mergeAsTextInContext(m)),S={url:m,headers:s.requestHeaders,method:x,modelDataSource:t.name,useProxy:g},w=s.requestBody,R=T(t),D=b[R])return D;I=S.headers,g?(P(I,{$Auth:C}),P(w,{$Auth:C})):(P(I,A={$Auth:l.extend({},C,{Username:_,Password:E})}),P(w,A)),w&&(S.contentType=s.requestBodyContentType||u,S.body=S.contentType===u?a.param(w):JSON.stringify(w)),N=t.makeRequest(S,{buffer:!1}),b[R]=N,N.always(function(){delete b[R]}).done(function(e){s.responseHeaders=e.headers,s.responseBody=a.parseAsJSONIfString(e.body),s.success=!0,L()}).fail(function(e){s.success=!1,O(e)})}else if("basicauth"!==y||f){if("skuidjwtbearer"===y)return k=s.responseBody,t.requestHeaders||(t.requestHeaders={}),t.requestHeaders.Authorization="Bearer {{$Auth.Response.Body}}",k&&r.default.isValid(k)?(s.success=!0,L()):r.default.getAPIToken().then(function(e){return s.responseBody=e.jwt,s.success=!0,L()}).catch(function(e){return s.responseBody=null,s.success=!1,O({error:"Unable to obtain valid Skuid JWT: "+(p(e)?e:e.message)})});if("provider"===y){var B=0===F.indexOf("oauth"),j=s.grantType;if(B&&(M=t.getStoredAuthData())&&M.access_token){if(!(M.expires&&M.expires<(new Date).getTime()/1e3))return s.responseBody=M,s.success=!0,L();t.removeOAuthAccessToken()}if(B&&l.inArray(j,["password","saml2-bearer","client_credentials"])>-1){if(!f)return O("You must connect through the Proxy to use this OAuth grant type."),d.promise();if(S={url:s.tokenUrl,headers:s.requestHeaders,method:x,modelDataSource:n},w=s.requestBody,R=T(t),D=b[R])return D;w&&(S.contentType=s.requestBodyContentType||u,S.body=S.contentType===u?a.param(w):JSON.stringify(w)),N=e.ajax.proxy(S,{buffer:!1}),b[R]=N,N.always(function(){delete b[R]}).done(function(e){s.success=!0,s.responseHeaders=e.headers;var n=a.parseAsJSONIfString(e.body);!n.expires&&n.expires_in&&(n.expires=Math.floor((new Date).getTime()/1e3+(0|n.expires_in||31536e3))),s.responseBody=n,t.setStoredAuthData(n),L()}).fail(function(e){s.success=!1,O(e)})}else if(B)e.oauth?U():a.loadJS(a.getStaticResourceUrl("models/oAuthClient.js","skuid",void 0,a.getCacheTimestamp())).done(function(){e.oauth=window.hello}).done(U);else if("apex"===F){if(S={headers:s.requestHeaders,body:s.providerName,method:"GET",modelDataSource:t.name},R=T(t),D=b[R])return D;N=e.ajax.proxy(S,{buffer:!1}).done(function(e){s.responseHeaders=e.headers,s.responseBody=a.parseAsJSONIfString(e.body),s.success=!0,L()}).fail(function(e){s.success=!1,O(e)}).always(function(){delete b[R]}),b[R]=N.promise()}else s.success=!0,L()}else a.isString(s)||(s.success=!0),L()}else{if(_&&E)return t.requestHeaders.Authorization="Basic "+btoa(_+":"+E),s.success=!0,L();if(!_)return s.success=!1,t.removeStoredAuthData(),O({error:"No Username provided."});if(!E)return s.success=!1,t.removeStoredAuthData(),O({error:"No Password provided."})}else L();return d.promise()},getUserInfo:function(){var e,t=this.authentication,n=t&&t.responseBody;if(t&&(n||(n=t.responseBody=this.getStoredAuthData()),n&&(e=n.userInfo)))return e},getUserInfoProperty:function(e){var t=k[e]||e,n=this.getUserInfo();if(n&&t in n)return n[t]},removeOAuthAccessToken:function(){var e,t=["access_token","expires","expires_in"],n=this.getStoredAuthData();return(e=this.authentication.responseBody)&&t.forEach(function(t){delete e[t]}),n&&this.setStoredAuthData(this.authentication.responseBody),this},invalidateAuthentication:function(){var e,t=this.authentication,n=this.getStoredAuthData();function i(e){e&&l.isPlainObject(e)&&Object.keys(e).forEach(function(t){"refresh_token"!==t&&delete e[t]})}return t&&(e=t.authMethod&&v(t.authMethod,"oauth"),t.success=!1,delete t.responseHeaders,e?(i(t.responseBody),n&&i(n)):delete t.responseBody,n&&this.setStoredAuthData(t.responseBody)),this},logout:function(){var t=this.authentication,n=this.name;if(t&&(t.success=!1,delete t.responseHeaders,delete t.responseBody,t.authMethod&&v(t.authMethod,"oauth")&&"saml2-bearer"!==t.grantType)){var i=e.oauth&&e.oauth(n);i&&i.logout&&i.logout({name:n,options:{force:!0}})}return this.removeStoredAuthData(),this}},c(t,{DataSource:N,EntityMetadata:_,get:R,getDataSource:R,getDataSourceFromXML:function(t,n){var i,r,o=l.extend({useDefault:!0,nodeIdentifierAttribute:"id",allowNullReturn:!1},n);return t&&(i=o.customAttributeName?t.attr(o.customAttributeName):t.attr("datasource")||t.attr("service")),!i&&o.useDefault&&(i=e.platform.getDefaultDataSourceName()),void 0!==(r=i&&R(i))||o.allowNullReturn?r:(e.component.getByType("skuidpage")[0].addProblem(e.label.merge({template:e.$L("invalid_data_source"),data:[t.attr("datasource")||t.attr("service"),t.attr(o.nodeIdentifierAttribute)]})),R())},list:E,listByType:function(){return A(!0)},listDataSources:E,map:D,mapByType:function(){return A()},mapDataSources:D})}(skuid)},function(e,t,n){"use strict";!function(e){var t=e.$.extend,n=e.dataSource||(e.dataSource={}),i={},r=e.$,o=e.utils,a=function(e){if(!1!==e){t(this,e);var n=this.name;if(!n)throw"Data Source Type name is required.";i.hasOwnProperty(n)||(i[n]=this)}};function s(t){return i[t||e.platform.getDefaultDataSourceTypeName()]}function l(){return t({},i)}t(a.prototype,{prop:function(t){return this.properties?e.utils.getObjectProperty(this.properties,t):null},getActions:function(){return e.$.Deferred().resolve({})},runAction:function(t,n,i,r,o){var a=e.$;return r=r||{},o.getActions(o).then(function(s){var l={};e.utils.isFunction(s)&&(s=s(o)),a.isArray(s)?a.each(s,function(e,t){t.disabled||(l[t.name]=t)}):l=s;var c=l[t];return c?r.rows&&!r.row?a.when.all(a.map(r.rows,function(e){var t=a.extend({},r);return t.row=e,c.runtimeExecution(n,i,t,o)})):c.runtimeExecution(n,i,r,o):e.utils.reject("Invalid Data Source Action.")})},getNameFieldURLForReferenceField:function(t,n,i,a){var s,l=t.options.fieldXML,c={model:t.model,row:t.row},d=t.model.getDataSourceType(),u=l&&l.attr("redirecttype")||a,f=o.inPlatform(e.constants.NATIVE),p={},h="page"===u&&l.attr("page"),g="route"===u&&l.attr("route"),m="customurl"===u&&l.attr("window")||"self",v="customurl"===u&&l.attr("rooturl"),y='<a href="',b=!1;if("none"!==u&&u){if("datasourcedefault"===u&&d.getNameFieldURLForReferenceField&&d.getNameFieldURLForReferenceField!==this.getNameFieldURLForReferenceField)return d.getNameFieldURLForReferenceField(t,n,i,a);if("datasourcedefault"!==u)return r.each(l.children("params").children(),function(e,t){var n=r(t);p[n.attr("key")]=o.mergeAsTextInContext(n.attr("value"),c,{createFields:!1,registerFields:!1})}),f&&(h||g)&&(y+='#" onclick="skuid.loader.load('+o.encodeHTML(JSON.stringify({isReplace:!0,pageName:h,parameters:p,routeName:g}))+")",b=!0),"customurl"===u&&(s=o.mergeAsTextInContext(o.applyURLParametersToURL(v,p),c),"self"===m?y+=s:"blank"===m&&(y+=o.encodeHTML(s)+'" target="_blank'),b=!0),b?y+='" tabindex="-1">'+i+"</a>":void 0}},getNameFieldURLForTextField:function(e,t,n){return this.getNameFieldURLForReferenceField(e,n,t,"datasourcedefault")},getDefaultFieldsForReferenceField:function(t,n,i){if(!!(i&&i.dataSourceType&&i.dataSourceType.getNameField))return[e.utils.getFieldReference(t,n,i)]},modelsCanSearch:function(){return!1!==this.prop("canFieldsBeIndividuallySearched")||this.prop("hasDefaultSearch")&&this.prop("canServerSearch")},supportsVoiceCommands:function(){for(var t=["voiceCommands","voiceCommands.methods","voiceCommands.methods.beginConversation","voiceCommands.methods.conversationKillSwitch","voiceCommands.props","voiceCommands.props.page","voiceCommands.props.actionSequence","voiceCommands.props.actionSequence.topLevelProps","voiceCommands.props.actionSequence.shouldHaveInputs"],n=0;n<t.length;n++)if(!e.utils.getObjectProperty(this,t[n]))return!1;return!0},getPageParametersForVoiceCommands:function(t){var n=e.utils.getObjectProperty(this,"voiceCommands.props.page");if(!n)return{};var i=n(),o={};return r.each(i,function(e,n){o[n.id]=t.attr(n.id)}),o},clientSideCacheIsEnabled:function(){return!1},dataSourceProvidesLanguageDetails:function(){return!1}}),t(n,{DataSourceType:a,getAllTypes:l,getAllDataSourceTypes:l,listAllTypes:function(){return r.map(i,function(e){return e}).sort(function(e,t){var n=e.label?e.label:e.name,i=t.label?t.label:t.name;return n.localeCompare(i)})},mapTypes:l,mapDataSourceTypes:l,getType:s,getDataSourceType:s,libraries:{skuid:{}}})}(skuid)},function(e,t,n){"use strict";!function(e,t){var n,i=t(document.body),r=e.utils,o=e.component,a=e.constants,s=o.Component,l=e.events,c=l.Event,d=a.EVENT_SCOPES,u=a.MERGE_CONTEXTS.GLOBAL;function f(t){return t._getCPI().isUserPageAdmin()&&!t.isInclude&&!t.isReplace&&!e.mobile}function p(e){return e.has("isPageInclude")||e.set("isPageInclude",e.getElement().parent().hasClass("nx-include-panel")),e.get("isPageInclude")}n={addProblem:function(t,n){var i=this.problems;e.utils.isString(t)&&(t={message:t}),e.page.displayProblem(t)&&i.push(t),!0!==n&&e.page.updateProblemsWrapper(),e.utils.runningTests()&&e.events.publish("pageProblem.created",t)},addProblems:function(n){var i=this;n instanceof Array?t.each(n,function(e,t){i.addProblem(t,!0)}):i.addProblem(n,!0),e.page.updateProblemsWrapper()},removeProblem:function(e){var t,n=this.problems;if(n&&n.length&&n instanceof Array)for(t=n.length-1;t>=0;t--)if(n[t]===e)return n.splice(t,1)[0]},removeProblems:function(){this.problems.length=0,e.page.updateProblemsWrapper()},unregisterChildComponents:function(){var n=this;return n.childComponents.length&&t.each(n.childComponents,function(){this.unregister()}),t.each(n.getModels(),function(){e.platform.getName()===a.VISUALFORCE&&e.utils.isUndefined(this.processOnClient)&&(n.has("serverSideModelCache")||n.set("serverSideModelCache",[]),n.get("serverSideModelCache").push(this)),this.unregister()}),n.globalFeedback&&n.globalFeedback.unregister(),n.getParentPage()===n&&e.actions.runAction("closeAllPopups"),n},unregister:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=[];if(e.page.rebuildPageProblems(),t.initiatorId){var i=e.component.getById(t.initiatorId);i&&(n=i.get("actionSequences").map(function(e){return e.getId()}))}return(this.get("actionSequences")||[]).forEach(function(e){n.includes(e.getId())||e.unregister()}),s.prototype.unregister.call(this)},getPageRecord:function(){return this._pageRecord},getParameter:function(t){if("string"==typeof t){var n=e.page.getParameters(this);return t in n?n[t]:n[t.toLowerCase()]}},getPageParameters:function(){var t=this._pageParameters;return t||(t=this._pageParameters=e.page._parametersByPage[this.id()]),t},setPageParameters:function(n){var i=this._pageParameters;return i||(i=this._pageParameters=e.page._parametersByPage[this.id()]={}),t.extend(i,n),this},getContentElement:function(){return this.has("contentElement")||this.set("contentElement",t('<div class="nx-page-content">')),this.get("contentElement")},getPanelsElement:function(){return this.has("panelsElement")||this.set("panelsElement",p(this)?this.getParentPage().getPanelsElement():t('<div class="nx-page-panels">')),this.get("panelsElement")},getOriginalTopPadding:function(){var t;return this.has("originalTopPadding")||(t=this.getContentElement(),this.set("originalTopPadding",e.utils.getCSSSizeObj(t.css("padding-top")||"0px"))),this.get("originalTopPadding")}},e.componentType.register("skuidpage",{label:"Skuid Page",onlyRenderOnce:!0,render:function(o,s,c){var h,g,m,v,y,b,w,S,C,I=e?e.page:null,k=c.preventUnloadIfUnsavedChanges="yes"===s.attr("unsavedchangeswarning"),x=s.attr("globalfeedbackenabled"),T=s.attr("hideeditbutton"),R={},D=c._getCPI(),A=e.utils.resolve;function E(){return function(n,r,o,a){return t.when.all(t.map(a,function(e){return e._createDefaultRowIfNeeded()})).then(function(){t.each(a,function(e,t){t._cloneRowsIfNeeded(r)}),t.each(o,function(e,t){delete t.realToFakeIdMap}),e.utils._oniOS()&&e.utils._inIframe()&&t(function(){i.removeClass("sk-scrollfix-ios-body"),t("html").removeClass("sk-scrollfix-ios-html"),i.addClass("sk-scrollfix-ios-body"),t("html").addClass("sk-scrollfix-ios-html")}),"Theme4d"===e.platform.get("SFUITheme")&&i.addClass("sk-body-nopadding")})}(0,c,w,S)}return"true"!==s.attr("useviewportmeta")||e.mobile||t("#sk-meta-viewport").length||t("head").append('<meta id="sk-meta-viewport" name="viewport" content="width=device-width, initial-scale=1">'),c.problems=[],t.extend(c,n),h=c.getContentElement(),g=c.getPanelsElement(),c.getModels=D.getModels,c.getModel=D.getModel,c.panel={create:function(e,t,n){var i=e.attr("uniqueid");return R[i]=c.createChildComponents(e,g,n)[0],R[i]},createFromAction:function(e,t,n){var i=e.children("panel").first(),r=i.attr("uniqueid");return R[r]=c.createChildComponents(i,g,n)[0],R[r]},getById:function(e){return R[e]},_detachById:function(e){R[e]&&delete R[e]},getAll:function(){return t.extend({},R)},closeAll:function(){t.each(R,function(){this.close()})}},function(e,n,i){!e._unsavedChangesHandler&&i&&(e._unsavedChangesHandler=!0,t(window).on("beforeunload.skuid",function(){return e.getUnloadMessage(n)}))}(I,c,k),e.utils.processStylesNode(s.children("styles"),h),function(n,o,a){if("true"===a||!f(o))return!1;var s,l;r.onPageBuilder()||e.platform.isCordova()||(s=t("<div>").prop("id","skuidEditBtnContainer"),l=t("<div>").prop("id","skuidEditBtn").appendTo(s),t("<div>").addClass("inline sk-icon sk-icon-configure").css("margin-right","4px").appendTo(l),t("<div>").addClass("skuidEditButtonLabel").text(e.$L("edit_page")).appendTo(l),s.css("display","block").on("mouseover",function(){s.stop().animate({width:"90px"},400)}).on("mouseleave",function(){s.stop().animate({width:"16px"},400)}).on("click",function(){window.open(e.platform.getPageComposeUrlById(n.id),"_blank")}).appendTo(i))}(I,c,T),function(e,n){if(!f(n))return!1;var i,r,o,a=e.getAllProblems(),s=n.getContentElement();e.problemsIndicator?i=e.problemsWrapper:(i=t("<div>").addClass("nx-page-problems-wrapper clearfix"),r=t("<div>").addClass("nx-page-problems-indicator nx-error").css({display:"inline-block","text-align":"left",padding:"7px"}).click(function(){o.toggle()}),o=t('<div class="nx-page-problems-container">').css({display:"none","white-space":"wrap"}),t.extend(e,{problemsIndicator:r,problemsWrapper:i,problemsContainer:o}),i.append(r,o),s.prepend(i)),a.length?t.each(a,function(){e.displayProblem(this)}):i.css("display","none")}(I,c),function(t,n,r){var o=void 0,a=void 0;!t||t.runningOnForceSite||n.isInclude||n.isReplace||e.mobile||(e.settings&&e.settings.globalFeedback?(a=e.settings.globalFeedback("position"),o=e.settings.globalFeedback("enabled")):(a=e.page.globalFeedbackPosition,o=e.page.globalFeedbackEnabled),o&&"false"!==r&&(n.globalFeedback=new e.globalFeedback.GlobalFeedback({position:a,pageComponent:n,element:i})))}(I,c,x),c.set("actionSequences",e.actionSequences.initializeActionSequences(c)),(v=s.children("models").children()).length&&v.each(function(){var n={_parentPageId:c.id()};c.isReplace&&(n.processOnClient=!0),new e.model.Model(t(this),n).register()}),c._pageRecord&&(!e.page.modstamp||e.page.modstamp<c._pageRecord.LastModifiedDate)&&(e.page.modstamp=c._pageRecord.LastModifiedDate),c.has("serverSideModelCache")&&(b=c.get("serverSideModelCache"),t.each(b,function(){this.register()}),c.unset("serverSideModelCache")),m=[],w=c.getModels(),S=[],C=[],t.each(w,function(e,t){t.initialize({createDefaultRowIfNeeded:!1,cloneRowsIfNeeded:!1,pageComponent:c}),!t.processOnClient||!t.doQuery&&t.hasMetadataLoaded()?(t.errors&&t.errors.length&&c.addProblems(t.errors),S.push(t)):(t.loadAsync?C:m).push(t)}),t.holdReady(!0),e.offline.populateMetadata().then(function(){return y=(m.length?e.model.load(m,null,{pageComponent:c}):A()).then(E,E).then(function(){return!0===e.webfonts.haveFontsLoaded()?A():l.subscribeOnce("ui.fontsloaded")}).then(function(){return function(n,i,r){var o,s,l,c,f,h,g=i._pageRecord?i._pageRecord.Name:"",m=e.region.get("__header"+g),v=e.region.get("__footer"+g),y=r.children("components").first().children(),b=r.children("interactions").first(),w=i.getElement(),S=i.getContentElement(),C=i.getPanelsElement(),I=r.attr("title");function k(e){h="mousedown"===e.type,i.set("usingMouse",h,{renderOnChange:!1})}function x(e){!h&&e.target&&e.target.classList&&e.target.classList.add("sk-focus-keyboard")}function T(e){e.target&&e.target.classList&&e.target.classList.remove("sk-focus-keyboard")}function R(e,t){w[0].addEventListener(e,t)}e.utils.inPlatform([a.NATIVE,a.VISUALFORCE])&&I&&!i.isInclude&&(document.title=e.utils.mergeAsText(u,I)),!0!==i.get("loading.stopped")?((i.isReplace||i.isInclude)&&i.previousPageComponent&&i.previousPageComponent.unrender().unregister({initiatorId:i.getId(),removeElement:!1}),o={_parentPageId:i.id()},f=i.context,m&&i.createChildComponents(m.xmlDefinition.children("components").first().children(),S,f,o),i.createChildComponents(y,S,f,o),v&&i.createChildComponents(v.xmlDefinition.children("components").first().children(),S,f,o),n.updateProblemsWrapper(),S.css("display","block"),w.css("display","block"),e.events.publish("ui.resize"),w.find(".nx-field > :input:visible:not(.hasDatepicker)").first().focus(),l=t('a.zen-trigger[title="Publisher Type Overflow Menu"]'),c=l.next(),l.click(function(){c.toggle()}),c.click(function(){c.hide()}),b.length&&e.interactions.enableInteractions(S,{interactionsDef:b,component:i}),p(i)?w.append(S):w.append(S,C),h=!0,R("keydown",k),R("mousedown",k),R("focusin",x),R("focusout",T),e.platform.checkSessionExpiration&&!i.get("checking.session")&&e.utils.userInfo.isAuthenticated&&!e.offline.networkDown()&&(i.set("checking.session",!0),e.utils.addSessionWarningCheck(e.utils.userInfo.sessionExpireTime,i)),s={page:i,component:i},i.publish("page.rendered",s,{qualifyEventName:!1,scope:d.SKUID}),i.publish("ui.reflow",s,{buffer:10,qualifyEventName:!1,scope:d.SKUID}),t.holdReady(!1),i.element.trigger("pageload")):t.holdReady(!1)}(I,c,s)}),t.each(C,function(){this.load(null,{pageComponent:c})}),c.subscribeOnce("stop.loading",function(){c.set("loading.stopped",!0),y.reject&&y.reject()}),y.promise()})},cpi:{$M:function(e){var t=this._getCPI().getModels(e);if(t.length)return t[0]},getModel:function(e){return this._getCPI().$M(e)},getModels:function(t){var n=this.getId();return e.model.list().filter(function(e){return e.getParentPageId()===n&&(!t||e.id===t)})},$C:function(e){return this.getChildComponent(e)},getComponent:function(e){return this._getCPI().$C(e)},createPopup:function(t){if(t.isInk)return e.utils.createPopupFromPopupXML(t,t.context)},isUserPageAdmin:function(){return e.page&&e.page.editable&&!e.page.runningOnForceSite}}}),l.register([new c("page.rendered","Skuid Page: Rendered")])}(skuid,skuid.$)},function(e,t,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,t){var n=(e.sfdc={}).api={},r=t.extend,o=e.utils,a='Parameter "type" expected, e.g. "POST", "GET"',s='Parameter "url" expected, e.g. "/sobjects/Account", "/query/?q=select+Name+from+Account"',l="Missing object property: ",c=n.version="42.0",d="/services/data/v",u={},f={},p={StaticResource:{fields:{Name:{required:!0},Description:{required:!1},Body:{required:!0},CacheControl:{required:!0,defaultValue:"Public"},ContentType:{required:!0,defaultValue:"text/plain"}}},ApexPage:{fields:{Name:{required:!0},Markup:{required:!0},MasterLabel:{required:!0},ApiVersion:{required:!0,defaultValue:n.version}}},ApexClass:{fields:{Name:{required:!0},Body:{required:!0},ApiVersion:{required:!0,defaultValue:n.version}}}},h=function(e){if(!e)return!0;var t=e.dataSourceType;return!!t&&(!!t.isDataSourceNativeSalesforce&&t.isDataSourceNativeSalesforce(e))};function g(n){n||(n={});var i,r,l,p,g=n.type,m=n.url,v=n.data,y=!v&&!0===n.cache,b=n.dataSource,w=h(b),S=w&&o.inPlatform(e.constants.VISUALFORCE),C=function(e){var t=function(e,t){return t?e:e&&e.body?o.parseAsJSONIfString(e.body):e}(e,S);return n.success&&n.success(t),t},I=function(e,t,i){if(e.responseJSON||w||(e.responseJSON=e.body),n.error)n.error(e,t,i);else{var r=e.responseJSON[0];window.alert("There was an error performing this "+g+" request:\n\nError code: "+r.errorCode+"\nMessage: "+r.message+"\n")}return e};if(!g)throw a;if(!m)throw s;var k=b&&b.name||"";r=g+" "+m+(k?" "+k:"");var x=o.getSafeRelativeUrl(d+c+m);return i={url:x,dataType:"json",headers:{"Content-Type":"application/json"},success:C,error:I},r in f?y?(l=f[r],(i=t.Deferred()).done(C).resolve(l),i.promise()):void delete f[r]:!v&&r in u?u[r].done(C).fail(I):(n.crossDomain&&(i.crossDomain=!0),S?(i.type=g,i.headers.Authorization="Bearer "+e.utils.userInfo.sessionId,v&&(i.data=JSON.stringify(v)),p=t.ajax(i)):(i.method=g,i.contentType="application/json",i.url=o.combineUrls(b.serviceUrl,i.url),v&&(i.body=JSON.stringify(v)),p=b.authenticate().then(function(){return b.makeRequest(b.createHTTPRequest(i))}).then(i.success,i.error)),v||(u[r]=p,p.always(function(){delete u[r]}),y&&p.done(function(e){f[r]=e})),p)}function m(e,t){this._type=e,"object"===(void 0===t?"undefined":i(t))&&r(this,t)}m.prototype={insert:function(){return function(e){e||(e={});var n=this,i=n.getFields(),r=n.getType(),o={},a=e.useToolingApi||"ApexClass"===r;return i&&t.each(i,function(e,t){var i=n[e];if(t.required&&(void 0===i||""===i)){if(!t.defaultValue)throw l+e;i=n[e]=t.defaultValue}o[e]=i}),g({type:"POST",url:"/"+(a?"tooling/":"")+"sobjects/"+r,data:o,success:function(t){t.success&&(n.Id=t.id,e.success&&e.success(t))},error:function(t,n,i){if(e.error)e.error(t,n,i);else{var o=t.responseJSON;o&&o.length&&window.alert("Unable to create new "+r+" due to error:\n\nError code: "+o[0].errorCode+"\nMessage: "+o[0].message)}}})}.apply(this,arguments)},update:function(){return function(e){e||(e={});var n=this,i=n.getFields(),r=n.getType(),o={};return i&&t.each(i,function(e){var t=n[e];void 0!==t&&(o[e]=t)}),g({type:"PATCH",url:"/"+(e.useToolingApi?"tooling/":"")+"sobjects/"+r+"/"+n.Id,data:o,success:e.success,error:function(t,i,o){if(e.error)e.error(t,i,o);else{var a=t.responseJSON;a&&a.length&&window.alert("Unable to update "+r+" with Id "+n.Id+" due to error:\n\nError code: "+a[0].errorCode+"\nMessage: "+a[0].message)}}})}.apply(this,arguments)},delete:function(){return function(e){e||(e={});var t=this.getType(),n=e.useToolingApi||"ApexClass"===t;if(!this.Id)throw l+"Id";return g({type:"DELETE",url:"/"+(n?"tooling/":"")+"sobjects/"+t+"/"+this.Id,success:e.success,error:e.error})}.apply(this,arguments)},get:function(e){return this[e]},set:function(e,t){o.isString(e)?this[e]=t:r(this,e)},getType:function(){return this._type},getFields:function(){var e=p[this.getType()];return e?e.fields:null},getField:function(e){var t=this.getFields();return t?t[e]:null}},r(n,{getCachedResult:function(e){e||(e={});var t,n=e.type,i=e.url,r=e.data,o=e.dataSource,l=o&&o.name;if(!n)throw a;if(!i)throw s;if(t=n+" "+i+(l?" "+l:""),!r&&t in f)return f[t]},makeRequest:g,query:function(e,t){return t||(t={}),g({type:"GET",url:"/"+(t.useToolingApi?"tooling/":"")+"query/?q="+encodeURIComponent(e),success:t.success,error:function(e,n,i){if(t.error)t.error(e,n,i);else{var r=e.responseJSON;r&&r.length&&window.alert("There was an error performing this query: "+r[0].message)}}})},escapeMetadataBody:function(e){return window.btoa(window.unescape(encodeURIComponent(e)))},SObject:m})}(skuid,skuid.$)},function(e,t,n){"use strict";!function(e,t){var n=e.page={_parametersByPage:{}},i=t.extend,r=e.utils,o="preventUnloadIfUnsavedChanges";function a(t){var o,a,s,l=i({},n.params,r.deparam(window.location.search));return t&&(r.isString(t)?(o=t,a=e.$C(o)):o=(a=t).id()),a&&(s=a.getPageParameters()),s||(s=n._parametersByPage[o]),s&&i(l,s),l}function s(){var t=[],n=e.component.getByType("skuidpage"),i={};return n&&n.length&&n.forEach(function(e){var n=e.problems;n&&n.length&&n.forEach(function(e){var n;e&&(n=r.isString(e)?e:e.message),n&&!n[i]&&t.push(e)})}),t}i(n,{getAllProblems:s,getParameter:function(e,t){if("string"==typeof e){var n=a(t);return e in n?n[e]:n[e.toLowerCase()]}},getParameters:a,displayProblem:function(e){var i,r=this._uniqueProblemMessages,o=e.message;return r||(r=this._uniqueProblemMessages={}),!(!n.problemsContainer||e.isDisplayed||r[o]||((i=t("<div>").addClass("nx-problem").appendTo(n.problemsContainer)).text(i.index()-0+1+". "+e.message),e.isDisplayed=!0,r[o]=e,0))},updateProblemsWrapper:function(){n.rebuildPageProblems({justUpdateWrapper:!0})},rebuildPageProblems:function(i){var r=s(),o=n.problemsWrapper,a=!!i&&!0===i.justUpdateWrapper;o&&(a||n.problemsContainer.empty(),r.length?(a||t.each(r,function(){this.isDisplayed=!1,n.displayProblem(this)}),o.css("display","block"),n.problemsIndicator.text(e.label.merge(e.$L("skuid_page_problems"),r.length)).append(t("<div>").append(t('<div class="ui-icon ui-icon-close">')).addClass("nx-page-problems-dismiss").on("click",function(){o.hide()}))):o.css("display","none"))},getUnloadMessage:function(n){var i,r=n&&n.getModels();return t.each(r,function(t,r){if(r.hasChanged&&r[o]&&n[o])return i=e.$L("unsaved_changes_warning"),!1}),i},params:r.deparam(window.location.search)})}(skuid,skuid.$)},function(e,t){(function(){!function(e){"use strict";function t(e,n,i,r){this.message=e,this.expected=n,this.found=i,this.location=r,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,t)}!function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}(t,Error),t.buildMessage=function(e,t){var n={literal:function(e){return'"'+r(e.text)+'"'},class:function(e){var t,n="";for(t=0;t<e.parts.length;t++)n+=e.parts[t]instanceof Array?o(e.parts[t][0])+"-"+o(e.parts[t][1]):o(e.parts[t]);return"["+(e.inverted?"^":"")+n+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function i(e){return e.charCodeAt(0).toString(16).toUpperCase()}function r(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(e){return"\\x0"+i(e)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(e){return"\\x"+i(e)})}function o(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(e){return"\\x0"+i(e)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(e){return"\\x"+i(e)})}return"Expected "+function(e){var t,i,r,o=new Array(e.length);for(t=0;t<e.length;t++)o[t]=(r=e[t],n[r.type](r));if(o.sort(),o.length>0){for(t=1,i=1;t<o.length;t++)o[t-1]!==o[t]&&(o[i]=o[t],i++);o.length=i}switch(o.length){case 1:return o[0];case 2:return o[0]+" or "+o[1];default:return o.slice(0,-1).join(", ")+", or "+o[o.length-1]}}(e)+" but "+function(e){return e?'"'+r(e)+'"':"end of input"}(t)+" found."},e.skuid.formula.parser={SyntaxError:t,parse:function(e,n){n=void 0!==n?n:{};var i,r={},o={Expression:gn},a=gn,s=function(e){return e},l=function(){return Un("keyword","null")},c='"',d=cn('"',!1),u=/^[^"\\]/,f=dn(['"',"\\"],!0,!1),p=function(e){return Un("string",e.join(""))},h="'",g=cn("'",!1),m=/^[^'\\]/,v=dn(["'","\\"],!0,!1),y="\\",b=cn("\\",!1),w=/^[1-7]/,S=dn([["1","7"]],!1,!1),C=/^[0-7]/,I=dn([["0","7"]],!1,!1),k=function(e){var t=parseInt(e,8),n="";return t>=256&&(t=parseInt(e.substring(0,2),8),n=e.substring(2,3)),String.fromCharCode(t)+n},x="\\x",T=cn("\\x",!1),R=/^[0-9a-f]/i,D=dn([["0","9"],["a","f"]],!1,!0),A=function(e){var t=parseInt(e,16);return String.fromCharCode(t)},E="\\u",F=cn("\\u",!1),N="\\n",M=cn("\\n",!1),_=function(){return"\n"},P="\\\n",O=cn("\\\n",!1),L=function(){return""},U="\\r",B=cn("\\r",!1),j=function(){return"\r"},V="\\t",G=cn("\\t",!1),H=function(){return"\t"},z="\\b",q=cn("\\b",!1),$=function(){return"\b"},W="\\f",Y=cn("\\f",!1),K=function(){return"\f"},X="\\v",J=cn("\\v",!1),Q=function(){return"\v"},Z="\\0",ee=cn("\\0",!1),te=function(){return"\0"},ne="\\\\",ie=cn("\\\\",!1),re=function(){return"\\"},oe="\\'",ae=cn("\\'",!1),se=function(){return"'"},le='\\"',ce=cn('\\"',!1),de=function(){return'"'},ue=/^[0-9]/,fe=dn([["0","9"]],!1,!1),pe=".",he=cn(".",!1),ge=function(e){return Un("number",parseFloat(e))},me="date",ve=cn("date",!0),ye="-",be=cn("-",!1),we="T",Se=cn("T",!1),Ce=":",Ie=cn(":",!1),ke=function(e,t,n,i,r,o,a){return a},xe=function(e,t,n,i,r,o,a){return{second:o,millisecond:a||"0"}},Te=function(e,t,n,i,r,o){return o||(o={second:"0",millisecond:"0"}),{hour:i,minute:r,second:o.second,millisecond:o.millisecond}},Re="Z",De=cn("Z",!1),Ae="+00:00",Ee=cn("+00:00",!1),Fe="+",Ne=cn("+",!1),Me="0",_e=cn("0",!1),Pe=function(e,t,n,i,r){var o=0,a=0,s=0,l=0;e=parseInt(e),t=parseInt(t),n=parseInt(n),(t<1||t>12)&&ln("A Valid Date");var c,d=new Date(e,t,1);return d.setDate(0),(n<1||n>d.getDate())&&ln("A Valid Date"),i&&(o=parseInt(i.hour),a=parseInt(i.minute),s=parseInt(i.second),l=parseInt(i.millisecond),(o>23||a>59||s>59||l>999)&&ln("A Valid Date")),c=r?new Date(Date.UTC(e,t-1,n,o,a,s,l)):skuid.time.getRealJSDateTimeFromLocal(new Date(e,t-1,n,o,a,s,l)),Un("date",new Date(c))},Oe="true",Le=cn("true",!0),Ue="false",Be=cn("false",!0),je="null",Ve=cn("null",!0),Ge="undefined",He=cn("undefined",!0),ze="nan",qe=cn("nan",!0),$e=/^[a-z0-9_]/i,We=dn([["a","z"],["0","9"],"_"],!1,!0),Ye=function(e){return Un("keyword",e)},Ke="{{{",Xe=cn("{{{",!1),Je=/^[\/#\^]/,Qe=dn(["/","#","^"],!1,!1),Ze=/^[^{}]/,et=dn(["{","}"],!0,!1),tt="}}}",nt=cn("}}}",!1),it=function(e){return e},rt="{{",ot=cn("{{",!1),at="}}",st=cn("}}",!1),lt=function(e){return Un("merge",e)},ct="(",dt=cn("(",!1),ut=",",ft=cn(",",!1),pt=function(e,t,n){return n},ht=function(e,t,n){return[t].concat(n)},gt=")",mt=cn(")",!1),vt=function(e,t){return Ln("function",{name:e,arguments:t||[]})},yt=function(e){return Un("identifier",e)},bt=function(e,t,n){return{operator:t,operand:n}},wt=function(e,t){return Ln("operational",{head:e,operations:t})},St="|",Ct=cn("|",!1),It=function(e){return e},kt="or",xt=cn("or",!0),Tt=function(){return Bn("logical","or")},Rt="&",Dt=cn("&",!1),At="and",Et=cn("and",!0),Ft=function(){return Bn("logical","and")},Nt="!",Mt=cn("!",!1),_t="=",Pt=cn("=",!1),Ot=function(e){return Bn("logical",e)},Lt=/^[<>]/,Ut=dn(["<",">"],!1,!1),Bt=/^[\-+]/,jt=dn(["-","+"],!1,!1),Vt=function(e){return Bn("algebraic",e)},Gt=/^[\/%*]/,Ht=dn(["/","%","*"],!1,!1),zt=function(e){return{operator:e}},qt=function(e,t){return Ln("operational",{head:t,operation:e,unary:!0})},$t=/^[\-+!]/,Wt=dn(["-","+","!"],!1,!1),Yt=function(e){return Bn("unary",e)},Kt=function(e){return e},Xt=/^[ \f\n\r\t\x0B\xA0\u1680\u180E\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]/,Jt=dn([" ","\f","\n","\r","\t","\v"," "," ","᠎",[" "," "],"\u2028","\u2029"," "," ","　","\ufeff"],!1,!1),Qt=/^[a-z]/i,Zt=dn([["a","z"]],!1,!0),en=0,tn=0,nn=[{line:1,column:1}],rn=0,on=[],an=0,sn={};if("startRule"in n){if(!(n.startRule in o))throw new Error("Can't start parsing from rule \""+n.startRule+'".');a=o[n.startRule]}function ln(t,n){throw n=void 0!==n?n:fn(tn,en),hn([function(e){return{type:"other",description:e}}(t)],e.substring(tn,en),n)}function cn(e,t){return{type:"literal",text:e,ignoreCase:t}}function dn(e,t,n){return{type:"class",parts:e,inverted:t,ignoreCase:n}}function un(t){var n,i=nn[t];if(i)return i;for(n=t-1;!nn[n];)n--;for(i={line:(i=nn[n]).line,column:i.column};n<t;)10===e.charCodeAt(n)?(i.line++,i.column=1):i.column++,n++;return nn[t]=i,i}function fn(e,t){var n=un(e),i=un(t);return{start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:i.line,column:i.column}}}function pn(e){en<rn||(en>rn&&(rn=en,on=[]),on.push(e))}function hn(e,n,i){return new t(t.buildMessage(e,n),e,n,i)}function gn(){var e,t,n,i=29*en+0,o=sn[i];return o?(en=o.nextPos,o.result):(e=en,(t=Mn())!==r&&(n=wn())!==r&&Mn()!==r?(tn=e,e=t=s(n)):(en=e,e=r),e===r&&(e=en,(t=Mn())!==r&&(n=yn())!==r&&Mn()!==r?(tn=e,e=t=s(n)):(en=e,e=r),e===r&&(e=en,(t=Mn())!==r&&(n=mn())!==r&&Mn()!==r?(tn=e,e=t=s(n)):(en=e,e=r),e===r&&(e=en,(t=Mn())!==r&&(tn=e,t=l()),e=t))),sn[i]={nextPos:en,result:e},e)}function mn(){var t,n=29*en+1,i=sn[n];return i?(en=i.nextPos,i.result):((t=function(){var t,n,i,o,a=29*en+2,s=sn[a];if(s)return en=s.nextPos,s.result;if(t=en,34===e.charCodeAt(en)?(n=c,en++):(n=r,0===an&&pn(d)),n!==r){for(i=[],(o=vn())===r&&(u.test(e.charAt(en))?(o=e.charAt(en),en++):(o=r,0===an&&pn(f)));o!==r;)i.push(o),(o=vn())===r&&(u.test(e.charAt(en))?(o=e.charAt(en),en++):(o=r,0===an&&pn(f)));i!==r?(34===e.charCodeAt(en)?(o=c,en++):(o=r,0===an&&pn(d)),o!==r?(tn=t,n=p(i),t=n):(en=t,t=r)):(en=t,t=r)}else en=t,t=r;if(t===r)if(t=en,39===e.charCodeAt(en)?(n=h,en++):(n=r,0===an&&pn(g)),n!==r){for(i=[],(o=vn())===r&&(m.test(e.charAt(en))?(o=e.charAt(en),en++):(o=r,0===an&&pn(v)));o!==r;)i.push(o),(o=vn())===r&&(m.test(e.charAt(en))?(o=e.charAt(en),en++):(o=r,0===an&&pn(v)));i!==r?(39===e.charCodeAt(en)?(o=h,en++):(o=r,0===an&&pn(g)),o!==r?(tn=t,n=p(i),t=n):(en=t,t=r)):(en=t,t=r)}else en=t,t=r;return sn[a]={nextPos:en,result:t},t}())===r&&(t=function(){var t,n,i,o,a,s,l=29*en+4,c=sn[l];if(c)return en=c.nextPos,c.result;for(t=en,n=en,i=en,o=en,a=[],ue.test(e.charAt(en))?(s=e.charAt(en),en++):(s=r,0===an&&pn(fe));s!==r;)a.push(s),ue.test(e.charAt(en))?(s=e.charAt(en),en++):(s=r,0===an&&pn(fe));if(a!==r?(46===e.charCodeAt(en)?(s=pe,en++):(s=r,0===an&&pn(he)),s!==r?o=a=[a,s]:(en=o,o=r)):(en=o,o=r),o===r&&(o=null),o!==r){if(a=[],ue.test(e.charAt(en))?(s=e.charAt(en),en++):(s=r,0===an&&pn(fe)),s!==r)for(;s!==r;)a.push(s),ue.test(e.charAt(en))?(s=e.charAt(en),en++):(s=r,0===an&&pn(fe));else a=r;a!==r?i=o=[o,a]:(en=i,i=r)}else en=i,i=r;return(n=i!==r?e.substring(n,en):i)!==r&&(tn=t,n=ge(n)),t=n,sn[l]={nextPos:en,result:t},t}())===r&&(t=function(){var t,n,i,o,a,s,l,c,d,u,f,p,h,g,m,v,y,b,w,S,C=29*en+5,I=sn[C];if(I)return en=I.nextPos,I.result;if(t=en,e.substr(en,4).toLowerCase()===me?(n=e.substr(en,4),en+=4):(n=r,0===an&&pn(ve)),n!==r)if(Mn()!==r)if(i=en,o=en,ue.test(e.charAt(en))?(a=e.charAt(en),en++):(a=r,0===an&&pn(fe)),a!==r?(ue.test(e.charAt(en))?(s=e.charAt(en),en++):(s=r,0===an&&pn(fe)),s!==r?(ue.test(e.charAt(en))?(l=e.charAt(en),en++):(l=r,0===an&&pn(fe)),l!==r?(ue.test(e.charAt(en))?(c=e.charAt(en),en++):(c=r,0===an&&pn(fe)),c!==r?o=a=[a,s,l,c]:(en=o,o=r)):(en=o,o=r)):(en=o,o=r)):(en=o,o=r),(i=o!==r?e.substring(i,en):o)!==r)if(45===e.charCodeAt(en)?(o=ye,en++):(o=r,0===an&&pn(be)),o!==r)if(a=en,s=en,ue.test(e.charAt(en))?(l=e.charAt(en),en++):(l=r,0===an&&pn(fe)),l!==r?(ue.test(e.charAt(en))?(c=e.charAt(en),en++):(c=r,0===an&&pn(fe)),c===r&&(c=null),c!==r?s=l=[l,c]:(en=s,s=r)):(en=s,s=r),(a=s!==r?e.substring(a,en):s)!==r)if(45===e.charCodeAt(en)?(s=ye,en++):(s=r,0===an&&pn(be)),s!==r)if(l=en,c=en,ue.test(e.charAt(en))?(d=e.charAt(en),en++):(d=r,0===an&&pn(fe)),d!==r?(ue.test(e.charAt(en))?(u=e.charAt(en),en++):(u=r,0===an&&pn(fe)),u===r&&(u=null),u!==r?c=d=[d,u]:(en=c,c=r)):(en=c,c=r),(l=c!==r?e.substring(l,en):c)!==r){if(c=en,84===e.charCodeAt(en)?(d=we,en++):(d=r,0===an&&pn(Se)),d!==r)if(u=en,f=en,ue.test(e.charAt(en))?(p=e.charAt(en),en++):(p=r,0===an&&pn(fe)),p!==r?(ue.test(e.charAt(en))?(h=e.charAt(en),en++):(h=r,0===an&&pn(fe)),h!==r?f=p=[p,h]:(en=f,f=r)):(en=f,f=r),(u=f!==r?e.substring(u,en):f)!==r)if(58===e.charCodeAt(en)?(f=Ce,en++):(f=r,0===an&&pn(Ie)),f!==r)if(p=en,h=en,ue.test(e.charAt(en))?(g=e.charAt(en),en++):(g=r,0===an&&pn(fe)),g!==r?(ue.test(e.charAt(en))?(m=e.charAt(en),en++):(m=r,0===an&&pn(fe)),m!==r?h=g=[g,m]:(en=h,h=r)):(en=h,h=r),(p=h!==r?e.substring(p,en):h)!==r){if(h=en,58===e.charCodeAt(en)?(g=Ce,en++):(g=r,0===an&&pn(Ie)),g!==r)if(m=en,v=en,ue.test(e.charAt(en))?(y=e.charAt(en),en++):(y=r,0===an&&pn(fe)),y!==r?(ue.test(e.charAt(en))?(b=e.charAt(en),en++):(b=r,0===an&&pn(fe)),b!==r?v=y=[y,b]:(en=v,v=r)):(en=v,v=r),(m=v!==r?e.substring(m,en):v)!==r){if(v=en,46===e.charCodeAt(en)?(y=pe,en++):(y=r,0===an&&pn(he)),y!==r){if(b=en,w=[],ue.test(e.charAt(en))?(S=e.charAt(en),en++):(S=r,0===an&&pn(fe)),S!==r)for(;S!==r;)w.push(S),ue.test(e.charAt(en))?(S=e.charAt(en),en++):(S=r,0===an&&pn(fe));else w=r;(b=w!==r?e.substring(b,en):w)!==r?(tn=v,y=ke(i,a,l,u,p,m,b),v=y):(en=v,v=r)}else en=v,v=r;v===r&&(v=null),v!==r?(tn=h,g=xe(i,a,l,u,p,m,v),h=g):(en=h,h=r)}else en=h,h=r;else en=h,h=r;h===r&&(h=null),h!==r?(tn=c,d=Te(i,a,l,u,p,h),c=d):(en=c,c=r)}else en=c,c=r;else en=c,c=r;else en=c,c=r;else en=c,c=r;if(c===r&&(c=null),c!==r){if(d=en,90===e.charCodeAt(en)?(u=Re,en++):(u=r,0===an&&pn(De)),u===r&&(e.substr(en,6)===Ae?(u=Ae,en+=6):(u=r,0===an&&pn(Ee)),u===r))if(u=en,43===e.charCodeAt(en)?(f=Fe,en++):(f=r,0===an&&pn(Ne)),f!==r){if(p=[],48===e.charCodeAt(en)?(h=Me,en++):(h=r,0===an&&pn(_e)),h!==r)for(;h!==r;)p.push(h),48===e.charCodeAt(en)?(h=Me,en++):(h=r,0===an&&pn(_e));else p=r;p!==r?u=f=[f,p]:(en=u,u=r)}else en=u,u=r;u===r&&(u=null),(d=u!==r?e.substring(d,en):u)!==r?(tn=t,n=Pe(i,a,l,c,d),t=n):(en=t,t=r)}else en=t,t=r}else en=t,t=r;else en=t,t=r;else en=t,t=r;else en=t,t=r;else en=t,t=r;else en=t,t=r;else en=t,t=r;return sn[C]={nextPos:en,result:t},t}())===r&&(t=function(){var t,n,i,o,a=29*en+6,s=sn[a];return s?(en=s.nextPos,s.result):(t=en,e.substr(en,4).toLowerCase()===Oe?(n=e.substr(en,4),en+=4):(n=r,0===an&&pn(Le)),n===r&&(e.substr(en,5).toLowerCase()===Ue?(n=e.substr(en,5),en+=5):(n=r,0===an&&pn(Be)),n===r&&(e.substr(en,4).toLowerCase()===je?(n=e.substr(en,4),en+=4):(n=r,0===an&&pn(Ve)),n===r&&(e.substr(en,9).toLowerCase()===Ge?(n=e.substr(en,9),en+=9):(n=r,0===an&&pn(He)),n===r&&(e.substr(en,3).toLowerCase()===ze?(n=e.substr(en,3),en+=3):(n=r,0===an&&pn(qe)))))),n!==r?(i=en,an++,$e.test(e.charAt(en))?(o=e.charAt(en),en++):(o=r,0===an&&pn(We)),an--,o===r?i=void 0:(en=i,i=r),i!==r?(tn=t,n=Ye(n),t=n):(en=t,t=r)):(en=t,t=r),sn[a]={nextPos:en,result:t},t)}())===r&&(t=function(){var t,n,i,o,a,s,l,c,d=29*en+7,u=sn[d];if(u)return en=u.nextPos,u.result;if(t=en,n=en,i=en,e.substr(en,3)===Ke?(o=Ke,en+=3):(o=r,0===an&&pn(Xe)),o!==r&&(a=Mn())!==r?i=o=[o,a]:(en=i,i=r),i!==r)if(o=en,an++,Je.test(e.charAt(en))?(a=e.charAt(en),en++):(a=r,0===an&&pn(Qe)),an--,a===r?o=void 0:(en=o,o=r),o!==r){if(a=en,s=[],Ze.test(e.charAt(en))?(l=e.charAt(en),en++):(l=r,0===an&&pn(et)),l!==r)for(;l!==r;)s.push(l),Ze.test(e.charAt(en))?(l=e.charAt(en),en++):(l=r,0===an&&pn(et));else s=r;(a=s!==r?e.substring(a,en):s)!==r?(s=en,(l=Mn())!==r?(e.substr(en,3)===tt?(c=tt,en+=3):(c=r,0===an&&pn(nt)),c!==r?s=l=[l,c]:(en=s,s=r)):(en=s,s=r),s!==r?(tn=n,i=it(a),n=i):(en=n,n=r)):(en=n,n=r)}else en=n,n=r;else en=n,n=r;if(n===r)if(n=en,i=en,e.substr(en,2)===rt?(o=rt,en+=2):(o=r,0===an&&pn(ot)),o!==r&&(a=Mn())!==r?i=o=[o,a]:(en=i,i=r),i!==r)if(o=en,an++,Je.test(e.charAt(en))?(a=e.charAt(en),en++):(a=r,0===an&&pn(Qe)),an--,a===r?o=void 0:(en=o,o=r),o!==r){if(a=en,s=[],Ze.test(e.charAt(en))?(l=e.charAt(en),en++):(l=r,0===an&&pn(et)),l!==r)for(;l!==r;)s.push(l),Ze.test(e.charAt(en))?(l=e.charAt(en),en++):(l=r,0===an&&pn(et));else s=r;(a=s!==r?e.substring(a,en):s)!==r?(s=en,(l=Mn())!==r?(e.substr(en,2)===at?(c=at,en+=2):(c=r,0===an&&pn(st)),c!==r?s=l=[l,c]:(en=s,s=r)):(en=s,s=r),s!==r?(tn=n,i=it(a),n=i):(en=n,n=r)):(en=n,n=r)}else en=n,n=r;else en=n,n=r;return n!==r&&(tn=t,n=lt(n)),t=n,sn[d]={nextPos:en,result:t},t}()),sn[n]={nextPos:en,result:t},t)}function vn(){var t,n,i,o,a,s,l,c,d=29*en+3,u=sn[d];return u?(en=u.nextPos,u.result):(t=en,92===e.charCodeAt(en)?(n=y,en++):(n=r,0===an&&pn(b)),n!==r?(i=en,o=en,w.test(e.charAt(en))?(a=e.charAt(en),en++):(a=r,0===an&&pn(S)),a!==r?(C.test(e.charAt(en))?(s=e.charAt(en),en++):(s=r,0===an&&pn(I)),s===r&&(s=null),s!==r?(C.test(e.charAt(en))?(l=e.charAt(en),en++):(l=r,0===an&&pn(I)),l===r&&(l=null),l!==r?(C.test(e.charAt(en))?(c=e.charAt(en),en++):(c=r,0===an&&pn(I)),c===r&&(c=null),c!==r?o=a=[a,s,l,c]:(en=o,o=r)):(en=o,o=r)):(en=o,o=r)):(en=o,o=r),o===r&&(o=en,C.test(e.charAt(en))?(a=e.charAt(en),en++):(a=r,0===an&&pn(I)),a!==r?(C.test(e.charAt(en))?(s=e.charAt(en),en++):(s=r,0===an&&pn(I)),s!==r?(C.test(e.charAt(en))?(l=e.charAt(en),en++):(l=r,0===an&&pn(I)),l===r&&(l=null),l!==r?o=a=[a,s,l]:(en=o,o=r)):(en=o,o=r)):(en=o,o=r)),(i=o!==r?e.substring(i,en):o)!==r?(tn=t,t=n=k(i)):(en=t,t=r)):(en=t,t=r),t===r&&(t=en,e.substr(en,2)===x?(n=x,en+=2):(n=r,0===an&&pn(T)),n!==r?(i=en,o=en,R.test(e.charAt(en))?(a=e.charAt(en),en++):(a=r,0===an&&pn(D)),a!==r?(R.test(e.charAt(en))?(s=e.charAt(en),en++):(s=r,0===an&&pn(D)),s!==r?o=a=[a,s]:(en=o,o=r)):(en=o,o=r),(i=o!==r?e.substring(i,en):o)!==r?(tn=t,t=n=A(i)):(en=t,t=r)):(en=t,t=r),t===r&&(t=en,e.substr(en,2)===E?(n=E,en+=2):(n=r,0===an&&pn(F)),n!==r?(i=en,o=en,R.test(e.charAt(en))?(a=e.charAt(en),en++):(a=r,0===an&&pn(D)),a!==r?(R.test(e.charAt(en))?(s=e.charAt(en),en++):(s=r,0===an&&pn(D)),s!==r?(R.test(e.charAt(en))?(l=e.charAt(en),en++):(l=r,0===an&&pn(D)),l!==r?(R.test(e.charAt(en))?(c=e.charAt(en),en++):(c=r,0===an&&pn(D)),c!==r?o=a=[a,s,l,c]:(en=o,o=r)):(en=o,o=r)):(en=o,o=r)):(en=o,o=r),(i=o!==r?e.substring(i,en):o)!==r?(tn=t,t=n=A(i)):(en=t,t=r)):(en=t,t=r),t===r&&(t=en,e.substr(en,2)===N?(n=N,en+=2):(n=r,0===an&&pn(M)),n!==r&&(tn=t,n=_()),(t=n)===r&&(t=en,e.substr(en,2)===P?(n=P,en+=2):(n=r,0===an&&pn(O)),n!==r&&(tn=t,n=L()),(t=n)===r&&(t=en,e.substr(en,2)===U?(n=U,en+=2):(n=r,0===an&&pn(B)),n!==r&&(tn=t,n=j()),(t=n)===r&&(t=en,e.substr(en,2)===V?(n=V,en+=2):(n=r,0===an&&pn(G)),n!==r&&(tn=t,n=H()),(t=n)===r&&(t=en,e.substr(en,2)===z?(n=z,en+=2):(n=r,0===an&&pn(q)),n!==r&&(tn=t,n=$()),(t=n)===r&&(t=en,e.substr(en,2)===W?(n=W,en+=2):(n=r,0===an&&pn(Y)),n!==r&&(tn=t,n=K()),(t=n)===r&&(t=en,e.substr(en,2)===X?(n=X,en+=2):(n=r,0===an&&pn(J)),n!==r&&(tn=t,n=Q()),(t=n)===r&&(t=en,e.substr(en,2)===Z?(n=Z,en+=2):(n=r,0===an&&pn(ee)),n!==r&&(tn=t,n=te()),(t=n)===r&&(t=en,e.substr(en,2)===ne?(n=ne,en+=2):(n=r,0===an&&pn(ie)),n!==r&&(tn=t,n=re()),(t=n)===r&&(t=en,e.substr(en,2)===oe?(n=oe,en+=2):(n=r,0===an&&pn(ae)),n!==r&&(tn=t,n=se()),(t=n)===r&&(t=en,e.substr(en,2)===le?(n=le,en+=2):(n=r,0===an&&pn(ce)),n!==r&&(tn=t,n=de()),t=n))))))))))))),sn[d]={nextPos:en,result:t},t)}function yn(){var t,n,i,o,a,s,l,c,d,u,f=29*en+8,p=sn[f];if(p)return en=p.nextPos,p.result;if(t=en,n=en,i=function(){var t,n,i,o,a,s,l=29*en+9,c=sn[l];if(c)return en=c.nextPos,c.result;if(t=en,(n=_n())!==r){for(i=[],o=en,46===e.charCodeAt(en)?(a=pe,en++):(a=r,0===an&&pn(he)),a!==r&&(s=_n())!==r?o=a=[a,s]:(en=o,o=r);o!==r;)i.push(o),o=en,46===e.charCodeAt(en)?(a=pe,en++):(a=r,0===an&&pn(he)),a!==r&&(s=_n())!==r?o=a=[a,s]:(en=o,o=r);i!==r?t=n=[n,i]:(en=t,t=r)}else en=t,t=r;return sn[l]={nextPos:en,result:t},t}(),(n=i!==r?e.substring(n,en):i)!==r)if((i=Mn())!==r)if(40===e.charCodeAt(en)?(o=ct,en++):(o=r,0===an&&pn(dt)),o!==r)if(Mn()!==r){if(a=en,(s=bn())!==r)if(Mn()!==r){for(l=[],c=en,44===e.charCodeAt(en)?(d=ut,en++):(d=r,0===an&&pn(ft)),d!==r&&Mn()!==r&&(u=bn())!==r&&Mn()!==r?(tn=c,c=d=pt(n,s,u)):(en=c,c=r);c!==r;)l.push(c),c=en,44===e.charCodeAt(en)?(d=ut,en++):(d=r,0===an&&pn(ft)),d!==r&&Mn()!==r&&(u=bn())!==r&&Mn()!==r?(tn=c,c=d=pt(n,s,u)):(en=c,c=r);l!==r?(tn=a,a=s=ht(n,s,l)):(en=a,a=r)}else en=a,a=r;else en=a,a=r;a===r&&(a=null),a!==r?(41===e.charCodeAt(en)?(s=gt,en++):(s=r,0===an&&pn(mt)),s!==r?(tn=t,t=n=vt(n,a)):(en=t,t=r)):(en=t,t=r)}else en=t,t=r;else en=t,t=r;else en=t,t=r;else en=t,t=r;return sn[f]={nextPos:en,result:t},t}function bn(){var t,n,i,o,a,s=29*en+10,l=sn[s];return l?(en=l.nextPos,l.result):((t=wn())===r&&(t=mn())===r&&(t=en,Mn()!==r?(n=en,(n=(i=_n())!==r?e.substring(n,en):i)!==r&&(i=Mn())!==r?(o=en,an++,40===e.charCodeAt(en)?(a=ct,en++):(a=r,0===an&&pn(dt)),an--,a===r?o=void 0:(en=o,o=r),o!==r?(tn=t,t=yt(n)):(en=t,t=r)):(en=t,t=r)):(en=t,t=r),t===r&&(t=yn())),sn[s]={nextPos:en,result:t},t)}function wn(){var e,t,n,i,o,a,s=29*en+11,l=sn[s];if(l)return en=l.nextPos,l.result;if(e=en,(t=Cn())!==r){if(n=[],i=en,(o=Sn())!==r&&(a=Cn())!==r?(tn=i,i=o=bt(t,o,a)):(en=i,i=r),i!==r)for(;i!==r;)n.push(i),i=en,(o=Sn())!==r&&(a=Cn())!==r?(tn=i,i=o=bt(t,o,a)):(en=i,i=r);else n=r;n!==r?(tn=e,e=t=wt(t,n)):(en=e,e=r)}else en=e,e=r;return e===r&&(e=Cn()),sn[s]={nextPos:en,result:e},e}function Sn(){var t,n,i,o,a,s=29*en+12,l=sn[s];if(l)return en=l.nextPos,l.result;if(t=en,Mn()!==r){if(n=en,i=en,124===e.charCodeAt(en)?(o=St,en++):(o=r,0===an&&pn(Ct)),(i=o!==r?e.substring(i,en):o)!==r){for(o=[],124===e.charCodeAt(en)?(a=St,en++):(a=r,0===an&&pn(Ct));a!==r;)o.push(a),124===e.charCodeAt(en)?(a=St,en++):(a=r,0===an&&pn(Ct));o!==r?(tn=n,n=i=It(i)):(en=n,n=r)}else en=n,n=r;n===r&&(e.substr(en,2).toLowerCase()===kt?(n=e.substr(en,2),en+=2):(n=r,0===an&&pn(xt))),n!==r&&(i=Mn())!==r?(tn=t,t=Tt()):(en=t,t=r)}else en=t,t=r;return sn[s]={nextPos:en,result:t},t}function Cn(){var e,t,n,i,o,a,s=29*en+13,l=sn[s];if(l)return en=l.nextPos,l.result;if(e=en,(t=kn())!==r){if(n=[],i=en,(o=In())!==r&&(a=kn())!==r?(tn=i,i=o=bt(t,o,a)):(en=i,i=r),i!==r)for(;i!==r;)n.push(i),i=en,(o=In())!==r&&(a=kn())!==r?(tn=i,i=o=bt(t,o,a)):(en=i,i=r);else n=r;n!==r?(tn=e,e=t=wt(t,n)):(en=e,e=r)}else en=e,e=r;return e===r&&(e=kn()),sn[s]={nextPos:en,result:e},e}function In(){var t,n,i,o,a,s=29*en+14,l=sn[s];if(l)return en=l.nextPos,l.result;if(t=en,Mn()!==r){if(n=en,i=en,38===e.charCodeAt(en)?(o=Rt,en++):(o=r,0===an&&pn(Dt)),(i=o!==r?e.substring(i,en):o)!==r){for(o=[],38===e.charCodeAt(en)?(a=Rt,en++):(a=r,0===an&&pn(Dt));a!==r;)o.push(a),38===e.charCodeAt(en)?(a=Rt,en++):(a=r,0===an&&pn(Dt));o!==r?(tn=n,n=i=It(i)):(en=n,n=r)}else en=n,n=r;n===r&&(e.substr(en,3).toLowerCase()===At?(n=e.substr(en,3),en+=3):(n=r,0===an&&pn(Et))),n!==r&&(i=Mn())!==r?(tn=t,t=Ft()):(en=t,t=r)}else en=t,t=r;return sn[s]={nextPos:en,result:t},t}function kn(){var e,t,n,i,o,a,s=29*en+15,l=sn[s];if(l)return en=l.nextPos,l.result;if(e=en,(t=Tn())!==r){if(n=[],i=en,(o=xn())!==r&&(a=Tn())!==r?(tn=i,i=o=bt(t,o,a)):(en=i,i=r),i!==r)for(;i!==r;)n.push(i),i=en,(o=xn())!==r&&(a=Tn())!==r?(tn=i,i=o=bt(t,o,a)):(en=i,i=r);else n=r;n!==r?(tn=e,e=t=wt(t,n)):(en=e,e=r)}else en=e,e=r;return e===r&&(e=Tn()),sn[s]={nextPos:en,result:e},e}function xn(){var t,n,i,o,a,s,l=29*en+16,c=sn[l];if(c)return en=c.nextPos,c.result;if(t=en,Mn()!==r){if(n=en,i=en,o=en,33===e.charCodeAt(en)?(a=Nt,en++):(a=r,0===an&&pn(Mt)),a===r&&(a=null),a!==r?(61===e.charCodeAt(en)?(s=_t,en++):(s=r,0===an&&pn(Pt)),s!==r?o=a=[a,s]:(en=o,o=r)):(en=o,o=r),(i=o!==r?e.substring(i,en):o)!==r){for(o=[],61===e.charCodeAt(en)?(a=_t,en++):(a=r,0===an&&pn(Pt));a!==r;)o.push(a),61===e.charCodeAt(en)?(a=_t,en++):(a=r,0===an&&pn(Pt));o!==r?(tn=n,n=i=It(i)):(en=n,n=r)}else en=n,n=r;n!==r&&(i=Mn())!==r?(tn=t,t=Ot(n)):(en=t,t=r)}else en=t,t=r;return sn[l]={nextPos:en,result:t},t}function Tn(){var e,t,n,i,o,a,s=29*en+17,l=sn[s];if(l)return en=l.nextPos,l.result;if(e=en,(t=Dn())!==r){if(n=[],i=en,(o=Rn())!==r&&(a=Dn())!==r?(tn=i,i=o=bt(t,o,a)):(en=i,i=r),i!==r)for(;i!==r;)n.push(i),i=en,(o=Rn())!==r&&(a=Dn())!==r?(tn=i,i=o=bt(t,o,a)):(en=i,i=r);else n=r;n!==r?(tn=e,e=t=wt(t,n)):(en=e,e=r)}else en=e,e=r;return e===r&&(e=Dn()),sn[s]={nextPos:en,result:e},e}function Rn(){var t,n,i,o,a,s=29*en+18,l=sn[s];return l?(en=l.nextPos,l.result):(t=en,Mn()!==r?(n=en,i=en,Lt.test(e.charAt(en))?(o=e.charAt(en),en++):(o=r,0===an&&pn(Ut)),o!==r?(61===e.charCodeAt(en)?(a=_t,en++):(a=r,0===an&&pn(Pt)),a===r&&(a=null),a!==r?i=o=[o,a]:(en=i,i=r)):(en=i,i=r),(n=i!==r?e.substring(n,en):i)!==r&&(i=Mn())!==r?(tn=t,t=Ot(n)):(en=t,t=r)):(en=t,t=r),sn[s]={nextPos:en,result:t},t)}function Dn(){var e,t,n,i,o,a,s=29*en+19,l=sn[s];if(l)return en=l.nextPos,l.result;if(e=en,(t=En())!==r){if(n=[],i=en,(o=An())!==r&&(a=En())!==r?(tn=i,i=o=bt(t,o,a)):(en=i,i=r),i!==r)for(;i!==r;)n.push(i),i=en,(o=An())!==r&&(a=En())!==r?(tn=i,i=o=bt(t,o,a)):(en=i,i=r);else n=r;n!==r?(tn=e,e=t=wt(t,n)):(en=e,e=r)}else en=e,e=r;return e===r&&(e=En()),sn[s]={nextPos:en,result:e},e}function An(){var t,n,i,o=29*en+20,a=sn[o];return a?(en=a.nextPos,a.result):(t=en,Mn()!==r?(n=en,Bt.test(e.charAt(en))?(i=e.charAt(en),en++):(i=r,0===an&&pn(jt)),(n=i!==r?e.substring(n,en):i)!==r&&(i=Mn())!==r?(tn=t,t=Vt(n)):(en=t,t=r)):(en=t,t=r),sn[o]={nextPos:en,result:t},t)}function En(){var e,t,n,i,o,a,s=29*en+21,l=sn[s];if(l)return en=l.nextPos,l.result;if(e=en,(t=Nn())!==r){if(n=[],i=en,(o=Fn())!==r&&(a=Nn())!==r?(tn=i,i=o=bt(t,o,a)):(en=i,i=r),i!==r)for(;i!==r;)n.push(i),i=en,(o=Fn())!==r&&(a=Nn())!==r?(tn=i,i=o=bt(t,o,a)):(en=i,i=r);else n=r;n!==r?(tn=e,e=t=wt(t,n)):(en=e,e=r)}else en=e,e=r;return e===r&&(e=Nn()),sn[s]={nextPos:en,result:e},e}function Fn(){var t,n,i,o=29*en+22,a=sn[o];return a?(en=a.nextPos,a.result):(t=en,Mn()!==r?(n=en,Gt.test(e.charAt(en))?(i=e.charAt(en),en++):(i=r,0===an&&pn(Ht)),(n=i!==r?e.substring(n,en):i)!==r&&(i=Mn())!==r?(tn=t,t=Vt(n)):(en=t,t=r)):(en=t,t=r),sn[o]={nextPos:en,result:t},t)}function Nn(){var t,n,i,o=29*en+23,a=sn[o];return a?(en=a.nextPos,a.result):(t=en,n=en,(i=function(){var t,n,i,o,a=29*en+24,s=sn[a];return s?(en=s.nextPos,s.result):(t=en,(n=Mn())!==r?(i=en,$t.test(e.charAt(en))?(o=e.charAt(en),en++):(o=r,0===an&&pn(Wt)),(i=o!==r?e.substring(i,en):o)!==r&&(o=Mn())!==r?(tn=t,n=Yt(i),t=n):(en=t,t=r)):(en=t,t=r),sn[a]={nextPos:en,result:t},t)}())!==r&&(tn=n,i=zt(i)),(n=i)!==r&&(i=Nn())!==r?(tn=t,t=n=qt(n,i)):(en=t,t=r),t===r&&(t=function(){var t,n,i,o,a=29*en+25,s=sn[a];return s?(en=s.nextPos,s.result):(t=en,40===e.charCodeAt(en)?(n=ct,en++):(n=r,0===an&&pn(dt)),n!==r&&Mn()!==r&&(i=gn())!==r&&Mn()!==r?(41===e.charCodeAt(en)?(o=gt,en++):(o=r,0===an&&pn(mt)),o!==r?(tn=t,n=Kt(i),t=n):(en=t,t=r)):(en=t,t=r),t===r&&(t=function(){var e,t=29*en+26,n=sn[t];return n?(en=n.nextPos,n.result):((e=mn())===r&&(e=yn()),sn[t]={nextPos:en,result:e},e)}()),sn[a]={nextPos:en,result:t},t)}()),sn[o]={nextPos:en,result:t},t)}function Mn(){var t,n,i=29*en+27,o=sn[i];if(o)return en=o.nextPos,o.result;for(t=[],Xt.test(e.charAt(en))?(n=e.charAt(en),en++):(n=r,0===an&&pn(Jt));n!==r;)t.push(n),Xt.test(e.charAt(en))?(n=e.charAt(en),en++):(n=r,0===an&&pn(Jt));return sn[i]={nextPos:en,result:t},t}function _n(){var t,n,i,o,a=29*en+28,s=sn[a];if(s)return en=s.nextPos,s.result;if(t=en,n=[],Qt.test(e.charAt(en))?(i=e.charAt(en),en++):(i=r,0===an&&pn(Zt)),i!==r)for(;i!==r;)n.push(i),Qt.test(e.charAt(en))?(i=e.charAt(en),en++):(i=r,0===an&&pn(Zt));else n=r;if(n!==r){for(i=[],$e.test(e.charAt(en))?(o=e.charAt(en),en++):(o=r,0===an&&pn(We));o!==r;)i.push(o),$e.test(e.charAt(en))?(o=e.charAt(en),en++):(o=r,0===an&&pn(We));i!==r?t=n=[n,i]:(en=t,t=r)}else en=t,t=r;return sn[a]={nextPos:en,result:t},t}function Pn(e,t,n){this.class={major:e,minor:t},this.params=n}function On(e,t,n){return new Pn(e,t,n)}function Ln(e,t){return On("expression",e,t)}function Un(e,t){return On("literal",e,{value:t})}function Bn(e,t){return On("operator",e,{symbol:t})}if(Pn.prototype.is=function(e,t){return this.class.major===e&&this.class.minor===t},(i=a())!==r&&en===e.length)return i;throw i!==r&&en<e.length&&pn({type:"end"}),hn(on,rn<e.length?e.charAt(rn):null,rn<e.length?fn(rn,rn+1):fn(rn,rn))}}}(this)}).call(window)},function(e,t,n){"use strict";!function(e){var t=e.$,n=t.extend,i=e.formula={},r=function(){return e.time},o=e.utils,a=e.constants,s=a.LOG_LEVELS.WARNING,l=a.JS_TYPES,c=l.BOOLEAN,d=l.NUMBER,u=l.STRING,f="date",p=a.DISPLAY_TYPES,h=p.BOOLEAN,g=p.INTEGER,m=p.NUMBER,v=p.PERCENT,y=p.CURRENCY,b=p.DOUBLE,w=p.DATE,S=p.DATETIME,C=!1,I={};function k(e){return e=e.toUpperCase(),I[e]}function x(){var e=t.map(I,function(e){var t=e._getIsDeprecated(),n=e.getLocalName(),i=e.getFullName(),r=e.getNamespace(),o=e.getDefaultBuilderState(),a=null!==r;if(!t)return{label:n.toUpperCase()+(a?" (custom - "+r+")":""),value:o||i+"()",isCustom:a,formula:e}});return e.sort(function(e,t){var n=e.formula,i=t.formula,r=n.getLocalName().toUpperCase(),o=i.getLocalName().toUpperCase(),a=(n.getNamespace()||"").toUpperCase(),s=(i.getNamespace()||"").toUpperCase();return r<o?-1:r>o?1:a<s?-1:1}),e}function T(e,t){return o.isUndefined(t)&&(t=0),function(){var n=Array.prototype.slice.call(arguments),i=n[t];return o.isDate(i)&&(n[t]=r().getLocalDateTime(i)),e.apply(window,n)}}function R(e){var t=1,n=arguments.length,i=n%2==0,r=n-(i?2:1);if(n<3)throw"The CASE function requires at least 3 parameters.";for(;t<r;t+=2)if(e===arguments[t])return arguments[t+1];return i?arguments[n-1]:void 0}function D(e){var t,n=Array.prototype.slice.call(arguments,1),i=n.length;if(!o.isString(e)||!i)return!1;for(t=0;t<i;t++)if(-1!==e.indexOf(n[t]))return!0;return!1}function A(e){var t,n=Array.prototype.slice.call(arguments,1),i=n.length;if(!o.isString(e)||!i)return!1;for(t=0;t<i;t++)if(-1===e.indexOf(n[t]))return!1;return!0}var E={logical:{or:function(e,t){return e||t},and:function(e,t){return e&&t},"!=":function(e,t){return e!=t},"=":function(e,t){return e===t},"<":function(e,t){return e<t},"<=":function(e,t){return e<=t},">":function(e,t){return e>t},">=":function(e,t){return e>=t}},algebraic:{"+":function(e,t){return e+t},"-":function(e,t){return e-t},"*":function(e,t){return e*t},"/":function(e,t){return e/t},"%":function(e,t){return e%t}},unary:{"+":function(e){return+e},"-":function(e){return-e},"!":function(e){return!e}}};function F(t,n,i){return i||(i={}),function(t,n){var i=e.time;switch(n){case g:return parseInt(t,10);case y:case m:case v:case b:return parseFloat(t);case h:return(!o.isString(t)||"false"!==t.trim().toLowerCase())&&(null===t||void 0===t?t:!!t);case w:return o.isDate(t)&&(t=i.getLocalDateTime(t)),i.getSFDate(t);case S:return i.getSFDateTime(t)}return t}(r(t),i.outputType);function r(e){var t=e.class.major,i=e.class.minor;return"expression"===t?function(e,t){var n,i,o,s,l=t.params;"operational"===e?(n=r(l.head),l.operations?l.operations.forEach(function(e){n=a(n,e)}):l.operation&&(n=a(n,l.operation))):((s=(l.name||"").toUpperCase()).startsWith("C_")&&!s.startsWith("C__")&&(s="C__"+s.substring(2)),i=k(s),o=i&&l.arguments.map(function(e){return r(e)}),n=i&&i.evaluate(o));void 0===n&&(n=null);return n}(i,e):function(e,t){var i,r=t.params.value;null!==r&&void 0!==r||(r="");switch(e){case"keyword":switch(r.toLowerCase()){case"true":return!0;case"false":return!1;case"nan":return NaN;default:return null}case"number":return parseFloat(r);case"merge":i=o.mergeInContext("{{"+r+"}}",n,{asData:!0,apiExtensions:n.apiExtensions,coerceToJSType:!0,pageComponent:n.pageComponent});break;default:i=r}void 0===i&&(i=null);return i}(i,e)}function a(e,t){var n=t.operator,i=E[n.class.minor][n.params.symbol],o=t.operand,a=i&&o&&r(o);return void 0===e&&(e=null),void 0===a&&(a=null),i&&i(e,a)}}function N(e){try{this.__root=i.parser.parse(e)}catch(e){this.__error=e}}N.prototype={getTokenTree:function(){return this.__root||{}},getError:function(){return this.__error},evaluate:function(e,t){if(!this.__error)return F(this.__root,e,t)}},t(document.body).one("pageload",function(){e.builder&&e.builder.core&&(e.builder.core.formula={getFormulasAsItems:x})});var M=1,_="_prop"+M++,P="_prop"+M++,O="_prop"+M++,L="_prop"+M++,U="_prop"+M++,B="_prop"+M++,j="_prop"+M++,V="_prop"+M++;function G(e,t,n){if(!(this instanceof G))return new G(e,t,n);n=n||{};var i=C?null:n.namespace||"c",r=((C?"":i+"__")+e).toUpperCase();if(!o.isString(e)||!o.isFunction(t))throw"Bad Formula Initialization: both forumula formulaName and formula function must be defined";this[_]=e,this[P]=i,this[L]=n.argCount||n.numArgs,this[U]=n.returnType,this[B]=t,this[O]=r,this[j]=n.defaultBuilderState||n.defaultState,this[V]=n.deprecated||!1,I[r]=this}G.prototype={evaluate:function(e){var n=this[B];if(n)return 1===arguments.length&&t.isArray(e)||(e=arguments),n.apply(this,e)},getLocalName:function(){return this[_]},getNamespace:function(){return this[P]},getArgumentCount:function(){return this[L]},getReturnType:function(){return this[U]},getFullName:function(){return this[O]},getDefaultBuilderState:function(){return this[j]},_getIsDeprecated:function(){return this[V]},register:function(){!function(e){var t=e.getFullName();if(I[t]&&I[t]!==e)throw'A formula with the name "'+t+'" was already registered.';I[t]=e}(this)},unregister:function(){var e;e=this.getFullName(),I[e]&&delete I[e]},getFunction:function(){return o.log("Formula.getFunction is deprecated. Use Formula.evaluate instead.",s),this[B]},getName:function(){return o.log("Formula.getName is deprecated. Use Formula.getLocalName instead.",s),this.getFullName()},getNumArgs:function(){return o.log("Formula.getNumArgs is deprecated. Use Formula.getArgumentCount instead.",s),this.getArgumentCount()}},C=!0,t.each({ABS:{state:"ABS(number)",type:d,func:Math.abs},AMPM:{state:"AMPM(datetime)",type:f,func:T(r().getPeriod)},CASE:{state:"CASE(testValue, case1, result1, case2, result2, ..., default)",func:R},CEIL:{state:"CEIL(val)",type:f,func:Math.ceil},COMBINE_STRINGS:{state:"COMBINE_STRINGS(startString,endString,separator)",type:u,args:3,func:o.combineStrings,deprecated:!0},CONTAINS:{state:"CONTAINS(stringToExamine,stringToLookFor)",type:c,args:2,func:o.contains},CONTAINS_ALL:{state:"CONTAINS_ALL(stringToExamine, stringToLookFor1, stringToLookFor2, ...)",type:c,func:A},CONTAINS_ANY:{state:"CONTAINS_ANY(stringToExamine, stringToLookFor1, stringToLookFor2, ...)",type:c,func:D},ENDS_WITH:{state:"ENDS_WITH(stringToExamine,stringToLookFor)",type:c,args:2,func:o.endsWith},TODAY:{type:f,state:"TODAY()",args:0,func:function(){var e=new Date;return e.setHours(0,0,0,0),e}},DAY:{state:"DAY(date)",type:f,func:T(r().getDay)},DAY_NAME:{state:"DAY_NAME(date)",type:f,func:T(r().getDayName)},DAY_NAME_SHORT:{state:"DAY_NAME_SHORT(date)",type:f,func:T(r().getDayNameShort)},DAY_OF_WEEK:{state:"DAY_OF_WEEK(date)",type:f,func:T(r().getDayOfWeek)},DAY_OF_WEEK_UTC:{state:"DAY_OF_WEEK_UTC(date)",type:f,func:T(r().getUTCDayOfWeek)},FLOOR:{state:"FLOOR(val)",type:d,func:Math.floor},FORMAT_DATE:{state:"FORMAT_DATE(format,date)",type:f,args:2,func:T(r().formatDate,1)},FORMAT_TIME:{state:"FORMAT_TIME(format,datetime)",type:f,args:2,func:T(r().formatTime,1)},HOUR:{state:"HOUR(datetime)",type:f,func:T(r().getHour)},HOUR_UTC:{state:"HOUR_UTC(datetime)",type:f,func:r().getUTCHour},IF:{state:"IF(logic_test,value_if_true,value_if_false)",type:c,args:3,func:o.ifElse},ISBLANK:{state:"ISBLANK(val)",type:c,func:o.isBlank},JOIN_TEXT:{state:"JOIN_TEXT(separator,firstString,secondString,etcString)",type:u,args:3,func:o.joinStrings},LEFT:{state:"LEFT(string,numChars)",type:u,args:2,func:o.substringLeft},LEN:{state:"LEN(string)",type:u,func:o.size},LOWER:{state:"LOWER(string)",type:u,func:o.lowercase},MILLISECOND:{state:"MILLISECOND(datetime)",type:f,func:T(r().getMillisecond)},MINUTE:{state:"MINUTE(datetime)",type:f,func:T(r().getMinute)},MINUTE_UTC:{state:"MINUTE_UTC(datetime)",type:f,func:r().getUTCMinute},MODEL_LOOKUP:{state:"MODEL_LOOKUP(Lookup_Model_Id,Model_Field_To_Return,Model_Field_To_Search,Search_Value)",args:4,func:o.modelLookup},MONTH:{state:"MONTH(date)",type:f,func:T(r().getMonth)},MONTH_UTC:{state:"MONTH_UTC(date)",type:f,func:r().getUTCMonth},MONTH_NAME:{state:"MONTH_NAME(date)",type:f,func:T(r().getMonthName)},MONTH_NAME_SHORT:{state:"MONTH_NAME_SHORT(date)",type:f,func:T(r().getMonthNameShort)},NOW:{type:f,state:"NOW()",args:0,func:r().roundedNow},RIGHT:{state:"RIGHT(string,numChars)",type:u,args:2,func:o.substringRight},ROUND:{state:"ROUND(val)",type:d,func:Math.round},SECOND:{state:"SECOND(datetime)",type:f,func:T(r().getSecond)},SECOND_UTC:{state:"SECOND_UTC(datetime)",type:f,func:r().getUTCSecond},STARTS_WITH:{state:"STARTS_WITH(stringToExamine,stringToLookFor)",type:c,args:2,func:o.startsWith},UPPER:{state:"UPPER(string)",type:u,func:o.uppercase},VALUE:{state:"VALUE(text)",type:u,func:window.parseFloat},YEAR:{state:"YEAR(date)",type:f,func:T(r().getYear)},YEAR_UTC:{state:"YEAR_UTC(date)",type:f,func:r().getUTCYear}},function(e,t){new G(e,t.func,{argCount:t.args,returnType:t.type,defaultBuilderState:t.state,deprecated:t.deprecated})}),C=!1,t.extend(i,{CompiledFormula:N,FormulaFunction:G,evaluate:function(e,t,n){return n||(n={}),F(i.parser.parse(e),t,n)},get:k,map:function(){return n({},I)},Formula:G}),e.utils.runningTests()&&(i.internalFunctions={CASE:R,CONTAINS_ALL:A,CONTAINS_ANY:D})}(window.skuid)},function(e,t,n){"use strict";!function(e){var t=e.$,n=e.settings={},i=e.utils,r=i.KeyValueStore,o=n.__stores={},a="skuid.settings.added:",s="skuid.settings.modified:";function l(e){var t=o[e];return t instanceof r?t:void 0}t.extend(e.settings,{init:function(i,s){var l;1===arguments.length?s=i:(l=s,(s={})[i]=l),t.each(s,function(t,i){var s;if(n[t]){if(!((s=o[t])instanceof r))return!0}else s=new r,n[t]=s.get.bind(s),o[t]=s;s.extend(i),e.events.publish(a+t)})},get:function(e,t){var n,r;if(i.isString(e))return 1===arguments.length&&(e=(n=e.match(/^([^.]*)\.?(.*)?/))[1],t=n[2]),(r=l(e))?t?r.get(t):r:void 0},set:function(n,r,o){if(!i.isString(n))throw"Invalid namespace";var a,c,d,u,f,p,h={},g={},m={};f=(u=s+n)+".",2===arguments.length&&(n=(c=n.match(/^([^.]*)\.?(.*)?/))[1],(d=c[2])?m[d]=r:m=r),3===arguments.length&&i.isString(r)&&!i.isObject(o)&&(m[r]=o),a=l(n),t.each(m,function(e,t){(p=a.get(e))!==t&&(h[e]=t,g[e]=p)}),a.extend(m),t.each(m,function(t,n){e.events.publish(f+t,[{event:f+t,newValue:n,previousValue:g[t]}])}),e.events.publish(u,[{event:u,values:m,newValues:h,previousValues:g}])},__getStore:l,__getStores:function(){return t.map(Object.getOwnPropertyNames(o),l)}})}(window.skuid)},function(e,t,n){"use strict";var i,r=n(0),o=(i=r)&&i.__esModule?i:{default:i};!function(e){var t=e.$,n=e.utils,i=function(){var e=new Date;return e.setDate(e.getDate()+7),e.getTime()},r=function(e,n){for(var i=!1,r=0;r<e.length;r++){if(!e[r].inactive){i=!0;break}}if(i)return(n?n+"_":"")+t.map(e,function(e){var t,n="",i=e.encloseValueInQuotes;if(t=e.values&&e.values.length?e.values.join(","):i?"'"+e.value+"'":e.value,!e.inactive)return e.name?n+=e.name:e.field?n+=e.field:"param"===e.sourceType&&(n+=e.sourceParam),n+=e.operator+(t||"")}).sort().join("&")},a=[{name:"dataSourceMetadata",expires:!0,expiresDate:i},{name:"entityData",expires:!0,expiresDate:i,buildIdField:function(e){var n,i=e.dataSource.name,o=e.data,a=e.objectName,s=o.fields&&o.fields.length?function(e){var n=t.map(e,function(e){return e.id});return t.map(n,function(n){var i=e.find(function(e){return e.id===n});if(t.isArray(i)&&(i=i[0]),!i||!i.idField&&!i.uiOnly)return n}).sort().join(",")}(o.fields):"null",l=o.orderByClause?o.orderByClause.replace(" ",""):"null";return s||(s="null"),e.conditions&&e.conditions.length&&(n=r(e.conditions,o.conditionLogic)),i+"--"+a+"--"+(n=n||"null")+"--"+s+"--"+l},buildRow:function(e){var i,o=n.isString(e.dataSource)?e.dataSource:e.dataSource.name,a=e.data,s=e.objectName;return e.conditions&&e.conditions.length&&(i=r(e.conditions,a.conditionLogic)),t.extend(e,{id:this.buildIdField(e),data:e.data,dataSource:o,objectName:s,conditions:i,fields:a.fields,recordsLimit:e.data.recordsLimit,orderBy:a.orderByClause})}},{name:"entityMetadata",expires:!0,expiresDate:i,buildIdField:function(e){return e.dataSource.name+"--"+e.objectName}},{name:"pages",indexes:[{id:"name"},{id:"route"}],expires:!0,expiresDate:i,buildRow:function(e){return t.extend(e,{id:e.id,name:e.name,data:e.data})}},{name:"queries",expires:!0,expiresDate:i,buildRow:function(e){return t.extend(e,{id:e.id,data:e.data})}},{name:"saves",expires:!0,expiresDate:i,buildRow:function(e){return t.extend(e,{id:e.id,data:e.data})}},{name:"syncedSaves",expires:!0,expiresDate:i,buildRow:function(e){return t.extend(e,{id:e.id,data:e.data})}}];e.storage.registerVersionedSchemas(o.default.id,a)}(skuid)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var r=skuid.$L,o=["message","instructions","primaryButton","cancelButton"],a=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sessionWarningCheckTimeout,this.showingSessionWarning=!1,this.pageComponent=n,this.createModel(),this.sessionWarningCheck(t)}return i(e,[{key:"sessionWarningCheck",value:function(t){var n=this;clearTimeout(this.sessionWarningCheckTimeout);var i=t?e.getMillisecondsFromNow(t)-18e4:0;i<0?this.showWarning(t):this.sessionWarningCheckTimeout=setTimeout(function(){skuid.platform.checkSessionExpiration().then(function(e){return n.sessionWarningCheck(e)})},i)}},{key:"setIntervalChecks",value:function(e){var t=this;clearTimeout(this.sessionWarningCheckTimeout),this.showingSessionWarning=!0,this.setExpireMessageText(e),this.sessionCountDownInterval=setInterval(function(){return t.setExpireMessageText(e)},1e3)}},{key:"setExpireMessageText",value:function(e){var t=this.getMessaging(e),n=this.model.getFirstRow();return this.model.updateRow(n,t),this.model.save(),t.isExpired&&clearInterval(this.sessionCountDownInterval),this}},{key:"clickContinue",value:function(){var e=this;return skuid.platform.forceSessionActivity&&skuid.platform.forceSessionActivity().then(function(t){e.sessionWarningCheck(t)}).catch(function(){return skuid.platform.checkSessionLoginType(skuid.utils.userInfo.sessionId).then(function(e){if(!(!!e&&!!e.sso_config_id&&!!e.login_type&&"saml2"==e.login_type))throw new Error("Needs to login through the default skuid login page");var t=e.sso_config_id;skuid.platform.openLoginWindow({sso_login:"/auth/saml/sp/"+t+"/login?next="+window.location.pathname})}).catch(function(){window.addEventListener("message",function(t){t.origin===window.location.origin&&"login_success"===t.data&&e.sessionWarningCheck(null)}),skuid.platform.openLoginWindow()})}),this}},{key:"createModel",value:function(){this.model=new skuid.model.Model({id:"session-warning-"+skuid.utils.generateGUID(),dataSource:skuid.dataSource.get("Ui-Only"),preventUnloadIfUnsavedChanges:!1,createRowIfNoneFound:!0,doQuery:!1,fields:o.map(function(e){return{displaytype:skuid.constants.DISPLAY_TYPES.TEXT,accessible:!0,editable:!0,id:e}})}).initialize().register()}},{key:"unregister",value:function(){this.model.unregister(),this.showingSessionWarning=!1,clearTimeout(this.sessionWarningCheckTimeout),clearInterval(this.sessionCountDownInterval)}},{key:"getMessaging",value:function(t){var n=e.getExpiration(t),i=n.minutes,o=n.seconds,a=this.nl,s={isExpired:o<=0,primaryButton:r("continue","Continue"),cancelButton:r("cancel","Cancel")};return o>0?(s.instructions='Click the "'+s.primaryButton+'" button below to renew your session and continue working.',s.message=i>0?"Your session will expire in "+i+" minute"+(1===i?"":"s")+".":"Your session will expire in "+o+" second"+(1===o?"":"s")+"."):(s.primaryButton=r("login","Log In"),s.message="Your session has expired.",s.instructions='Press "'+s.primaryButton+'" to open the login page in a new window.'+a+a+"(You may need to disable pop-up blocking for this site.)"),s}}],[{key:"getMillisecondsFromNow",value:function(e){var t=new Date;return new Date(e).getTime()-t.getTime()}},{key:"getExpiration",value:function(t){var n=e.getMillisecondsFromNow(t),i=Math.floor(n/1e3);return{seconds:i,minutes:Math.floor(i/60)}}}]),e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(190),a=(i=o)&&i.__esModule?i:{default:i};var s=skuid.$,l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),r(t,[{key:"showWarning",value:function(e){var t=this;if(!this.showingSessionWarning){var n=this.getMessaging(e),i=this.nl,r=void 0,o=void 0,a=s("<div>"),l=s("<div>"),c=s("<div>").text(n.primaryButton).skooButton().click(function(){t.clickContinue(),r.dialog("close")}),d=s('<div class="nx-button-secondary">').text(n.cancelButton).skooButton().click(function(){r.dialog("close")}),u=function(e){a.text(e.message),l.html(i+e.instructions+i+i),c.button("option","label",e.primaryButton),d.button("option","label",e.cancelButton),r.dialog({position:o})};r=s("<div>").append(a,l,c,d),o={my:"right-20 bottom-20",at:"right bottom",of:window};var f=skuid.events.subscribe("ui.resize",function(){r.dialog({position:o})});this.pageComponent.storeSubscription(f),r.dialog({title:"Session Warning",modal:!1,width:300,position:o,beforeClose:function(){t.unregister(),f.unsubscribe()}}),u(n),this.model.subscribe("row.updated",function(){var e=t.model.getFirstRow();u(e)}),this.setIntervalChecks(e)}}},{key:"nl",get:function(){return"<br/>"}}]),t}();t.default=l},function(e,t,n){"use strict";var i,r=n(191),o=(i=r)&&i.__esModule?i:{default:i};skuid.utils.addSessionWarningCheck=function(e,t){return new o.default(e,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var o=skuid,a=o.$L,s=o.utils,l=o.$,c=window.File&&window.FileReader&&window.FileList&&window.Blob&&window.XMLHttpRequest,d=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.initialized=!1;var n=t.component,r=t.context,o="object"===i(t.model)?t.model:skuid.$M(t.model),d=n?l(n.xmlDefinition):void 0,u=d?n.createConditionsFromXml(d):null,f=t.row||e.getRow(o,r,u),p=t.dataSource,h=o?o.getDataSource():skuid.dataSource.get(p),g=t.saveTo,m="field"===g,v=t.idField,y=t.storeAs,b=t.deletable||t.deleteable,w=t.editable,S=t.fileName,C=void 0,I=void 0,k=void 0,x=void 0,T=c&&s.isApiEnabled()&&s.userInfo.isAuthenticated;if(!o&&!t.model&&r&&r.model&&(o=r.model),h||m)if(x=h.getUploadMethod(y),m&&(x={}),x||m)if(o||!x.needsRecordContext)if(!x.needsRecordContext||f){var R=!0;if(x.needsRecordContext){if(!o.accessible)return void this.addError("You do not have permission to upload files to this record.");if(o.isRowNew(f))return this.addError("This record must be saved before you can upload files."),void(this.isNewRow=!0)}if(x.needsFieldContext){if(!(k=v))return void this.addError("No image field was specified");C=o.getFieldValue(f,k),I=this.getFileId(x,k,o,f),S=this.getFileName(x,k,o,f);var D=o.getField(k);R=o.accessible&&(w||b)&&(o.updateable&&D.editable||this.fieldValue)}this.canUpload=!1,this.supportsDragAndDrop=T,x.supportsIframeUpload&&x.supportsIframeUpload()?this.canUpload=!0:T&&(this.canUpload=!0),n&&(this.component=n),this.model=o,this.row=f,this.dataSource=h,this.storeAs=y,this.saveTo=g,this.uploadMethod=x,this._deletable=b,this.editable=w,this.idField=v,this.xmlDef=d,this.dataSourceName=p,this.fieldValue=C,this.fileId=I,this.fileName=S,this.fieldName=k,this.canCreateOrUpdateImage=R,n&&(this._GUID=n._GUID),this.autoRefreshModelsOnUpload=t.autoRefreshModelsOnUpload,this.field=t.field,this.displayAs=t.displayAs,this.element=t.element,this.cacheBuster=t.cacheBuster,this.description=t.description,this.snippetName=t.snippetName,this.enforceMaxFileSize=!!t.enforceMaxFileSize,this.maxFileSize=parseInt(t.maxFileSize,10),this.defaultMaxFileSizeMessage=a("error_exceeds_max_file_size"),this.uploadSuccessActions=t.uploadSuccessActions,this.uploadFailureActions=t.uploadFailureActions,this.initialized=!0}else this.addError("No record found for file component.");else this.addError("This upload method requires a record context, but could not find one.");else this.addError(skuid.label.merge(a("error_could_not_find_upload_method"),y));else this.addError(skuid.label.merge(a("error_invalid_file_upload_data_source"),p))}return r(e,[{key:"addError",value:function(e){this.error=e}},{key:"shouldSaveToField",value:function(){return"field"===this.saveTo}},{key:"getFileId",value:function(e,t,n,i){var r=e.getFileIdField&&e.getFileIdField(t);return n.getFieldValue(i,r)}},{key:"getFileName",value:function(e,t,n,i){var r=e.getFileNameField&&e.getFileNameField(t);return n.getFieldValue(i,r)}},{key:"handleUpload",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("field"===this.saveTo){n.startHook&&n.startHook({fileName:t[0].name});var i=this.model,r=this.row,o=this.field,a=new FileReader;return a.onload=function(e){var a={};a[o]=e.target.result,i.updateRow(r,a),n.endHook&&n.endHook({newFileName:t[0].name})},void a.readAsText(t[0])}if(t.length){var s=void 0;Array.from(t).forEach(function(t){s=s?s.then(function(){return e.uploadFile(t,n)}):e.uploadFile(t,n)})}return!1}},{key:"uploadFile",value:function(e){var t,n,i=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=skuid.$.Deferred(),a=this.dataSource,s=this.getOptions(),l=this.getComponent(),c=function(e){r.startHook&&r.startHook(e)},d=function(e){r.endHook&&r.endHook(e),e&&e.message?o.reject(e.message):o.resolve()},u=function(e){r.progressHook&&r.progressHook(e)};if(this.enforceMaxFileSize&&e.size>this.maxFileSize){var f=skuid.label.merge(this.defaultMaxFileSizeMessage,e.name,(t=""+this.maxFileSize,n=[{value:"000000000",label:"GB"},{value:"000000",label:"MB"},{value:"000",label:"KB"},{value:"",label:"B"}].find(function(e){return t.endsWith(e.value)}),""+t.substring(0,t.length-n.value.length)+n.label));r.endHook({message:f})}else a.authenticate().then(function(){i.uploadMethod.upload(e,l,s,c,d,u)},function(e){r.endHook({message:e})});return o.promise()}},{key:"uploadFinished",value:function(e){var t=this,n=void 0,i=e&&(e.newFileId||e.newAttachmentId),r=new Date;this.cacheBuster=r.getTime(),e&&e.newFileName&&(this.fileName=e.newFileName),i&&(this.fileId=i,this.fieldValue=e.newFieldValue||e.newImageId,this.syncModel()),e&&e.message?(this.fileId&&this.fileName&&"image"===this.displayAs&&!this.fileId&&this.fileName&&(this.fileName=""),this.uploadFailureActions&&skuid.actions.runActionsNode(this.uploadFailureActions,this,{model:this.model,row:this.row,$Error:{Message:e.message}})):(this.uploadMethod.needsFieldContext||this.uploadMethod.canRunPostUploadSnippet&&this.snippetName&&skuid.snippet.get(this.snippetName)(e),this.uploadMethod.relatedObjectName&&this.autoRefreshModelsOnUpload&&(n=[],skuid.model.list().forEach(function(e){var i=e.objectName===t.uploadMethod.relatedObjectName,r=e.dataSource===t.uploadMethod.dataSource;i&&r&&(n.push(e),e.cancel())}),skuid.model.updateData(n)),this.uploadSuccessActions&&skuid.actions.runActionsNode(this.uploadSuccessActions,this,{model:this.model,row:this.row,apiExtensions:{$Result:{body:e&&e.body?e.body:{}}}}))}},{key:"deleteFile",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=function(n){n&&n.message||(e.fileId=null,e.fileName=null,e.fieldValue=null,e.syncModel()),t.endHook&&t.endHook(n)};this.dataSource.authenticate().then(function(){return t.startHook&&t.startHook(),e.uploadMethod.deleteFile({context:{model:e.model,row:e.row},component:e.getComponent(),dataSource:e.uploadMethod.dataSource})}).then(n).catch(function(e){return n({message:e})})}},{key:"syncModel",value:function(){var e={},t=this.model,n=this.row,i={},r=this.uploadMethod,o=r.getFileIdField&&r.getFileIdField(this.fieldName),a=r.getFileNameField&&r.getFileNameField(this.fieldName),c={};t&&n&&(e[t.getRowId(n)]=i,this.fieldName&&(this.fieldValue===n[this.fieldName]&&this.fileId===t.getFieldValue(n,o,!0)||(i[this.fieldName]=this.fieldValue),s.setObjectProperty(c,o,this.fileId),s.setObjectProperty(c,a,this.fileName),this.fieldValue?(l.each(c,function(e,t){i[e]=t}),l.extend(n,i)):(delete n[this.fieldName],l.each(c,function(e){return delete n[e]})),s.size(i)&&t.notifyFieldsOfChange(e,{initiatorId:this._GUID})))}},{key:"getComponent",value:function(){return{model:this.model,row:this.row,ownerIdField:this.ownerIdField,fieldValue:this.fieldValue,fieldName:this.fieldName,fileId:this.fileId,fileName:this.fileName,options:this.getOptions()}}},{key:"getOptions",value:function(){return{description:this.description,storeAs:this.storeAs,saveTo:this.saveTo,uploadMethod:this.uploadMethod,field:this.field,saveToModel:this.model&&this.model.id,model:this.model,row:this.row,displayAs:this.displayAs,autoRefreshModelsOnUpload:this.autoRefreshModelsOnUpload,idField:this.idField,deletable:this.deletable,editable:this.editable,_GUID:this._GUID,cacheBuster:this.cacheBuster,xmlDef:this.xmlDef}}},{key:"deletable",get:function(){return this._deletable}},{key:"deleteable",get:function(){return this._deletable}}],[{key:"getRow",value:function(e,t,n){var i=void 0;return e&&e.data&&(i=n&&n.length?e.getRows(n,t):t&&e&&t.model&&t.row&&t.model===e?[t.row]:e.getRows(null,t)),i&&i.length?i[0]:null}}]),e}();t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var r=skuid.utils,o=skuid.$,a=r._ie,s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.fileController=t,this.uploadMethod=t.uploadMethod,this.fileName=t.fileName,this.description=t.description,this._GUID=t._GUID,this.progressDiv=o("<div>").addClass("nx-file-progress"),this.dragAndDrop=t.supportsDragAndDrop,t.supportsDragAndDrop?this.iframe=o('<input style="display:none;" type="file" id="'+r.generateUniqueId()+'" multiple>'):this.iframe=o('<iframe style="display:none;" src="" frameborder="0">')}return i(e,[{key:"setSource",value:function(e,t,n){var i=this.uploadMethod;if(!this.dragAndDrop){var r=this.description||"",o=this.fileName||"";i&&i.getIframeSrc&&this.iframe.attr("src",i.getIframeSrc(e,t,n,r,o))}}},{key:"pickFile",value:function(){this.dragAndDrop?this.iframe.click():this.iframe.contents().find("input[type=file]").click()}},{key:"startProgress",value:function(){this.fileComponent.progressParentDiv&&this.fileComponent.progressParentDiv.append(this.progressDiv)}},{key:"handleProgress",value:function(e){if(this.fileComponent.progressParentDiv){var t=Math.round(e.loaded/e.total*100);t<100&&this.progressDiv.css("width",t+"%")}}},{key:"endProgress",value:function(){var e=this;this.fileComponent.progressParentDiv&&(this.progressDiv.css("width","100%"),setTimeout(function(){return e.progressDiv.detach()},1e3))}},{key:"uploadFile",value:function(e){var t=this,n=this.fileController,i=this.fileController.element;return n.uploadFile(e,{startHook:function(e){t.startProgress(),i.trigger("imageuploadstarted",e)},progressHook:function(e){t.handleProgress(e)},endHook:function(e){t.endProgress(),i.trigger("imageuploadcomplete",e)}})}},{key:"attach",value:function(e){var t,n,i,r,s,l=this,c=this.fileController,d=e.elem,u=!1;if(this.iframe.appendTo(d),this.element=d,this.fileComponent=e,this.dragAndDrop){n=o(document.body),i=o("<div>").addClass("nx-file-droppable").text(e.buttonText),r=function(e){e.preventDefault();var t=e.originalEvent.dataTransfer?e.originalEvent.dataTransfer.files:e.target.files;c.handleUpload(t,{startHook:function(e){l.startProgress(),d.trigger("imageuploadstarted",e)},progressHook:function(e){l.handleProgress(e)},endHook:function(e){l.endProgress(),d.trigger("imageuploadcomplete",e)}})};var f=function(){s&&clearTimeout(s),s=setTimeout(function(){i.detach(),u=!1,i.removeClass("nx-file-dropping")},100)};this.iframe.on("click",function(e){this.value=null,e.stopPropagation()}).on("change",r),d.on("dragover",function(e){a||e.stopPropagation(),e.preventDefault(),e.originalEvent.dataTransfer.dropEffect="copy"}).on("dragenter",function(e){a&&(e.stopPropagation(),e.preventDefault(),f()),i.addClass("nx-file-dropping"),a&&(u||(d.append(i),u=!0))}).on("dragleave",function(e){a&&(e.stopPropagation(),e.preventDefault()),i.removeClass("nx-file-dropping")}).on("drop",r),n.on("dragenter."+this._GUID,function(e){e.preventDefault(),a?(u||(d.append(i),u=!0),f()):(t=e.target,d.append(i))}).on("dragover."+this._GUID,function(e){e.preventDefault(),a&&f()}).on("dragleave."+this._GUID,function(e){a||t!==e.target||(i.detach(),i.removeClass("nx-file-dropping"))}).on("drop."+this._GUID,function(e){return e.preventDefault(),e.stopPropagation(),i.detach(),i.removeClass("nx-file-dropping"),t=null,!1})}}},{key:"unregister",value:function(e){var t=e.options._GUID;o(document.body).off("dragenter."+t+" dragleave."+t+" drop."+t)}}]),e}();t.default=s},function(e,t,n){"use strict";var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=a(n(194)),o=a(n(193));function a(e){return e&&e.__esModule?e:{default:e}}var s=skuid.utils,l=skuid.$L,c=skuid.$,d=window.File&&window.FileReader&&window.FileList&&window.Blob&&window.XMLHttpRequest,u=function(){function e(t,n){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var o,a=this,u=a.fileController=this.initializeFileController(t,n),f=u.uploadMethod,p=u.dataSource,h=u.row,g=u.model,m=u.canCreateOrUpdateImage,v=u.saveTo,y=u.canUpload,b=u.displayAs,w=u.deletable,S=u.editable,C=u.fileId;if(!u.initialized){if(u.isNewRow)var I=skuid.events.subscribe("models.saved",function(i){g.id in i.models&&(g.isRowNew(h)||(t.empty(),new e(t,n),skuid.events.unsubscribe(I)))});return t.text(u.error),!1}if(t.data("object",a).addClass("nx-fileupload"),a.elem=t,a.options=n,a.buttonText=n.label||l("upload"),a.dataSource=p,t.off("imageuploadcomplete imageuploadstarted mouseenter mouseleave click drop dragleave dragenter dragover"),(m||"field"===v)&&(a.uploader=new r.default(u),y?(a.uploader.attach(a),h&&g.getRowId(h)&&a.uploader.setSource({row:h,model:g},a.elem,a.fieldName)):t.text((o=s.isApiEnabled())||d?o&&!d?"Your browser does not support HTML5 file uploads.":!o&&d?"You do not have permission to upload files using the API.":void 0:"You either do not have permission to upload files using the API, or your browser does not support HTML5 file uploads.")),a.uploader&&y||(m=u.canCreateOrUpdateImage=!1),a.status=c("<div>").addClass("nx-fileupload-status").css({float:"none",display:"inline-block"}).appendTo(t).hide(),a.statustext=c("<div>").appendTo(a.status),"filename"===b||f.forceStoreAsFileName){var k,x;if(!1!==m&&a.uploader&&(x=c("<div>"),a.progressParentDiv=x,skuid.mobile?(x.addClass("sm-button").css("display","inline-block"),k=new skuid.mobile.ui.Button({icon:"fa-plus",label:a.buttonText,element:x,iconColor:"green"}),x.on("tap",function(){a.uploader.pickFile()})):x.text(a.buttonText).css("vertical-align","top").skooButton({icon:"sk-icon-upload"}).click(function(e){e.stopPropagation(),a.uploader.pickFile()}),x.appendTo(t)),skuid.mobile||(a.status.addClass("nx-actionselect nx-status").css({"margin-left":"4px","word-break":"break-all"}),a.statustext.addClass("nx-actionselect-text")),g&&g.updateable&&w){if(skuid.mobile){a.deletebutton=c('<div class="sm-button">');var T=new skuid.mobile.ui.Button({icon:"fa-minus",element:a.deletebutton,iconColor:"red"});a.deletebutton.on("tap",function(){T.startProcessing(),a.deleteImage()}),t.on("imagedeletecomplete",function(){T.stopProcessing()})}else a.deletebutton=c('<div class="sk-icon inline sk-icon-delete">').css({border:"3px solid #EEE","vertical-align":"top","background-color":"#EEE","margin-top":"3px",cursor:"pointer"}),a.deletebutton.click(function(){a.deleteImage()});a.deletebutton.css("display","inline-block").appendTo(t)}t.on("imageuploadstarted",function(e,t){i.fileController.supportsDragAndDrop||(i.fileName=t.fileName),i.setStatus(skuid.label.merge(l("uploading"),t.fileName)),a.status.off("click.skuid"),k&&k.startProcessing()}),k&&t.on("imageuploadcomplete",function(){k.stopProcessing()})}else"image"===b&&(a.progressParentDiv=a.elem,a.elem.children(".nx-edithover").remove(),a.elem.addClass("nx-attachmentimage"),a.defaultImageSrc=s.getDefaultImageUrl(a.options.defaultImage||"person"),a.image=c("<img>").addClass("nx-attachmentimage-image").css("max-width","100%").appendTo(t),!1!==m&&a.elem.on("mouseenter",function(){S&&a.uploader&&a.elem.append(c("<div>").addClass("nx-edithover sk-icon inline sk-icon-edit").css({"background-color":"white",opacity:"0.8",border:"4px solid white"}).click(function(e){a.elem.find(".nx-error").remove(),a.uploader&&a.uploader.pickFile(),e.stopPropagation()})),f.needsFieldContext&&!C||!w||a.elem.append(c("<div>").addClass("nx-edithover sk-icon inline sk-icon-delete").css({cursor:"pointer","background-color":"white",opacity:"0.8",border:"4px solid white",left:"4px"}).click(function(e){a.elem.find(".nx-error").remove(),a.deleteImage(),e.stopPropagation()}))}).on("mouseleave",function(){a.elem.find("div.nx-edithover").remove()}));t.on("imageuploadcomplete",function(e,t){a.fileController.uploadFinished(t);var n,r=t&&(t.newFileId||t.newAttachmentId),o=a.fileController,s=o.fileId,c=o.fileName;r&&a.draw(),t&&t.message?(n={text:t.message,hideIn:4},s&&c&&"image"!==b&&(n.complete=function(){i.setStatus(c)}),i.setStatus(n)):f.needsFieldContext||i.setStatus({text:l("upload_successful"),hideIn:2})}),a.draw()}return i(e,[{key:"draw",value:function(){var e=this,t=this.fileController,n=t.uploadMethod,i=t.fileId,r=t.fileName,o=t.displayAs,a=t.fieldName,l=t.deletable,d=t.cacheBuster,u=d?"&cachebuster="+d:"",f=function(){if(i){var t,o=c("<img>").css({"max-height":"600px","max-width":"800px"}),a=e.image&&e.image.attr("src");a?o.attr("src",a):n.getSrc&&n.getSrc({context:{id:i},component:e.fileController.getComponent(),paramString:u,dataSource:n.dataSource}).then(function(e){t=e,o.attr("src",e)},function(){o.attr("src","")}),o.load(function(){var e=c("<div>").attr("title",s.encodeHTML(r)).append(o).dialog({close:function(){c(this).remove()},modal:!0,width:"auto",resizable:!1,open:function(){c(".ui-widget-overlay").on("click",function(){e.dialog("close")})},dialogClass:"nx-imageview"})}),o.error(function(){t&&skuid.dataSource.utils.downloadWithLink(r,t)})}};if("filename"===o||(n||{}).forceStoreAsFileName)i&&r&&a?(e.setStatus(r),e.status.off("click.skuid").on("click.skuid",function(){f()}),l&&e.deletebutton&&e.deletebutton.show()):(e.deletebutton&&e.deletebutton.hide(),e.status.hide());else if("image"===o){if(i||!n.needsFieldContext){var p={};i&&(p.id=i),n.getSrc&&n.getSrc({context:p,component:e.fileController.getComponent(),paramString:u,dataSource:n.dataSource}).then(function(t){e.image.attr("src",t)},function(){e.image.attr("src","")})}else e.defaultImageSrc&&e.image.attr("src",e.defaultImageSrc);e.image.error(function(){e.defaultImageSrc&&e.image.attr("src",e.defaultImageSrc)}),e.elem.off("click.skuid").on("click.skuid",function(){f()}),e.status&&e.status.hide()}}},{key:"setStatus",value:function(e){var t,n,i,r=this.status,o=this.statustext;e&&(s.isString(e)?t=e:(t=e.text,n=e.hideIn,i=e.complete)),r&&o&&(this.statusTimeout&&clearTimeout(this.statusTimeout),skuid.ui.setStatus(r,o,t),n>=0&&(this.statusTimeout=setTimeout(function(){r.animate({opacity:0},{duration:2e3,complete:i||function(){r.hide()}})},1e3*n)))}},{key:"deleteImage",value:function(){var e=this,t=this.fileController.fileId;this.fileController.deleteFile({startHook:function(){e.setStatus(l("deleting"))},endHook:function(n){n&&n.message?e.setStatus({text:n.message,hideIn:2,complete:function(){return e.draw()}}):(e.elem.trigger("imagedeletecomplete",{oldFileId:t}),e.draw())}})}},{key:"unregister",value:function(){this.elem&&this.elem.remove&&this.elem.remove(),this.uploader&&this.uploader.unregister(this)}},{key:"initializeFileController",value:function(e,t){return new o.default({component:t.component,element:e,context:t.context,model:t.model,row:t.row,dataSource:t.datasource,idField:t.idField,field:t.field,saveTo:t.saveTo,storeAs:t.storeAs,displayAs:t.displayAs,editable:t.editable,deletable:t.deletable,fileName:t.filename,maxFileSize:t.maxFileSize,enforceMaxFileSize:t.enforceMaxFileSize,cacheBuster:t.cacheBuster,snippetName:t.snippetName,autoRefreshModelsOnUpload:t.autoRefreshModelsOnUpload,uploadSuccessActions:t.onUploadSuccessActions,uploadFailureActions:t.onUploadFailureActions})}}]),e}();s.FileComponent=u},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0});var r=window||void 0,o=function(){return r.URL||r.webkitURL||r},a=r.document.createElementNS("http://www.w3.org/1999/xhtml","a"),s="download"in a,l=/constructor/i.test(r.HTMLElement)||r.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent),d=function(e){(r.setImmediate||r.setTimeout)(function(){throw e},0)},u=function(e){setTimeout(function(){"string"==typeof e?o().revokeObjectURL(e):e.remove()},4e4)},f=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},p=function(e,t,n){n||(e=f(e));var i,p=this,h="application/octet-stream"===e.type,g=function(){!function(e,t,n){for(var i=(t=[].concat(t)).length;i--;){var r=e["on"+t[i]];if("function"==typeof r)try{r.call(e,n||e)}catch(e){d(e)}}}(p,"writestart progress write writeend".split(" "))};if(p.readyState=p.INIT,s)return i=o().createObjectURL(e),void setTimeout(function(){a.href=i,a.download=t,function(e){var t;try{t=new MouseEvent("click")}catch(e){(t=document.createEvent("MouseEvent")).initEvent("click",!0,!1)}e.dispatchEvent(t)}(a),g(),u(i),p.readyState=p.DONE});!function(){if((c||h&&l)&&r.FileReader){var t=new FileReader;return t.onloadend=function(){var e=c?t.result:t.result.replace(/^data:[^;]*;/,"data:attachment/file;");r.open(e,"_blank")||(r.location.href=e),e=void 0,p.readyState=p.DONE,g()},t.readAsDataURL(e),void(p.readyState=p.INIT)}i||(i=o().createObjectURL(e)),h?r.location.href=i:r.open(i,"_blank")||(r.location.href=i);p.readyState=p.DONE,g(),u(i)}()},h=p.prototype;i="undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,n){return t=t||e.name||"download",n||(e=f(e)),navigator.msSaveOrOpenBlob(e,t)}:function(e,t,n){return new p(e,t||e.name||"download",n)},h.abort=function(){},h.readyState=h.INIT=0,h.WRITING=1,h.DONE=2,h.error=h.onwritestart=h.onprogress=h.onwrite=h.onabort=h.onerror=h.onwriteend=null;t.saveAs=i},function(e,t,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=n(196);!function(e){e.utils||(e.utils={});var t,n,o,a,s=e.$,l=e.utils,c=s.extend,d=e.time,u=s.inArray,f={}.toString,p=e.constants,h=e.currency,g=s.ui.keyCode,m="_crEventSubscriptions",v=p.MERGE_CONTEXTS,y=v.GLOBAL,b=v.MODEL,w=v.ROW,S="fieldvalue",C='"',I='""',k=[",",'"',"\n"],x=p.LOG_LEVELS,T=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,R=/^([and|or|\d|\(|\)]+)$/,D=/\{{2,3}[^\{\}]+\}{2,3}/g,A="PageBuilder",E=p.JS_TYPES,F=E.BOOLEAN,N=E.NUMBER,M=E.STRING,_=E.OBJECT,P=E.FUNCTION,O=E.UNDEFINED,L=p.DISPLAY_TYPES,U=L.BOOLEAN,B=L.INTEGER,j=L.NUMBER,V=L.PERCENT,G=L.CURRENCY,H=L.DOUBLE,z=L.DATE,q=L.DATETIME,$=L.ID,W=L.REFERENCE,Y="nodata",K={createFields:!1,registerFields:!1},X={createFields:!0,registerFields:!1},J={global:1,model:1,row:1},Q=[B,j,V,G,H],Z=[z,q],ee={defaultcurrency:"defaultCurrency",firstname:"firstName",lastname:"lastName",organizationid:"organizationId",organizationname:"organizationName",profileid:"profileId",profilename:"profileName",sessionid:"sessionId",userid:"userId",username:"userName",userroleid:"userRoleId",usertype:"userType"},te={includes:1,excludes:1,in:1,"not in":1},ne=function(){return e.platform.getLayoutFields()},ie=function(){return e.dataSource.getType(p.SALESFORCE)},re=function(){for(var e=3,t=document.createElement("div"),n=t.getElementsByTagName("i");t.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e",n[0];);return e<=4&&!window.ActiveXObject&&"ActiveXObject"in window?11:e>4?e:void 0}(),oe=2,ae="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz_-".split(""),se=window.location.host,le=Date.now(),ce=It({prefix:"sk-merge"}),de=",";function ue(){return e.page.name}function fe(){return e.platform.getName()}function pe(e){var t=fe();return s.isArray(e)?-1!==e.indexOf(t):t===e}function he(){return e.utils.userInfo}function ge(){return se}function me(t,n,i,r){return e.platform.getResourceUrl({name:t,namespace:n,nestedPath:i,modstamp:r})}function ve(t){var n=t&&Ye(t,"/"),i=e.page.sitePrefix;return i&&"null"!==i&&n&&!Ye(t,i)?(We(i,"/s")&&(i=i.substring(0,i.length-2)),i+t):t}function ye(e){if(e&&e.length)return e.charAt(0).toUpperCase()+e.slice(1)}function be(){return we.apply(this,["/"].concat(Array.prototype.slice.apply(arguments)))}function we(e,t){var n=s.isArray(t)?t:Array.prototype.slice.call(arguments,1);return e||(e=""),n.reduce(function(t,n){if(!n)return t;if(!t)return n;var i=We(t,e),r=Ye(n,e);return i||r?i&&r?t+n.substring(e.length):t+n:t+e+n},"")}function Se(e){if(e&&l.isString(e))try{e=JSON.parse(e)}catch(e){}return e}function Ce(e,t,n,i){i||(i=K);var r=n&&n.model?n.row?w:b:y,o=s("<div>"),a=e.attr(t);if(void 0!==a)return r===w?o.append(pt(w,a,i,n.model,n.row)):r===b?o.append(pt(b,a,i,n.model)):o.append(pt(y,a,i)),o.text()}function Ie(t,n,i){if(!t)return null;n||(n={}),i||(i={});var r=s("<div>").attr("title",Ce(t,"title",n,{createFields:!0,registerFields:!1})),o=[],a=[],l=!0,c=!0;return n.popup=r,"false"!==t.attr("modal")&&!1!==i.modal||(l=!1),"false"!==t.attr("resizable")&&!1!==i.resizable||(c=!1),t.children("components").first().children().each(function(){var t=e.component.factory({definition:this,context:n});o.push(t.element),a.push(t)}),r.append(o).dialog({close:function(){a&&s.each(a,function(){this.unregister&&this.unregister()}),r.dialog("destroy").remove(),i.close&&i.close.apply(this);var o=t.children("afterclose");o.length&&e.actions.runActionsNode(o,null,n)},open:function(){var n=r.parent();function o(e){var t=window.innerHeight,i=parseInt(.8*t,10),o=function(){r.css({"overflow-y":"scroll",height:i-n.find(".ui-dialog-titlebar").outerHeight()+"px"}),r.find(".popup-content-padding").length||r.append(s('<div class="popup-content-padding">').css({height:"15px"})),n.css({height:i+"px",top:parseInt(.1*t,10)+"px",position:"fixed"})};n.innerHeight()>i?o():e&&o()}o(!1),s(window).resize(function(){o(!0)}),e.events.subscribe("skuid.includepanel.loadcomplete",function(){o(!0)}),n.find(".ui-dialog-titlebar-close .ui-icon").after(s(e.ui.createIcon(t.attr("closeicon")||"sk-icon-close")).css({left:"0",display:"inline-block"})).remove(),i.open&&i.open.apply(this)},beforeClose:function(){i.beforeClose&&i.beforeClose.apply(this)},modal:l,resizable:c,width:t.attr("width")||"600px",buttons:i.buttons||[]}),r}function ke(e){e||(e={});var t,n,i,r,o={registerFields:!1,nl2br:!1},a=e.fieldMetadata;if(a&&(i=a.rel,r=a.id),!("template"in e||"fieldMetadata"in e))throw"skuid.utils.calculateReferenceText: Either fieldMetadata or a template must be provided.";if(e.template){var s=r.indexOf(".");n=r&&-1!=s?r.substring(0,s+1):"",t=e.template,o.fieldPrefix=n+i+"."}else{var l,c;if(a.ref&&-1!=a.ref.indexOf(",")||a.referenceTo&&a.referenceTo.length>=2){if(e.targetObject){var d=e.targetObject.split(".");l=d[d.length-1]}else l=a.referenceTo[0].objectName;c="Name"}else l=a.ref,c=e.model.getDataSource().getNameField(l||e.model.objectName);i?(-1!=r.indexOf(".")&&(i=r.substring(0,r.lastIndexOf(".")+1)+i),t="{{"+i+"."+c+"}}"):t="{{"+c+"}}"}return e.model.getRowMergeResult(e.row,t,o)}function xe(e,t){var n=e.split(".");n.pop();var i=n.join(".");return t.displaytype===W?(i?i+".":"")+t.rel:i}function Te(e){return e.referenceTo[0]}function Re(e,t,n){var i=Qe(Te(t).objectName,n);if(i)return xe(e,t)+"."+i}function De(t){var n=ee[t]||t,i=he();return"ismulticurrencyorganization"===t?e.utils.isMultiCurrencyOrganization:n in i?i[n]:void 0}function Ae(e,t,n){var i,r=!0,o=t.length;if(n||(n={}),e?(i=e.toLowerCase().replace(/\s+/g,""),R.test(i)||(r=!1)):r=!1,!r)throw"Invalid Condition Logic: "+e;for(n.customAndString&&(i=i.replace(/and/g,n.customAndString)),n.customOrString&&(i=i.replace(/or/g,n.customOrString));o>0;o--)i=i.replace(o,t[o-1]);return i}var Ee={"!=":function(e,t){return e!==t},"=":function(e,t){return e===t},gt:function(e,t){return e>t},lt:function(e,t){return e<t},gte:function(e,t){return e>=t},lte:function(e,t){return e<=t},"starts with":function(e,t){return Ye(e,t,!0)},"does not start with":function(e,t){return!Ye(e,t,!0)},"ends with":function(e,t){return We(e,t,!0)},"does not end with":function(e,t){return!We(e,t,!0)},contains:function(e,t){return Ke(e,t,!0)},"does not contain":function(e,t){return!Ke(e,t,!0)},includes:function(e,t){return-1!==u(t,e.split(";"))},excludes:function(e,t){return-1===u(t,e.split(";"))}},Fe={"!=":function(e,t){return e<t[0]||e>=t[1]},"=":function(e,t){return e>=t[0]&&e<t[1]},gt:function(e,t){return e>=t[1]},lt:function(e,t){return e<t[0]},gte:function(e,t){return e>=t[0]},lte:function(e,t){return e<t[1]}};function Ne(e){var t=e.left,n=e.right,r=e.op,o=e.displaytype,a=Ee[r]||Ee["="],l=o===z,c=o===q,u=d.resolveDateKeyword,f=l?function(e){return d.getRealJSDateTimeFromLocal(d.parseSFDate(e))}:d.parseSFDateTime;if(l||c){if((void 0===t?"undefined":i(t))===M&&(t=f(t)),!t)return!1;t=t.getTime(),(void 0===n?"undefined":i(n))===M&&(n=f(n)||n),(void 0===n?"undefined":i(n))===M?(n=u(n),s.isArray(n)?(n[0]=n[0].getTime(),n[1]=n[1].getTime(),a=Fe[r]||Fe["="]):(t=e.left,n=e.right)):n=n.getTime()}return a(t,n)}function Me(t,n){n||(n={});var i=!0,r=!1,o=!1,a=n.context,l=n.logicType||"and",c=n.pageComponent,d=void 0,f=void 0,p=void 0,h=void 0,g=void 0,m=void 0,v=void 0,y=void 0,b=void 0,w=void 0,C=void 0,I=void 0,k=void 0,x=void 0,T=void 0,R=void 0,D=void 0,A=void 0,E=void 0,F=void 0,N=void 0,M=void 0,_=void 0,P=void 0,O=void 0,L=void 0,U=void 0,B=void 0,j=void 0,V=void 0,G=void 0,H=void 0,z=void 0,q=void 0,$=void 0,W=void 0;for("custom"===l?(_=n.logic,d=[]):"or"===l?o=!0:r=!0,t instanceof Array||(t=[t]),F=0;F<t.length;F++){if(j=!0,$=(q=(h=t[F]).sourceType||S)===S,z=h.sourceProperty,B=h.operator,v=h.type||S,L=null,V=null,D=null,g=h.value,m=h.values,$||We(q,"property")){if(h.fieldModel){if((L=e.$M(h.fieldModel))&&L.data)if(n.row&&(n.model&&n.model.id===L.id||L.getRowById(L.getRowId(n.row))))V=n.row;else if(L.data.length)V=L.data[0],h.fieldRow=L.getRowId(V);else if($){if("deactivate"===(U=h.noSourceRowBehavior||"deactivate"))continue;return"skipandrender"===U}}else n.row&&(V=n.row,n.model&&(L=n.model));"function"==typeof V&&(V=V()),L&&(D=L.getField(h.field))}if($)T=L?L.getFieldValue(V,h.field,!0):Oe(V,h.field);else if("userinfo"===q)T=De(h.sourceUserInfoType);else if("userhaspermission"===q){var Y=he().namedPermissions,K=h.permissionNamespace,X=Y?Y[K]:[];T=X&&X.includes(g),"!="!==B&&(B="="),g=!0}else"param"===q?T=c?c.getParameter(h.sourceParam):e.page.params[h.sourceParam]:"snippet"===q?(T=!(H=e.snippet.get(h.sourceSnippet))||H(),B="=",g=!0):"feature"===q?(T=e.platform.hasFeature&&e.platform.hasFeature(g),"!="!==B&&(B="="),g=!0):"datasourceuserinfo"===q?(k=h.dataSourceName,T=(x=(I=e.dataSource.getDataSource(k))&&I.getDataSourceType())&&x.evaluateUserInfoConditionSourceType?x.evaluateUserInfoConditionSourceType(I,h.sourceDataSourceTypeUserInfo):I&&I.getUserInfoProperty(h.sourceDataSourceTypeUserInfo)):"nofeature"===q?(T=e.platform.hasFeature&&e.platform.hasFeature(g),B="=",g=!1):We(q,"property")&&z&&L&&(u(z,["hasRows","hasNoRows"])>-1?(T=!(!L.data||!L.data.length),g="hasRows"===z,B="=",v=S):"rowproperty"===q?V?(v||(v=S),g||!1===g||0===g||(g=!0),B||(B="="),"isCloned"===z?T=L.isRowUnsavedClone(V):"isNew"===z?T=L.isNewRow(V):"isSaved"===z?T=!L.isNewRow(V):"hasChanged"===z?T=L.isRowChanged(V):"isMarkedForDeletion"===z?T=L.isRowMarkedForDeletion(V):"rowid"===z&&(T=L.getRowId(V))):j=!1:("data.length"===z&&(g=parseInt(g,10)),T=Oe(L,z)));if((N=null===T||""===T||void 0===T)&&(T=""),"userinfo"===v?g=De(h.userInfoType):"datasourceuserinfo"===v?g=L?L.getDataSource().getUserInfoProperty(h.userInfoType):void 0:"param"===v&&(g=c?c.getParameter(g):e.page.params[g]),a)if(y=a.model,b=a.row,w=a.rows,P=h.mergeField,"contextrow"===v&&b)Ge(O=P?y.getFieldValue(b,P,!0):y.getRowId(b))||(g=O);else if("contextrows"===v&&w){for(W={},G=0;G<w.length;G++)C=w[G],Ge(O=P?y.getFieldValue(C,P,!0):y.getRowId(C))||O in W||(W[O]=1);m=Object.keys(W)}if("blank"===v)"!="===B?N&&(j=!1):N||(j=!1);else if(-1!==s.inArray(v,["multiple","contextrows"])){if(m&&m instanceof Array)if(M="includes"===B,E=m.length,"in"===B&&-1===u(T,m))j=!1;else if("not in"===B&&-1!==u(T,m))j=!1;else if("includes"===B||"excludes"===B)if((R=T.split(";")).length){for(f=0;f<m.length;f++)if(p=m[f],-1!==u(p,R)){if(!M){j=!1;break}}else if(M){j=!1;break}}else M&&E&&(j=!1)}else A=D&&D.displaytype,je(g)&&s.inArray(A,Q)>-1&&(g=parseInt(g,10)),Ne({left:T,op:B,right:g,displaytype:A})||(j=!1);if(r&&!j){i=!1;break}if(o){if(i=j,j)break}else _&&d.push(j)}return _&&d&&d.length&&(i=function(t,n){return e.formula.evaluate(Ae(t,n,{customAndString:"&&",customOrString:"||"}))}(_,d)),i}function _e(e,t,n,i){return Me(t,{row:e,model:i,context:n})}function Pe(e){return!isNaN(e-0)}function Oe(e,t){if(e&&t){for(var n,i,r,o=bt(t),a=0;a<o.length;){if(n=o[a],!e)return;if(e instanceof Array&&"length"!==n){r=null;try{i=parseInt(n,10)}catch(e){r=e}if((r||isNaN(n))&&e.length){e=e[0];continue}if(i>=0){e=e[i],a++;continue}}e=e[n],a++}return e}}function Le(e,t){if(e&&t){for(var n=bt(t),i=0,r=!1;i<n.length;){if(!(e&&n[i]in e))return!1;e=e[n[i++]],r=!0}return r}return!1}function Ue(e){return je(e)?e&&s("<div/>").html(e).text():e}function Be(e){return je(e)?e&&String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):e}function je(e){return(void 0===e?"undefined":i(e))===M||e instanceof String}function Ve(e){return(void 0===e?"undefined":i(e))===P}function Ge(e){return(void 0===e?"undefined":i(e))===O}function He(e){return null!==e&&(void 0===e?"undefined":i(e))===_}function ze(e){return e&&e.replace(/(\r\n|\n|\r)/gm,"<br>")}function qe(e){return e&&je(e)?e.toLocaleLowerCase?e.toLocaleLowerCase():e.toLowerCase():e}function $e(e,t,n,i){return!!(e&&t&&n)&&(i&&(t=qe(t),n=qe(n)),e(t,n))}function We(e,t,n){return $e(function(e,t){return-1!==e.indexOf(t,e.length-t.length)},e,t,n)}function Ye(e,t,n){return $e(function(e,t){return 0===e.lastIndexOf(t,0)},e,t,n)}function Ke(e,t,n){return $e(function(e,t){return-1!==e.indexOf(t)},e,t,n)}function Xe(n,i){i||(i={});var r,o,l,c=s.Deferred(),d=!i||!1!==i.cache,u=function(e){var t={},n=i&&!0===i.json;s.each(e,function(e,i){var r=t[e]={};s.each(i,function(e,t){r[e]=n?Se(t):t})}),c.resolve(t)};return d&&(t||(t={}),r={},s.each(n,function(e,n){var i,o=t[e];return o?(i=r[e]={},s.each(n,function(e,t){if(!o[t])return r=!1,!1;i[t]=o[t]}),!!r):(r=!1,!1)})),r?u(r):(l=JSON.stringify(n),a||(a={}),(o=a[l])||(o=a[l]=s.Deferred(),e.remote().getBodiesOfZIPResourceFiles(l,function(e){delete a[l],(e=Se(e))&&!e.error?(d&&s.each(e,function(e,n){var i=t[e];i||(i=t[e]={}),s.each(n,function(e,t){i[e]=t})}),o.resolve(e)):o.reject(e&&e.error?e.error:e)},{escape:!1,buffer:!1!==i.buffer})),o.done(u)),c.promise()}function Je(e,t,n,i){var r={},o=(t?t+"__":"")+e;return r[o]=[n],Xe(r,i).then(function(e){var t=e[o];if(t&&t[n]){if(t=t[n],i&&!0===i.json&&je(t))try{t=JSON.parse(t)}catch(e){throw"Unable to parse body of file at path: "+n}return t}throw"ZIP resource contained no file at path: "+n})}function Qe(t,n){var i=n&&n.dataSourceType||e.dataSource.getType("salesforce");return i&&i.getNameField(t,n)}function Ze(t,n){return e.load.js(t,n)}function et(e,t,n){return"MULTIPICKLIST"===t?"="===e||"exact"===e?"=":"includes":t===$||"Id"===n||We(n,".Id")?"=":"exact"===e?"=":e}function tt(t,n){n||(n={});var i={},r=ht(),o=function e(t){if(t instanceof Array)for(var o=0;o<t.length;o++){var a=t[o];if("name"===a[0]||"&"===a[0]||"#"===a[0]||"^"===a[0]){var s,l=a[1];""!==l&&(s=r[l],n.ignoreGlobals&&(s||-1!==l.indexOf("$")||-1!==l.indexOf("Model."))||n.ignoreFunctions&&"function"==typeof s||(i[l]=1))}a.length>=5&&a[4]instanceof Array&&e(a[4])}};return o(e.Mustache.parse(t,["{{","}}"])),o(e.Mustache.parse(t,["{{{","}}}"])),Object.keys(i)}function nt(e){if(null!==e)switch(void 0===e?"undefined":i(e)){case F:return U;case N:return e%1==0?B:H;case _:if(e){if(e instanceof Array)return"ARRAY";if(e instanceof Date)return q}return"OBJECT";case M:if(Date.parse(e)){if(-1!==e.indexOf("T"))return q;if(3===e.split("-").length)return z}else if(Ke(e,"://"))return"URL";try{if(!isNaN(+e))return-1!==e.indexOf(".")?H:B}catch(e){return"STRING"}}return"STRING"}function it(){var t=this;return function(n,i){return Be(t.Model?e.$M(t.Model.id).getRowId(t):t.Id||"")+de+"value="+i(n)}}function rt(){return function(t){return e.label.read(t)}}function ot(e){for(var t=new RegExp(ce+".*?"+de+"value=([\\s\\S]*?)"+ce,"g"),n=[],i=void 0;null!==(i=t.exec(e));){var r=i[0],o=i[1];r&&o&&n.push({match:r,value:o})}return n.forEach(function(t){e=e.replace(t.match,t.value)}),e}function at(){return function(e,t){var n=t(e),i=-1===e.indexOf("{{{");return n=ot(n),i&&(n=s("<div>").html(n).text()),encodeURIComponent(n)}}function st(){var e=this;return function(t,n){var i=n(t),r=-1===t.indexOf("{{{");return i=ot(i),r&&(i=s("<div>").html(i).text(),e.__mergeSettings.asText||(i=Be(i))),decodeURIComponent(i)}}function lt(){return function(e,t){return t(e).replace(/\\/g,"\\\\").replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/"/g,'\\"').replace(/'/g,"\\'")}}function ct(e,t,n,i){n||(n={});var r=n.model,o=n.row,a=i||X;return a.apiExtensions=c({},a.apiExtensions,n),o&&r?e(w,t,a,r,o):r?e(b,t,a,r):e(y,t,a)}function dt(e,t,n,i,r){return n||(n={}),n.asData=!0,t?gt(e,t,n,i,r):null}function ut(e,t,n){return ct(ft,e,t,n)}function ft(e,t,n,i,r){return n||(n={}),void 0===n.nl2br&&(n.nl2br=!1),n.asText=!0,t?gt(e,t,n,i,r):""}function pt(e,t,n,i,r){var o=gt(e,t,n,i,r);return He(o)&&o.merges?o.merges:o}function ht(t){t||(t={});var n=t.mode||y,i=t.model,r=t.row,o=t.__mergeSettings,a=e.platform.isCordova(),s=t.apiExtensions,l=he(),d=t.pageComponent||i&&i.getParentPage&&i.getParentPage()||e.component.getByType("skuidpage")[0],u=d?d.getPageRecord():null,f=e.page,p=window.sforce?sforce.connection:{},h=c({},s,{$Api:{Session_Id:p.sessionId||e.utils.userInfo.sessionId,Organization_Id:l.organizationId,User_Id:l.userId,Partner_Server_Url:p.partnerServerUrl,Enterprise_Server_Url:p.enterpriseServerUrl,Partner_Server_Urls:p.partnerServerUrls,Enterprise_Server_Urls:p.enterpriseServerUrls},$Label:e.label.map,$Model:e.model.map(),$Native:{InSkuidNative:a,IOS:!!a&&e.native.isIOS(),Android:!!a&&e.native.isAndroid(),Location:l.location||{}},$Page:{Id:u?u.Id:f.id,Name:u?u.Name:f.name},$Param:d?c({},f.params,d.getPageParameters()):f.params,$Platform:{AuthUrl:e.platform.getAuthUrl(),Name:fe(),TokenURL:e.platform.getTokenURL()},$Site:{CurrentSiteUrl:f.currentSiteUrl,Prefix:f.sitePrefix},$User:l,$Network:{Connected:"connected"===e.offline.state,Disconnected:"disconnected"===e.offline.state},SkuidField:it,SkuidLabel:rt,__mergeSettings:o,urlEncode:at,encodeUrl:at,urlDecode:st,decodeUrl:st,escapeJS:lt,escapeLiterals:lt});if(n!==b&&n!==w||c(h,{Model:{conditions:i.conditions,Data:i.data,data:i.data,Label:i.label,label:i.label,LabelPlural:i.labelPlural,labelPlural:i.labelPlural,fields:i.fields,Fields:i.fieldsMap,fieldsMap:i.fieldsMap,KeyPrefix:i.keyPrefix,keyPrefix:i.keyPrefix,ObjectName:i.objectName,objectName:i.objectName,id:i.id,updateable:i.updateable,createable:i.createable,deleteable:i.deleteable}}),n===w){var g=i.data.indexOf(r)+1,m=i.getRecordForRow(r),v=1===g,S=g===i.data.length,C={first:v,last:S,index:g};m&&(C.Record={id:m.getId(),index:g,isFirst:v,isLast:S,isNew:m.isNew(),isClone:m.isClone(),isMarkedForDeletion:m.isMoribund(),data:m&&m.get()}),c(h,C,r)}return h}function gt(t,n,r,o,a){var c=arguments[0];if(null!==c&&(void 0===c?"undefined":i(c))===_&&(t=c.mode,n=c.template,r=c.options,o=c.model,a=c.row),a&&"function"==typeof a&&(a=a()),a||"row"!==t||(o&&o.data&&o.data.length?a=o.data[0]:t="model"),o||"model"!==t||(t="global"),!n&&""!==n)throw"Required argument 'template' was not provided.";if(!(t&&t.toLowerCase()in J))throw"Invalid merge mode. Valid modes are: global,model,row.";t=t.toLowerCase(),r||(r={});var f=r,p=f.apiExtensions,h=f.pageComponent,g=f.outputType;if(!0===r.evaluateFormulas)return e.formula.evaluate(n,{apiExtensions:p,model:o,pageComponent:h,row:a},{outputType:g});var m,v,b,S,C,I,k,x,T,R,A,E,F,N,M,P,O,L,B,j,V,G,H,q,$,W,Y,K,X,ee,te,ne,ie,re,oe,ae,se,le,ue,fe,pe,he,ge,me,ve,ye=o,be=ye?ye.fieldsMap:null,we=!0===r.asText,Se=!0===r.asData,Ce=!0===r.coerceToJSType,Ie=we||Se?!1!==r.allowHTML:!0===r.allowHTML,ke=r.nl2br,xe=!1!==r.createFields,Te=xe&&!1!==r.registerFields,Re={fields:[]},De=function(e){return[(e+="").match(D)||[],e.split(D)]}(n),Ae=De[0],Ee=De[1],Fe=1===Ae.length&&""===Ee.join(""),Ne="",Me=r.parentRow||null,_e=r.childRelName||!1,Pe=-1,Le=Ee.length;if(Ae.length)T=ht({apiExtensions:p,mode:t,model:ye,pageComponent:h,row:a,__mergeSettings:{asText:we}});else if(we||Se)return Ie?n:l.encodeHTML(n);if(Se){if(Fe&&1===(L=tt(Ae[0])).length){if(Ye(N=L[0],"$Label."))return e.$L(N.substring(7));if(void 0===(B=Oe(T,N))||null===B)return null;if(!Ce)return B;if(N.match(/\.data\.\d+\./)?(M=N.split("."),X=Ye(N,"$Model."),F=M.splice(0,X?4:3),E=!!(F=X?e.$M(F[1]):ye)&&F.getField(M.join("."))):ye&&(E=ye.getField(N)),!E)return B;if(ge=E.displaytype,fe=u(ge,Q)>-1,le=ge===U,ue=u(ge,Z)>-1,fe)return window.parseFloat(B);if(le){if(je(B)){if("true"===B.toLowerCase())return!0;if("false"===B.toLowerCase())return!1}return!!B}return ue?ge===z?e.time.getRealJSDateTimeFromLocal(e.time.parseSFDate(B)):e.time.parseSFDateTime(B):B}we=!0}for(;Le>0;)if(Le--,Ne+=Ee[++Pe],he=Ae[Pe]){if(re="{{{"===he.substring(0,3),j=(N=he.substring(re?3:2,he.lastIndexOf(re?"}}}":"}}"))).charAt(0),ie=(ee=-1!==["#","/","^"].indexOf(j))||-1!==["&","!"].indexOf(j),ne="/"===j,te=ee&&!ne,K=Ye(N,"$System")||Ye(N,"$Date")||Ye(N,"$Time"),k=null,O=null,me=null,oe=!0,Ye(N,"$Label.")){Ne+="{{#SkuidLabel}}"+N.substring(7)+"{{/SkuidLabel}}";continue}if(r.fieldPrefix&&(he="{{"+(N=ie?j+r.fieldPrefix+N.substr(1):r.fieldPrefix+N)+"}}"),-1!==N.indexOf(".records")&&ee&&(te?m=(_e=N.substring(1,N.indexOf(".records"))).startsWith("$Model."):ne&&(_e=!1,m=!1)),K){if(ae=d.getLocalDateTime(new Date),"$System.Now"===N)N=re?d.getSFDateTime(ae):d.makeFormattedLongDateTime(ae);else if(1===(R=N.split(".")).length)N="$Date"===N?d.makeFormattedDateFromLocal(ae):d.formatTime(Tt().timeFormat,ae);else switch(R[1]){case"Year":N=ae.getFullYear();break;case"Month":N=ae.getMonth()+1;break;case"Day":N=ae.getDate();break;case"DayOfWeek":N=ae.getDay();break;case"Hour":N=ae.getHours();break;case"Minute":N=ae.getMinutes()+1;break;case"Second":N=ae.getSeconds();break;case"Millisecond":N=ae.getMilliseconds();break;case"Period":N=d.getPeriod(ae)}Ne+=N;continue}if(xe&&!re&&"&"!==j&&(!ee||-1!==N.indexOf(".records"))){if(oe=!1,"$System.Now"===N){Ne+=d.makeFormattedLongDateTime(new Date);continue}if(null!==(V=N.match(/^[#/]?\$Model\.([^.]+)\.data\.(\d+)\.(.+)/))&&(q=e.$M(V[1]),W=V[2],G=V[3],H=q&&q.fieldsMap,$=q&&q.getRows()[W],_e&&(_e=G.substring(0,G.indexOf(".records")))),ee||null!==(P=(null!==V?G:N).match(/(.+)\.records\.(\d+)\.(.+)/))&&(_e=P[1],v=P[2],O=P[3],V&&q?(b=q,S=$||null):(b=o,S=a),(I=(C=b.getFieldValue(S,_e))&&C.records?C.records:null)&&I[v]&&(k=b.getRowId(I[v]))),null!==V?me={isSectionChar:ee,childRelName:_e,fieldsMap:H,fieldName:O||!ee&&G||N,mode:w,model:q,row:$,childRowId:k,token:he}:m?me={isSectionChar:ee,childRelName:_e,fieldsMap:H,fieldName:N,mode:w,model:q,row:$,token:he}:t!==y&&(x=_e&&Me||a,!k&&_e&&be[_e]&&"childRelationship"===be[_e].type&&(k=o.getChildIdFromRow(a,_e)),me={isSectionChar:ee,childRelName:_e,fieldsMap:be,fieldName:O||N,mode:t,model:o,row:x,childRowId:k,token:he}),me&&(oe=null!==(ve=mt(me)))){Ne+=ve;continue}}if(N){Ne+=!we||ee||xe&&oe&&!re?"{{"+N+"}}":"{{{"+N+"}}}";continue}Ne+=he}A=Ie||we&&!0!==ke||!1===ke,pe=e.Mustache.render(Ne,T),Y=A?pe:ze(pe);var Be=0,Ve=[],Ge=[];if(xe){var He=new RegExp(ce+"([\\s\\S]*?)"+ce,"g"),qe=Y.match(He);null!==qe&&qe.length&&(Be+=qe.length,qe.forEach(function(t){var n=new RegExp(ce,"g"),i=t.replace(n,"").split(de).reduce(function(e,t){var n,i=t.split("="),r=(n=i,Array.isArray(n)?n:Array.from(n)),o=r[0],a=r.slice(1);return a=a.join("="),e[o]=a,e},{}),l=i.model,c=i.field,d=i.parentfield,u=i.parentrowid,f=i.rowid,p=i.value,h=void 0,g=void 0,m=void 0,v=void 0,y=void 0,b=l&&e.$M(l)||o;!f&&a&&(f=b.getRowId(a));je(f)&&(f=Ue(f));je(u)&&(u=Ue(u));if(a&&Me)h=a;else if(d&&u&&f){C=b.dataMap[u]&&b.dataMap[u][d],v=C&&C.records?C.records:null;var w=b.getIdFieldForChildRelationship(d);try{var S=JSON.parse(f);f=S[w]}catch(e){}v&&s.each(v,function(e,t){if(w&&f&&t[w]===f)return h=t,!1})}else b&&(h=b.dataMap[f]);c&&h?(g={fieldId:c,editable:!1,register:Te},d&&(g.fieldContext=d),r.noLink&&(g.noLink=!0),m=new e.ui.Field(h,b,null,g),Ve.push(m),m.render(),Re.fields.push(m),y=we?"{fieldValues."+(Ge.push(m.element.text())-1)+"}":'<span class="nx-merge">'+(Ve.length-1)+"</span>",Y=Y.replace(t,y),we&&m.unregister()):we?(y="{fieldValues."+(Ge.push(p)-1)+"}",Y=Y.replace(t,y)):Y=Y.replace(t,"")}))}return we?(xe&&Be?(e.Mustache.parse(Y,["",""]),pe=e.Mustache.render(Y,{fieldValues:Ge})):pe=Y,Ie?pe:l.encodeHTML(pe)):((se=s('<div class="nx-template">').html(Y)).find(".nx-merge").toArray().forEach(function(e){var t=s(e).text(),n=Ve[t];s(e).replaceWith(n.element)}),Re.merges=se,Re)}function mt(e){var t=e.isSectionChar,n=e.childRelName,i=e.fieldsMap,r=e.fieldName,o=t&&n&&i&&n in i&&"childRelationship"===i[n].type,a=e.mode,s=e.model,l=e.row,c=e.token,d=s&&l?s.getRowId(l):null,u=e.childRowId,f=null,p=void 0;return!o&&(n&&!t?(p=i[n].subFieldsMap)&&r in p||"Id"===r:i&&r in i||"Id"===r)&&(f=ce+(s?"model="+s.id:"")+de+"field="+r,f+=a===w?n?de+"parentfield="+n+(d?de+"parentrowid="+Be(d):"")+de+"rowid="+(u?Be(u)+de+"value="+c:"{{#SkuidField}}"+c+"{{/SkuidField}}")+ce:(l&&d?de+"rowid="+Be(d):"")+de+"value="+c+ce:(n?de+"parentfield="+n:"")+de+"rowid={{#SkuidField}}"+c+"{{/SkuidField}}"+ce),f}function vt(e){return e&&"function"==typeof e.then}function yt(t){return t instanceof e.$&&(t=t[0]),t.xml?t.xml:(new XMLSerializer).serializeToString(t)}function bt(e,t){t||(t=".");var n=["\\\\","\\"+t,t];return e.indexOf(".")<0?[e]:e.indexOf("\\")<0?e.split("."):function e(t,n){var i,r=n[0],o=[],a=[],l=r&&r.substring(1);if(1===n.length)return t.split(r);t.split(r).forEach(function(t){o.push(e(t,n.slice(1,n.length)))});i=o.length;s.each(o,function(e,t){if(t.length){var n=t.length;s.each(t,function(t,r){if(t===n-1&&e!==i-1){var s=r+l+o[e+1][0];for(o[e+1].shift();o[e+2]&&!o[e+1].length;)s+=l+o[++e+1][0],o[e+1].shift();a.push(s)}else a.push(r)})}});return a}(e,n)}function wt(e,t){return["\\",t||"."].reduce(function(e,t){return e.split(t).join("\\"+t)},e)}function St(e){if(e&&e.eventType){var t,n=e.eventType,i=e.delay||400,r=e.callback;(e.context||s(window)).on(n,function(){clearTimeout(t),t=setTimeout(function(){r&&r()},i)})}}function Ct(){return oe++}function It(e){var t=""+function(e){var t="";do{t=ae[63&e]+t,e>>>=6}while(0!==e);return t}(Date.now());return(1===arguments.length?e.prefix:"sk")+"-"+t.substring(0,t.length-2)+"-"+Ct()}var kt={};function xt(t,n,i,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=o.context||{},l=i&&i.attr,c=l?i.attr("logictype"):null,d=l?i.attr("logic"):null,u=l?i.children():null,f=[],p=o.row?o.row:a.row,h=o.model?o.model:a.model,g=!1,v=e.events.subscribe,y=o.eventSubscriptions,b=o.pageComponent,w=o.renderOverride,S=o.uniqueid;function C(e){return w&&w.override?!0===w.doRender:Me(e,{logic:d,logicType:c,model:h,pageComponent:b,row:p})}function I(e){if(e?(e.userInitiated=!0,o.event=e):"event"in o&&delete o.event,!g){g=!0;var i=void 0;i=C(f)?t(o):n(o),o.component&&e&&e.name&&(vt(i)||(i=Dt()),i.then(function(){return o.component.publish("handled."+e.name)})),g=!1}}function k(t){var n=h&&p&&h.id&&(!t.fieldModel||t.fieldModel===h.id),i=n?h.id:t.fieldModel?t.fieldModel:h?h.id:null,r=i?e.$M(i):null,o=n?p:t.fieldRow?t.fieldRow:p||null,a=void 0,s=void 0;return o&&He(o)&&r?a=r.getRowId(o):Ve(o)?(s=o())&&(a=r.getRowId(s)):a=o,{modelId:i,rowId:a}}return y||(y=o.eventSubscriptions=[]),function t(){f.length=0;var n=r&&r.data(m),i={},o=void 0,a=void 0;if(y.length){if(s.each(y,function(t,n){e.events.unsubscribe(n)}),n&&n.length)for(o=n.length-1;o>=0;o--){a=n[o];for(var l=0;l<y.length;l++)a===y[l]&&n.splice(o,1)}y.length=0}u&&u.each(function(){var t=new e.model.Condition(s(this));f.push(t)}),f.length&&(s.each(f,function(t,n){var r,o,a=k(n),s=a.modelId,l=a.rowId,c=n.field,d=s&&e.model.getModel(s),u=n.sourceType;s&&((r=i[s])||(r=i[s]={}),l?(o=r[l])||(o=r[l]={}):"fieldvalue"===u&&(r.__conditionsNeedRows=!0),"hasChanged"===n.sourceProperty?"modelproperty"===u?r.__any=!0:o&&(o.__any=!0):o&&c&&(d&&d.isRelationshipField(c)&&(c=d.getReferenceFieldNameFromRelationshipField(c)),o[c]||(o[c]=1)))}),y.push(v("row.updated",function(e){var n,r=i[e.modelId],o=!1;r&&((n=r[e.rowId])&&(s.each(n,function(t){if(Le(e.updates,t))return o=!0,!1}),!o&&n.__any&&(o=!e.rowHadPriorChanges)),o||(r.__any?o=!e.modelHadPriorChanges:r.__conditionsNeedRows&&(delete r.__conditionsNeedRows,t(),o=!0))),o&&I({name:"row.updated",data:e})})),y.push(v("row.created",function(e){var t=i[e.modelId];t&&(t[e.rowId]=e.row,I({name:"row.created",data:e}))})),y.push(v("row.deleted",function(e){e.modelId in i&&I({name:"row.deleted",data:e})})),y.push(v("row.undeleted",function(e){e.modelId in i&&I({name:"row.undeleted",data:e})})),y.push(v("models.saved",function(e){var t=!1;s.each(i,function(n,i){if(n in e.models){t=!0;var r=e.insertResults;r&&r.length&&s.each(r,function(e,t){var n=t.oldId,r=t.id;t.success&&n&&r&&n in i&&(i[r]=i[n],delete i[n])})}}),t&&I({name:"models.saved",data:e})})),y.push(v("models.cancelled",function(e){s.each(i,function(t){if(t in e.models)return I({name:"models.cancelled",data:e}),!1})})),y.push(v("models.loaded",function(e){s.each(i,function(t){if(t in e.models)return I({name:"models.loaded",data:e}),!1})}))),y.push(v("actions.conditionaloverride",function(e){S===e.componentId&&I({name:"actions.conditionaloverride"})})),y.length&&(n?Array.prototype.push.apply(n,y):r&&r.data(m,y))}(),w&&w.override&&w.doRender||f.length&&C(f)||!f.length?t(o):n(o)}function Tt(){return e.utils.userLocale}function Rt(){return e.settings&&e.settings.skuidApp&&"development"===e.settings.skuidApp("coreMode")||!e.version?le:e.version.date}function Dt(t){return vt(t)?t:e.$.Deferred().resolve(t).promise()}function At(e){var t=this;if(t._GUID="SelectItem-"+Ct(),!e)throw"You must provide a configuration object when creating a new SelectItem.";if(!("value"in e))throw"Value is required.";c(t,e),"label"in e||(t.label=t.value),t.isSelected||(t.isSelected=!1)}function Et(){this.items=[],this.itemsMap={},this.selectedIndex=this.selectedKey=!1}function Ft(e){e||(e={});this._get=e.get,this._set=e.set,this.key=this._createKey({id:e.id,type:e.type})}function Nt(){var e=l.generateUniqueId({prefix:"kvs"});this.__id=e,this[this.__getPropName("s")]={}}function Mt(t,n){var i=this;return i.element=t,i.options=n||{},i.editor=new e.ui.Editor(t,{showHeader:!1,showMessages:!1,customContentClass:"nx-editor-contents-template"}),n.model&&(i.model=n.model,i.editor.registerModel(i.model)),!i.conditions&&n.conditions&&(i.conditions=n.conditions),n.controllingComponent||(i.editor.handleSave=function(e){e&&i.render()},i.editor.handleCancel=function(){i.render()},i.editor.handleDataRefresh=function(){i.render()},i.editor.handleChange=function(){i.render()}),i.render(),i}At.prototype.id=function(){return this._GUID},Et.prototype={getItems:function(){return this.items},addItem:function(e,t){var n,i=this.items;if(!e._GUID)throw"Invalid SelectItem.";if(-1!==u(e,i))throw"Item is already in the List.";e.isSelected&&!1!==this.selectedIndex&&(i[this.selectedIndex].isSelected=!1),t?i.unshift(e):i.push(e),n=t?0:i.length-1,e.isSelected?(this.selectedIndex=n,this.selectedKey=e.value):t&&!1!==this.selectedIndex&&this.selectedIndex++,this.itemsMap[e.value]=e,!1===this.selectedIndex&&(this.selectedIndex=n,this.selectedKey=e.value,e.isSelected=!0)},getSelected:function(){return!1===this.selectedIndex?null:this.items[this.selectedIndex]},addItems:function(e,t){var n=this;e&&s.each(e,function(){n.addItem(this,t)})},size:function(){return this.items?this.items.length:0},removeItemAtIndex:function(e){this._validateIndex(e);var t=this.items[e],n=t.isSelected;t&&(t.value&&t.value in this.itemsMap&&delete this.itemsMap[t.value],this.items.splice(e,1),t.isSelected=!1),!1!==n&&(this.selectedIndex=!1,this.selectedKey=!1,this.size()>0&&this.selectItemAtIndex(0))},getItemAtIndex:function(e){return this.items[e]},getItemById:function(e){return s.grep(this.items,function(){return this.id()===e})},selectItemAtIndex:function(e){if(this._validateIndex(e),!1!==this.selectedIndex){if(e===this.selectedIndex)return!0;this.items[this.selectedIndex].isSelected=!1}this.items[e].isSelected=!0,this.selectedIndex=e,this.selectedKey=this.items[e].value},unselectItemAtIndex:function(e){this._validateIndex(e),e===this.selectedIndex&&(this.items[e].isSelected=!1,this.selectedIndex=!1,this.selectedKey=!1)},_getItemIndex:function(e){var t;if(-1!==(t=Pe(e)?e:this.indexOf(e)))return t;throw"Invalid Item"},selectItem:function(e){this.selectItemAtIndex(this._getItemIndex(e))},unselectItem:function(e){this.unselectItemAtIndex(this._getItemIndex(e))},removeItem:function(e){this.removeItemAtIndex(this._getItemIndex(e))},indexOf:function(e){return!(e instanceof At)&&e.value&&e.value in this.itemsMap&&(e=this.itemsMap[e.value]),e?u(e,this.items):-1},contains:function(e){return-1!==this.indexOf(e)},_validateIndex:function(e){if(e>=this.size()||e<0)throw"Invalid Index";return!0}},Ft.prototype={_createKey:function(e){if(e&&e.id)switch(e.type){case"component":return"skuid.component("+e.id+")";case"model":return"skuid.model("+e.id+")";default:return i(e.type)===M?e.type+"("+e.id+")":e.id}},getSettings:function(){var e=this.key,t=this._get();return e&&t&&e in t?c(!0,{},t[e]):{}},updateSettings:function(e,t){var n=this.key,r=this._get(),o=c(!0,{},r[n],e);if(t&&!0===t.removeNulls){var a=0;!function e(t){var n,r;if(!(a>200)){for(n in r=[],t)r.push(n);s.each(r,function(n,r){void 0===t[r]||null===t[r]?delete t[r]:i(t[r])===_&&(a++,e(t[r]),a--)})}}(o)}r[n]=o,this._set(r)}},Nt.prototype={get:function(e){var t=this[this.__getPropName("s")]||{};return t.hasOwnProperty(e)?t[e]:void 0},set:function(e,t){var n={};n[e]=t,this.extend(n)},extend:function(e){var t=this.__getPropName("s"),n=Object.getPrototypeOf(this),i=this[t]||(this[t]={});s.each(e,function(e,t){if(n[e])return!0;i[e]=t})},__getPropName:function(e){return"__"+this.__id+"_"+e}},Mt.prototype={unregister:function(){this.editor&&this.model&&this.editor.unregister()},render:function(){var e=this,t=e.model,n=e.options,i=n.templateBody||"",r=n.component,o=n.context,a=e.conditions,l=void 0,c={allowHTML:n.allowHTML,pageComponent:r?r.getParentPage():void 0,registerFields:!1};void 0!==o&&(c.apiExtensions=o),e.editor.contents.empty(),t?(l=a&&a.length?t.getRows(a,o):o&&t&&o.model&&o.row&&o.model===t?[o.row]:t.getRows(null,o),!n.isMultiRow&&l&&l.length?(l&&l.length>1&&!0===n.onlyShowFirstRow&&(l=[l[0]]),s.each(l,function(n,r){r&&e.editor.contents.append(t.mergeRow(r,i,c))})):e.editor.contents.append(t.mergeModel(i,c))):e.editor.contents.append(pt(y,i,c))}},c(l,{addResizeHandler:function(e,t){St({eventType:"resize orientationchange",delay:t,callback:e})},adjustValueBasedOnQuotedness:function(e,t){var n=e;return void 0!==e&&(t?n=e.toString():"false"===e?n=!1:"true"===e?n=!0:Pe(e)&&!1!==e&&!0!==e&&(n=-1!==e.toString().indexOf(".")?parseFloat(e):parseInt(e,10))),n},applyURLParametersToURL:function(e,t){return s.each(t,function(t,n){-1!==e.indexOf("?")?e+="&"+t+"="+n:e+="?"+t+"="+n}),e},areConditionsMet:Me,areArraysEqual:function(e,t){return e.length==t.length&&e.every(function(e,n){return e===t[n]})},calculateReferenceMerges:ke,calculateReferenceText:function(e){return ke(e).merges.text()},canUseSessionStorage:function(){if("nodata"===Y)try{Y="sessionStorage"in e.data&&null!==e.data.sessionStorage}catch(e){Y=!1}return Y},capitalizeFirst:ye,clamp:function(e,t,n){return Math.min(n,Math.max(t,e))},combineStrings:function(e,t,n){e||(e=""),t||(t=""),n||(n="");var i=e.length,r=t.length,o=n.length;return(i&&We(e,n)?e.substring(0,i-o):e)+(i&&r?n:"")+(r&&Ye(t,n)?t.substring(o,r):t)},combineUrls:be,conditionallyDo:xt,conditionallyRender:function(e,t,n,i,r,o){var a=n?n.attr("uniqueid"):"";return o||(o={}),a&&!kt[a]&&(kt[a]={override:!1,doRender:!0}),o.renderOverride=kt[a],o.uniqueid=a,xt(function(){var t;return!i.data("rendered")&&(t=e(n,i,r,o),i.data("rendered",!0),t)},function(){var e,a=i.data("rendered");return!(!a&&void 0!==a)&&(e=t(n,i,r,o),i.data("rendered",!1),e)},o.renderConditions?o.renderConditions:n&&n.children?n.children("renderconditions"):null,o.eventParentElement||i,o)},contains:Ke,convertCurrency:function(t,n,i){var r,o=h.getConversionRates(),a=e.utils.conversionRatesMap;if(!o||!o.length)return t;if(r=o[0].IsoCode,a||(a=e.utils.conversionRatesMap={},s.each(o,function(e,t){a[t.IsoCode]=t})),a&&a[n]&&a[i]){var l=a[i],c=Math.pow(10,6);if(n!==r){var d=a[n];t=Math.round(t/d.ConversionRate*c)/c}return Math.round(t*l.ConversionRate*c)/c}},createMapForArray:function(t,n,i,r){return e.utils.isString(n)&&(n=[n]),t&&s.each(t,function(){var e=this;e[i]={},s.each(n,function(t,n){e[n]&&e[n].length&&s.each(e[n],function(t,n){var o;s.each(r instanceof Array?r:[r],function(t,r){(o=n[r])&&"undefined"!=o&&(e[i][o]=n)})})})}),t},createPopupFromPopupXML:Ie,createPopupFromAction:function(e,t,n){return Ie(e.children("popup").first(),t,n)},createSearchSubConditions:function(e,t,n,i,r){r||(r={});var o,a=r.delimiter||" ",l=r.searchOperator||"contains",c=1,d=e.dataSource.getDataSourceType();return t.subConditions=[],t.subConditionLogic="",o=r.tokenize?n.split(a):[n],s.each(o,function(n){var r=this+"",a=[];if(!r)return!0;s.each(i,function(n,i){var o=i.searchOperator||l,s=e.getField?e.getField(i.id):i;s||(s=i);var u=!(!s||!s.displaytype)&&s.displaytype,f=u===W?Re(i.id,i,e.getDataSource()):i.id,p=f&&e.getField(f);if(f&&(!p||!1!==p.filterable)||d.fieldIsFilterableWhenSearchingReferenceFieldOptions&&d.fieldIsFilterableWhenSearchingReferenceFieldOptions(p)){var h={name:"__default_searchbox_subcondition",type:"fieldvalue",field:f,inactive:!1};if(h.operator=et(o,u,f),"MULTIPICKLIST"===u)"="===h.operator||"exact"===h.operator?h.value=r:h.values=[r];else if(u===$||"Id"===f||We(f,".Id")){if(!r||18!==r.length&&15!==r.length)return!0;h.value=r}else h.value=r;if(u===W){var g=e.getField(f);g&&g.targetObjects&&(h.fieldTargetObjects=g.targetObjects)}else i.targetObjects&&(h.fieldTargetObjects=i.targetObjects);t.subConditions.push(h),a.push(c),c++}}),t.subConditionLogic+="("+a.join(" OR ")+")",n<o.length-1&&(t.subConditionLogic+=" AND ")}),t},debounce:function(e,t,n){var i=null;return function(){var r=arguments;clearTimeout(i),i=setTimeout(function(){e.apply(n||this,r)},t)}},decodeHTML:Ue,decodeXML:function(e){return e.replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&")},delay:function(e){var t=s.Deferred();return setTimeout(function(){t.resolve()},e||0),t.promise()},delayEventCallback:St,delayInputCallback:function(t,n,i){var r,o,a,s,l,c="change keydown";a=(i=i||{}).delayTime||400,(o=i.dataPropertyName)?t.data(o,t.val()):r=t.val(),c+=re?9===re?" selectionchange keyup":re<9?" keyup":" keyup input":" keyup input",t.on(c,function(i){if(!t.prop("disabled")){var c=t.val(),d=function(){if(clearTimeout(s),l&&e.events.unsubscribe(l),o&&(r=t.data(o)),c===t.val()&&c!==r){var i=r;o?t.data(o,c):r=c,n&&n(c,i)}};clearTimeout(s),l&&e.events.unsubscribe(l);var u="keydown"===i.type&&(i.which===g.ENTER||i.which===g.TAB||i.metaKey||i.ctrlKey);"change"===i.type||u?d():"keydown"!==i.type&&(l=e.events.subscribe("skuid.ui.commitUserInput",d),s=setTimeout(d,a))}})},deparam:function(e){if(!e||!e.length)return{};Ke(e,"?")&&(e=e.substr(e.indexOf("?")+1));for(var t,n=e.split("&"),i={},r=0;r<n.length;++r)2==(t=n[r].split("=")).length&&(i[decodeURIComponent(t[0])]=decodeURIComponent(t[1].replace(/\+/g," ")));return i},doArraysIntersect:function(e,t){for(var n=0;n<e.length;n++)if(u(e[n],t)>-1)return!0},doesRowMeetConditions:_e,downloadBase64StringAsFile:function(t,n){var i=e.utils._ie;if(!(i&&i<10)){for(var r=atob(t),o=new Array(r.length),a=0;a<r.length;a++)o[a]=r.charCodeAt(a);var s=new Uint8Array(o),l=new Blob([s],{type:"octet/stream"});l.size<=1||e.utils.saveAs(l,n)}},downloadStringAsFile:function(t,n,i){var r,o,a,s=e.utils._ie;if(s&&s<10)throw"File download is not supported for this browser.";if(je(t))return r=i||(pe(p.LIGHTNING)?"application/octet-stream":"text/csv"),o=new Blob([t],{type:r}),a=e.utils.saveAs(o,n),e.events.publish("filedownload",[{data:o,filename:n}]),a},encodeHTML:Be,endsWith:We,escapeCSVCell:function(e){return void 0!==e?(e.indexOf(C)>-1&&(e=e.replace(/"/g,I)),s.each(k,function(t,n){if(e.indexOf(n)>-1)return e=C+e+C,!1})):e="",e},escapeFieldName:wt,escapeSelector:function(e){return e&&e.replace(/\./g,"\\.")},escapeSingleQuotes:function(e){return e&&e.replace(/'/g,"\\'")},extractFieldsFromTemplate:tt,filterRowsByConditions:function(e,t,n,i){return e&&e.length?t&&t.length?e.filter(function(e){return _e(e,t,n,i)}):e:[]},filterByDataSourceAndEntity:function(e,t){return function(n){return n.attr("datasource")===e&&n.attr("x-entityname")===t}},generateGUID:Ct,generateUniqueId:It,getAPIDescribeLayout:function(e){var t=ie();return t&&t.getAPIDescribeLayout(e)},getAPIDescribeSObject:function(e){var t=ie();return t&&t.getAPIDescribeSObject(e)},getBodiesOfZIPResourceFiles:Xe,getBodyOfStaticResource:function(e){var t={};return t[e]=[""],Xe(t,{buffer:!1})},getBodyOfZIPResourceFile:Je,getCacheTimestamp:Rt,getCSSSizeObj:function(e,t){var n;return t=t||{},e&&(n=e.toString().match(/^([\d]*\.?[\d]+)([^\d]*)$/)),!!n&&(n[1]=n[1].indexOf(".")>=0?parseFloat(n[1]):parseInt(n[1],10),{original:n[0],number:n[1],unit:n[2]?n[2]:t.defaultUnit||"px"})},getContextToUse:function(t,n,i){var r={},o=i&&i.mode||"row";return t&&t.context&&c(r,t.context),n&&(c(r,n),n.rows&&(r.rows=n.rows)),r.model||(t&&t.model?r.model=t.model:t&&t.list&&t.list.model&&(r.model=t.list.model)),r.row||(r.item&&r.item.row?r.row=r.item.row:!t||!t.row||t instanceof e.model.Model?t&&t.item&&t.item.row&&(r.row=t.item.row):r.row=t.row),r.list||t&&t.list&&(r.list=t.list),r.editor||t&&t.editor&&(r.editor=t.editor),"model"===o&&(r.row=void 0,r.list=void 0,r.rows=void 0),r},getCurrentDomain:ge,getDefaultImageUrl:function(t){return me(be(e.platform.getDefaultImagePath?e.platform.getDefaultImagePath():"","DefaultPhotos"),"skuid",("org"===t?"Org":"Profile")+".jpg",e.version.date)},getDisplayTypeOfEntity:nt,getFieldReference:Re,getFieldRelationshipName:xe,getHourOptions:function(e,t,n){var i,r=Tt().timeFormat,o=r.toLowerCase(),a=o.indexOf("a"),s=o.indexOf("h"),l=[],c=new Date;for(-1!=a&&(r=a<s?"a"+r.charAt(s):r.charAt(s)+"a"),e=e||0,t=t||24,i=e;i<=t;i++)c.setHours(i,0,0,0),l.push({value:i,label:d.formatTime(r,c),isSelected:n===i});return l},getInvokable:function(e,t){return Ve(t)?function(){return t.apply(e,arguments)}:function(){return e[t].apply(e,arguments)}},getJSONBodiesOfZIPResourceFiles:function(e,t){return Xe(e,c({json:!0},t))},getJSONBodyOfZIPResourceFile:function(e,t,n,i){return Je(e,t,n,c({json:!0},i))},getLayoutFields:ne,getLocalVisualforceDomain:function(e){var t,n,i,r,a=!e;return o&&a?o:(e||(e=ge()),"c"===(i=(n=e.split("."))[0])||We(i,"--c")?t=e:(Ke(i,"--")?((r=i.split("--")).pop(),r.push("c"),n[0]=r.join("--")):n[0]="c",t=n.join(".")),a&&(o=t),t)},getMergeApi:ht,getMergeResult:gt,getModelFieldIdChanges:function(e){var t={};return s.each(e,function(e,n){!function e(t,n,i,r){var o=i?i+".":i;o+=wt(t),s.isPlainObject(n)?s.each(n,function(t,n){e(t,n,o,r)}):r[o]=n}(e,n,"",t)}),t},getNameField:Qe,getObjectProperty:Oe,getRowCurrency:function(e){var t,n=e.model,i=e.row,r=e.field,o=r.lastIndexOf("."),a=n.isAggregate,s=-1!==o?r.substring(0,o+1):"";return a?t=h.getConversionRates()[0].IsoCode:(t=n.getFieldValue(i,s+"CurrencyIsoCode",!0))||(t=n.getFieldValue(i,"CurrencyIsoCode",!0)),t},getSafeRelativeUrl:ve,getSearchOperatorForDisplayType:et,getCurrentSkuidPageName:ue,getStaticResourceUrl:me,determineIfInSkuidNamespace:function(){return We(ge().split(".")[0],"--skuid")},getTargetObject:Te,getUnescapedParts:bt,getUrlFromAttachmentId:function(e){return(n||"")+"?file="+e+"&retURL="+encodeURIComponent(location.pathname+location.search)},getUserInfoPropValue:De,getWindowLocation:function(){return window.location},getXML:yt,grab:function(){var e=Array.prototype.slice.call(arguments||[]),t=e.shift(),n=e[0],i=0;for(s.isArray(n)&&(e=n);i<e.length;i++){try{t=t[e[i]]}catch(e){return}if(Ge(t))return}return t},hasObjectProperty:Le,highlightSFTab:function(t){var n,i=s(".bodyDiv"),r=s("ul#tabBar"),o=r.children("li.zen-active, li.active"),a=o.find("span.zen-assistiveText, span.assistiveText").detach(),l=e.utils.sfTabs[t];o.removeClass("zen-active primaryPalette primaryPalette active").find("a").attr("title",function(e,t){return t.replace(" - Selected","")}),t&&l&&(n=r.children("li").has('a[href="'+t+'"]')),n.length&&(n.first().addClass("zen-active active primaryPalette").find("a").attr("title",function(e,t){return t+" - Selected"}).after(a),l.color&&(n.css({"background-color":"#"+l.color,"border-color":"#"+l.color}),i.css("border-top-color","#"+l.color)))},ifElse:function(e,t,n){return e?t:n},inPlatform:pe,ingestConstructorArguments:function(e,t,n){t&&s.each(t,function(t,n){if(Ge(n))throw"Required constructor argument not provided for "+e.constructor.name;e[t]=n}),n&&s.each(n,function(t,n){Ge(n)||(e[t]=n)})},insertAtIndex:function(e,t,n){n<=0?e.prepend(t):e.children().eq(n-1).after(t)},isApiEnabled:function(){return he().isApiEnabled},isBlank:function(e){return 0!==e&&"boolean"!=typeof e&&!e},isDate:function(e){return"[object Date]"===Object.prototype.toString.call(e)},isExactlyNaN:function(e){return e!=e},isFunction:Ve,isMultiValueOperator:function(e){return e&&e.toLowerCase()in te},isInteger:function(e){return Number.isInteger(parseFloat(e))},isNumber:Pe,isPromise:vt,isString:je,isUndefined:Ge,isObject:He,joinStrings:we,keyBy:function(e,t){for(var n,i,r=s.isArray(t)?t.length:0,o=0,a={};o<e.length;o++)if(n=e[o],r>0)for(i=0;i<r;i++)n.hasOwnProperty(t[i])&&(a[n[t[i]]]=n);else n.hasOwnProperty(t)&&(a[n[t]]=n);return a},loadJS:Ze,loadRichTextApi:function t(n){var i;e.CKEDITOR?n(e.CKEDITOR):t.loading?t.loading.done(function(){n(e.CKEDITOR)}):(t.loading=s.Deferred(),Ze(me("CKEditor","skuid","ckeditor.js",Rt()),function(){i=e.CKEDITOR=window.CKEDITOR,t.configured||(t.configured=!0,i.disableAutoInline=!0),n(i),t.loading.resolve()}))},loadCSS:function(t,n){return He(t)?n=c(t,n):n.href=t,e.platform.isCordova()&&Ye(n.href,"/")&&(n.href=n.href.substring(1)),e.load.css(n,n.callback)},log:function(e,t){var n=window&&window.console;if(n)switch(!t&&e instanceof Error&&(t="error"),t){case x.ERROR:n.error(e);break;case x.WARNING:n.warn(e);break;default:n.log(e)}},lowercase:qe,makeConditionLogicString:Ae,makeXMLDoc:function(e){return je(e)?s(s.parseXML(e)).children().first():s(e).children().first()},merge:pt,mergeArrays:function(e,t){Array.prototype.push.apply(e,t)},mergeAsDataInContext:function(e,t,n){return ct(dt,e,t,n)},mergeAsTextInContext:ut,mergeAsText:ft,mergeInContext:function(e,t,n){return ct(pt,e,t,n)},mergeNodeProperty:Ce,modelLookup:function(t,n,i,r){var o,a,s,l,c=e.$M(t),d=nt(r);return i||(i=null,r=null),c&&((o=i&&c.getField(i))&&(a=o.displaytype),a&&d&&a!==d&&(a===B?r=parseInt(r,10):a===H&&(r=parseFloat(r))),s=c.getRows(),i&&(s=s.filter(function(e){return c.getFieldValue(e,i,!0)===r}))),s&&s.length&&(l=c.getFieldValue(s[0],n,!0)),l},niceExpand:function(e,t,n,i){n=n||0;var r,o,a,l=e.scrollParent(),c=l[0],d=c.scrollTop,u=c.clientHeight,f=d+u;if(!i&&s(t).is(":visible"))t.hide();else if(t.show(),r=e[0].offsetHeight,(o=(a=e[0].offsetTop-n)+r)>=f-1){var p=Math.min(o-u+18,a);p>d&&(re||l.animate({scrollTop:p},500))}},nl2br:ze,onPageBuilder:function(){return ue()===A},outerHTML:function(e){return e.outerHTML||(t=e,(i=document.createElement("div")).appendChild(t.cloneNode(!0)),n=i.innerHTML,i=null,n);var t,n,i},param:function(e){return s.map(e,function(e,t){return encodeURIComponent(t)+"="+encodeURIComponent(e)}).join("&")},parseAsJSONIfString:Se,parseAsXMLIfString:function(e){if(e&&l.isString(e))try{e=s.parseXML(e)}catch(e){}return e},processStylesNode:function(t,n,i){n.element&&(n=n.element);var r={},o={},a=[];(i=i||{}).removeInlineStyles&&n.removeAttr("style"),t.find("styleitem").each(function(){var t,n,l=s(this),c=l.attr("property"),d=l.attr("value"),u=l.attr("type"),f=l.attr("datasource"),p=e.dataSource.get(f);"background"===u&&"image"===l.attr("bgtype")?(!i.whitelist||i.whitelist&&-1!==i.whitelist.indexOf("background-image"))&&(t=l.attr("bg-source"),(n=p&&p.getImageSource(t))&&n.getSrc&&a.push(n.getSrc({context:{},mergeSettings:{},dataSource:n.dataSource,xmlDef:l,prefix:"bg-"}).then(function(e){o["background-image"]=e?"url("+e+")":""},function(){o["background-image"]=""}))):c&&(!i.whitelist||i.whitelist&&-1!==i.whitelist.indexOf(c))&&(r[c]=d||"")}),s.isEmptyObject(r)||n.css(r),s.when.all(a).then(function(){s.isEmptyObject(o)||n.css(o)})},readFileAsBase64:function(e){var t=s.Deferred(),n=new FileReader;return n.onload=function(e){var n=e.target.result;n?t.resolve(n.substring(n.indexOf(",")+1)):t.reject("No Content Found")},n.onerror=function(e){t.reject(e)},n.readAsDataURL(e),t.promise()},redirect:function(t){if(t){var n=t.model,i=t.row,r=t.url,o=t.title||"",a=t.window,s=c(K,t.mergeSettings||{}),l=!(!window.sforce||!sforce.one)&&sforce.one,d=!!(window.sforce&&sforce.console&&sforce.console.isInConsole())&&sforce.console,u=r&&Ye(r,"/"),f=n&&i?n.getRowId(i):null,p="blank"===a;if(r)if(r=ut(r,{model:n,row:i,$Input:t.$Input},s),pe(e.constants.LIGHTNING))u&&!p?window.$A.get("e.force:navigateToURL").setParams({url:r}).fire():window.open(r);else if(l)l.navigateToURL(r,p);else if(d)u?(n&&i&&(Ye(r,"/"+f)||Ye(r,"/"+f.substring(0,15)))&&n.getRowById(f)&&(o=n.getNameFieldValueForRow(i)),e.ui.openConsoleTabForUrl(r,o)):window.open(r);else if(e.platform.isCordova())if(r.indexOf("/ui/page/preview")>-1){var h=r.split("/");(r=h[h.length-1]).indexOf("?")>-1?r=r.substring(0,r.indexOf("?"))+".html"+r.substring(r.indexOf("?")):r+=".html",window.location=r}else-1===r.indexOf("/")&&r.indexOf(".html")>-1?window.location=r:window.open(r);else u&&(r=ve(r)),p?window.open(r):"parent"===a?parent.location=r:"top"===a?window.top.location.href=r:window.location=r}},registerBlurHandler:function(e,t){var n=s("html");n.on("click.skuidBlur",function i(r){s(r.target).closest(e).length||(n.off("click.skuidBlur",i),t())})},registerPlugin:function(e,t){s.fn[e]=function(n){return t[n]?t[n].apply(this,Array.prototype.slice.call(arguments,1)):(void 0===n?"undefined":i(n))!==_&&n?void s.error("Method "+n+" does not exist on jQuery."+e):t.init.apply(this,arguments)}},reject:function(t){return e.$.Deferred().reject(t).promise()},removeAllAttrsExcept:function(e,t,n){var i={};s.each(t,function(e,t){i[t]=!0});var r=s.map(e[0].attributes,function(e){return e.name});s.each(r,function(t,n){i[n]||e.removeAttr(n)}),n||e.empty()},removeEventSubscriptions:function(t){t&&t.data(m)&&(s.each(t.data(m),function(){e.events.unsubscribe(this)}),t.removeData(m))},removeScriptTags:function(e){return e&&je(e)?e.replace(T,""):e},renameFileWhileKeepingExtension:function(e,t){var n=e.split("."),i=t||"";return i&&-1===i.indexOf(".")&&n.length>1?i+="."+n[n.length-1]:i||(i=e),i},resolve:Dt,rfc4122v4GUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})},runPromiseReturningFunctionsInSeries:function(e){var t=e[0]();return s.each(e,function(e,n){e&&(t=t.then(function(){return n()}))}),t},runningTests:function(){return e.environment===p.ENVIRONMENTS.TEST},scrollTo:function(e,t){t=t||0;var n=e.scrollParent(),i=n[0].clientHeight,r=e[0].offsetHeight,o=e[0].offsetTop+r-t-i+18;re||n.animate({scrollTop:o},500)},sessionStorage:function(t,n){return function(t,n,i){if(!Ge(t)){var r=l["canUse"+ye(i)]();return Ge(n)?r?e.data[i].getItem(t):s.cookie(t):r?(e.data[i].setItem(t,n),n):s.cookie(t,n)}}(t,n,"sessionStorage")},setObjectProperty:function(e,t,n){if(e&&t){for(var i,r,o,a=bt(t),s=0,l=a.length-1;s<l&&(i=a[s],e);){if(e instanceof Array){o=null;try{r=parseInt(i,10)}catch(e){o=e}!o&&!isNaN(i)&&r>=0&&(e=e[r])}else e=!Ge(e[i])&&He(e[i])?e[i]:e[i]={};s++}e&&(e instanceof Array&&isNaN(a[l])?e.push(n):e[a[l]]=n)}},size:function(e){if(Ge(e)||null===e)return 0;if(s.isPlainObject(e)){var t,n=0;for(t in e)e.hasOwnProperty(t)&&n++;return n}return s.isArray(e)||je(e)?e.length:Pe(e)?e.toString().replace(/\D/g,"").length:0},startsWith:Ye,substringLeft:function(e,t){return e&&t&&(void 0===e?"undefined":i(e))===M&&e.length>t?e.substring(0,t):e},substringRight:function(e,t){return e&&t&&(void 0===e?"undefined":i(e))===M&&e.length>t?e.substring(e.length-t,e.length):e},toArray:function(e){return e instanceof Array?e:[e]},toClass:f,unsetObjectProperty:function(e,t){if(e&&t){for(var n,i,r,o=bt(t),a=0,l=o.length-1;a<l&&(n=o[a],e);){if(e instanceof Array){r=null;try{i=parseInt(n,10)}catch(e){r=e}!r&&!isNaN(n)&&i>=0&&(e=e[i])}else{if(!(n in e))throw"No property at this location.";e=e[n]}a++}e&&(s.isArray(e)&&!isNaN(o[l])?e.splice(o[l],1):delete e[o[l]])}},uppercase:function(e){return e&&je(e)?e.toLocaleUpperCase?e.toLocaleUpperCase():e.toUpperCase():e},writeXmlToPageLayoutFields:function(e,t,n){var i,r=ne();if(i=e?je(e)?e:""+yt(e):"",r.length){for(var o,a,l,c,d,u="",f=0,p=0,h=i.length,g=0,m=0,v={};m<r.length&&h>g;){if(o=r[m],l=h>=f+(a=t.getField(o).length),u=i.substring(f,l?f+a:h),c=!1,l&&u.length&&""!==s.trim(u))for(d=u.length-1;d>-1;d--)if(""===s.trim(u[d]))c=!1;else{if(c){p=d+1;break}c=!0}else p=u.length;t.updateRow(n,o,u.substring(0,p)),f+=p,g+=a,m++}for(;m<r.length;)v[o=r[m]]=null,m++;if(t.updateRow(n,v),g<h)throw"The total number of characters in this Page's Layout ("+h+") exceeds the maximum number of characters available for each Page ("+g+"). Please split out some of your content into other Pages, and then include these Pages within this Page."}},XMLToJSON:function e(t){if(!(t instanceof Node))return t;var n={};if(1===t.nodeType){if(t.attributes.length>0){n.$={};for(var i=0;i<t.attributes.length;i++){var r=t.attributes.item(i);n.$[r.nodeName]=r.nodeValue}}}else 3===t.nodeType&&(n=t.nodeValue);if(t.hasChildNodes()&&1===t.childNodes.length&&3===t.childNodes[0].nodeType)n=t.childNodes[0].nodeValue;else if(t.hasChildNodes())for(var o=0;o<t.childNodes.length;o++){var a=t.childNodes.item(o),s=a.nodeName;if(void 0===n[s])n[s]=e(a);else{if(void 0===n[s].push){var l=n[s];n[s]=[],n[s].push(l)}n[s].push(e(a))}}return n},_getRenderOverride:function(e){return kt[e]},_ie:re,_inIframe:function(){try{return window.self!==window.top}catch(e){return!0}},_oniOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream},_setAttachmentBaseUrl:function(e){e&&(n=e.substring(0,e.indexOf("?")))},_setCurrentDomain:function(e){se=e},KeyValueService:Ft,KeyValueStore:Nt,SelectList:Et,SelectItem:At,TemplateComponent:Mt,saveAs:function(){r.saveAs.apply(this,arguments)}})}(window.skuid)},function(e,t,n){"use strict";!function(e,t){var n=e.region={},i={};function r(e){return i[e]}function o(e,t){e.unregisterChildComponents().createChildComponents(t.children(),e.element,e.context)}t.extend(n,{get:r,list:function(){var e=[];return t.each(i,function(t,n){e.push(n)}),e},map:function(){return i},register:function(n,r){if(!n)return!1;n&&e.utils.isString(n)&&(n=e.utils.makeXMLDoc(n)),n.jquery||(n=t(n));var o=n.attr("uniqueid");r&&("__header"!==o&&"__footer"!==o||(o+=r)),i[o]={xmlDefinition:n}},unregisterAll:function(){i={}},setContent:o,setContentByIds:function(t,n){var i=e.$C(t),a=r(n);a&&o(i,a.xmlDefinition.children("components").first())}})}(skuid,skuid.$)},function(e,t,n){"use strict";!function(e,t){var n=e.constants.FLEX,i=e.responsive={config:{resizeWaitTime:100}},r=!1;function o(){return e.utils.getCSSSizeObj.apply(this,arguments)}function a(t){return e.themeSettings.getThemeSettings().spacing(t)}function s(e,t){var n,i,r,a,s,l,c,d,u,f,p;(t=t||{}).columnGutter&&(s=o(t.columnGutter))&&(l=s.number/2+s.unit),t.rowGutter&&(c=o(t.rowGutter))&&(d=c.number+c.unit),(d||l)&&e.css({margin:(d||"0")+" "+(l||"0")+" 0 "+(l||"0")}),"top"===t.verticalAlign?e.css({"-webkit-justify-content":"flex-start","justify-content":"flex-start"}):"center"===t.verticalAlign?e.css({"-webkit-justify-content":"flex-start","justify-content":"center"}):"bottom"===t.verticalAlign&&e.css({"-webkit-justify-content":"flex-start","justify-content":"flex-end"}),"specified"===t.behavior?e.css({width:t.width,"-webkit-flex":"none",flex:"none"}):"fit"===t.behavior?e.css({width:"","-webkit-flex":"none",flex:"none"}):(f=o(t.minWidth),p=o(t.maxWidth),u=o(t.parentMinWidth),n=t.relativeSize||1,i=t.relativeSize||1,f?r=f.number+f.unit:u&&(r=u.number*(t.relativeSize||1)+u.unit),a=n+" "+i+" "+r,e.css({"-webkit-flex":a,flex:a,width:"","max-width":p.unit?p.number+p.unit:void 0}))}function l(e){e.css({margin:"",width:"","-webkit-flex":"none",flex:"none","-webkit-justify-content":"","justify-content":""})}t(window).on("resize orientationchange",function(){!1!==r&&clearTimeout(r),r=setTimeout(e.responsive.handleResize,e.responsive.config.resizeWaitTime)}),t.extend(i,{handleResize:function(){e.events.publish("ui.reflow"),e.events.publish("ui.resize")},prepareDivision:s,prepareFlexDivision:function(e,t){var i,r,s,l,c,d=a((t=t||{}).columnGutter),u=a(t.rowGutter),f=t.relativeSize||1,p=f,h=f,g=n.ALIGNMENT[t.alignSelf];(u||d)&&(c=(u||"0")+" "+(d||"0")+" 0 "+(d||"0")),l=o(t.minWidth),s=o(t.parentMinWidth),l?i=l.number+l.unit:s&&(i=s.number*(t.relativeSize||1)+s.unit),r=p+" "+h+" "+i,e.css({flex:r,alignSelf:g,margin:c,width:null,maxWidth:t.maxWidth})},prepareGrid:function(n,i){var r,a,l,c;if(i.columnGutter&&(r=o(i.columnGutter))&&(a=r.number/2*-1+r.unit),i.rowGutter&&(l=o(i.rowGutter))&&(c=-1*l.number+l.unit),a||c?n.css({margin:(c||"0")+" "+(a||"0")+" 0 "+(a||"0")}):n.css({margin:""}),"rigid"===i.layoutMode&&i.precision&&n.children().length>i.precision&&!n.children(".sm-grid-division-filler").length)for(var d=0;d<i.precision;d++){var u=e.mobile?"sm-card sm-grid-division sm-grid-division-filler":"sk-card sk-grid-division sk-grid-division-filler",f=t("<article>").addClass(u);s(f,{parentMinWidth:i.minWidth,columnGutter:i.columnGutter,rowGutter:i.rowGutter}),n.append(f)}},prepareFlexGrid:function(e,t){e.css({flexDirection:n.DIRECTION[t.flexDirection],justifyContent:n.JUSTIFY[t.justifyContent],alignItems:n.ALIGNMENT[t.alignItems]})},processGrid:function(e){var n,i=parseInt(e.data("voffset"),10),r=parseInt(e.data("vpercent"),10),o=parseInt(e.data("precision"),10);if((i||0===i)&&r||0===r?(n=(e.offsetParent().outerHeight()-i)*(r/100),e.addClass("sm-grid-fixed-vertical").css("height",n+"px")):e.removeClass("sm-grid-fixed-vertical").css("height",""),o){var a,s=0;e.children(".sm-grid-division-forcewrap").remove(),t.each(e.children(".sm-grid-division"),function(){var e,n=t(this),i=n.data("size"),r=n.data("component"),l=r&&r.xmlDefinition&&r.xmlDefinition.attr("type"),c=n[0].offsetTop;e=(!l||"specified"!==l&&"fit"!==l)&&parseInt(i,10)||1,c!==a&&(s=0),(s+=e)>o&&(n.before(t("<div>").addClass("sm-grid-division-forcewrap")),c=n[0].offsetTop,s=e),a=c})}},unMakeDivision:l,unMakeGrid:function(e){e.css({margin:""}),t.each(e.children(),function(){l(this)})}})}(skuid,skuid.$)},function(e,t,n){"use strict";var i,r=n(0),o=(i=r)&&i.__esModule?i:{default:i};!function(e,t){var n=e.ajax={},i={};function r(){return e.utils}function a(t){var n=t.url;if(0===n.indexOf("/")){var i=e.platform.isCordova()&&e.native.instanceUrl;i&&n.indexOf(i)<0&&(t.url=e.utils.combineUrls(i,n))}}function s(n){var o,a,s=n.modelDataSource,l=e.dataSource.get(s),c={_foundCache:!1};return l&&l.isAuthenticated()&&function(e){return e.idempotent||"GET"===e.method}(n)?(o=function(e){return function(e){var t,n,i=0;if(0===e.length)return i;for(t=0,n=e.length;t<n;t++)i=(i<<5)-i+e.charCodeAt(t),i|=0;return i}([e.modelDataSource||"",e.url,e.method||"GET",r().size(e.headers)?JSON.stringify(e.headers):"{}",e.body||""].join(" - "))}(n),(a=i[o])?c._foundCache=!0:(a=i[o]=t.Deferred(),c.deferred=function(){return a}),c.promise=function(){return a.promise()}):(a=t.Deferred(),c.deferred=function(){return a}),c.markComplete=function(){o&&delete i[o]},c.wasFound=function(){return c._foundCache},c.promise=function(){return a.promise()},c}function l(e){for(var t,n=/^(.*?):[ \t]*([^\r\n]*)$/gm,i={};t=n.exec(e);)i[t[1]]=t[2];return i}t.extend(n,{proxy:function(n,i){var o,a,l,c=n.body,d=t.extend({},n.headers),u=r().isString,f=e.platform,p="function"!=typeof f.requiresSerializedProxyRequests||f.requiresSerializedProxyRequests();function h(){e.remote().proxy(p?JSON.stringify(n):n,function(n,i){o.markComplete(),(n=r().parseAsJSONIfString(n))&&(l=n.setCookies),l&&l.length&&(t.cookie.raw=!0,t.each(l,function(n,i){var o,a={};t.each(["path","secure","domain"],function(e,t){t in i&&(a[t]=i[t])}),"expires"in i&&(o=i.expires,a.expires=!1===r().isNumber(o)?e.time.parseDateTimeString(o):parseInt(o,10)),t.cookie(i.name,i.value,a)}),t.cookie.raw=!1),n&&!n.error&&0!==n.statusCode&&(!n.statusCode||n.statusCode<400)?a.resolve(n):(!n&&i&&i.message&&(n={statusCode:0,status:"",error:i.message}),a.reject(n))},i)}return delete n.originalRequest,n.contentType&&(d["Content-Type"]=n.contentType),n.headers=d,o=s(n),delete n.idempotent,o.wasFound()?o.promise():(a=o.deferred(),i||(i={}),i.escape=!1,!c||u(c)||c instanceof FormData||c instanceof Blob||(n.body=JSON.stringify(c)),p&&c instanceof Blob?r().readFileAsBase64(c).then(function(e){n.body=e,h()},function(e){a.reject(e)}):h(),a.promise())},direct:function(n){var i,c=n.body,d=s(n),u=e.offline,f=e.storage;return a(n),d.wasFound()?d.promise():(i=d.deferred(),!c||r().isString(c)||c instanceof FormData||c instanceof Blob?n.data=c:n.data=JSON.stringify(c),delete n.originalRequest,delete n.idempotent,t.extend(n,function(e){return{xhr:function(){var n=t.ajaxSettings.xhr();return n.upload&&n.upload.addEventListener("progress",function(t){e.notify(t)},!1),n}}}(i)),n.offline&&u.networkDown()?f.getDb(o.default.id).getTable("queries").get(n.url).then(function(e){return e.data}):(t.ajax(n).always(function(){d.markComplete()}).done(function(e,t,r){var a={statusCode:r.status,body:e,status:r.statusText,headers:l(r.getAllResponseHeaders())};n.offline&&f.getDb(o.default.id).getTable("queries").add(n.url,{data:a}),i.resolve(a)}).fail(function(e){var t={statusCode:e.status,body:e.responseText,status:e.statusText,headers:l(e.getAllResponseHeaders())};i.reject(t)}),i.promise()))},getResponseHeaderObject:l,getErrorMessage:function(e,t){var n,i,o=t?t+": ":"",a=r().isString,s=e&&!a(e)?e.response||e.body:e;if(s)try{(n=r().parseAsJSONIfString(s))&&(n.message&&a(n.message)?i=n.message:n[0]&&n[0].message&&(i=n[0].message),i&&(o+=i))}catch(e){a(s)&&(o+=s)}return o}})}(skuid,skuid.$)},function(e,t,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,t){var n=t(document.body),r=e.component={},o=e.events,a=e.utils,s=e.constants,l={},c={},d=function(e){return"There is no Skuid Component Type called '"+e+"'"},u="childComponents",f="_skuidComponentEventProperties",p="_skuidComponentEventSubscriptions",h="_crEventSubscriptions",g="_eventService",m="_skuidProperties",v=s.EVENT_SCOPES,y=s.LOG_LEVELS,b=y.WARNING,w=y.ERROR;function S(n,i){var r,o,a,s=[],l=n.is("conditions")?n.children():n.children("conditions").first().children(),c=n.attr("rowid");l&&(i&&(a=i.model,o=i.rows,r=i.row||o&&o.length&&o[0]||null),l.each(function(){var n=new e.model.Condition(t(this)),i=n.mergeField;if("contextrow"==n.type){var l=c;!l&&r&&a&&(l=a.getFieldValue(r,i,!0)),l&&(n.value=l)}else"contextrows"==n.type&&a&&o&&o.length&&(n.values=o.map(function(e){return a.getFieldValue(e,i,!0)}));s.push(n)}));return s}function C(e){var t=e.type();!t||t in c||(c[t]=[]),c[t].push(e),l[e.id()]=e}function I(e){return l[e]}function k(n,i,r,o){var s=void 0,l=void 0;if(1==arguments.length){var c=arguments[0];n=c.element,i=c.xmlDefinition||c.definition,r=c.type||i&&i.componentType,s=c.context,o=c.options,l=c.state}if(o||(o={}),!r&&!i)throw"Either a Component Type or XML Definition must be provided.";if(n?n.jquery||(n=t(n)):n=t("<div>"),i&&(i instanceof e.$||a.isString(i)||i instanceof Element?(a.isString(i)&&(i=a.makeXMLDoc(i)),i.jquery||(i=t(i)),i.length&&(i=i.first()),r||(r=i.prop("tagName")),i.attr("uniqueid")&&(o.uniqueId=i.attr("uniqueid")),i.attr("cssclass")&&n.addClass(i.attr("cssclass"))):i.uniqueId=o.uniqueId=i.uniqueId||a.generateUniqueId()),e.componentType.get(r)){var u,f,p,h=new T(n,r,t.extend(o,{state:l}));return i&&(i instanceof t&&(h.xmlDefinition=h.definition=i,u=i.attr(h.modelAttributeName())),i instanceof t||(i.context=s||i.context,i.uniqueId||(i.uniqueId=h._GUID),h.set(i))),u&&(f=e.$M(u)),f&&(p=f.loadAsync),o.ignoreConditionalRendering?h.render({context:s,xmlDefinition:i}):h.conditionallyRender({context:s,xmlDefinition:i}),p&&!h.onlyRenderOnce&&h.needsModelMetadata()&&f.subscribeOnce("loaded.async",function(){h.rerender()}),h}return d(r)}function x(e,n,i,r,o){var a=[],s=[],l=(o=o||{}).parentComponent;return t.each(e,function(e){var t=l&&l.get&&l.get("uniqueId");t&&(this.attr?this.attr("uniqueId",this.attr("uniqueId")||t+"__"+(l.childComponents.length+e)):this.uniqueId=this.uniqueId=this.uniqueId||t+"__"+(l.childComponents.length+e));var n=k({definition:this,context:i,state:r});n&&n instanceof T&&(n.element&&s.push(n.element),a.push(n))}),n&&(n.append(s),t.each(s,function(){t(this).trigger("attach")})),a}function T(n,i,r){r||(r={});var s,l=this,c=e.componentType.get(i),d=c.cpi;d&&((s=c._cpiKeys)||(s=c._cpiKeys=Object.keys(d))),r.state&&t.extend(l,r.state),l.element=n,l._componentType=i,l._GUID=r.uniqueId||n.prop("id")||a.generateUniqueId(),l._shortcuts={},l[g]=new o.EventService,l[m]={},l[f]={},l[p]=[],l[u]=[],l.isRendered=!1,n.prop("id")!==l._GUID&&n.prop("id",l._GUID),n.attr("data-rendered","false").data({rendered:!1,component:l}),l._cpi={},s&&s.forEach(function(e){l._cpi[e]=function(){return d[e].apply(l,arguments)}}),C(l)}T.prototype={id:function(){return this._GUID},getId:function(){return this.id()},type:function(){return this._componentType},getType:function(){return this.type()},setType:function(e){return this._componentType=e,this},_getCPI:function(){return this._cpi},getCPI:function(){var t=this._cpi,n=a.grab(e.componentType.get(this.type()),"schema","access","cpi","public"),i={};return n&&n.length&&n.forEach(function(e){i[e]=t[e]}),i},getElement:function(){return this.element},getPersonalizationService:function(){var t="_personalizationService",n=this[t];return n||(n=this[t]=e.personalization.createComponentService(this)),n},setParentPageId:function(e){return this._parentPageId=e,this},getParentPage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l[this.getParentPageId(e)]},getParentPageId:function(){var e,t,n,i=this,r=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).root,o=i._parentPageId||this[m].parentPageId,a=this[m].rootParentPageId;return r?a||(this[m].rootParentPageId=s()):o||(this[m].parentPageId=s());function s(){if((n=c.skuidpage)&&1===n.length)return n[0].id();if(r&&(t=i.getParentPage()),t||(e=i.getParentComponent())&&(t=e.getParentPage()),!t){var o=i.element.parent().closest(".nx-page");o.length&&o.data("component")&&(t=o.data("component"))}if(t||"skuidpage"!==i.getType()||i.isInclude||(t=i),t||(t=n[0]),r)for(;"skuidpage"!==(a=t).getType()||a.getParentPage()!==a;)t=t.getParentPage();var a;return t.id()}},setParentComponent:function(e){return this._parentComponent=e,this},getParentComponent:function(){return this._parentComponent},getParentComponentId:function(){return this._parentComponent&&this._parentComponent.id()},render:function(t){var n,r,o=this,s=o.getType(),l=e.componentType.get(s);function c(){o.isBeingRendered=!1,o.set("rendered",!0),o.isRendered=!0,o.element.attr("data-rendered","true").data("rendered",!0),o.publish("rendered",!0)}function u(t){o.isBeingRendered=!1,o.set("rendered",!1),o.isRendered=!1,o.element.attr("data-rendered","false").data("rendered",!1);var n,i=t&&t.message?t.message:t;e.utils.isString(i)&&(i="There was a problem rendering a component of type "+o.getType()+": "+i),n=e.component.getByType("skuidpage"),"skuidpage"===o.getType()?o.addProblem(i):n&&n.length&&n[0].addProblem(i),o.publish("rendered",!1),a.log(t,w)}if(t||(t={}),!l)return d(s);if(t.context&&(o.context=t.context),t.xmlDefinition?o.xmlDefinition=o.definition=n=t.xmlDefinition:n=o.xmlDefinition,o.element.empty&&l&&!l.onlyRenderOnce&&!1!==l.emptyBeforeRender&&o.element.empty(),o.get("enableConditions")&&e.utils.conditionallyDo(function(){o.set("disabled",!1)},function(){o.set("disabled",!0)},o.get("enableConditions"),o.element),o.get("selectedConditions")&&e.utils.conditionallyDo(function(){o.set("selected",!0)},function(){o.set("selected",!1)},o.get("selectedConditions"),o.element),!o.isBeingRendered&&(!o.isRendered||o.isRendered&&!l.onlyRenderOnce)){var f;switch(o.isBeingRendered=!0,void 0===l?"undefined":i(l)){case"function":f=l;break;case"object":if("render"in l){f=l.render;break}default:throw"Invalid Component Type definition. Component Type must be a JavaScript Object with a render() method."}try{r=f.call(l,o.element,n,o)}catch(e){u(e)}r&&e.utils.isPromise(r)?r.then(c,u):c()}return o.get("afterCreateFunction")&&o.get("afterCreateFunction")(o),o},unrender:function(){var r=this,o=r.getType(),a=e.componentType.get(o);return"function"==typeof r.beforeUnrender&&r.beforeUnrender(),r.element.data&&t.each(r.element.data(),function(e,t){"component"!==e&&"object"!==e&&t&&"object"===(void 0===t?"undefined":i(t))&&t.widget&&t.widget._destroy&&t.widget._destroy()}),r.unsubscribeAll(),r.unregisterChildComponents(),r.element.empty&&a&&!a.onlyRenderOnce?r.element.removeAttr("style").empty():a&&a.onlyRenderOnce&&r.xmlDefinition.attr("domid")&&n.append(r.element.children().hide().detach()),r.element.attr("data-rendered","false").data("rendered",!1),r.set("rendered",!1),r.isRendered=!1,r.publish("rendered",!1),"function"==typeof r.afterUnrender&&r.afterUnrender(),r},rerender:function(){return this.unrender().render()},unregisterChildComponents:function(){var e=this[u];return e.forEach(function(e){a.removeEventSubscriptions(e.element),e.unregister&&e.unregister()}),e.length=0,this},conditionallyRender:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;return e.pageComponent||(e.pageComponent=t.getParentPage()),a.conditionallyRender(function(n,i,r,a){t.render(e),a&&a.eventSubscriptions&&(t[h]=(t[h]||[]).concat(a.eventSubscriptions)),a&&a.event&&a.event.userInitiated&&o.publish("ui.reflow",[{component:t}])},function(e,n,i,r){r&&r.event&&r.event.userInitiated&&o.publish("ui.reflow",[{component:t}]),t.unrender()},t.xmlDefinition,t.element,t._GUID,e),t},createConditionsFromXml:function(t,n){var i,r=t||this.xmlDefinition,o=this.element;if(i=S(r,n&&n.context||this&&this.context),o){var a=r.attr("controllingcomponent")||this._controllingComponent;a&&(o.controllingComponent=e.component.getById(a)),o.conditions=i}return i},addProblem:function(e){var n=this;t(function(){var t=n.getParentPage(),i=n._GUID;!t||t.id()===i&&i||t.addProblem(e)})},addProblems:function(e){var n=this;t(function(){var t=n.getParentPage(),i=n._GUID;!t||t.id()===i&&i||t.addProblems(e)})},unregister:function(i){this.publish("beforeUnregister"),i=t.extend({removeElement:!0},i);var r,o=this,a=o.getType(),s=e.componentType.get(a),d=c[a];o.id()in l&&delete l[o.id()],-1!==(r=t.inArray(o,d))&&d.splice(r,1),o.unregisterChildComponents({removeElement:!1}),[h,p].forEach(function(e){var t=o[e];t&&t.length&&t.forEach(function(e){e.unsubscribe()})}),s&&s.onlyRenderOnce&&o.xmlDefinition.attr("domid")&&n.append(o.element.children().hide().detach()),i.removeElement&&this.element.remove(),this.get("styleNode")&&this.get("styleNode").remove()},createChildComponent:function(e,t,n,i){return this.createChildComponents([e],t,n,i)[0]},createChildComponents:function(e,t,n,i){i||(i={}),i._parentComponent=this,i._parentPageId=i._parentPageId||this._parentPageId||this.getParentPageId();var r=x(e,t,n,i,{parentComponent:this});return Array.prototype.push.apply(this[u],r),r},getChildComponents:function(){return this[u]},getChildComponent:function(e){var t=this.getChildComponents().filter(function(t){return t.getId()===e});return t.length>0?t[0]:null},modelAttributeName:function(){return"model"},needsModelMetadata:function(){return!1},get:function(e){return a.getObjectProperty(this[m],e)},has:function(e){return a.hasObjectProperty(this[m],e)},set:function(e,t){var n,i=this[m],r=this,o=this.getState(),s=a.setObjectProperty;return"string"!=typeof e?Object.keys(e).forEach(function(t){var a=e[t];n=o[t],s(i,t,a),n!==a&&r.publish("stateChange:"+t,Array.isArray(a)?[a]:a,{scope:v.COMPONENT,provideDefaultData:!1})}):(n=r.get(e),s(i,e,t),n!==t&&r.publish("stateChange:"+e,Array.isArray(t)?[t]:t,{scope:v.COMPONENT,provideDefaultData:!1})),this},getState:function(){return this[m]},unset:function(){var e=this[m];return Array.prototype.forEach.call(arguments,function(n){n&&t.isArray(n)?n.forEach(function(t){a.unsetObjectProperty(e,t)}):a.unsetObjectProperty(e,n)}),this},bind:function(e,t,n){var i=this;n=n||e,i.set(e,i.get(e)||t.get(n)),t.set(n,i.get(e)||t.get(n)),i.subscribeChange(e,function(e){t.set(n,e)}),t.subscribeChange(n,function(t){i.set(e,t)})},bindMultiple:function(e,t){var n=this;e.forEach(function(e){n.bind(e,t)})},subscribeChange:function(e,t){return this.subscribe("stateChange:"+e,t)},storeSubscription:function(e){return this[p].push(e),this},publish:function(e,n,i){i||(i={});var r,s,l=i.channel,c=this.getType(),d=!1!==i.qualifyEventName?c+"."+e:e,u="skuidpage"===c,p=u?null:this.getParentPage(),h=this[g],m=a.rfc4122v4GUID(),y={scope:v.COMPONENT,uniqueId:m},b={uniqueId:m};return a.isUndefined(n)&&!1!==i.provideDefaultData&&(n={component:this}),r=t.isArray(n)?n:[n],s=i&&i.scope?i.scope:v.PAGE,b.scope=s,l&&(b.channel=l,y.channel=l),a.setObjectProperty(this[f],e,n),h.publish(e,r,y),s!==v.COMPONENT&&(!u&&p&&p.publish(d,r,y),s!==v.SKUID&&s!==v.GLOBAL||o.publish(d,r,b)),this},subscribe:function(e,t,n){var i,r={scope:v.COMPONENT};return n&&n.channel&&(r.channel=n.channel),i=this[g].subscribe(e,t,r),this.storeSubscription(i),i},subscribeToPageEvent:function(e,t,n){var i,r={scope:v.PAGE};return n&&n.channel&&(r.channel=n.channel),i=this.getParentPage().subscribe(e,t,r),this.storeSubscription(i),i},unsubscribe:function(e){for(var t=this[p],n=t.length-1,i=this[g];n>=0;n--)if(t[n].id===e.id){t.splice(n,1),i.unsubscribe(e);break}return this},countEventSubscribers:function(e){return this[g].count(e)},once:function(e,n,i){var r,o=t.Deferred(),s=this[f],l=!(i&&!1===i.cache),c=a.getObjectProperty(s,e),d=this,u=this[g],p=function(e){n&&n(d,e),o.resolve(d,e)};return l&&c?p(c):(r=u.subscribeOnce(e,function(t){a.setObjectProperty(s,e,t),p(t)}),this.storeSubscription(r)),o.promise()},subscribeOnce:function(e,t){return this.once(e,t,{cache:!1})},unsubscribeAll:function(){var e=this[p];return e.length&&(e.forEach(function(e){e.unsubscribe()}),e.length=0),this},shortcut:function(e){var t=this,n=this._shortcuts[e];return n||(n=this._shortcuts[e]=function(){return t[e].apply(t,arguments)}),n},getChildComponentsOfType:function(e){return this.getChildComponents().filter(function(t){return t.getType()===e})}},t.extend(r,{Component:T,createConditionsFromXml:S,getByType:function(e){if(e){var t=c[e];return t||{}}return c},getAll:function(){return t.map(l,function(e){return e})},getById:I,factory:k,register:C,createChildComponents:function(){return a.log('"skuid.component.createChildComponents" is deprecated. Use the skuid.component.Component instance method instead: https://docs.skuid.com/latest/en/skuid/api/skuid_component.html#skuid.component.createChildComponents',b),x.apply(null,arguments)}}),e.$C=I}(skuid,skuid.$)},function(e,t,n){"use strict";!function(e,t){var n=e.componentType={},i={};t.extend(n,{get:function(e){if(e)return i[e]},register:function(t,n){i[t]=n,n.type=t,n.events&&e.events.registerComponentEvents(t,n.events)},unregister:function(n){n&&(e.utils.isString(n)&&n in i?delete i[n]:n instanceof Array&&t.each(n,function(e,t){t&&t in i&&delete i[t]}))},list:function(){return t.map(i,function(e){return e})},map:function(){return i},getAll:function(){return Object.keys(i)}})}(skuid,skuid.$)},function(e,t,n){"use strict";!function(e){var t=e.currency={},n=e.$,i=e.utils,r={AED:"د.إ",AFN:"؋",ALL:"Lek",AMD:"֏",AOA:"Kz",ARS:"$",AWG:"f",AUD:"$",BSD:"$",BBD:"$",BYR:"p.",BZD:"BZ$",BMD:"$",BOB:"$b",BAM:"KM",BWP:"P",BRL:"R$",BND:"$",BDT:"৳",BGN:"лв",BHD:".د.ب",BIF:"Fr",BOV:"-",BRB:"₢",BTN:"Nu.",CAD:"$",KYD:"$",CLP:"$",CNY:"¥",COP:"$",CRC:"c",HRK:"kn",CZK:"Kc",CDF:"Fr",CLF:"UF",CUP:"$",CVE:"Esc",DKK:"kr",DOP:"RD$",DJF:"Fr",DZD:"د.ج",ERN:"Nfk",ETB:"Br",XCD:"$",EGP:"£",SVC:"$",EEK:"kr",EUR:"€",FKP:"£",FJD:"$",GBP:"£",GHC:"c",GIP:"£",GTQ:"Q",GGP:"£",GYD:"$",GEL:"₾",GHS:"₵",GMD:"D",GNF:"Fr",HTG:"G",HNL:"L",HKD:"$",HUF:"Ft",ISK:"kr",IDR:"Rp",IMP:"£",ILS:"₪",INR:"₹",IQD:"ع.د",IRR:"﷼",JMD:"J$",JPY:"¥",JEP:"£",JOD:"د.ا",KES:"Sh",KGS:"с",KHR:"៛",KMF:"Fr",KPW:"₩",KRW:"₩",KWD:"د.ك",KZT:"₸",LAK:"₭",LKR:"ரூ",LSL:"L",LYD:"ل.د",LVL:"Ls",LBP:"£",LRD:"$",LTL:"Lt",MYR:"RM",MXN:"$",MZN:"MT",MAD:"د. م.",MDL:"L",MGA:"Ar",MKD:"ден",MMK:"Ks",MNT:"₮",MOP:"P",MRO:"UM",MUR:"₨",MVR:".ރ",MWK:"MK",MXV:"$",NGN:"₦",NPR:"₨",NAD:"$",ANG:"f",NZD:"$",NIO:"C$",NOK:"kr",OMR:"ر.ع.",PGK:"K",PHP:"₱",PKR:"₨",PAB:"B/.",PYG:"Gs",PEN:"S/.",PLN:"zl",QAR:"ر.ق",RSD:"дин.",RUB:"₽",RWF:"Fr",RON:"lei",SHP:"£",SGD:"$",SBD:"$",SOS:"S",ZAR:"R",SEK:"kr",CHF:"CHF",SRD:"$",SYP:"£",SAR:"ر.س",SCR:"₨",SDG:"ج.س.",SLL:"Le",SSP:"£",STD:"Db",SZL:"L",THB:"฿",TJS:"ЅМ",TMT:"m",TND:"د.ت",TOP:"T$",TZS:"Sh",TWD:"NT$",TTD:"TT$",TRY:"TL",TRL:"£",TVD:"$",USD:"$",UYU:"$U",UAH:"₴",UGX:"Sh",UZS:"лв",VND:"₫",VUV:"Vt",VEF:"Bs",WST:"T",XAF:"Fr",XOF:"Fr",XPF:"Fr",YER:"﷼",ZMK:"ZK",ZWL:"Z$",ZWD:"Z$"};function o(e){var t=r[e];return t||"$"}n.extend(t,{getConversionRates:function(){return i.conversionRates||[]},getDisplayValue:function(e,t){t||(t={});var r,a,s,l=i.userLocale,c=i.userInfo.defaultCurrency,d=t.decimalPlaces||0,u=t.decimalsSeparator||l.decimalsSeparator||".",f=t.thousandsSeparator||l.thousandsSeparator||",",p=t.recordCurrency;return e||0===e||(e=""),a=e,""!==e&&(a=n.number(e,d,u,f),i.isMultiCurrencyOrganization?(a=p+" "+a,p&&p!=c&&(r=i.convertCurrency(e,p,c))&&r!=e&&(a+=" ("+c+" "+n.number(r,d,u,f)+")")):((s=o(c)).match(/^(\$?[a-zA-Z\.\/]+\$?)/)&&(s+=" "),a=s+a)),a},getSymbol:o})}(skuid)},function(e,t,n){"use strict";!function(e,t){var n=e.label={},i={},r={};function o(e,t){return e in i?i[e]:-1===e.indexOf("__")&&"skuid__"+e in i?i["skuid__"+e]:t||""}t.extend(n,{add:function(e){t.extend(i,e)},read:o,labelize:function(n,i,r){var a=e.label.parse(n,i,r),s=a[0],l=a[1],c="";return t(l).each(function(e){c+=this;var t=s[e];t&&(c+=o(t.substring(t.indexOf(".")+1,t.length-1)))}),c},merge:function(n){var i="string"==typeof n,r=i?n:n.template,o=(i?Array.prototype.slice.call(arguments,1):n.data)||[],a=n&&n.leftMerge,s=n&&n.rightMerge,l=e.label.parse(r,a,s),c=l[0],d=l[1],u="";return t(d).each(function(e){u+=this;var t=c[e];t&&(u+=o[t.substring(1,t.length-1)])}),u},parse:function(e,t,n){t||(t="{"),n||(n="}");var i=t+"__"+n,o=i in r?r[i]:r[i]=new RegExp("\\"+t+"[^"+t+"\\"+n+"]+\\"+n,"g");return[e.match(o)||[],e.split(o)]},getAll:function(){return i},map:i}),e.$L=o}(skuid,skuid.$)},function(e,t,n){"use strict";!function(e,t){var n,i,r=e.time={},o=(new Date).getTimezoneOffset(),a=(new Date).getTimezoneOffset(),s=!1,l="moment",c=function(e){return void 0===e};function d(e){return"[object Date]"===Object.prototype.toString.call(e)}function u(){if(i)return i;var t=window.Intl&&window.Intl.DateTimeFormat&&window.Intl.DateTimeFormat();return t&&(t=t.resolved?t.resolved.timeZone:t.resolvedOptions?t.resolvedOptions().timeZone:null),!t&&e[l]&&(t=e[l].tz.guess()),i=t,t}function f(){var t=function(t){return e.settings.get("userLocale",t)};e[l].updateLocale("sk-user-locale",{months:t("monthNames"),monthsShort:t("monthNamesShort"),weekdays:t("dayNames"),weekdaysShort:t("dayNamesShort"),weekdaysMin:t("dayNamesMin"),meridiem:function(e){return e<12?t("amPm")[0]:t("amPm")[1]}})}function p(e){if(!e)return!1;if(d(e))return e;var t=e.split&&e.split("T"),n=t&&t.length&&t[0].split("-");return!(!n||3!==n.length)&&new Date(n[0],n[1]-1,n[2])}function h(t){if(t){if(d(t)){var n=t.getMonth()-0+1+"",i=t.getDate()+"";return 1===n.length&&(n="0"+n),1===i.length&&(i="0"+i),t.getFullYear()+"-"+n+"-"+i}return e.utils.isString(t)&&3===t.split("-").length?t:null}return null}function g(e){return m(C(e))}function m(n){return n?t.datepicker.formatDate(e.utils.userLocale.dateFormat,n):""}var v=/^(\d{4}|[+\-]\d{6})(?:-(\d{2})(?:-(\d{2}))?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(?:\.(\d{3}))?)?(?:(Z)|([+\-])(\d{2})(?::?(\d{2}))?)?)?$/;function y(t){var n=e.utils;if(!t&&0!==t)return!1;var i,r=Date.parse,o=[1,4,5,6,7,10,11],a=0;if(i=v.exec(t)){for(var s,l=0;s=o[l];++l)i[s]=+i[s]||0;return i[2]=(+i[2]||1)-1,i[3]=+i[3]||1,"Z"===i[8]||n.isUndefined(i[9])||(a=60*i[10]+i[11],"+"===i[9]&&(a=0-a)),Date.UTC(i[1],i[2],i[3],i[4],i[5]+a,i[6],i[7])}return n.isString(t)&&-1!==t.split(":")[0].indexOf("N_")?NaN:r?r(t):NaN}function b(e){if(d(e))return e;var t=y(e);return!isNaN(t)&&!1!==t&&new Date(t)}function w(t){return s?e[l].tz.zone(n).offset(t):a}function S(t){return s?e[l].tz.zone(u()).offset(t):o}function C(e){if(!e)return!1;var t=e.getTime(),n=new Date(t);return n.setMinutes(n.getMinutes()-(w(t)-S(t))),n}function I(e){if(!e)return!1;var t=e.getTime(),n=new Date(t);return n.setMinutes(e.getMinutes()+(w(t)-S(t))),n}function k(t,n){if(!n&&0!==n)return"";e.utils.isString(n)&&(n=b(n));var i,r=function(e){var n=i+1<t.length&&t.charAt(i+1)===e;return n&&i++,n},o=function(e){return e.getHours()%12},a=function(e,t,n){var i=""+t;if(r(e))for(;i.length<n;)i="0"+i;return i},s="",l=!1;if(n)for(i=0;i<t.length;i++)if(l)"'"!==t.charAt(i)||r("'")?s+=t.charAt(i):l=!1;else switch(t.charAt(i)){case"a":s+=T(n);break;case"h":var c=o(n);0===c&&(c=12),s+=a("h",c,2);break;case"K":s+=a("h",o(n),2);break;case"k":s+=a("k",n.getHours()+1,2);break;case"H":s+=a("H",n.getHours(),2);break;case"m":s+=a("m",n.getMinutes(),2);break;case"s":s+=a("s",n.getSeconds(),2);break;case"S":s+=a("S",n.getMilliseconds(),3);break;case"Z":var d=S(n),u=Math.floor(Math.abs(d)/60),f=Math.abs(d)-60*u;u<10&&(u="0"+u),f<10&&(f="0"+f),s+=(d<0?"+":"-")+u+f;break;case"'":r("'")?s+="'":l=!0;break;default:s+=t.charAt(i)}return s}function x(t,n){var i,r,o=e.utils,a=o.isUndefined;return t||0===t?(o.isString(t)?(t=(r=(i=v.exec(t))&&!a(i[3])&&a(i[4]))?p(t):b(t))&&!r&&(t=C(t)):o.isNumber(t)&&(t=new Date(t)),t&&o.isDate(t)?(n&&(t=Date.prototype[n].call(t)),t):null):null}function T(t){var n=e.time.amPm,i=x(t,"getHours");return null!==i?i>11?n[1]:n[0]:null}Date.prototype.toISOString||function(){function e(e){return e<10?"0"+e:e}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"."+(this.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}}(),t.each({getYear:"getFullYear",getDay:"getDate",getHour:"getHours",getMinute:"getMinutes",getSecond:"getSeconds",getMillisecond:"getMilliseconds",getUTCYear:"getUTCFullYear",getUTCDay:"getUTCDate",getUTCHour:"getUTCHours",getUTCMinute:"getUTCMinutes",getUTCSecond:"getUTCSeconds"},function(e,t){r[e]=function(e){return x(e,t)}});var R="YEAR",D="QUARTER",A="MONTH",E="WEEK",F="DAY",N="HOUR",M="MINUTE",_="SECOND";function P(e,t,n){t=t||{},n=n||{};var i,r,o=t.years||0,a=t.quarters||0,s=(t.months||0)+3*a,l=t.weeks||0,c=t.days||0,d=(t.hours||0)+24*c+168*l,u=t.minutes||0,f=t.seconds||0,p=t.milliseconds||0,h=n.baseDate,g=n.useDeviceTimeZone||n.useDeviceTimezone;switch(r=h?new Date(h.getTime()):g?new Date:C(new Date),e){case R:r.setMonth(0);case D:r.setMonth(r.getMonth()-r.getMonth()%3);case A:r.setDate(1);case F:r.setHours(0);case N:r.setMinutes(0);case M:r.setSeconds(0);case _:r.setMilliseconds(0);break;case E:r.setHours(-24*r.getDay()),r.setMinutes(0),r.setSeconds(0),r.setMilliseconds(0)}return o&&r.setFullYear(r.getFullYear()+o),s&&(i=(r.getMonth()+s)%12,r.setMonth(r.getMonth()+s),r.getMonth()>i&&r.setDate(-r.getDate())),d&&r.setHours(r.getHours()+d),u&&r.setMinutes(r.getMinutes()+u),f&&r.setSeconds(r.getSeconds()+f),p&&r.setMilliseconds(r.getMilliseconds()+p),h||g||(r=I(r)),r}var O=e.constants.DATE_KEYWORDS,L=O.NOW,U=O.YESTERDAY,B=O.TODAY,j=O.TOMORROW,V=O.LAST_90_DAYS,G=O.NEXT_90_DAYS,H=O.LAST_N_DAYS,z=O.NEXT_N_DAYS,q=O.N_DAYS_AGO,$=O.LAST_WEEK,W=O.THIS_WEEK,Y=O.NEXT_WEEK,K=O.LAST_N_WEEKS,X=O.NEXT_N_WEEKS,J=O.N_WEEKS_AGO,Q=O.LAST_MONTH,Z=O.THIS_MONTH,ee=O.NEXT_MONTH,te=O.LAST_N_MONTHS,ne=O.NEXT_N_MONTHS,ie=O.N_MONTHS_AGO,re=O.LAST_QUARTER,oe=O.THIS_QUARTER,ae=O.NEXT_QUARTER,se=O.LAST_N_QUARTERS,le=O.NEXT_N_QUARTERS,ce=O.N_QUARTERS_AGO,de=O.LAST_YEAR,ue=O.THIS_YEAR,fe=O.NEXT_YEAR,pe=O.LAST_N_YEARS,he=O.NEXT_N_YEARS,ge=O.N_YEARS_AGO;function me(e){if("string"!=typeof e||0===e.length)return e;var n,i,r,o=P,a=function(e){return o(F,e)},s=function(e){return o(E,e)},l=function(e){return o(A,e)},c=function(e){return o(D,e)},d=function(e){return o(R,e)};switch(e=e.split(":"),t.isNumeric(e[1])&&(r=parseInt(e[1])),e[0]){case L:n=i=new Date;break;case U:n=a({days:-1}),i=a();break;case B:n=a(),i=a({days:1});break;case j:n=a({days:1}),i=a({days:2});break;case V:n=a({days:-90}),i=a();break;case G:n=a({days:1}),i=a({days:91});break;case H:if(!r)return e;n=a({days:-r}),i=a();break;case z:if(!r)return e;n=a({days:1}),i=a({days:r+1});break;case q:if(!r)return e;n=a({days:-r}),i=a({days:1-r});break;case $:n=s({weeks:-1}),i=s();break;case W:n=s(),i=s({weeks:1});break;case Y:n=s({weeks:1}),i=s({weeks:2});break;case K:if(!r)return e;n=s({weeks:-r}),i=s();break;case X:if(!r)return e;n=s({weeks:1}),i=s({weeks:1+r});break;case J:if(!r)return e;n=s({weeks:-r}),i=s({weeks:1-r});break;case Q:n=l({months:-1}),i=l();break;case Z:n=l(),i=l({months:1});break;case ee:n=l({months:1}),i=l({months:2});break;case te:if(!r)return e;n=l({months:-r}),i=l();break;case ne:if(!r)return e;n=l({months:1}),i=l({months:1+r});break;case ie:if(!r)return e;n=l({months:-r}),i=l({months:1-r});break;case re:n=c({quarters:-1}),i=c();break;case oe:n=c(),i=c({quarters:1});break;case ae:n=c({quarters:1}),i=c({quarters:2});break;case se:if(!r)return e;n=c({quarters:-r}),i=c();break;case le:if(!r)return e;n=c({quarters:1}),i=c({quarters:1+r});break;case ce:if(!r)return e;n=c({quarters:-r}),i=c({quarters:1-r});break;case de:n=d({years:-1}),i=d();break;case ue:n=d(),i=d({years:1});break;case fe:n=d({years:1}),i=d({years:2});break;case pe:if(!r)return e;n=d({years:-r}),i=d();break;case he:if(!r)return e;n=d({years:1}),i=d({years:1+r});break;case ge:if(!r)return e;n=d({years:-r}),i=d({years:1-r});break;default:return e[0]}return[n,i]}t.extend(r,{formatDate:function(n,i){if(void 0!==i&&void 0!==n){var r,o,a=e.utils.isString;return a(i)&&!a(n)&&d(n)?(r=n,o=i):(a(i)&&(i=b(i)),r=i,o=n),t.datepicker.formatDate(o,r)}return""},formatTime:k,getAnchoredDate:P,getDayName:function(t){var n=x(t,"getDay");return null!==n?e.time.dayNames[n]:null},getDayNameShort:function(t){var n=x(t,"getDay");return null!==n?e.time.dayNamesShort[n]:null},getDayOfWeek:function(e){var t=x(e,"getDay");return null!==t?1+t:null},getLocalDateTime:C,getMonth:function(e){var t=x(e,"getMonth");return null!==t?1+t:null},getMonthName:function(t){var n=x(t,"getMonth");return null!==n?e.time.monthNames[n]:null},getMonthNameShort:function(t){var n=x(t,"getMonth");return null!==n?e.time.monthNamesShort[n]:null},getParseDateTimeResult:y,getPeriod:T,getRealJSDateTimeFromLocal:I,getSFDate:h,getSFDateTime:function(t){return t&&"function"==typeof t.toISOString?t.toISOString():t&&e.utils.isString(t)?t:null},getUTCDayOfWeek:function(e){var t=x(e,"getUTCDay");return null!==t?1+t:null},getUTCMonth:function(e){var t=x(e,"getUTCMonth");return null!==t?1+t:null},makeFormattedDate:function(t){return t?1===(n=e.utils.isDate(t)?h(t):t).split(" ").length?m(p(n)):g(p(n)):"";var n},makeFormattedDateFromJS:g,makeFormattedDateFromLocal:m,makeFormattedLongDateTime:function(t){if(t){var n=C(d(t)?t:b(t)),i=e.utils.userLocale;if(n)return i.showTimeBeforeDate?k(i.timeFormat,n)+" "+m(n):m(n)+" "+k(i.timeFormat,n)}return""},parseDateString:b,parseDateTimeString:b,parseSFDate:p,parseSFDateTime:function(e){return b(e)},resolveDateKeyword:me,resolveDateTimeValue:function(n,i){i||(i={});var r=e.utils,o=i.fieldType,a=i.useLocalTimeZone?C:function(e){return e},s=e.constants.DISPLAY_TYPES,l=s.DATE,c=s.DATETIME,d=void 0;if(r.isDate(n))return n;if(r.isNumber(n))return new Date(n);if(r.isString(n)){switch(o||(n.indexOf("T")>=0?c:l)){case l:d=p(n);break;case c:d=a(b(n))}if(d)return d;if(d=me(n),t.isArray(d))return a(d[0])}return null},roundedNow:function(){var e=new Date;return e.setMilliseconds(0),e},initializeMomentLocale:function(){var n,i=e.utils;return(n=e[l]?t.Deferred().resolve():i.loadJS(i.getStaticResourceUrl("MomentJS","skuid",null,i.getCacheTimestamp()))).then(function(){f(),e.events.subscribe("skuid.settings.modified:userLocale",f)}).catch(function(){throw"Unable to initialize moment locale information."}),n.promise()},setUserTimeZone:function(t,i){if(c(t))throw"A valid TimeZone Id is required.";var r=n,d=a,f=u(),p=!c(i)&&d!==i||r!==t,h=e.utils,g=h.resolve;return p?((c(f)?o===i:f===t)||e[l]?g():h.loadJS(h.getStaticResourceUrl("MomentJS","skuid",null,h.getCacheTimestamp()))).then(function(){var o;return o=e[l],s=!c(o),n=t,a=o?o.tz.zone(n).offset(new Date):c(i)?a:i,e.events.publish("ui.timeZoneChanged",[{oldTimeZone:r,newTimeZone:t}]),{changed:!0}}).catch(function(){throw"Unable to load information for timezone."}):g({changed:!1})},getUserTimeZone:function(){return n},getDeviceTimeZone:u,setUserTimeZoneOffset:function(e){a=e}})}(skuid,skuid.$)},function(e,t,n){"use strict";!function(e,t){var n="_cls",i=e.remote=function(){var r,o=e.utils.getObjectProperty,a=i[n],s=o(window,a),l=o(window,"skuid.RemotingStubs");return"skuid.RemotingStubs"!==a?(r=l||{},s&&t.extend(r,s)):r=s||l,r};function r(e){i[n]=e}function o(e,t){this.remoteImpl=e,this.isRemoteStillValid=t}o.prototype={isValid:function(){return this.isRemoteStillValid()},getRemoteImpl:function(){return this.remoteImpl}},r("skuid.RemotingStubs"),i.set=r,i.get=function(){return i[n]},i.promisify=function(t,n){var i=Array.prototype.slice.call(arguments,2);return e.$.Deferred(function(r){i.push(function(t,n){n.status?r.resolve(e.utils.parseAsJSONIfString(t)):r.reject(n.message)}),i.push({escape:!1}),t[n].apply(null,i)})},i.Provider=o}(skuid,skuid.$)},function(e,t,n){"use strict";!function(e,t,n){var i=e.data={},r={},o=e.constants.DISPLAY_TYPES.REFERENCE,a=0,s=0;function l(){return e.utils}function c(e,n){var i=e[n],o=r[e];o||(o=r[i]={}),t.extend(o,e)}function d(n){var i={},a={};return t.each(n,function(n,s){var c,d=s.objectType,u=s.dataSourceName,f=s.idField,p=s.fields,h=s.records,g=i[n]={};t.each(h,function(i,s){var h,m={},v={},y=0,b={};t.each(p,function(e,t){v[t]=1,y++}),y&&((h=r[s])&&t.each(v,function(e){var t=l().getObjectProperty(h,e);l().isUndefined(t)||(b[e]=t,delete v[e],y--)}),y&&(t.each(e.model.list(),function(e,n){if(n.data&&n.data.length&&(n.objectName===d&&(h=n.getRowById(s))&&t.each(v,function(e){e in h&&(b[e]=n.getFieldValue(h,e,!0),delete v[e],y--)}),y)){var i={},r=n.fields;r&&r.length&&t.each(r,function(e,n){var r=n.referenceTo;n.displaytype===o&&r&&r.length&&t.each(r,function(e,t){if(t.objectName===d)return i[n.id]=n.rel,!1})}),l().size(i)&&t.each(i,function(e,i){if(t.each(n.data,function(n,r){if(l().getObjectProperty(r,e)===s&&(t.each(v,function(e){var t=l().getObjectProperty(r,i+"."+e);l().isUndefined(t)||(b[e]=t,delete v[e],y--)}),!y))return!1}),!y)return!1})}}),y&&((c=a[d])||(c=a[n]={objectType:d,dataSourceName:u,idField:f,fields:{},records:[]}),c.records.push(s),c.fields[f]=1,t.each(v,function(e){c.fields[e]=1})))),t.extend(m,b),g[s]={record:m,isDone:0===y}})}),{data:i,serverRequests:a}}function u(e){var n=[];t.each(e,function(e,t){n.push([e,t])}),n.sort(function(e,t){return e[1]-t[1]});var i=[];return t.each(n,function(e,t){i.push(t[0])}),i}i.get=function(n){var i,r,o=d(n),u=o.serverRequests,f=o.data;return l().size(u)?(i=a++,r=t.map(u,function(n){var r=new e.model.Model({conditions:[{field:n.idField,operator:"IN",type:"multiple",values:n.records}],dataSource:e.dataSource.get(n.dataSourceName),doClone:!1,doQuery:!0,fields:t.map(n.fields,function(e,t){return{id:t}}),id:"data_req_"+l().generateGUID(),objectName:n.objectType,recordsLimit:n.records.length});return r.calloutIterator=i,r.lastSuccessfulCallout=function(){return s},r}),u={},e.model.load(r).then(function(){return t.each(r,function(e,n){var i=n.getIdField(),r=n.getKeyPrefix(),o=f[r];t.each(n.data,function(e,n){"attributes"in n&&delete n.attributes;var r=n[i],a=o[r];a||(a=o[r]={}),t.extend(a,n),a.isDone=!0,c(n,i)})}),s=r[0].lastSuccessfulCallout,f})):t.Deferred().resolve(f)},i.getSync=function(e){var t=d(e);return l().size(t.serverRequests)?null:t.data},i.add=c,i.localStorage=window.localStorage,i.sessionStorage=window.sessionStorage;var f=45e6,p="TIME_CACHED_REPO";function h(r){var o,a={},s={},c={},d={};return{setItem:function(e,t,o){if(d[e]!==t||o){var s=n.compress(t);if(s&&!(s.length>=f)){var l=!1;for(a=a||JSON.parse(this.getItem(p)||"{}");!l;)try{i[r].setItem(e,s),e!==p&&(a[e]=Date.now(),d[e]=t),l=!0}catch(e){if(!(e.name.toLowerCase().indexOf("quota")>-1))throw e;var c=u(a)[0];if(!c)throw e;i[r].removeItem(c),delete a[c]}e!==p&&this.setItem(p,JSON.stringify(a))}}},batchSetItem:function(n,i){var r=this;if(c[n]!==i){c[n]=i,d[n]=i;var a=function(){t.each(c,function(e,t){r.setItem(e,t,!0),delete c[e]})};if(!o){if(e.utils.runningTests())return o=t.when().then(function(){a(),o=void 0});o=setTimeout(function(){a(),o=void 0},500)}}},getItem:function(t){if(d[t])return d[t];var i=e.data[r].getItem(t);t!==p&&(a[t]=Date.now(),this.batchSetItem(p,JSON.stringify(a)));var o=n.decompress(i)||i;return d[t]=o},getItemJSON:function(e){var t=this.getItem(e);return s[t]?s[t]:s[t]=l().parseAsJSONIfString(t)},removeItem:function(e){i[r].removeItem(e);var t=d[e];t&&delete s[t],delete d[e],delete a[e],this.batchSetItem(p,JSON.stringify(a))},clear:function(){i[r].clear(),this._internals.inMemCache=d={},this._internals.timeCache=a={},this._internals.jsonParsedCache=s={}},_internals:{timeCache:a,jsonParsedCache:s,updatesToMake:c,inMemCache:d,TIME_CACHED_KEY:p}}}i.v2={localStorage:h("localStorage"),sessionStorage:h("sessionStorage")}}(skuid,skuid.$,window.LZString)},function(e,t,n){"use strict";!function(e,t){var n,i={},r={},o=e.constants.EVENT_SCOPES,a=e.utils,s=2;function l(){return a.ingestConstructorArguments.apply(window,arguments)}function c(e,t,n,i){l(this,{name:e,label:t},{parameters:n,metadata:i})}function d(e,t,n,i){l(this,{name:e,label:t,displayType:n},{metadata:i}),this.displayType=this.displayType.toUpperCase()}function u(e,t,n,i){l(this,{eventService:e,topic:t},{callback:n,channel:i}),this.id=""+a.generateGUID()}function f(){var n={},i={},r={},a=function(){},l=Date.now()+"-"+s++,c=2;function d(e,t,i){n[e]||(n[e]=[]);var r=i&&i.channel,o=new u(a,e,t,r);return n[e].push(o),o}function f(e,n,i){return e instanceof Array?t.map(e,function(e){return d(e,n,i)}):d(e,n,i)}function p(e){var t,i=e.getTopic(),r=e.getId(),o=n[i];if(o&&o.length){for(t=o.length-1;t>=0;t--)if(o[t].getId()===r){o.splice(t,1);break}o.length||delete n[i]}}function h(e){t.isArray(e)?e.forEach(p):p(e)}return t.extend(a,{count:function(e){function t(e){var t=n[e];return t&&t.length?t.length:0}if(e)return t(e);var i={};for(e in n)i[e]=t(e);return i},publish:function(a,s,d){d||(d={}),d.buffer&&!i[a]?i[a]={interval:d.buffer}:!1===d.buffer&&i[a]&&delete i[a];var u,f=i[a],p=d.channel,h=d.scope,g=d.uniqueId,m=n[a]&&n[a].length,v=e.platform&&e.platform.publishEvent&&h===o.GLOBAL;function y(){if(g){if(r[g])return;!function(e){r[e]=1,setTimeout(function(){delete r[e]},5)}(g)}if(u=[],s&&(t.isArray(s)?Array.prototype.push.apply(u,s):u.push(s)),u.push({uniqueId:g}),n[a]&&n[a].length&&t.each(n[a].slice(0),function(e,t){var n=t.getCallback(),i=t.getChannel();!n||i&&i!==p||n.apply(window,u)}),h===o.GLOBAL&&e.platform&&e.platform.publishEvent){var i={};p&&(i.channel=p),e.platform.publishEvent(a,u,i)}}(m||v||f)&&(g||(g=d.uniqueId=l+"-"+c++),f?(!f.initialCallTime||(new Date).getTime()-f.initialCallTime>f.interval)&&(setTimeout(y,f.interval),f.initialCallTime=(new Date).getTime()):y())},subscribe:f,subscribeOnce:function(e,n,i){var r=n?null:t.Deferred(),o=f(e,function(){h(o),n?n.apply(t,arguments):r.resolve.apply(t,arguments)},i);return n?o:r.promise()},unsubscribe:h}),a}function p(e){return t.map(e,function(e){return e}).sort(function(e,t){return e.getLabel()>t.getLabel()})}function h(e){if(!(e instanceof c))throw"Expected an instance of skuid.event.Event";var t=e.getName();i[t]||(i[t]=e)}function g(e,t){if(!(t instanceof c))throw"Expected an instance of skuid.event.Event";var n=t.getName(),i=r[e];i||(i=r[e]={}),i[n]||(i[n]=t,t.setComponentType(e))}c.prototype={getName:function(){var e=this.getComponentType();return e?e.type+"."+this.name:this.name},getLabel:function(){var e=this.getComponentType();return e?(e.label||e.type)+": "+this.label:this.label},getParam:function(e){var t=this.parameters,n=0;if(t)for(;n<t.length;n++)if(t[n].getName()===e)return t[n]},getParameters:function(){return this.parameters||[]},getScope:function(){if(this.metadata&&this.metadata.scope)return this.metadata.scope},isSubscribable:function(){return!this.metadata||!1!==this.metadata.subscribable},isComponentEvent:function(){return!!this._cmpType},getComponentType:function(){if(this._cmpType)return e.componentType.get(this._cmpType)},setComponentType:function(t){if(!e.componentType.get(t))throw"Invalid Component Type: "+t;return this._cmpType=t,this}},d.prototype={getName:function(){return this.name},getLabel:function(){return this.label},getDisplayType:function(){return this.displayType},getMetadata:function(){return this.metadata}},u.prototype={getCallback:function(){return this.callback},getChannel:function(){return this.channel},getId:function(){return this.id},getTopic:function(){return this.topic},unsubscribe:function(){this.eventService.unsubscribe(this)}},n=new f,e.events={Event:c,EventParameter:d,EventService:f,get:function(e,t){var n,o=t||e;return t?(n=r[e])?n[o]:void 0:i[o]},getRegisteredGlobalEvents:function(){return p(i)},getRegisteredComponentEvents:function(e){if(e){var n=r[e];return n?p(n):[]}var i={};return t.each(r,function(e,t){i[e]=p(t)}),i},register:function(e){t.isArray(e)?e.forEach(h):a.isUndefined(e)||h(e)},registerComponentEvents:function(e,n){t.isArray(n)?n.forEach(function(t){g(e,t)}):g(e,n)},count:n.count,publish:n.publish,subscribe:n.subscribe,subscribeOnce:n.subscribeOnce,unsubscribe:n.unsubscribe}}(skuid,skuid.$)},function(e,t,n){"use strict";!function(e,t){t.fn.skootip=function(n,i){var r,o={position:{my:"center bottom",at:"center top-10",collision:"fit",using:function(e,n){t(this).css({top:e.top,left:e.left});var i=e.left+n.element.width/2,o=n.target.left+n.target.width/2;r=Math.floor(o-i-4)}},show:{delay:700},open:function(e,n){var i=t("<div>").addClass("sk-hastooltip").css("left",r+"px");n.tooltip.append(i)}};return n&&this.attr("title",n),i&&t.extend(!0,o,i),e.utils._oniOS()?this:this.tooltip(o)}}(skuid,skuid.$)},function(e,t,n){"use strict";!function(e,t,n){var i=e.webfonts={attemptedToLoadFonts:!1,fontsloaded:!1},r="/resource/skuid__Fonts/";function o(){return e.utils}t.extend(i,{haveFontsLoaded:function(){return i.fontsloaded},load:function(n){function r(){var t=window.sforce,n=t&&t._consoleApiUrl,r=function(){e.events.publish("ui.fontsloaded")};i.fontsloaded=!0,n?e.load.js(n).always(function(){r()}):r()}n=o().parseAsJSONIfString(n);var a,s,l,c=i.processFontConfig(n&&n.fontConfig),d=n?n.cssResources:null,u=o().getSafeRelativeUrl,f=t("link#themeLink")[0];if(c.custom||c.google||c.typekit?(c.active=r,c.inactive=r,i.attemptedToLoadFonts=!0,WebFont.load(c)):r(),d)for(s=0;s<d.length;s++)a=d[s],l=null,o().isString(a)?l=a:"static"===a.type?(l=e.platform.themeBuilder.getThemeResourceUrl(a),t("body").find('link[href="'+l.substring(l.indexOf("force.com")).replace("force.com","")+'"]').remove()):l=a.url||a.path,l&&o().loadCSS(u(l),{insertAfter:f})},processFontConfig:function(i){i===n&&(i={});var a=o().size,s=o().getSafeRelativeUrl,l=t.extend({},i),c=l.custom,d=o().inPlatform(e.constants.LIGHTNING);return c!==n&&(d&&c.localurls&&c.localurls.length&&(c.localurls.forEach(function(e,t){c.urls[t]=e}),delete c.localurls),c.urls&&c.urls.length&&c.urls.forEach(function(t,n){var i=t;i=function(e){return o().startsWith(e,r)}(t)?e.platform.getResourceUrl({name:"Fonts",ns:"skuid",path:t.substring(r.length),modstamp:e.version?e.version.date:null}):s(t),c.urls[n]=i}),a(c)&&c.families!==n&&c.families.length||delete l.custom),(c=l.google)!==n&&(a(c)&&c.families!==n&&c.families.length||delete l.google),(c=l.typekit)!==n&&(a(c)&&c.id!==n&&"string"==typeof c.id||delete l.typekit),l}})}(skuid,skuid.$)},function(e,t,n){"use strict";var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();!function(e,t){var n,r=e.themeSettings={},o=e.utils;r.load=function(i){n=new a(t.extend({},e.utils.parseAsJSONIfString(i))),e.events.publish("ui.themeSettings.loaded")},r.getAll=function(){return n&&n.getAll()},r.getThemeSettings=function(){return n};var a=function(){function t(n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.themeSettingsMap=n,this._id=e.utils.rfc4122v4GUID()}return i(t,[{key:"getAll",value:function(){return this.themeSettingsMap}},{key:"setAll",value:function(e){this.themeSettingsMap=e}},{key:"get",value:function(e){return o.getObjectProperty(this.themeSettingsMap,e)}},{key:"set",value:function(e,t){o.setObjectProperty(this.themeSettingsMap,e,t)}},{key:"unset",value:function(t){e.utils.unsetObjectProperty(this.themeSettingsMap,t)}},{key:"getId",value:function(){return this._id}}]),t}();r.ThemeSettings=a}(skuid,skuid.$)},function(e,t,n){"use strict";!function(e){e.constants={ACTION_SEQUENCE_TYPES:{REUSABLE:"reusable",EVENT_TRIGGERED:"event-triggered",HOTKEY_TRIGGERED:"hotkey-triggered",VOICE_COMMAND:"voice-command"},AGGREGATION_TYPES:{SUM:"sum",AVERAGE:"avg",MAXIMUM:"max",MINIMUM:"min",MEDIAN:"med",COUNT:"count"},DATASOURCE:{SEARCH_CONDITION:"__default_searchbox",GLOBAL_SEARCH_CONDITION:"search"},DATE_KEYWORDS:{NOW:"NOW",YESTERDAY:"YESTERDAY",TODAY:"TODAY",TOMORROW:"TOMORROW",LAST_90_DAYS:"LAST_90_DAYS",NEXT_90_DAYS:"NEXT_90_DAYS",LAST_N_DAYS:"LAST_N_DAYS",NEXT_N_DAYS:"NEXT_N_DAYS",N_DAYS_AGO:"N_DAYS_AGO",LAST_WEEK:"LAST_WEEK",THIS_WEEK:"THIS_WEEK",NEXT_WEEK:"NEXT_WEEK",LAST_N_WEEKS:"LAST_N_WEEKS",NEXT_N_WEEKS:"NEXT_N_WEEKS",N_WEEKS_AGO:"N_WEEKS_AGO",LAST_MONTH:"LAST_MONTH",THIS_MONTH:"THIS_MONTH",NEXT_MONTH:"NEXT_MONTH",LAST_N_MONTHS:"LAST_N_MONTHS",NEXT_N_MONTHS:"NEXT_N_MONTHS",N_MONTHS_AGO:"N_MONTHS_AGO",LAST_QUARTER:"LAST_QUARTER",THIS_QUARTER:"THIS_QUARTER",NEXT_QUARTER:"NEXT_QUARTER",LAST_N_QUARTERS:"LAST_N_QUARTERS",NEXT_N_QUARTERS:"NEXT_N_QUARTERS",N_QUARTERS_AGO:"N_QUARTERS_AGO",LAST_YEAR:"LAST_YEAR",THIS_YEAR:"THIS_YEAR",NEXT_YEAR:"NEXT_YEAR",LAST_N_YEARS:"LAST_N_YEARS",NEXT_N_YEARS:"NEXT_N_YEARS",N_YEARS_AGO:"N_YEARS_AGO"},DATE_STORAGE_FORMAT:"YYYY-MM-DD",DISPLAY_TYPES:{ADDRESS:"ADDRESS",ANYTYPE:"ANYTYPE",ARRAY:"ARRAY",BASE64:"BASE64",BOOLEAN:"BOOLEAN",BUTTON:"BUTTON",BUTTONGROUP:"BUTTONGROUP",COMBOBOX:"COMBOBOX",CURRENCY:"CURRENCY",CUSTOM:"CUSTOM",DATE:"DATE",DATETIME:"DATETIME",DOUBLE:"DOUBLE",EMAIL:"EMAIL",ENCRYPTEDSTRING:"ENCRYPTEDSTRING",FORMULA:"FORMULA",ID:"ID",IMAGE:"IMAGE",INTEGER:"INTEGER",LOCATION:"LOCATION",MULTIBUTTONGROUP:"MULTIBUTTONGROUP",MULTIPICKLIST:"MULTIPICKLIST",NUMBER:"NUMBER",OBJECT:"OBJECT",PHONE:"PHONE",PICKLIST:"PICKLIST",PERCENT:"PERCENT",REFERENCE:"REFERENCE",STRING:"STRING",TEXT:"TEXT",TEXTAREA:"TEXTAREA",RICHTEXT:"RICHTEXT",TIME:"TIME",URL:"URL",UUID:"UUID"},ENVIRONMENTS:{DEV:"development",PROD:"production",TEST:"test"},EVENT_SCOPES:{COMPONENT:"component",MODEL:"model",PAGE:"page",SKUID:"skuid",GLOBAL:"global"},FIELD_TYPES:{BUTTON:"BUTTON",CHILDREL:"CHILDREL",COMBO:"COMBO",FILE:"FILE",IMAGE:"IMAGE"},FLEX:{DIRECTION:{"x-axis":"row","y-axis":"column",auto:null},ALIGNMENT:{top:"flex-start",middle:"center",bottom:"flex-end",stretch:"stretch",baseline:"baseline",auto:"auto"},JUSTIFY:{left:"flex-start",center:"center",right:"flex-end",justify:"space-between",spaced:"space-around",auto:null}},HTTP_VERBS:{GET:"GET",PATCH:"PATCH",POST:"POST",PUT:"PUT",DELETE:"DELETE",MERGE:"MERGE"},JS_TYPES:{BOOLEAN:"boolean",NUMBER:"number",STRING:"string",OBJECT:"object",FUNCTION:"function",UNDEFINED:"undefined"},LIGHTNING:"lightning",LOCAL:"local",LOG_LEVELS:{ERROR:"error",WARNING:"warning",INFO:"info"},MAPPED_STYLE_SETTINGS_TOKEN_NAME:"styleSettingVariantNameMappings",MEDIA_QUERY_BREAKPOINTS:{medium:1024,small:480},MERGE_CONTEXTS:{GLOBAL:"global",MODEL:"model",ROW:"row"},MIME_TYPES:{JSON:"application/json",ZIP:"application/zip",FORM_URL_ENCODED:"application/x-www-form-urlencoded"},NATIVE:"skuid-platform",SALESFORCE:"salesforce",VISUALFORCE:"visualforce",WEB_ICON_SET_LABELS:{"font-awesome":"Font Awesome 4","foundation-icons":"Foundation","icons8-win10":"Icons8 Windows 10",ionicons:"Ion","material-icons":"Material","lightning-icons":"Lightning Design"},WEB_ICON_SET_PREFIXES:["font-awesome","foundation-icons","icons8-win10","ionicons","material-icons","lightning-icons"]}}(skuid)},function(e,t,n){"use strict";var i,r=n(0),o=(i=r)&&i.__esModule?i:{default:i};skuid.version=o.default,skuid.snippet.register("skuid.getPageAPIVersionPicklistEntries",function(){return skuid.platform.getPageAPIVersions().map(function(e){var t=e.id;return{active:!0,defaultValue:!!e.isDefault,label:t,value:t}})})},function(e,t,n){"use strict";!function(e){var t={};function n(e,n){t[e]=n}function i(e){return t[e]}e.snippet={registerSnippet:n,register:n,getSnippet:i,get:i,unregister:function(e){delete t[e]}}}(skuid)},function(e,t,n){"use strict";n.r(t);n(214),n(213),n(212),n(211),n(210),n(209),n(208),n(207),n(206),n(205),n(204),n(203),n(202),n(201),n(200),n(199),n(198),n(197),n(195),n(192),n(189),n(188),n(187),n(186),n(185),n(19),n(184),n(183),n(182),n(181),n(180),n(179),n(178),n(177),n(176),n(175),n(174),n(173),n(172),n(171),n(170),n(169),n(168),n(167),n(166),n(165),n(164),n(163),n(162),n(161),n(160),n(159),n(158),n(157),n(156),n(155),n(44)}]);